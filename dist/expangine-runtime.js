!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("expangine-runtime",[],e):"object"==typeof exports?exports["expangine-runtime"]=e():t["expangine-runtime"]=e()}(this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};function o(t){return"number"==typeof t&&isFinite(t)}function i(t){return"string"==typeof t}function u(t){return Array.isArray(t)}function p(t){return t instanceof Date}function c(t){return t instanceof Map}function s(t){return"boolean"==typeof t}function a(t){return"function"==typeof t}function f(t){return"object"==typeof t&&!Array.isArray(t)}function y(t){return void 0===t}function l(t,e){return t.constructor===e.constructor}function d(t){if(u(t))return 0===t.length;if(f(t)){for(var e in t)return!1;return!0}return null==t}function h(t,e,n){void 0===n&&(n=function(t){return t});var r={};for(var o in t){var i=t[o];r[n(o,i)]=e(i,o)}return r}function m(t){var e=[];for(var n in t)e.push(t[n]);return e}function v(t){var e,n,o=[];try{for(var i=r(t),u=i.next();!u.done;u=i.next()){var p=u.value;o.push(p)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o}function b(t,e){return 0===t&&0===e?0:t<e?1:-1}function g(t,e){return void 0===t?e:t}var _={boolean:0,number:1,bigint:2,string:3,symbol:4,object:5,undefined:6,function:7};function x(t,e){if(t===e)return 0;var n=typeof t,r=typeof e;if(n!==r)return _[n]-_[r];var o=u(t),i=u(e);if(o!==i)return(o?1:0)-(i?1:0);if(o)return t.length-e.length;switch(n){case"object":var p=t instanceof Date,c=e instanceof Date;if(p!==c)return(p?1:0)-(c?1:0);if(p)return t.getTime()-e.getTime();var s=0,a=0;for(var f in t)f in e||s++;for(var f in e)f in t||a++;for(var f in t)if(f in e){var y=x(t[f],e[f]);y<0&&s++,y>0&&a++}return b(s,a);case"bigint":case"number":return t-e;case"boolean":return(t?1:0)-(e?1:0);case"string":return t.localeCompare(e)}return 0}function w(t,e,n){var o,i;if(void 0===e&&(e=[]),void 0===n&&(n=[]),!t)return t;if(p(t))return new Date(t.getTime());if("object"==typeof t){var c=e.indexOf(t);if(-1!==c)return n[c];if(u(t)){var s=[];e.push(t),n.push(s);try{for(var a=r(t),f=a.next();!f.done;f=a.next()){var y=f.value;s.push(w(y,e,n))}}catch(t){o={error:t}}finally{try{f&&!f.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return s}var l={};for(var d in e.push(t),n.push(l),t)l[d]=w(t[d],e,n);return l}return t}function T(t,e,n){return void 0===n&&(n=e),O(t+"",e,"0",!0).substring(0,n)}function O(t,e,n,r){for(;t.length<e;)r?t=n+t:t+=n;return t}var M,S=function(){function t(t){this.options=t}return t.fromInput=function(e){return e instanceof t?e:e.baseType},t.resolve=function(e){var n,r=this;return e&&(e instanceof t?n=e:e.baseType instanceof t?n=e.baseType:u(e)?n=e.map(function(t){return r.resolve(t)}):f(e)&&(n=h(e,function(t){return r.resolve(t)}))),n},t.prototype.getOperations=function(t){var e=this;return this.operations||(this.operations=h(t.operations.map,function(t){return t(e)})),this.operations},t}(),C=function(t){this.id=t},j=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u},E=function(){function t(t){this.prefix=t,this.map=Object.create(null)}return t.prototype.getBuilder=function(t){return this.map[t]||this.map[this.prefix+t]},t.prototype.get=function(t,e){return this.getBuilder(t)(e)},t.prototype.set=function(t,e,n,r,o,i){void 0===e&&(e={});var u=this.prefix+t,p=e.mutates||[],c=e.complexity||0,s={id:u,mutates:p,complexity:c,returnType:S.resolve(n),params:S.resolve(r),optional:S.resolve(o),scope:S.resolve(i)},a=i?h(i,function(t,e){return e}):void 0;return this.put(u,!1,c,a,function(){return s})},t.prototype.build=function(t,e,n,r,o){void 0===e&&(e={});var i=this.prefix+t,u=e.mutates||[],p=e.complexity||0;return this.put(i,!0,p,r,function(t){var e=j(n(t,o),4),r=e[0],c=e[1],s=e[2],a=e[3];return{id:i,mutates:u,complexity:p,returnType:S.resolve(r),params:S.resolve(c),optional:S.resolve(s),scope:S.resolve(a),generics:o}})},t.prototype.put=function(t,e,n,r,o){var i=o;return i.id=t,i.dynamic=e,i.complexity=n,i.scopeDefaults=r,this.map[t]=i,i},t}(),A=(M=function(t,e){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}M(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),P=function(t){function e(n){var r=t.call(this,e.id)||this;return r.value=n,r}return A(e,t),e.has=function(t,n){return t instanceof e&&t.value===n},e.is=function(t){return t instanceof e},e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return u(t.value)?[this.id,t.value]:t.value},e.prototype.getComplexity=function(){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="constant",e}(C),k=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k(e,t),e.decode=function(t,e){return this.baseType},e.encode=function(t){return this.id},e.describe=function(t,e){return this.baseType},e.prototype.merge=function(t,e){},e.prototype.getSubTypes=function(){return null},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return!0},e.prototype.isValid=function(t){return!0},e.prototype.normalize=function(t){return t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){return null},e.id="any",e.operations=new E("any:"),e.baseType=new e({}),e.describePriority=0,e}(S),I=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return I(e,t),e.decode=function(t,n){return new e(n.getType(t[1]))},e.encode=function(t){return[this.id,t.options.encode()]},e.describe=function(t,e){return null},e.prototype.getOperations=function(t){return this.operations||(this.operations=this.options.getOperations(t)),this.operations},e.prototype.merge=function(t,e){},e.prototype.getSubTypes=function(){return this.options.getSubTypes()},e.prototype.getExactType=function(t){return this.options.getExactType(t)},e.prototype.isCompatible=function(t){return t instanceof e?this.options.isCompatible(t.options):this.options.isCompatible(t)},e.prototype.isValid=function(t){return null==t||this.options.isCompatible(t)},e.prototype.normalize=function(t){return null==t?t:this.options.normalize(t)},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){return this.options&&t(0,1,!1)>.3?this.options.random(t):void 0},e.id="?",e.operations=new E("?:"),e.baseType=new e(D.baseType),e.describePriority=-1,e}(S),L=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return L(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getType(t)}))},e.encode=function(t){var e=t.options.map(function(t){return t.encode()});return[this.id,e]},e.describe=function(t,e){return null},e.prototype.getOperations=function(t){var e=this;return this.operations||(this.operations={},this.options.forEach(function(t){var n=t.getOperations(t.constructor);for(var r in n)e.operations[r]=n[r]})),this.operations},e.prototype.forMany=function(t,e){var n,r,o=this.options;try{for(var i=F(o),u=i.next();!u.done;u=i.next()){var p=e(u.value);if(void 0!==p)return p}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},e.prototype.merge=function(t,e){},e.prototype.getSubTypes=function(){var t=this;return this.subs||(this.subs={},this.options.forEach(function(e){var n=e.getSubTypes();n&&Object.assign(t.subs,n)})),this.subs},e.prototype.getExactType=function(t){return this.forMany(this,function(e){return e.isValid(t)?e:void 0})},e.prototype.isCompatible=function(t){return this.forMany(!1,function(e){return!!e.isCompatible(t)||void 0})},e.prototype.isValid=function(t){return this.forMany(!1,function(e){return!!e.isValid(t)||void 0})},e.prototype.normalize=function(t){return this.forMany(t,function(e){return e.isValid(t)?e.normalize(t):void 0})},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){var e=this.options;return e[t(0,e.length,!0)].random(t)},e.id="many",e.operations=new E("many:"),e.baseType=new e([D.baseType]),e.describePriority=-1,e}(S),N=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e.decode=function(t,n){var r=h(t[1],function(t){return n.getType(t)});return e.from(r)},e.encode=function(t){var e=h(t.options.props,function(t){return t.encode()});return[this.id,e]},e.describe=function(t,n){return f(t)&&null!==t?e.from(h(t,function(t){return n.describe(t)})):null},e.from=function(t){return new e({props:t?S.resolve(t):{}})},e.prototype.merge=function(t,e){var n=this.options.props,r=t.options.props;for(var o in n)n[o]=o in r?e.mergeType(n[o],r[o]):e.optionalType(n[o]);for(var o in r)o in n||(n[o]=e.optionalType(r[o]))},e.prototype.getSubTypes=function(){return this.options.props},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){if(!(t instanceof e))return!1;var n=this.options.props;for(var r in n)if(!t.options.props[r])return!1;return!0},e.prototype.isValid=function(t){if(!f(t))return!1;var e=this.options.props;for(var n in e)if(!e[n].isValid(t[n]))return!1;return!0},e.prototype.normalize=function(t){return t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){var e=this.options.props,n=Object.create(null);for(var r in e)n[r]=e[r].random(t);return n},e.id="obj",e.operations=new E("obj:"),e.baseType=e.from(),e.describePriority=5,e}(S),z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return z(e,t),e.decode=function(t,n){return new e({returnType:n.getType(t[1]),params:n.getType([q.id,t[2]]),expression:n.getExpression(t[3])})},e.encode=function(t){var e=t.options,n=e.returnType,r=e.params,o=e.expression;return[this.id,n.encode(),r.encode(),o.encode()]},e.describe=function(t,e){return null},e.prototype.merge=function(t,e){},e.prototype.getSubTypes=function(){var t=this.options;return{returnType:t.returnType,params:t.params}},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e&&this.options.returnType.isCompatible(t.options.returnType)&&this.options.params.isCompatible(t.options.params)},e.prototype.isValid=function(t){return a(t)},e.prototype.normalize=function(t){return t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){var e=this;return function(){return e.options.returnType.random(t)}},e.id="func",e.operations=new E("func:"),e.baseType=new e({returnType:D.baseType,params:q.baseType,expression:null}),e.describePriority=-1,e}(S),Y=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},J=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u},B=function(){function t(t){this.types=Object.create(null),this.expressions=Object.create(null),this.parsers=Object.create(null),this.functions=Object.create(null),this.describers=[],this.operations=new E(""),t&&this.add(t)}return t.prototype.extend=function(e,n){void 0===e&&(e=!1);var r=new t({types:m(this.types),expressions:m(this.expressions),aliases:h(this.aliased,function(t){return e?t.encode():t}),functions:h(this.functions,function(t){return e?t.encode():t})});return n&&r.add(n),r},t.prototype.add=function(t){var e=this;t.types&&t.types.forEach(function(t){return e.addType(t)}),t.expressions&&t.expressions.forEach(function(t){return e.addExpression(t)}),this.import(t)},t.prototype.describe=function(t){var e,n;try{for(var r=Y(this.describers),o=r.next();!o.done;o=r.next()){var i=o.value.describe(t,this);if(i)return i}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return D.baseType},t.prototype.merge=function(t,e){return this.mergeType(t,this.describe(e))},t.prototype.mergeType=function(t,e){var n,r;if(t instanceof D)return e;var o=t instanceof V||e instanceof V,i=this.requiredType(t),u=this.requiredType(e);if(l(i,u))return i.merge(u,this),o?new V(i):i;if(i instanceof U||u instanceof U){var p=this.getTypes(i),c=this.getTypes(u),s=p.length;try{for(var a=Y(c),f=a.next();!f.done;f=a.next()){for(var y=f.value,d=!1,h=y instanceof V,m=h?y.options:y,v=0;v<s;v++){var b=p[v],g=b instanceof V,_=g?b.options:b;l(_,m)&&(d=!0,_.merge(m,this),h&&!g&&(p[v]=new V(_)))}d||p.push(y)}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o?new V(this.getReducedType(p)):this.getReducedType(p)}return new U([t,e])},t.prototype.optionalType=function(t){var e=this;return t instanceof V?t:(t instanceof U&&(t.options=t.options.map(function(t){return e.requiredType(t)})),new V(t))},t.prototype.requiredType=function(t){return t instanceof V?t.options:t},t.prototype.getTypes=function(t){return t instanceof U?t.options:[t]},t.prototype.getReducedType=function(t){return 1===t.length?t[0]:new U(t)},t.prototype.sortDescribers=function(){this.describers.sort(function(t,e){return e.describePriority-t.describePriority})},t.prototype.addType=function(t){this.types[t.id]=t,this.parsers[t.id]=function(e,n){return t.decode(e,n)},this.describers.push(t),this.sortDescribers()},t.prototype.addAlias=function(t,e){var n=e instanceof S?e:this.getType(e);this.parsers[t]=function(){return n},this.aliased[t]=n},t.prototype.getType=function(t){if(t instanceof S)return t;var e=u(t)?t[0]:t,n=u(t)?t:[];return this.parsers[e](n,this)},t.prototype.addFunction=function(t,e,n,r){var o=new R({returnType:S.resolve(e),params:q.from(S.resolve(n)),expression:this.getExpression(r)});return this.functions[t]=o,o},t.prototype.setFunction=function(t,e){return this.functions[t]=this.getType(e)},t.prototype.getFunction=function(t){return this.functions[t]},t.prototype.getOperationBuilder=function(t){var e=this.operations.getBuilder(t);if(e)return e;var n=J(t.split(":"),1)[0],r=this.types[n];return r?r.operations.getBuilder(t):null},t.prototype.addExpression=function(t){this.expressions[t.id]=t},t.prototype.getExpression=function(t){if(t instanceof C)return t;if(u(t)){var e=this.expressions[t[0]];if(!e)throw new Error("An expression was not found for: "+JSON.stringify(t));return e.decode(t,this)}return new P(t)},t.prototype.export=function(){return{aliases:h(this.aliased,function(t){return t.encode()}),functions:h(this.functions,function(t){return t.encode()})}},t.prototype.import=function(t){var e=this;t.aliases&&h(t.aliases,function(t,n){return e.addAlias(n,t)}),t.functions&&h(t.functions,function(t,n){return e.setFunction(n,t)})},t}(),X=function(){function t(t){this.defs=t,this.ops=Object.create(null),this.exprs=Object.create(null)}return t.prototype.extend=function(e){var n=new t(e||this.defs);return Object.assign(n.ops,this.ops),Object.assign(n.exprs,this.exprs),n},t.prototype.setOperation=function(t,e){this.ops[t.id]=e},t.prototype.setExpression=function(t,e){this.exprs[t.id]=e},t.prototype.getFunction=function(t){return this.defs.getFunction(t)},t.prototype.getOperation=function(t){return this.ops[t]},t.prototype.getOperationScopeDefaults=function(t){var e=this.defs.getOperationBuilder(t);return e?e.scopeDefaults:{}},t.prototype.getExpression=function(t){return this.exprs[t]},t.prototype.getCommand=function(t){return this.exprs[t.id](t,this)},t.prototype.eval=function(t){return u(t)?this.getCommand(this.defs.getExpression(t)):function(){return t}},t}(),H=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return H(e,t),e.decode=function(t){return new e(t[1]||{})},e.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},e.describe=function(t,n){return o(t)?new e({min:t,max:t,whole:Math.abs(Math.floor(t)-t)<=e.WHOLE_EPSILON}):null},e.prototype.merge=function(t,e){var n=this.options,r=t.options;n.max=Math.max(n.max,r.max),n.min=Math.min(n.min,r.min),n.whole=n.whole&&r.whole},e.prototype.getSubTypes=function(){return null},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e},e.prototype.isValid=function(t){return o(t)},e.prototype.normalize=function(t){return t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){var e=this.options,n=e.min,r=e.max,o=e.whole;return t(g(n,0),g(r,10),o)},e.WHOLE_EPSILON=1e-6,e.id="num",e.operations=new E("num:"),e.baseType=new e({}),e.describePriority=4,e}(S),K=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return K(e,t),e.decode=function(t,n){return new e(t[1]||{})},e.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},e.describe=function(t,e){return s(t)?this.baseType:null},e.prototype.merge=function(t,e){},e.prototype.getSubTypes=function(){return null},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e||t instanceof W},e.prototype.isValid=function(t){if(s(t))return!0;var e=t+"";return!(!this.options.true||!this.options.true[e])||!(!this.options.false||!this.options.false[e])},e.prototype.normalize=function(t){if(!s(t)){var e=t+"";if(this.options.true&&this.options.true[e])return!0;if(this.options.false&&this.options.false[e])return!1}return t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){return t(0,1,!1)<.5},e.id="bool",e.operations=new E("bool:"),e.baseType=new e({}),e.describePriority=4,e}(S),Q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Z=function(){return(Z=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},$=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Q(e,t),e.decode=function(t,n){var r=n.getType(t[1]),o=t[2]||{};return new e(Z({item:r},o))},e.encode=function(t){var e=Z({},t.options),n=e.item;return delete e.item,d(e)?[this.id,n.encode()]:[this.id,n.encode(),e]},e.describe=function(t,n){if(!u(t))return null;for(var r=n.describe(t[0]),o=1;o<t.length;o++)r=n.merge(r,t[o]);return new e({item:r,min:t.length,max:t.length})},e.forItem=function(t){return new e({item:S.fromInput(t)})},e.prototype.merge=function(t,e){var n=this.options,r=t.options;n.item=e.mergeType(n.item,r.item),n.min=Math.min(n.min,r.min),n.max=Math.max(n.max,r.max)},e.prototype.getSubTypes=function(){return{length:e.lengthType,item:this.options.item}},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e&&this.options.item.isCompatible(t.options.item)},e.prototype.isValid=function(t){var e,n;if(!Array.isArray(t))return!1;var r=this.options,i=r.item,u=r.min,p=r.max;if(o(u)&&t.length<u)return!1;if(o(p)&&t.length>p)return!1;try{for(var c=$(t),s=c.next();!s.done;s=c.next()){var a=s.value;if(!i.isValid(a))return!1}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return!0},e.prototype.normalize=function(t){if(u(t))for(var e=this.options.item,n=0;n<t.length;n++)t[n]=e.normalize(t[n]);return t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){for(var e=this.options,n=e.min,r=e.max,o=g(n,2),i=g(r,5),u=t(Math.min(o,i),Math.max(o,i)+1,!0),p=[],c=0;c<u;c++)p.push(this.options.item.random(t));return p},e.prototype.getSplitResultType=function(){return q.from({pass:this,fail:this})},e.prototype.getIterationScope=function(){return{list:this,item:this.options.item,index:e.lengthType}},e.prototype.getCompareScope=function(){return{list:this,value:this.options.item,test:this.options.item}},e.lengthType=new W({min:0,whole:!0}),e.id="list",e.operations=new E("list:"),e.baseType=new e({item:D.baseType}),e.describePriority=6,e.IterationScopeDefaults={list:"list",item:"item",index:"index"},e.CompareScopeDefaults={list:"list",value:"value",test:"test"},e}(S),et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-+=:.",rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return et(e,t),e.decode=function(t){return new e(t[1]||{})},e.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},e.describe=function(t,n){return i(t)?new e({min:t.length,max:t.length,requireLower:t.toLowerCase()===t,requireUpper:t.toUpperCase()===t}):null},e.prototype.merge=function(t,e){var n=this.options,r=t.options;n.max=Math.max(n.max,r.max),n.min=Math.min(n.min,r.min),n.requireLower=n.requireLower&&r.requireLower,n.requireUpper=n.requireUpper&&r.requireUpper},e.prototype.getSubTypes=function(){return null},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e},e.prototype.isValid=function(t){if(!i(t))return!1;var e=this.options,n=e.min,r=e.max,u=e.requireLower,p=e.requireUpper,c=e.matches,s=e.forceLower,a=e.forceUpper;return!(o(n)&&t.length<n)&&(!(o(r)&&t.length>r)&&(!(u&&t!==t.toLowerCase()&&!s)&&(!(p&&t!==t.toUpperCase()&&!a)&&!(c&&c instanceof RegExp&&!c.test(t)))))},e.prototype.normalize=function(t){return i(t)&&(this.options.forceLower&&(t=t.toLowerCase()),this.options.forceUpper&&(t=t.toUpperCase())),t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){for(var e=this.options,n=e.min,r=e.max,o=e.requireLower,i=e.forceLower,u=e.requireUpper,p=e.forceUpper,c=o||i,s=u||p,a=t(g(n,1),g(r,16)+1,!0),f="",y=0;y<a;y++)f+=nt.charAt(t(0,nt.length,!0));return c&&(f=f.toLowerCase()),s&&(f=f.toUpperCase()),f},e.id="text",e.operations=new E("text:"),e.baseType=new e({}),e.describePriority=3,e}(S),ot=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},ut=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u},pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ot(e,t),e.decode=function(t,n){var r=n.getType(t[1]);return new e({key:t[2]?n.getType(t[2]):rt.baseType,value:r})},e.encode=function(t){var e=t.options,n=e.key,r=e.value;return n!==rt.baseType?[this.id,r.encode()]:[this.id,r.encode(),n.encode()]},e.describe=function(t,n){var r,o;if(!c(t))return null;var i=new D({}),u=new D({});try{for(var p=it(t.entries()),s=p.next();!s.done;s=p.next()){var a=ut(s.value,2),f=a[0],y=a[1];i=n.merge(i,f),u=n.merge(u,y)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}return new e({key:i,value:u})},e.forItem=function(t,n){void 0===n&&(n=rt);var r=S.fromInput(t);return new e({key:S.fromInput(n),value:r})},e.prototype.merge=function(t,e){var n=this.options,r=t.options;n.key=e.mergeType(n.key,r.key),n.value=e.mergeType(n.value,r.value)},e.prototype.getSubTypes=function(){var t=this.options;return{key:t.key,value:t.value}},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e&&this.options.key.isCompatible(t.options.key)&&this.options.value.isCompatible(t.options.value)},e.prototype.isValid=function(t){if(t instanceof Map&&f(t)){var e=this.options,n=e.key,r=e.value;return this.iterate(t,!0,function(t,e){if(!n.isValid(t)||!r.isValid(e))return!1})}return!1},e.prototype.normalize=function(t){var e=this.options,n=e.key,r=e.value,o=[];return this.iterate(t,void 0,function(t,e){o.push([n.normalize(t),r.normalize(e)])}),new Map(o)},e.prototype.iterate=function(t,e,n){var r,o,i,u;if(t instanceof Map)try{for(var p=it(t.entries()),c=p.next();!c.done;c=p.next()){var s=ut(c.value,2);if(void 0!==(l=n(s[0],s[1])))return l}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}else if(f(t))try{for(var a=it(t),y=a.next();!y.done;y=a.next()){var l,d=y.value;if(void 0!==(l=n(d,t[d])))return l}}catch(t){i={error:t}}finally{try{y&&!y.done&&(u=a.return)&&u.call(a)}finally{if(i)throw i.error}}return e},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){for(var e=this.options,n=e.key,r=e.value,o=t(2,6,!0),i=new Map,u=0;u<o;u++){var p=n.random(t),c=r.random(t);i.set(p,c)}return i},e.prototype.getValuesType=function(){return tt.forItem(this.options.value)},e.prototype.getKeysType=function(){return tt.forItem(this.options.key)},e.prototype.getEntriesType=function(){return q.from({keys:this.getKeysType(),values:this.getValuesType()})},e.prototype.getIterationScope=function(){return{map:this,key:this.options.key,value:this.options.value}},e.prototype.getCompareScope=function(){return{key:this.options.key,value:this.options.value,test:this.options.value}},e.id="map",e.operations=new E("map:"),e.baseType=new e({key:rt.baseType,value:D.baseType}),e.describePriority=7,e.IterationScopeDefaults={map:"map",key:"key",value:"value"},e.CompareScopeDefaults={key:"key",value:"value",test:"test"},e}(S),ct=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),st=function(t){function e(n){var r=t.call(this,e.id)||this;return r.expressions=n,r}return ct(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.expressions.map(function(t){return t.encode()});return[this.id,e]},e.prototype.getComplexity=function(t){return this.expressions.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="and",e}(C),at=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ft=function(t){function e(n){var r=t.call(this,e.id)||this;return r.chain=n,r}return at(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.chain.map(function(t){return t.encode()});return[this.id,e]},e.prototype.getComplexity=function(t){return this.chain.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="chain",e}(C),yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lt=function(t){function e(n,r){var o=t.call(this,e.id)||this;return o.define=n,o.body=r,o}return yt(e,t),e.decode=function(t,n){return new e(h(t[1],function(t){return n.getExpression(t)}),n.getExpression(t[2]))},e.encode=function(t){var e=h(t.define,function(t){return t.encode()});return[this.id,e,t.body.encode()]},e.prototype.getComplexity=function(t){var e=this.body.getComplexity(t);for(var n in this.define)e=Math.max(e,this.define[n].getComplexity(t));return e},e.prototype.getScope=function(){return h(this.define,function(){return D.baseType})},e.prototype.encode=function(){return e.encode(this)},e.id="def",e}(C),dt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ht=function(t){function e(n,r,o,i,u,p){var c=t.call(this,e.id)||this;return c.variable=n,c.start=r,c.end=o,c.body=i,c.breakVariable=u,c.maxIterations=p,c}return dt(e,t),e.decode=function(t,n){return new e(t[1],n.getExpression(t[2]),n.getExpression(t[3]),n.getExpression(t[4]),t[5]||"break",parseInt(t[6])||this.MAX_ITERATIONS)},e.encode=function(t){var e=[this.id,t.variable,t.start.encode(),t.end.encode(),t.body.encode()],n=t.maxIterations!==this.MAX_ITERATIONS;return("break"!==t.breakVariable||n)&&e.push(t.breakVariable),n&&e.push(t.maxIterations),e},e.prototype.getComplexity=function(t){return Math.max(this.start.getComplexity(t),this.end.getComplexity(t),this.body.getComplexity(t))+1},e.prototype.getScope=function(){var t;return(t={})[this.variable]=W.baseType,t[this.breakVariable]=G.baseType,t},e.prototype.encode=function(){return e.encode(this)},e.MAX_ITERATIONS=1e5,e.id="for",e}(C),mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(t){function e(n){var r=t.call(this,e.id)||this;return r.path=n,r}return mt(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.path.map(function(t){return t.encode()});return[this.id,e]},e.prototype.getComplexity=function(t){return this.path.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="get",e}(C),bt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u},_t=function(t){function e(n,r){var o=t.call(this,e.id)||this;return o.cases=n,o.otherwise=r,o}return bt(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){var e=gt(t,2),r=e[0],o=e[1];return[n.getExpression(r),n.getExpression(o)]}),n.getExpression(t[2]))},e.encode=function(t){var e=t.cases.map(function(t){var e=gt(t,2),n=e[0],r=e[1];return[n.encode(),r.encode()]});return P.has(t.otherwise,void 0)?[this.id,e]:[this.id,e,t.otherwise.encode()]},e.prototype.getComplexity=function(t){return this.cases.reduce(function(e,n){var r=gt(n,2),o=r[0],i=r[1];return Math.max(e,o.getComplexity(t),i.getComplexity(t))},this.otherwise.getComplexity(t))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="if",e}(C),xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wt=function(t){function e(n){var r=t.call(this,e.id)||this;return r.expression=n,r}return xt(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]))},e.encode=function(t){var e=t.expression.encode();return[this.id,e]},e.prototype.getComplexity=function(t){return this.expression.getComplexity(t)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="not",e}(C),Tt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ot=function(t){function e(n,r,o){var i=t.call(this,e.id)||this;return i.name=n,i.params=r,i.scopeAlias=o,i}return Tt(e,t),e.decode=function(t,n){return new e(t[1],h(t[2],function(t){return n.getExpression(t)}),t[3]||{})},e.encode=function(t){var e=h(t.params,function(t){return t.encode()});return d(t.scopeAlias)?[this.id,t.name,e]:[this.id,t.name,e,t.scopeAlias]},e.prototype.getComplexity=function(t){var e=t.getOperationBuilder(this.name),n=e?e.complexity:0;for(var r in this.params)n=Math.max(n,this.params[r].getComplexity(t));return n},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="op",e}(C),Mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),St=function(t){function e(n){var r=t.call(this,e.id)||this;return r.expressions=n,r}return Mt(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.expressions.map(function(t){return t.encode()});return[this.id,e]},e.prototype.getComplexity=function(t){return this.expressions.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="or",e}(C),Ct=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jt=function(t){function e(n,r){var o=t.call(this,e.id)||this;return o.path=n,o.value=r,o}return Ct(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}),n.getExpression(t[2]))},e.encode=function(t){var e=t.path.map(function(t){return t.encode()});return[this.id,e,t.value.encode()]},e.prototype.getComplexity=function(t){return this.path.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},this.value.getComplexity(t))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="set",e}(C),Et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u},Pt=function(t){function e(n,r,o,i){var u=t.call(this,e.id)||this;return u.value=n,u.op=r,u.cases=o,u.defaultCase=i,u}return Et(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),t[2],t[3].map(function(t){var e=At(t,2),r=e[0],o=e[1];return[r.map(function(t){return n.getExpression(t)}),n.getExpression(o)]}),n.getExpression(t[4]))},e.encode=function(t){var e=t.value.encode(),n=t.cases.map(function(t){var e=At(t,2),n=e[0],r=e[1];return[n.map(function(t){return t.encode()}),r.encode()]});return P.has(t.defaultCase,void 0)?[this.id,e,t.op,n]:[this.id,e,t.op,n,t.defaultCase.encode()]},e.prototype.getComplexity=function(t){return this.cases.reduce(function(e,n){var r=At(n,2),o=r[0],i=r[1];return Math.max(e,i.getComplexity(t),o.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0))},Math.max(this.value.getComplexity(t),this.defaultCase.getComplexity(t)))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="switch",e}(C),kt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt=function(t){function e(n,r){var o=t.call(this,e.id)||this;return o.template=n,o.params=r,o}return kt(e,t),e.decode=function(t,n){return new e(t[1],h(t[2],function(t){return n.getExpression(t)}))},e.encode=function(t){var e=h(t.params,function(t){return t.encode()});return[this.id,t.template,e]},e.prototype.getComplexity=function(t){var e=0;for(var n in this.params)e=Math.max(e,this.params[n].getComplexity(t));return e},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="tmpl",e}(C),It=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vt=function(t){function e(n,r,o,i){var u=t.call(this,e.id)||this;return u.condition=n,u.body=r,u.breakVariable=o,u.maxIterations=i,u}return It(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),n.getExpression(t[2]),t[3]||"break",parseInt(t[4])||this.MAX_ITERATIONS)},e.encode=function(t){var e=[this.id,t.condition.encode(),t.body.encode()],n=t.maxIterations!==this.MAX_ITERATIONS;return("break"!==t.breakVariable||n)&&e.push(t.breakVariable),n&&e.push(t.maxIterations),e},e.prototype.getComplexity=function(t){return Math.max(this.condition.getComplexity(t),this.body.getComplexity(t))+1},e.prototype.getScope=function(){var t;return(t={})[this.breakVariable]=G.baseType,t},e.prototype.encode=function(){return e.encode(this)},e.MAX_ITERATIONS=1e5,e.id="while",e}(C),Lt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ft=function(t){function e(n,r,o,i){var u=t.call(this,e.id)||this;return u.condition=n,u.body=r,u.breakVariable=o,u.maxIterations=i,u}return Lt(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),n.getExpression(t[2]),t[3]||"break",parseInt(t[4])||this.MAX_ITERATIONS)},e.encode=function(t){var e=[this.id,t.condition.encode(),t.body.encode()],n=t.maxIterations!==this.MAX_ITERATIONS;return("break"!==t.breakVariable||n)&&e.push(t.breakVariable),n&&e.push(t.maxIterations),e},e.prototype.getComplexity=function(t){return Math.max(this.condition.getComplexity(t),this.body.getComplexity(t))+1},e.prototype.getScope=function(){var t;return(t={})[this.breakVariable]=G.baseType,t},e.prototype.encode=function(){return e.encode(this)},e.MAX_ITERATIONS=1e5,e.id="do",e}(C),Ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nt=function(t){function e(n,r,o){var i=t.call(this,e.id)||this;return i.path=n,i.value=r,i.currentVariable=o,i}return Ut(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}),n.getExpression(t[2]),t[3]||"current")},e.encode=function(t){var e=t.path.map(function(t){return t.encode()}),n=t.value.encode();return"current"===t.currentVariable?[this.id,e,n]:[this.id,e,n,t.currentVariable]},e.prototype.getComplexity=function(t){return this.path.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},this.value.getComplexity(t))},e.prototype.getScope=function(){var t;return(t={})[this.currentVariable]=D.baseType,t},e.prototype.encode=function(){return e.encode(this)},e.id="up",e}(C),qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qt(e,t),e.decode=function(t,n){return new e({key:n.getType(t[1]),value:n.getType(t[2]),constants:new Map(t[3])})},e.encode=function(t){var e=t.options,n=e.key,r=e.value,o=e.constants;return[this.id,n.encode(),r.encode(),v(o.entries())]},e.describe=function(){return null},e.prototype.merge=function(t,e){},e.prototype.getSubTypes=function(){var t=this.options;return{key:t.key,value:t.value}},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e},e.prototype.isValid=function(t){return this.options.constants.has(t)},e.prototype.normalize=function(t){return t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){var e=v(this.options.constants.values());return e[t(0,e.length,!0)]},e.id="enum",e.operations=new E("enum:"),e.baseType=new e({key:rt.baseType,value:rt.baseType,constants:new Map}),e.describePriority=-1,e}(S),Rt=["th","st","nd","rd","th","th","th","th","th","th"],Yt={weekStartsOn:0,firstWeekContainsDate:4,am:"am",pm:"pm",formatLT:"h:mm A",formatLTS:"h:mm:ss A",formatL:"MM/DD/Y",formatl:"M/D/Y",formatLL:"MMMM D, Y",formatll:"MMM D, Y",formatLLL:"MMMM D, Y h:mm A",formatlll:"MMM D, Y h:mm A",formatLLLL:"dddd, MMMM D, Y h:mm A",formatllll:"ddd, MMM D, Y h:mm A",suffix:function(t){return t+(t>=11&&t<=13?"th":Rt[t%Rt.length])},list:function(t){for(var e=t.length-1,n=t[0],r=1;r<e;r++)n+=", "+t[r];return e>0&&(n+=" and "+t[e]),n},months:[["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["Ja","F","Mr","Ap","My","Je","Jl","Ag","S","O","N","D"]],weekdays:[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Su","M","Tu","W","Th","F","Sa"]]},Jt=7,Bt=3,Xt=1,Ht=23,Wt=59,Kt=59,Gt=999,Qt=6,Zt={millis:function(t){return t},second:function(t){t.setMilliseconds(0)},minute:function(t){t.setSeconds(0,0)},hour:function(t){t.setMinutes(0,0,0)},day:function(t){t.setHours(0,0,0,0)},week:function(t,e){void 0===e&&(e=Yt);var n=ee(t,e);t.setDate(t.getDate()-n),t.setHours(0,0,0,0)},month:ne,quarter:function(t){var e=t.getMonth();t.setMonth(e-e%Bt,Xt),t.setHours(0,0,0,0)},year:re},$t={millis:function(t){return t},second:function(t){t.setMilliseconds(Gt)},minute:function(t){t.setSeconds(Kt,Gt)},hour:function(t){t.setMinutes(Wt,Kt,Gt)},day:oe,week:function(t,e){void 0===e&&(e=Yt);var n=ee(t,e);t.setDate(t.getDate()+(Qt-n)),oe(t)},month:function(t){t.setFullYear(t.getFullYear(),t.getMonth()+1,0),oe(t)},quarter:function(t){var e=t.getMonth();t.setMonth(e-e%Bt+Bt,Xt),oe(t)},year:ie};function te(t,e){if(void 0===e&&(e=!1),p(t))return t;if(o(t)&&t>0)return new Date(t);if(i(t)){if(e){var n=t+" UTC",r=Date.parse(n);if(isFinite(r))return new Date(r)}var u=Date.parse(t);if(isFinite(u))return new Date(u)}return null}function ee(t,e){void 0===e&&(e=Yt);var n=e.weekStartsOn,r=t.getDay();return r<n?r-n+Jt:r-n}function ne(t){t.setDate(Xt),t.setHours(0,0,0,0)}function re(t){var e=t.getFullYear();t.setTime(0),t.setFullYear(e,0,1),t.setHours(0,0,0,0)}function oe(t){t.setHours(Ht,Wt,Kt,Gt)}function ie(t){t.setFullYear(t.getFullYear()+1,0,0),oe(t)}var ue=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ue(e,t),e.decode=function(t,n){return new e(t[1]||{})},e.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},e.describe=function(t,n){return p(t)?new e({validateMin:new Date(t.getTime()),validateMax:new Date(t.getTime())}):null},e.prototype.merge=function(t,e){var n=this.options,r=t.options;n.parseAsUTC=n.parseAsUTC&&r.parseAsUTC,n.validateMin&&r.validateMin&&n.validateMin.setTime(Math.min(n.validateMin.getTime(),r.validateMin.getTime())),n.validateMax&&r.validateMax&&n.validateMax.setTime(Math.max(n.validateMax.getTime(),r.validateMax.getTime()))},e.prototype.getSubTypes=function(){return null},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e},e.prototype.isValid=function(t){var e=this.options,n=e.parseAsUTC,r=e.validateMin,o=e.validateMax,i=te(t,n);return!!i&&(!(r&&i.getTime()<r.getTime())&&!(o&&i.getTime()>o.getTime()))},e.prototype.normalize=function(t){var e=this.options,n=e.parseAsUTC,r=e.forceMin,o=e.forceMax,i=e.forceStartOf,u=e.forceEndOf,p=te(t,n);return p?(r&&p.getTime()<r.getTime()&&p.setTime(r.getTime()),o&&p.getTime()>o.getTime()&&p.setTime(o.getTime()),i&&Zt[i](p),u&&$t[u](p),p):t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){var e=this.options,n=e.validateMin,r=e.validateMax,o=e.forceMin,i=e.forceMax,u=new Date,p=n||o,c=r||i,s=p?p.getTime():u.getTime(),a=c?c.getTime():u.getTime();return new Date(t(s,a,!0))},e.id="date",e.operations=new E("date:"),e.baseType=new e({}),e.describePriority=6,e}(S),ce=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),se=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ce(e,t),e.decode=function(t){return new e(t[1]||{})},e.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},e.describe=function(t){return null===t?this.baseType:null},e.prototype.merge=function(t,e){var n=this.options,r=t.options;n.includeUndefined=n.includeUndefined||r.includeUndefined},e.prototype.getSubTypes=function(){return null},e.prototype.getExactType=function(t){return this},e.prototype.isCompatible=function(t){return t instanceof e},e.prototype.isValid=function(t){return null===t||this.options.includeUndefined&&void 0===t},e.prototype.normalize=function(t){return t},e.prototype.encode=function(){return e.encode(this)},e.prototype.random=function(t){return null},e.id="null",e.operations=new E("null:"),e.baseType=new e({}),e.describePriority=6,e}(S),ae=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(t){function e(n,r){var o=t.call(this,e.id)||this;return o.name=n,o.args=r,o}return ae(e,t),e.decode=function(t,n){return new e(t[1],h(t[2],function(t){return n.getExpression(t)}))},e.encode=function(t){var e=h(t.args,function(t){return t.encode()});return[this.id,t.name,e]},e.prototype.getComplexity=function(t){var e=t.getFunction(this.name);if(!e)throw new Error("Function "+this.name+" has not been defined.");return e.options.expression.getComplexity(t)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.id="invoke",e}(C),ye=new B({types:[tt,W,rt,G,q,R,D,U,V,pt,zt,pe,se],expressions:[P,vt,jt,Ot,ft,_t,Pt,wt,st,St,ht,Vt,Ft,lt,Dt,Nt,fe]});n.d(e,"isNumber",function(){return o}),n.d(e,"isString",function(){return i}),n.d(e,"isArray",function(){return u}),n.d(e,"isDate",function(){return p}),n.d(e,"isMap",function(){return c}),n.d(e,"isBoolean",function(){return s}),n.d(e,"isFunction",function(){return a}),n.d(e,"isObject",function(){return f}),n.d(e,"isUndefined",function(){return y}),n.d(e,"isSameClass",function(){return l}),n.d(e,"isEmpty",function(){return d}),n.d(e,"objectMap",function(){return h}),n.d(e,"objectValues",function(){return m}),n.d(e,"toArray",function(){return v}),n.d(e,"getCompare",function(){return b}),n.d(e,"coalesce",function(){return g}),n.d(e,"COMPARE_TYPE_ORDER",function(){return _}),n.d(e,"compare",function(){return x}),n.d(e,"copy",function(){return w}),n.d(e,"padNumber",function(){return T}),n.d(e,"pad",function(){return O}),n.d(e,"Definitions",function(){return B}),n.d(e,"Expression",function(){return C}),n.d(e,"Operations",function(){return E}),n.d(e,"Runtime",function(){return X}),n.d(e,"Type",function(){return S}),n.d(e,"AnyType",function(){return D}),n.d(e,"BooleanType",function(){return G}),n.d(e,"FunctionType",function(){return R}),n.d(e,"ListType",function(){return tt}),n.d(e,"ManyType",function(){return U}),n.d(e,"NumberType",function(){return W}),n.d(e,"ObjectType",function(){return q}),n.d(e,"OptionalType",function(){return V}),n.d(e,"TextType",function(){return rt}),n.d(e,"MapType",function(){return pt}),n.d(e,"AndExpression",function(){return st}),n.d(e,"ChainExpression",function(){return ft}),n.d(e,"ConstantExpression",function(){return P}),n.d(e,"DefineExpression",function(){return lt}),n.d(e,"ForExpression",function(){return ht}),n.d(e,"GetExpression",function(){return vt}),n.d(e,"IfExpression",function(){return _t}),n.d(e,"NotExpression",function(){return wt}),n.d(e,"OperationExpression",function(){return Ot}),n.d(e,"OrExpression",function(){return St}),n.d(e,"SetExpression",function(){return jt}),n.d(e,"SwitchExpression",function(){return Pt}),n.d(e,"TemplateExpression",function(){return Dt}),n.d(e,"WhileExpression",function(){return Vt}),n.d(e,"defs",function(){return ye})}])});
//# sourceMappingURL=expangine-runtime.js.map