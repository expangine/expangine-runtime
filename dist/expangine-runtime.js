!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["expangine-runtime"]=e():t["expangine-runtime"]=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function o(t){return"number"==typeof t&&isFinite(t)}function i(t){return"string"==typeof t}function s(t){return Array.isArray(t)}function a(t){return t instanceof Date}function u(t){return t instanceof Map}function p(t){return t instanceof Set}function c(t){return"boolean"==typeof t}function l(t){return"function"==typeof t}function f(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function y(t){return void 0===t}function d(t,e){return t.constructor===e.constructor}function h(t,e){return void 0===e&&(e=1e-6),Math.abs(t-Math.round(t))<=e}function v(t){if(s(t))return 0===t.length;if(f(t)){for(var e in t)return!1;return!0}return null==t}function m(t,e,n){return t<e?e:t>n?n:t}function g(t){return s(t)?new Map(t):u(t)?t:f(t)?new Map(_(t,function(t,e){return[e,t]})):new Map}function T(t){return new Map(Array.from(t.entries()).map(function(t){var e=r(t,2),n=e[0];return[e[1],n]}))}function b(t,e,n,r,o,i){for(var s=e.map(function(){return!1}),a=function(r){var a=t[r],u=e.findIndex(function(t){return n(a,t)});-1!==u?(i(t,r,a,e[u]),s[u]=!0):o(t,r,a)},u=t.length-1;u>=0;u--)a(u);for(u=0;u<e.length;u++)s[u]||r(t,e[u]);return t}function x(t,e,n,r,o){for(var i in t)i in e||r(t,i,t[i]);for(var i in e)i in t?o(t,i,t[i],e[i]):n(t,i,e[i]);return t}function O(t,e,n){return void 0===n&&(n=function(t){return t}),S(t,function(t,r,o){return o[n(r,t)]=e(t,r),o},Object.create(null))}function E(t,e){return S(t,function(n,r){return e(n,r,t)},void 0)}function w(t,e){return void 0===e&&(e=function(t){return t}),S(t,function(t,n,r){return r.push(e(t,n)),r},[])}function S(t,e,n){for(var r in t)n=e(t[r],r,n);return n}function P(t,e){for(var n=Object.create(null),r=0;r<t.length;r++){var o=t[r];n[o]=e(o,r)}return n}function _(t,e){var n=[];for(var r in t)n.push(e(t[r],r));return n}function M(t,e){return void 0===t?e:t}function I(t,e,n){return void 0===n&&(n=e),C(t+"",e,"0",!0).substring(0,n)}function C(t,e,n,r){for(;t.length<e;)r?t=n+t:t+=n;return t}function D(t){return s(t)||f(t)?JSON.stringify(t):t+""}var j,k,A=function(){},N=function(){},L=function(){function t(t,e){this.remove=A,this.replace=N,this.callback=t,this.stack=[],this.path=[],this.stopped=!1,this.result=e}return t.isTraversable=function(t){return t&&l(t.traverse)},t.prototype.enter=function(t,e){return this.stopped?this.result:(this.callback(t,this.stack,this.path,this),this.remove=A,this.replace=N,e&&!this.stopped&&(this.stack.push(t),e(),this.stack.pop()),this.result)},t.prototype.step=function(e,n,r,o){return void 0===r&&(r=N),void 0===o&&(o=A),this.stopped?this:(this.path.push(e),this.remove=o,this.replace=r,t.isTraversable(n)?n.traverse(this):n(),this.path.pop(),this)},t.prototype.modify=function(t){var e=t(this.result);return void 0!==e&&(this.result=e),this},t.prototype.stop=function(t){return this.result=t,this},t.prototype.getResult=function(){return this.result},t.prototype.removeOrReplace=function(t){var e=this.canRemove(),n=this.canReplace();return!(!e&&!n)&&(e?this.remove():this.replace(l(t)?t():t),!0)},t.prototype.canRemove=function(){return this.remove!==A},t.prototype.canReplace=function(){return this.replace!==N},t.prototype.filterClass=function(t,e){return void 0===e&&(e=this.result),this.filter(function(e){return e.constructor===t},e)},t.prototype.filter=function(e,n){var r=this;void 0===n&&(n=this.result);return new t(function(t,n,o,i){e(t,n,o)&&r.callback(t,n,o,i)},n)},t.list=function(){var e=[];return new t(function(t,n,r){e.push({value:t,stack:n.slice(),path:r.slice()})},e)},t.count=function(){return new t(function(t,e,n,r){return r.result++},0)},t}(),R=function(){function t(t){this.parent=null,this.options=t}return t.prototype.getRequired=function(){return this},t.prototype.isWrapper=function(){return!1},t.prototype.isCompatible=function(t,e){return void 0===e&&(e={}),t===this||(!(e.exact||!t.isWrapper()||!this.isCompatible(t.getSimplifiedType(),e))||!(e.strict&&!d(this,t)&&!this.acceptsOtherTypes())&&this.isDeepCompatible(t,e))},t.prototype.acceptsOtherTypes=function(){return!1},t.prototype.acceptsType=function(t){return this.isCompatible(t,{strict:!0})},t.prototype.acceptsData=function(t){return this.isCompatible(t,{strict:!0,value:!0})},t.prototype.exactType=function(t){return this.isCompatible(t,{exact:!0,strict:!0})},t.prototype.exactData=function(t){return this.isCompatible(t,{exact:!0,strict:!0,value:!0})},t.prototype.getValueChangeExpression=function(t,e,n){return t},t.prototype.getValueChangeAt=function(t){for(var e=this.parent,n=this.getPath();e;){var r=n.pop();t=e.getValueChangeExpression(t,r,r),e=e.parent}return t},t.prototype.getPath=function(){var t=this;return this.getRootType().traverse(new L(function(e,n,r,o){e===t&&o.stop(r.slice())}))},t.prototype.getTypeFromPath=function(t){if(0===t.length)return this;var e=this.getTypeFromStep(t[0]);return e?e.getTypeFromPath(t.slice(1)):null},t.prototype.getTypeFromStep=function(t){return null},t.prototype.getRootType=function(){for(var t=this;t.parent;)t=t.parent;return t},t}();!function(t){t[t.LOW=1]="LOW",t[t.MEDIUM=2]="MEDIUM",t[t.HIGH=3]="HIGH"}(j||(j={})),function(t){t[t.UNSAFE_OPERATION=1]="UNSAFE_OPERATION",t[t.POSSIBLY_NULL=2]="POSSIBLY_NULL",t[t.INCOMPATIBLE_TYPES=3]="INCOMPATIBLE_TYPES",t[t.INVALID_EXPRESSION=4]="INVALID_EXPRESSION",t[t.MISSING_FUNCTION=5]="MISSING_FUNCTION",t[t.MISSING_EXPRESSION=6]="MISSING_EXPRESSION",t[t.MISSING_OPERATION=7]="MISSING_OPERATION",t[t.MISSING_TYPE_NAME=8]="MISSING_TYPE_NAME",t[t.MISSING_TYPE=9]="MISSING_TYPE",t[t.MISSING_RELATION_NAME=10]="MISSING_RELATION_NAME",t[t.MISSING_RELATION=11]="MISSING_RELATION",t[t.MISSING_DATA_NAME=12]="MISSING_DATA_NAME",t[t.MISSING_DATA=13]="MISSING_DATA"}(k||(k={}));var q=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},V=function(){function t(){this.parent=null}return t.prototype.getPath=function(){var t=this;return this.getRootExpression().traverse(new L(function(e,n,r,o){e===t&&o.stop(r.slice())}))},t.prototype.getExpressionFromPath=function(t){if(0===t.length)return this;var e=this.getExpressionFromStep(t);if(!e||!e[1])return null;var n=q(e,2),r=n[0];return n[1].getExpressionFromPath(t.slice(r))},t.prototype.getExpressionFromStep=function(t){return null},t.prototype.getRootExpression=function(){for(var t=this;t.parent;)t=t.parent;return t},t.prototype.validations=function(t,e){var n=[];return this.validate(t,e,function(t){return n.push(t)}),n},t.prototype.validateType=function(t,e,n,r,o,i){void 0===i&&(i=this);var s=n?n.getSimplifiedType():null,a=r?r.getType(t,e):null,u=a?a.getSimplifiedType():null,p=u;u?(u.isOptional()&&!s.isOptional()&&(p=p.getRequired()),s.acceptsType(p)?p!==u&&o({type:k.POSSIBLY_NULL,severity:j.MEDIUM,context:e,subject:r,parent:i,expected:s,actual:u}):o({type:k.INCOMPATIBLE_TYPES,severity:s.isCompatible(u)?j.MEDIUM:j.HIGH,context:e,subject:r,parent:i,expected:s,actual:u})):s&&!s.isOptional()&&o({type:k.INCOMPATIBLE_TYPES,severity:j.HIGH,context:e,subject:r,parent:i,expected:s}),r&&r.validate(t,e,o)},t.prototype.validatePath=function(t,e,n,r,o,i){void 0===i&&(i=this);var s=n;r.forEach(function(n){s&&(s=s.getSubType(n,t,e)),s||o({type:k.INVALID_EXPRESSION,severity:j.HIGH,subject:n,context:e,parent:i}),n.validate(t,e,o)})},t}();function F(t){return!("baseType"in t)&&l(t)}var Y,G=function(){function t(t){this.prefix=t,this.map=Object.create(null),this.types=Object.create(null)}return t.prototype.get=function(t){return this.map[t]||this.map[this.prefix+t]},t.prototype.getTypes=function(t){return this.types[t]||this.types[this.prefix+t]},t.prototype.set=function(t,e,n,r,o,i,s){void 0===e&&(e={}),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===o&&(o=[]),void 0===i&&(i=[]),void 0===s&&(s=[]);var a=this.prefix+t,u=e.mutates||[],p=e.complexity||0,c=Object.create(null);o.forEach(function(t){return c[t]=t});var l={id:a,mutates:u,complexity:p,params:n,optional:r,scope:o,scopeDefaults:c,hasScope:i,resultDependency:s};return this.map[a]=l,l},t.prototype.setTypes=function(t,e,n,r,o){void 0===n&&(n=Object.create(null)),void 0===r&&(r=Object.create(null)),void 0===o&&(o=Object.create(null));var i={returnType:e,params:n,optional:r,scope:o};return this.types[t.id]=i,i},t}(),B=function(){function t(t){this.prefix=t,this.map=Object.create(null),this.list=[]}return t.prototype.set=function(t,e,n,r){var o=this.prefix+t,i={id:o,op:e.id,value:n||e.params[0],params:r||{}};return this.map[o]=i,this.list.push(i),i},t.prototype.get=function(t){return this.map[t]||this.map[this.prefix+t]},t}(),U={Entity:"@",Any:"any",Boolean:"bool",Color:"color",Date:"date",Enum:"enum",Function:"func",List:"list",Many:"many",Not:"not",Map:"map",Null:"null",Number:"num",Object:"obj",Optional:"?",Reference:"ref",Relation:"rel",Set:"set",Text:"text",Tuple:"tuple",Delimiter:":"},W=new G(U.Boolean+U.Delimiter),H=new B(U.Boolean+U.Delimiter),J=W,K={create:J.set("create"),maybe:J.set("maybe",{},["value"]),and:J.set("&",{},["a","b"]),or:J.set("|",{},["a","b"]),xor:J.set("^",{},["a","b"]),not:J.set("!",{},["a"]),cmp:J.set("cmp",{},["value","test"]),isValid:J.set("?",{},["value"]),isTrue:J.set("t?",{},["value"]),isFalse:J.set("f?",{},["value"]),isEqual:J.set("=",{},["value","test"]),isNotEqual:J.set("!=",{},["value","test"]),asAny:J.set("~"+U.Any,{},["value"]),asBoolean:J.set("~"+U.Boolean,{},["value"]),asColor:J.set("~"+U.Color,{},["value"]),asDate:J.set("~"+U.Date,{},["value"]),asList:J.set("~"+U.List,{},["value"]),asMap:J.set("~"+U.Map,{},["value"]),asNumber:J.set("~"+U.Number,{},["value"]),asObject:J.set("~"+U.Object,{},["value"]),asText:J.set("~"+U.Text,{},["value"]),asTuple:J.set("~"+U.Tuple,{},["value"]),asSet:J.set("~"+U.Set,{},["value"])},z=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},X=function(){function t(){this.compareTypes=this.createTypeMap(function(t,e){return e}),this.compareMap=this.createTypeMap(function(){return[]}),this.equalsMap=this.createTypeMap(function(){return[]}),this.copyList=[],this.jsonList=[]}return t.prototype.compare=function(t,e){var n=this,r=function(t,e){var o,i,s=typeof t,a=typeof e;if(s!==a)return n.compareTypes[s]-n.compareTypes[a];var u=n.compareMap[s];try{for(var p=z(u),c=p.next();!c.done;c=p.next()){var l=c.value.compare(t,e,r);if(void 0!==l)return l}}catch(t){o={error:t}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return t===e?0:t<e?-1:1};return r(t,e)},t.prototype.getCompare=function(t,e){return 0===t&&0===e?0:t<e?1:-1},t.prototype.addCompare=function(t){return this.addToPriorityList(this.compareMap[t.type],t)},t.prototype.equals=function(t,e){var n=this,r=function(t,e){var o,i;if(t===e)return!0;var s=typeof t;if(s!==typeof e)return!1;var a=n.equalsMap[s];try{for(var u=z(a),p=u.next();!p.done;p=u.next()){var c=p.value.equals(t,e,r);if(void 0!==c)return c}}catch(t){o={error:t}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return!1};return r(t,e)},t.prototype.addEquals=function(t){return this.addToPriorityList(this.equalsMap[t.type],t)},t.prototype.copy=function(t,e){if(void 0===e&&(e=!1),!t)return t;if("object"==typeof t){var n=this.copyList;if(e){var r=new Map,o=function(t,e){r.set(t,e)},i=function(t){var e,s;if(!t)return t;if("object"==typeof t){var a=r.get(t);if(void 0!==a)return a;try{for(var u=z(n),p=u.next();!p.done;p=u.next()){var c=p.value.copy(t,i,o);if(void 0!==c)return c}}catch(t){e={error:t}}finally{try{p&&!p.done&&(s=u.return)&&s.call(u)}finally{if(e)throw e.error}}}return t};return i(t)}var s=function(t,e){},a=function(t){var e,r;if(!t)return t;if("object"==typeof t)try{for(var o=z(n),i=o.next();!i.done;i=o.next()){var u=i.value.copy(t,a,s);if(void 0!==u)return u}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return t};return a(t)}return t},t.prototype.addCopier=function(t){return this.addToPriorityList(this.copyList,t)},t.prototype.toJson=function(t){if(!t)return t;if("object"==typeof t){var e=this.jsonList,n=function(t){var r,o;if(!t)return t;if("object"==typeof t)try{for(var i=z(e),s=i.next();!s.done;s=i.next()){var a=s.value.toJson(t,n);if(void 0!==a)return a}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return t};return n(t)}return t},t.prototype.fromJson=function(t){if(!t)return t;if("object"==typeof t){var e=this.jsonList,n=function(t){var r,o;if(!t)return t;if("object"==typeof t)try{for(var i=z(e),s=i.next();!s.done;s=i.next()){var a=s.value.fromJson(t,n);if(void 0!==a)return a}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return t};return n(t)}return t},t.prototype.addJson=function(t){return this.addToPriorityList(this.jsonList,t)},t.prototype.createTypeMap=function(e){var n=Object.create(null);return t.TYPES.forEach(function(t,r){n[t]=e(t,r)}),n},t.prototype.addToPriorityList=function(t,e){return t.push(e),t.sort(function(t,e){return e.priority-t.priority}),this},t.TYPES=["boolean","number","bigint","string","symbol","object","undefined","function"],t}(),$=new X,Q=(Y=function(t,e){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Y(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Q(e,t),e.decode=function(t,n){return new e(t[1]||{})},e.encode=function(t){return v(t.options)?this.id:[this.id,t.options]},e.describe=function(t,e){return c(t)?this.baseType:null},e.register=function(){$.addCompare({priority:0,type:"boolean",compare:function(t,e){return(t?1:0)-(e?1:0)}}),$.addEquals({priority:0,type:"boolean",equals:function(t,e){return t===e}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){return!n.exact&&!n.strict||t instanceof e},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return wn.op(K.create,{})},e.prototype.getValidateExpression=function(){return wn.op(K.isValid,{value:wn.get("value")})},e.prototype.getCompareExpression=function(){return wn.op(K.cmp,{value:wn.get("value"),test:wn.get("test")})},e.prototype.isValid=function(t){if(c(t))return!0;var e=t+"";return!(!this.options.true||!this.options.true[e])||!(!this.options.false||!this.options.false[e])},e.prototype.normalize=function(t){if(!c(t)){var e=t+"";if(this.options.true&&this.options.true[e])return!0;if(this.options.false&&this.options.false[e])return!1}return t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e($.copy(this.options))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return!1},e.prototype.random=function(t){return t(0,1,!1)<.5},e.prototype.fromJson=function(t){return t},e.prototype.toJson=function(t){return t},e.id=U.Boolean,e.operations=W,e.computeds=H,e.baseType=new e({}),e.describePriority=4,e.registered=!1,e}(R),tt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),et=function(t){function e(e){var n=t.call(this)||this;return n.expression=e,n}return tt(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]))},e.encode=function(t){var e=t.expression.encode();return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.expression.getComplexity(t)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expression.clone())},e.prototype.getType=function(t,e){return Z.baseType},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){return t.step(e.STEP_NOT,n.expression,function(t){return n.expression=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_NOT?[1,this.expression]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.expression.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,Z.baseType,this.expression,n)},e.STEP_NOT="not",e.id="not",e}(V),nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rt=function(t){function e(e){var n=t.call(this)||this;return n.expressions=e,n}return nt(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.expressions.map(function(t){return t.encode()});return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.expressions.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expressions.map(function(t){return t.clone()}))},e.prototype.getType=function(t,e){return Z.baseType},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return e.expressions.forEach(function(n,r){return t.step(r,n,function(t){return e.expressions.splice(r,1,t)},function(){return e.expressions.splice(r,1)})})})},e.prototype.getExpressionFromStep=function(t){return o(t[0])&&t[0]<this.expressions.length?[1,this.expressions[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.expressions.forEach(function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){var r=this,o=Z.baseType;this.expressions.forEach(function(i){r.validateType(t,e,o,i,n)})},e.id="and",e}(V),ot=new G(U.Any+U.Delimiter),it=new B(U.Any+U.Delimiter),st=ot,at={complexity:2},ut={cmp:st.set("cmp",at,["value","test"]),copy:st.set("copy",at,["value"]),isDefined:st.set("isDefined",{},["value"]),getDefined:st.set("getDefined",{},["value","defined"],[],["defined"],["defined"],["value"]),coalesce:st.set("coalesce",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),require:st.set("require",{},["value"],[],[],[],["value"]),ternary:st.set("ternary",{},["condition","truthy","falsy"],[],[],[],["truthy","falsy"]),isValid:st.set("?",{},["value"]),isEqual:st.set("=",at,["value","test"]),isNotEqual:st.set("!=",at,["value","test"]),isLess:st.set("<",at,["value","test"]),isLessOrEqual:st.set("<=",at,["value","test"]),isGreater:st.set(">",at,["value","test"]),isGreaterOrEqual:st.set(">=",at,["value","test"]),asAny:st.set("~"+U.Any,{},["value"]),asBoolean:st.set("~"+U.Boolean,{},["value"]),asColor:st.set("~"+U.Color,{},["value"]),asDate:st.set("~"+U.Date,{},["value"]),asList:st.set("~"+U.List,{},["value"]),asMap:st.set("~"+U.Map,{},["value"]),asNumber:st.set("~"+U.Number,{},["value"]),asObject:st.set("~"+U.Object,{},["value"]),asText:st.set("~"+U.Text,{},["value"]),asTuple:st.set("~"+U.Tuple,{},["value"]),asSet:st.set("~"+U.Set,{},["value"])},pt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pt(e,t),e.decode=function(t){return e.baseType},e.encode=function(t){return this.id},e.describe=function(t){return null===t?this.baseType:null},e.register=function(){},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){return t instanceof e},e.prototype.isOptional=function(){return!0},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null)},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return wn.null()},e.prototype.getValidateExpression=function(){return wn.op(ut.isEqual,{value:wn.get("value"),test:wn.null()})},e.prototype.getCompareExpression=function(){return wn.op(ut.cmp,{value:wn.get("value"),test:wn.get("test")})},e.prototype.isValid=function(t){return null==t},e.prototype.normalize=function(t){return t},e.prototype.newInstance=function(){return this},e.prototype.clone=function(){return this},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return null},e.prototype.random=function(t){return null},e.prototype.fromJson=function(t){return null},e.prototype.toJson=function(t){return null},e.id=U.Null,e.operations=new G(U.Null+U.Delimiter),e.computeds=new B(U.Null+U.Delimiter),e.baseType=new e(null),e.describePriority=6,e.registered=!1,e}(R),lt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return lt(e,t),e.decode=function(t,e){return this.instance},e.encode=function(t){return[this.id]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return this},e.prototype.getType=function(t,e){return ct.baseType},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null)},e.prototype.validate=function(t,e,n){},e.id="noop",e.instance=new e,e}(V),yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return yt(e,t),e.decode=function(t,e){return this.baseType},e.encode=function(t){return this.id},e.describe=function(t,n){return f(t)&&i(t.$any)?new e({}):null},e.register=function(){},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isCompatible=function(t){return!0},e.prototype.isDeepCompatible=function(t,e){return!0},e.prototype.isOptional=function(){return!0},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return wn.string()},e.prototype.getValidateExpression=function(){return wn.true()},e.prototype.getCompareExpression=function(){return wn.op(ut.cmp,{value:wn.get("value"),test:wn.get("test")})},e.prototype.isValid=function(t){return!0},e.prototype.normalize=function(t){return t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e({})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return""},e.prototype.random=function(t){return null},e.prototype.fromJson=function(t){return $.fromJson(t)},e.prototype.toJson=function(t){return $.toJson(t)},e.id=U.Any,e.operations=ot,e.computeds=it,e.baseType=new e({}),e.describePriority=8,e.registered=!1,e}(R),ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},mt=function(t){function e(e,n){var r=t.call(this)||this;return r.define=e,r.body=n,r}return ht(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){var e=vt(t,2),r=e[0],o=e[1];return[r,n.getExpression(o)]}),n.getExpression(t[2]))},e.encode=function(t){var e=t.define.map(function(t){var e=vt(t,2);return[e[0],e[1].encode()]});return[this.id,e,t.body.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.define.reduce(function(e,n){var r=vt(n,2),o=(r[0],r[1]);return Math.max(e,o.getComplexity(t))},this.body.getComplexity(t))},e.prototype.getScope=function(){var t={};return this.define.forEach(function(e){var n=vt(e,2),r=n[0];n[1];return t[r]=dt.baseType}),t},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.define.map(function(t){var e=vt(t,2);return[e[0],e[1].clone()]}),this.body.clone())},e.prototype.getType=function(t,e){var n=t.getContextWithScope(e),r=n.scope,o=n.context;return this.define.forEach(function(e){var n=vt(e,2),i=n[0],s=n[1];return r[i]=s.getType(t,o)}),this.body.getType(t,o)},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_DEFINE,function(){return n.define.forEach(function(e,r){var o=vt(e,2),i=o[0],s=o[1];return t.step(i,s,function(t){return n.define[r].splice(1,1,t)},function(){return n.define.splice(r,1)})})}),t.step(e.STEP_BODY,n.body,function(t){return n.body=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_BODY?[1,this.body]:t[0]===e.STEP_DEFINE?[2,this.define.filter(function(e){return vt(e,1)[0]===t[1]}).map(function(t){var e=vt(t,2);e[0];return e[1]})[0]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.define.forEach(function(t){var n=vt(t,2);n[0];return n[1].setParent(e)}),this.body.setParent(this)},e.prototype.validate=function(t,e,n){var r=t.getContextWithScope(e);this.define.forEach(function(e){var o=vt(e,2),i=o[0],s=o[1];s.validate(t,r.context,n),r.scope[i]=s.getType(t,r.context)}),this.body.validate(t,r.context,n)},e.prototype.with=function(t,e){var n,r=i(t)?((n={})[t]=e,n):t,o=function(t){var e=wn.parse(r[t]),n=s.define.find(function(e){return vt(e,1)[0]===t});n?n[1]=e:s.define.push([t,e]),e.setParent(s)},s=this;for(var a in r)o(a);return this},e.prototype.run=function(t){return this.body=t,this.body.setParent(this),this},e.STEP_DEFINE="define",e.STEP_BODY="body",e.id="def",e}(V),gt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tt=1e5,bt="break",xt=function(t){function e(e,n,r,o){void 0===r&&(r=bt),void 0===o&&(o=Tt);var i=t.call(this)||this;return i.condition=e,i.body=n,i.breakVariable=r,i.maxIterations=o,i}return gt(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),n.getExpression(t[2]),t[3]||bt,parseInt(t[4])||this.MAX_ITERATIONS)},e.encode=function(t){var e=[this.id,t.condition.encode(),t.body.encode()],n=t.maxIterations!==this.MAX_ITERATIONS;return(t.breakVariable!==bt||n)&&e.push(t.breakVariable),n&&e.push(t.maxIterations),e},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return Math.max(this.condition.getComplexity(t),this.body.getComplexity(t))+1},e.prototype.getScope=function(){var t;return(t={})[this.breakVariable]=Z.baseType,t},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.condition.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},e.prototype.getType=function(t,e){var n=t.getContextWithScope(e,this.getScope()).context,r=this.body.getType(t,n);return r?Ti.optional(r):null},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_CONDITION,n.condition,function(t){return n.condition=t}),t.step(e.STEP_BODY,n.body,function(t){return n.body=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_CONDITION?[1,this.condition]:t[0]===e.STEP_BODY?[1,this.body]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.condition.setParent(this),this.body.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,Z.baseType,this.condition,n);var r=t.getContext(e,this.getScope());this.body.validate(t,r,n)},e.prototype.do=function(t,e){return this.body=t,this.body.setParent(this),e&&(this.condition=e,this.condition.setParent(this)),this},e.prototype.while=function(t){return this.condition=t,this.condition.setParent(this),this},e.prototype.withBreak=function(t){return this.breakVariable=t,this},e.prototype.withMax=function(t){return this.maxIterations=t,this},e.STEP_CONDITION="condition",e.STEP_BODY="body",e.MAX_ITERATIONS=Tt,e.id="do",e}(V),Ot=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wt=function(t){function e(e){var n=t.call(this)||this;return n.chain=e,n}return Ot(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.chain.map(function(t){return t.encode()});return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.chain.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.chain.map(function(t){return t.clone()}))},e.prototype.getType=function(t,e){return this.chain[this.chain.length-1].getType(t,e)},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return e.chain.forEach(function(n,r){return t.step(r,n,function(t){return e.chain.splice(r,1,t)},function(){return e.chain.splice(r,1)})})})},e.prototype.getExpressionFromStep=function(t){return o(t[0])&&t[0]<this.chain.length?[1,this.chain[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.chain.forEach(function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){this.chain.forEach(function(r){r.validate(t,e,n)})},e.prototype.add=function(t){var e,n,r=s(t)?t:[t];try{for(var o=Et(r),i=o.next();!i.done;i=o.next()){var a=i.value;this.chain.push(a),a.setParent(this)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},e.id="chain",e}(V),St=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pt=function(t){function e(e){var n=t.call(this)||this;return n.comment=e,n}return St(e,t),e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return[this.id,t.comment]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.comment)},e.prototype.getType=function(t,e){return ct.baseType},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){},e.id="comment",e.instance=new e(""),e}(V),_t=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=function(t){function e(e,n){var r=t.call(this)||this;return r.expression=e,r.name=n,r}return _t(e,t),e.decode=function(t,n){var r=t[1];return new e(n.getExpression(t[2]),r)},e.encode=function(t){return[this.id,t.name,t.expression.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){var e=t.getComputed(this.name);if(!e)return 0;var n=t.getOperation(e.op);return Math.max(n?n.complexity:0,this.expression.getComplexity(t))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expression.encode(),this.name)},e.prototype.getType=function(t,e){return t.getComputedReturnType(this.name,this.expression.getType(t,e))},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){return t.step(e.STEP_EXPRESSION,n.expression,function(t){return n.expression=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_EXPRESSION?[1,this.expression]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.expression.setParent(this)},e.prototype.validate=function(t,e,n){var r=this.expression.getType(t,e);r&&t.hasComputed(r,this.name)||n({type:k.INVALID_EXPRESSION,severity:j.HIGH,context:e,subject:this.expression,parent:this}),this.expression.validate(t,e,n)},e.STEP_EXPRESSION="expression",e.id="comp",e}(V),It=new G(U.Text+U.Delimiter),Ct=new B(U.Text+U.Delimiter),Dt=It,jt={create:Dt.set("create"),uuid:Dt.set("uuid"),maybe:Dt.set("maybe",{},["value"]),append:Dt.set("+",{},["value","append"]),prepend:Dt.set("pre",{},["value","prepend"]),lower:Dt.set("lo",{},["value"]),upper:Dt.set("up",{},["value"]),char:Dt.set("@",{},["value","index"],["outside"]),replace:Dt.set("replace",{},["value","find","replace"]),repeat:Dt.set("repeat",{},["value","times"]),split:Dt.set("split",{},["value","by"],["limit"]),chars:Dt.set("chars",{},["value"]),sub:Dt.set("sub",{},["value"],["start","end"]),indexOf:Dt.set("i?",{},["value","search"],["start"]),lastIndexOf:Dt.set("li?",{},["value","search"],["start"]),trim:Dt.set("trim",{},["value"],["start","end"]),startsWith:Dt.set("starts",{},["value","test"]),endsWith:Dt.set("ends",{},["value","test"]),soundex:Dt.set("soundex",{complexity:1},["value"],["max","min"]),metaphone:Dt.set("metaphone",{complexity:1},["value"]),distance:Dt.set("dist",{complexity:1},["value","test"]),length:Dt.set("len",{},["value"]),compare:Dt.set("cmp",{},["value","test"],["ignoreCase"]),like:Dt.set("like",{},["value","pattern"],["ignoreCase"]),pad:Dt.set("pad",{},["value","padding","min"],["max","append"]),regexTest:Dt.set("regexTest",{},["value","regex"],["ignoreCase","multiline"]),regexSplit:Dt.set("regexSplit",{},["value","regex"],["limit","ignoreCase","multiline"]),regexMatch:Dt.set("regexMatch",{},["value","regex"],["ignoreCase","multiline"]),regexMatchAll:Dt.set("regexMatchAll",{},["value","regex"],["ignoreCase","multiline"]),regexReplace:Dt.set("regexReplace",{},["value","regex","replacement"],["all","ignoreCase","multiline"]),regexReplaceDynamic:Dt.set("regexReplaceDynamic",{},["value","regex","replace"],["all","ignoreCase","multiline"],["match"],["replace"]),regexIndexOf:Dt.set("regexIndexOf",{},["value","regex"],["ignoreCase","multiline"]),base64:Dt.set("base64",{},["value"]),unbase64:Dt.set("unbase64",{},["value"]),encodeURI:Dt.set("encodeURI",{},["value"]),decodeURI:Dt.set("decodeURI",{},["value"]),encodeURIComponent:Dt.set("encodeURIComponent",{},["value"]),decodeURIComponent:Dt.set("decodeURIComponent",{},["value"]),md5:Dt.set("md5",{},["value"]),encrypt:Dt.set("encrypt",{},["value","secret"]),decrypt:Dt.set("decrypt",{},["value","secret"]),toNumber:Dt.set("toNumber",{},["value"],["invalidValue"]),isValid:Dt.set("?",{},["value"]),isEmpty:Dt.set("0?",{},["value"]),isNotEmpty:Dt.set("n?",{},["value"]),isEqual:Dt.set("=",{},["a","b"],["ignoreCase"]),isNotEqual:Dt.set("!=",{},["a","b"],["ignoreCase"]),isLess:Dt.set("<",{},["value","test"],["ignoreCase"]),isLessOrEqual:Dt.set("<=",{},["value","test"],["ignoreCase"]),isGreater:Dt.set(">",{},["value","test"],["ignoreCase"]),isGreaterOrEqual:Dt.set(">=",{},["value","test"],["ignoreCase"]),isLower:Dt.set("lo?",{},["value"]),isUpper:Dt.set("up?",{},["value"]),isUuid:Dt.set("uuid?",{},["value"]),asAny:Dt.set("~"+U.Any,{},["value"]),asBoolean:Dt.set("~"+U.Boolean,{},["value"]),asColor:Dt.set("~"+U.Color,{},["value"]),asDate:Dt.set("~"+U.Date,{},["value"]),asList:Dt.set("~"+U.List,{},["value"]),asMap:Dt.set("~"+U.Map,{},["value"]),asNumber:Dt.set("~"+U.Number,{},["value"]),asObject:Dt.set("~"+U.Object,{},["value"]),asText:Dt.set("~"+U.Text,{},["value"]),asTuple:Dt.set("~"+U.Tuple,{},["value"]),asSet:Dt.set("~"+U.Set,{},["value"])};Ct.set("toUpper",jt.upper),Ct.set("toLower",jt.lower),Ct.set("chars",jt.chars),Ct.set("trim",jt.trim),Ct.set("soundex",jt.soundex),Ct.set("metaphone",jt.metaphone),Ct.set("base64",jt.base64),Ct.set("unbase64",jt.unbase64),Ct.set("encodeURI",jt.encodeURI),Ct.set("decodeURI",jt.decodeURI),Ct.set("encodeURIComponent",jt.encodeURIComponent),Ct.set("decodeURIComponent",jt.decodeURIComponent),Ct.set("md5",jt.md5),Ct.set("toNumber",jt.toNumber),Ct.set("isEmpty",jt.isEmpty),Ct.set("isNotEmpty",jt.isNotEmpty),Ct.set("isLower",jt.isLower),Ct.set("isUpper",jt.isUpper);var kt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=function(){return(At=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Nt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-+=:.",Lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.decode=function(t){return new e(this.decodeOptions(t[1]||{}))},e.encode=function(t){return v(t.options)?this.id:[this.id,this.encodeOptions(t.options)]},e.decodeOptions=function(t){var e=t.matches;return e&&(t.matches=new RegExp(e[0],e[1])),t},e.encodeOptions=function(t){var e=At({},t),n=e.matches;return n&&(e.matches=[n.source,n.flags]),e},e.describe=function(t){return i(t)?new e({min:t.length,max:t.length,requireLower:t.toLowerCase()===t,requireUpper:t.toUpperCase()===t}):null},e.register=function(){$.addCompare({priority:4,type:"string",compare:function(t,e){return t.localeCompare(e)}}),$.addEquals({priority:4,type:"string",equals:function(t,e){return t===e}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.max=Math.max(e.max,n.max),e.min=Math.min(e.min,n.min),e.requireLower=e.requireLower&&n.requireLower,e.requireUpper=e.requireUpper&&n.requireUpper},e.prototype.getSubType=function(t,n,r){if(Ht.is(t)){if("length"===t.value)return Ti.LENGTH;if(o(t.value))return Ti.CHAR}var i=t.getType(n,r);if(i){if((i=i.getRequired())instanceof Pn)return Ti.CHAR;if(i instanceof Ut){if(i.options.value instanceof Pn)return Ti.CHAR;if(i.options.value instanceof e){var s=Array.from(i.options.constants.values());if(1===s.length&&"length"===s[0])return Ti.LENGTH}}}},e.prototype.getSubTypes=function(t){return[{key:"length",value:Ti.LENGTH},{key:Ti.INDEX,value:Ti.optional(Ti.CHAR)}]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){if(!(t instanceof e))return!1;if(n.value){var r=this.options.min,o=t.options.min;if(r&&(!o||o<r))return!1;var i=this.options.max,s=t.options.max;if(i&&(!s||s>i))return!1;var a=this.options.forceLower||this.options.requireUpper,u=t.options.forceLower||t.options.requireLower;if(a&&!u)return!1;var p=this.options.forceUpper||this.options.requireUpper,c=t.options.forceUpper||t.options.requireUpper;if(p&&!c)return!1;var l=this.options.matches,f=t.options.matches;if(l&&(!f||f.source!==l.source))return!1}return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){this.options={}},e.prototype.getCreateExpression=function(){return wn.op(jt.create,{})},e.prototype.getValidateExpression=function(){return wn.op(jt.isValid,{value:wn.get("value")})},e.prototype.getCompareExpression=function(){return wn.op(jt.compare,{value:wn.get("value"),test:wn.get("test"),ignoreCase:wn.true()})},e.prototype.isValid=function(t){if(!i(t))return!1;var e=this.options,n=e.min,r=e.max,s=e.requireLower,a=e.requireUpper,u=e.matches,p=e.forceLower,c=e.forceUpper;return!(o(n)&&t.length<n)&&(!(o(r)&&t.length>r)&&(!(s&&t!==t.toLowerCase()&&!p)&&(!(a&&t!==t.toUpperCase()&&!c)&&!(u&&u instanceof RegExp&&!u.test(t)))))},e.prototype.normalize=function(t){return i(t)&&(this.options.forceLower&&(t=t.toLowerCase()),this.options.forceUpper&&(t=t.toUpperCase())),t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e($.copy(this.options))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return""},e.prototype.random=function(t){for(var e=this.options,n=e.min,r=e.max,o=e.requireLower,i=e.forceLower,s=e.requireUpper,a=e.forceUpper,u=o||i,p=s||a,c=t(M(n,1),M(r,16)+1,!0),l="",f=0;f<c;f++)l+=Nt.charAt(t(0,Nt.length,!0));return u&&(l=l.toLowerCase()),p&&(l=l.toUpperCase()),l},e.prototype.fromJson=function(t){return t},e.prototype.toJson=function(t){return t},e.id=U.Text,e.operations=It,e.computeds=Ct,e.baseType=new e({}),e.describePriority=3,e.registered=!1,e}(R),Rt=new G(U.Map+U.Delimiter),qt=new B(U.Map+U.Delimiter),Vt=Rt,Ft={create:Vt.set("create"),createLike:Vt.set("createLike",{},["map"],[],[],[],["map"]),createFor:Vt.set("createFor",{},["value"],["key"],[],[],["value","key"]),maybe:Vt.set("maybe",{},["value"]),get:Vt.set("get",{},["map","key"],[],[],[],["map"]),set:Vt.set("set",{mutates:["map"]},["map","key","value"],[],["existingValue"],["value"],["map"]),has:Vt.set("has",{},["map","key"]),delete:Vt.set("delete",{mutates:["map"]},["map","key"]),keys:Vt.set("keys",{complexity:1},["map"],[],[],[],["map"]),values:Vt.set("values",{complexity:1},["map"],[],[],[],["map"]),entries:Vt.set("entries",{complexity:1},["map"],[],[],[],["map"]),pairs:Vt.set("pairs",{complexity:1},["map"],[],[],[],["map"]),clear:Vt.set("clear",{mutates:["map"]},["map"],[],[],[],["map"]),count:Vt.set("count",{},["map"]),cmp:Vt.set("cmp",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),copy:Vt.set("copy",{complexity:1},["map"],["deepCopy","deepCopyKey"],["map","key","value"],["deepCopy","deepCopyKey"],["map"]),map:Vt.set("map",{complexity:1},["map"],["transform","transformKey"],["map","key","value"],["transform","transformKey"],["map"]),toPlainObject:Vt.set("plain",{complexity:1},["map"]),fromPlainObject:Vt.set("fromPlain",{complexity:1},["object"],[],[],[],["object"]),isValid:Vt.set("?",{},["value"]),isEqual:Vt.set("=",{complexity:1},["value","test","isEqual"],[],["key","value","test"],["isEqual"]),isNotEqual:Vt.set("!=",{complexity:1},["value","test","isEqual"],[],["key","value","test"],["isEqual"]),isLess:Vt.set("<",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isLessOrEqual:Vt.set("<=",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isGreater:Vt.set(">",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isGreaterOrEqual:Vt.set(">=",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),asAny:Vt.set("~"+U.Any,{},["value"]),asBoolean:Vt.set("~"+U.Boolean,{},["value"]),asColor:Vt.set("~"+U.Color,{},["value"]),asDate:Vt.set("~"+U.Date,{},["value"]),asList:Vt.set("~"+U.List,{},["value"]),asMap:Vt.set("~"+U.Map,{},["value"]),asNumber:Vt.set("~"+U.Number,{},["value"]),asObject:Vt.set("~"+U.Object,{},["value"]),asText:Vt.set("~"+U.Text,{},["value"]),asTuple:Vt.set("~"+U.Tuple,{},["value"]),asSet:Vt.set("~"+U.Set,{},["value"])};qt.set("copy",Ft.copy),qt.set("keys",Ft.keys),qt.set("values",Ft.values),qt.set("entries",Ft.entries),qt.set("pairs",Ft.pairs),qt.set("count",Ft.count);var Yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Bt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yt(e,t),e.decode=function(t,n){var r=n.getType(t[1]),o=n.getType(t[2]),i=new Map(t[3].map(function(t){var e=Gt(t,2),n=e[0],i=e[1];return[r.fromJson(n),o.fromJson(i)]}));return new e({key:r,value:o,constants:i})},e.encode=function(t){var e=t.options,n=e.key,r=e.value,o=e.constants;return[this.id,n.encode(),r.encode(),Array.from(o.entries()).map(function(t){var e=Gt(t,2),o=e[0],i=e[1];return[n.toJson(o),r.toJson(i)]})]},e.describe=function(){return null},e.register=function(){},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return this.options.value.getOperations()},e.prototype.merge=function(t){var e,n,r=this.options.constants,o=t.options.constants;this.options.key=Ti.merge(this.options.key,t.options.key),this.options.value=Ti.merge(this.options.value,t.options.value);try{for(var i=Bt(o.entries()),s=i.next();!s.done;s=i.next()){var a=Gt(s.value,2),u=a[0],p=a[1];r.set(u,p)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.getSubType=function(t,e,n){return this.options.value.getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.options.value.getSubTypes(t)},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this.options.value},e.prototype.isWrapper=function(){return!0},e.prototype.isDeepCompatible=function(t,n){if(void 0===n&&(n={}),!(t instanceof e))return!1;var r=this.options,o=r.key,i=r.value;return!(n.exact&&!o.isCompatible(t.options.key,n))&&i.isCompatible(t.options.value)},e.prototype.isOptional=function(){return this.options.value.isOptional()},e.prototype.isSimple=function(){return this.options.value.isSimple()},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_KEY,n.options.key,function(t){return n.options.key=t}),t.step(e.STEP_VALUE,n.options.value,function(t){return n.options.value=t})})},e.prototype.getTypeFromStep=function(t){return t===e.STEP_KEY?this.options.key:t===e.STEP_VALUE?this.options.value:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.key.setParent(this),this.options.value.setParent(this)},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return this.options.value.getCreateExpression()},e.prototype.getValidateExpression=function(){return this.options.value.getValidateExpression()},e.prototype.getCompareExpression=function(){return this.options.value.getCompareExpression()},e.prototype.getValueChangeExpression=function(t,n,r){return n===e.STEP_KEY?wn.op(Ft.map,{map:wn.get("value"),transformKey:t},{key:"value",value:"actualValue"}):wn.op(Ft.map,{map:wn.get("value"),transform:t})},e.prototype.isValid=function(t){var e,n,r=this.options,o=r.constants;if(!r.value.isValid(t))return!1;try{for(var i=Bt(o.values()),s=i.next();!s.done;s=i.next()){var a=s.value;if(0===$.compare(a,t))return!0}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!1},e.prototype.normalize=function(t){return this.options.value.normalize(t)},e.prototype.newInstance=function(){var t=this.options,n=t.key,r=t.value;return new e({key:n.newInstance(),value:r.newInstance(),constants:new Map})},e.prototype.clone=function(){var t=this.options,n=t.key,r=t.value,o=t.constants;return new e({key:n.clone(),value:r.clone(),constants:new Map(o.entries())})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){var t=this.options,e=t.value,n=t.constants,r=n.keys().next();return r?n.get(r):e.create()},e.prototype.random=function(t){var e=Array.from(this.options.constants.values());return e[t(0,e.length,!0)]},e.prototype.fromJson=function(t){return this.options.value.fromJson(t)},e.prototype.toJson=function(t){return this.options.value.toJson(t)},e.STEP_KEY="key",e.STEP_VALUE="value",e.id=U.Enum,e.operations=new G(U.Enum+U.Delimiter),e.computeds=new B(U.Enum+U.Delimiter),e.baseType=new e({key:Lt.baseType,value:Lt.baseType,constants:new Map}),e.describePriority=-1,e.registered=!1,e}(R),Wt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ht=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return Wt(e,t),e.has=function(t,n){return t instanceof e&&t.value===n},e.is=function(t){return t instanceof e},e.decode=function(t,n){return new e(dt.baseType.fromJson(t[1]))},e.encode=function(t){var e=dt.baseType.toJson(t.value);return s(e)?[this.id,e]:e},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e($.copy(this.value))},e.prototype.getType=function(t,e){var n=this.value;if(i(n))return new Ut({key:Lt.baseType.newInstance(),value:Lt.baseType.newInstance(),constants:new Map([[n,n]])});if(o(n))return new Ut({key:Pn.baseType.newInstance(),value:Pn.baseType.newInstance(),constants:new Map([[n,n]])});var r=t.describe(this.value);return r&&r.removeDescribedRestrictions(),r},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){},e.id="constant",e}(V),Jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kt=1e5,zt="break",Xt=function(t){function e(e,n,r,o,i,s){void 0===i&&(i=zt),void 0===s&&(s=Kt);var a=t.call(this)||this;return a.variable=e,a.start=n,a.end=r,a.body=o,a.breakVariable=i,a.maxIterations=s,a}return Jt(e,t),e.decode=function(t,n){return new e(t[1],n.getExpression(t[2]),n.getExpression(t[3]),n.getExpression(t[4]),t[5]||zt,parseInt(t[6])||this.MAX_ITERATIONS)},e.encode=function(t){var e=[this.id,t.variable,t.start.encode(),t.end.encode(),t.body.encode()],n=t.maxIterations!==this.MAX_ITERATIONS;return(t.breakVariable!==zt||n)&&e.push(t.breakVariable),n&&e.push(t.maxIterations),e},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return Math.max(this.start.getComplexity(t),this.end.getComplexity(t),this.body.getComplexity(t))+1},e.prototype.getScope=function(){var t;return(t={})[this.variable]=Pn.baseType.newInstance(),t[this.breakVariable]=Z.baseType,t},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.variable,this.start.clone(),this.end.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},e.prototype.getType=function(t,e){var n=t.getContextWithScope(e,this.getScope()).context,r=this.body.getType(t,n);return r?Ti.optional(r):null},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_START,n.start,function(t){return n.start=t}),t.step(e.STEP_END,n.end,function(t){return n.end=t}),t.step(e.STEP_BODY,n.body,function(t){return n.body=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_START?[1,this.start]:t[0]===e.STEP_END?[1,this.end]:t[0]===e.STEP_BODY?[1,this.body]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.start.setParent(this),this.end.setParent(this),this.body.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,Pn.baseType,this.start,n),this.validateType(t,e,Pn.baseType,this.end,n);var r=t.getContext(e,this.getScope());this.body.validate(t,r,n)},e.prototype.loop=function(t,e,n,r,i,s){return this.variable=t,this.start=wn.parse(e),this.start.setParent(this),this.end=wn.parse(n),this.end.setParent(this),r&&(this.body=r,this.body.setParent(this)),i&&(this.breakVariable=i),o(s)&&(this.maxIterations=s),this},e.prototype.startAt=function(t){return this.start=wn.parse(t),this.start.setParent(this),this},e.prototype.endAt=function(t){return this.end=wn.parse(t),this.end.setParent(this),this},e.prototype.run=function(t){return this.body=t,this.body.setParent(this),this},e.prototype.withVariable=function(t){return this.variable=t,this},e.prototype.withBreak=function(t){return this.breakVariable=t,this},e.prototype.withMax=function(t){return this.maxIterations=t,this},e.STEP_START="start",e.STEP_END="end",e.STEP_BODY="body",e.MAX_ITERATIONS=Kt,e.id="for",e}(V),$t=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Zt=function(t){function e(e){var n=t.call(this)||this;return n.path=e,n}return $t(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.path.map(function(t){return t.encode()});return[this.id,e]},e.create=function(t){return new e(wn.parse(t))},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.path.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.path.map(function(t){return t.clone()}))},e.prototype.getType=function(t,e){return t.getPathType(this.path,e)},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return e.path.forEach(function(n,r){return t.step(r,n,function(t){return e.path.splice(r,1,t)},function(){return e.path.splice(r,1)})})})},e.prototype.getExpressionFromStep=function(t){return o(t[0])&&t[0]<this.path.length?[1,this.path[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.path.forEach(function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){this.validatePath(t,e,e,this.path,n)},e.prototype.add=function(t){var e,n,r=s(t)?t:[t];try{for(var o=Qt(r),i=o.next();!i.done;i=o.next()){var a=i.value,u=wn.parse(a);this.path.push(u),u.setParent(this)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},e.id="get",e}(V),te=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return te(e,t),e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return[this.id,t.name]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name)},e.prototype.getType=function(t,e){var n=t.getData(this.name);return n?n.dataType:ct.baseType},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){this.name?t.getData(this.name)||n({type:k.MISSING_DATA,severity:j.HIGH,context:e,parent:this}):n({type:k.MISSING_DATA_NAME,severity:j.HIGH,context:e,parent:this})},e.id="data",e.instance=new e(""),e}(V),ne=new G(U.Entity+U.Delimiter),re=new B(U.Entity+U.Delimiter),oe=ne,ie={newInstance:oe.set("newInstance",{},["name"],[],[],[],["name"]),get:oe.set("get",{},["name"],["where"],["instance"],["where"],["name"]),getKey:oe.set("getKey",{},["name","instance"],[],[],[],["name"]),save:oe.set("save",{mutates:["instance"]},["name","instance"],[],[],[],["name"]),remove:oe.set("remove",{mutates:["instance"]},["name","instance"],[],[],[],["name"]),setRelated:oe.set("setRelated",{complexity:1,mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),addRelated:oe.set("addRelated",{mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),removeRelated:oe.set("removeRelated",{mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),clearRelated:oe.set("clearRelated",{complexity:1,mutates:["instance"]},["name","instance","relation"],[],[],[],["name","relation"]),getRelated:oe.set("getRelated",{complexity:1},["name","instance","relation"],[],[],[],["name","relation"]),isRelated:oe.set("isRelated",{},["name","instance","relation","related"],[],[],[],["name","relation"])},se=new G(U.Object+U.Delimiter),ae=new B(U.Object+U.Delimiter),ue=se,pe={create:ue.set("create"),maybe:ue.set("maybe",{},["value"]),has:ue.set("has",{},["object","key"]),get:ue.set("get",{},["object","key"]),set:ue.set("set",{mutates:["object"]},["object","key","value"],[],["existingValue"],[],["object"]),delete:ue.set("del",{mutates:["object"]},["object","key"]),cmp:ue.set("cmp",{},["value","test"]),copy:ue.set("copy",{},["object"],[],[],[],["object"]),merge:ue.set("merge",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),isValid:ue.set("?",{},["value"]),isEqual:ue.set("=",{},["value","test"]),isNotEqual:ue.set("!=",{},["value","test"]),isLess:ue.set("<",{},["value","test"]),isLessOrEqual:ue.set("<=",{},["value","test"]),isGreater:ue.set(">",{},["value","test"]),isGreaterOrEqual:ue.set(">=",{},["value","test"]),asAny:ue.set("~"+U.Any,{},["value"]),asBoolean:ue.set("~"+U.Boolean,{},["value"]),asColor:ue.set("~"+U.Color,{},["value"]),asDate:ue.set("~"+U.Date,{},["value"]),asList:ue.set("~"+U.List,{},["value"]),asMap:ue.set("~"+U.Map,{},["value"]),asNumber:ue.set("~"+U.Number,{},["value"]),asObject:ue.set("~"+U.Object,{},["value"]),asText:ue.set("~"+U.Text,{},["value"]),asTuple:ue.set("~"+U.Tuple,{},["value"]),asSet:ue.set("~"+U.Set,{},["value"])};ae.set("copy",pe.copy);var ce=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),le=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},fe=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(le(arguments[e]));return t},ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ce(e,t),e.decode=function(t,n){return new e({props:O(t[1],function(t){return n.getType(t)})})},e.encode=function(t){var e=O(t.options.props,function(t){return t.encode()});return[this.id,e]},e.describe=function(t,n){return f(t)&&null!==t?new e({props:O(t,function(t){return n.describe(t)})}):null},e.register=function(){$.addJson({priority:7,fromJson:function(t,e){if(f(t))return O(t,e)},toJson:function(t,e){if(f(t))return O(t,e)}}),$.addCopier({priority:7,copy:function(t,e,n){if(f(t)){var r={};for(var o in n(t,r),t)r[e(o)]=e(t[o]);return r}}}),$.addCompare({priority:7,type:"object",compare:function(t,e,n){if(null===t)return 1;if(null===e)return-1;var r=0,o=0;for(var i in t)i in e||r++;for(var i in e)i in t||o++;for(var i in t)if(i in e){var s=n(t[i],e[i]);s<0&&r++,s>0&&o++}return $.getCompare(r,o)}}),$.addEquals({priority:7,type:"object",equals:function(t,e,n){if(null===t!=(null===e))return!1;for(var r in t)if(!(r in e))return!1;for(var r in e){if(!(r in t))return!1;if(!n(t[r],e[r]))return!1}return!0}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options.props,n=t.options.props;for(var r in e)r in n&&n[r]?e[r]=Ti.merge(e[r],n[r]):e[r]&&(e[r]=Ti.optional(e[r]));for(var r in n)r in e||!n[r]||(e[r]=Ti.optional(n[r]))},e.prototype.getSubType=function(t,e,n){var r=this;if(Ht.is(t)&&i(t.value))return this.options.props[t.value];var o=t.getType(e,n);if(o){if((o=o.getRequired())instanceof Lt){var s=w(this.options.props);return Ti.mergeMany(s,ct.baseType)}if(o instanceof Ut){s=Array.from(o.options.constants.values()).map(function(t){return r.options.props[t]}).filter(function(t){return!!t});return Ti.mergeMany(s,ct.baseType)}}return this.getWildcardType()},e.prototype.getSubTypes=function(t){var e=w(this.options.props);return fe(w(this.options.props,function(t,e){return{key:e,value:t}}),[{key:new Ut({key:Lt.baseType,value:Lt.baseType,constants:new Map(w(this.options.props,function(t,e){return[e,e]}))}),value:Ti.mergeMany(e,ct.baseType)},{key:Lt.baseType,value:Ti.optional(Ti.mergeMany(e,ct.baseType))}])},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return E(e.options.props,function(n,r){return t.step(r,n,function(t){return e.options.props[r]=t},function(){return delete e.options.props[r]})})})},e.prototype.getTypeFromStep=function(t){return this.options.props[t]||null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.options.props,function(t){return t?t.setParent(e):0})},e.prototype.removeDescribedRestrictions=function(){E(this.options.props,function(t){return t?t.removeDescribedRestrictions():0})},e.prototype.isDeepCompatible=function(t,n){if(!(t instanceof e))return!1;var r=this.options.props;for(var o in r)if(o!==e.wilcardProperty&&r[o]){if(!t.options.props[o])return!1;if(!r[o].isCompatible(t.options.props[o],n))return!1}var i=this.getWildcardType();if(n.exact){for(var o in t.options.props)if(!r[o]&&t.options.props[o])return!1}else if(i)for(var o in t.options.props)if(!r[o]&&t.options.props[o]&&!i.isCompatible(t.options.props[o],n))return!1;return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.getCreateExpression=function(){return wn.object(O(this.options.props,function(t){return t?t.getCreateExpression():wn.noop()}))},e.prototype.getValidateExpression=function(){return wn.and.apply(wn,fe([wn.op(pe.isValid,{value:wn.get("value")})],w(this.options.props,function(t,e){return wn.define({value:wn.get("value",e)}).run(t?t.getValidateExpression():wn.true())})))},e.prototype.getCompareExpression=function(){return wn.or.apply(wn,fe(w(this.options.props,function(t,e){return wn.define({value:wn.get("value",e),test:wn.get("test",e)}).run(t?t.getCompareExpression():wn.true())})))},e.prototype.getValueChangeExpression=function(t,e,n){var r=null!=e,o=null!=n;return!r&&o?wn.define({parent:wn.get("value")},wn.op(pe.set,{object:wn.get("value"),key:n,value:t})):r&&!o?wn.body(wn.op(pe.delete,{object:wn.get("value"),key:e}),wn.get("value")):e!==n?wn.body(wn.op(pe.set,{object:wn.get("value"),key:n,value:wn.get("value",e)}),wn.op(pe.delete,{object:wn.get("value"),key:e}),wn.get("value")):e===n&&r?wn.body(wn.update("value",e).to(t,"value"),wn.get("value")):t},e.prototype.isValid=function(t){if(!f(t))return!1;var n=this.options.props;for(var r in n)if(r!==e.wilcardProperty&&n[r]&&!n[r].isValid(t[r]))return!1;var o=this.getWildcardType();if(o)for(var r in t)if(!n[r]&&!o.isValid(t[r]))return!1;return!0},e.prototype.normalize=function(t){return t},e.prototype.newInstance=function(){return new e({props:{}})},e.prototype.clone=function(){return new e({props:O(this.options.props,function(t){return t?t.clone():t})})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return Object.create(null)},e.prototype.random=function(t){var e=this.options.props,n=Object.create(null);for(var r in e)e[r]&&(n[r]=e[r].random(t));return n},e.prototype.fromJson=function(t){var e=this;return O(t,function(t,n){var r=e.options.props[n];return r?r.fromJson(t):t})},e.prototype.toJson=function(t){var e=this;return O(t,function(t,n){var r=e.options.props[n];return r?r.toJson(t):t})},e.prototype.getWildcardType=function(){return this.options.props[e.wilcardProperty]||null},e.wilcardProperty="*",e.id=U.Object,e.operations=se,e.computeds=ae,e.baseType=new e({props:{}}),e.describePriority=5,e.registered=!1,e}(R),de=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),he=function(t){function e(e,n){var r=t.call(this,e)||this;return r.provider=n,r}return de(e,t),e.decode=function(t,n){return new e(t[1],n)},e.encode=function(t){return[this.id,t.options]},e.describe=function(t,e){return null},e.register=function(){},e.for=function(t,n){return new e(t,n)},e.prototype.getType=function(){return this.provider?this.provider.getType(this.options,ct.baseType):ye.baseType},e.prototype.getOperations=function(){return this.getType().getOperations()},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return this.getType().getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.getType().getSubTypes(t)},e.prototype.getExactType=function(t){return this.getType().getExactType(t)},e.prototype.getSimplifiedType=function(){return this.getType().getSimplifiedType()},e.prototype.isDeepCompatible=function(t,n){return t instanceof e?this.getType().isCompatible(t.getType(),n):this.getType().isCompatible(t,n)},e.prototype.isOptional=function(){return this.getType().isOptional()},e.prototype.isSimple=function(){return this.getType().isSimple()},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){return t.step(e.STEP_ENTITY,n.getType(),function(t){return t instanceof e?n.options=t.options:0})})},e.prototype.getTypeFromStep=function(t){return t===e.STEP_ENTITY?this.getType():null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return this.getType().getCreateExpression()},e.prototype.getValidateExpression=function(){return this.getType().getValidateExpression()},e.prototype.getCompareExpression=function(){return this.getType().getCompareExpression()},e.prototype.getValueChangeExpression=function(t,e,n){return t},e.prototype.isValid=function(t){return this.getType().isValid(t)},e.prototype.normalize=function(t){return this.getType().normalize(t)},e.prototype.newInstance=function(){return new e(this.options,this.provider)},e.prototype.clone=function(){return new e(this.options,this.provider)},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.getType().create()},e.prototype.random=function(t){return this.getType().random(t)},e.prototype.fromJson=function(t){return this.getType().fromJson(t)},e.prototype.toJson=function(t){return this.getType().toJson(t)},e.STEP_ENTITY="entity",e.id=U.Entity,e.operations=ne,e.computeds=re,e.baseType=new e("",null),e.describePriority=-1,e.registered=!1,e}(R),ve=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),me=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return ve(e,t),e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return[this.id,t.name]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name)},e.prototype.getType=function(t,e){return new he(this.name,t)},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){this.name?t.getEntity(this.name)||n({type:k.MISSING_TYPE,severity:j.HIGH,context:e,parent:this}):n({type:k.MISSING_TYPE_NAME,severity:j.HIGH,context:e,parent:this})},e.id="entity",e.instance=new e(""),e}(V),ge=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Te=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return ge(e,t),e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return[this.id,t.name]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name)},e.prototype.getType=function(t,e){return new Ut({key:Lt.baseType,value:Lt.baseType,constants:new Map([["relation",this.name]])})},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){this.name?t.getRelation(this.name)||n({type:k.MISSING_RELATION,severity:j.HIGH,context:e,parent:this}):n({type:k.MISSING_RELATION_NAME,severity:j.HIGH,context:e,parent:this})},e.id="relation",e.instance=new e(""),e}(V),be=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xe=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Oe=function(t){function e(e,n){var r=t.call(this)||this;return r.cases=e,r.otherwise=n,r}return be(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){var e=xe(t,2),r=e[0],o=e[1];return[n.getExpression(r),n.getExpression(o)]}),n.getExpression(t[2]))},e.encode=function(t){var e=t.cases.map(function(t){var e=xe(t,2),n=e[0],r=e[1];return[n.encode(),r.encode()]});return Ht.has(t.otherwise,void 0)?[this.id,e]:[this.id,e,t.otherwise.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.cases.reduce(function(e,n){var r=xe(n,2),o=r[0],i=r[1];return Math.max(e,o.getComplexity(t),i.getComplexity(t))},this.otherwise.getComplexity(t))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.cases.map(function(t){var e=xe(t,2),n=e[0],r=e[1];return[n.clone(),r.clone()]}),this.otherwise.clone())},e.prototype.getType=function(t,e){var n=this.cases.map(function(t){var e=xe(t,2);e[0];return e[1]}).concat(this.otherwise).filter(function(t){return!!t}).map(function(n){return n.getType(t,e)}).filter(function(t){return!!t});return Ti.mergeMany(n,ct.baseType)},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_CASES,function(){return n.cases.forEach(function(r,o){var i=xe(r,2),s=i[0],a=i[1];return t.step(o,function(){t.step(e.STEP_IF,s,function(t){return n.cases[o].splice(0,1,t)}),t.step(e.STEP_THEN,a,function(t){return n.cases[o].splice(1,1,t)})})})}),n.otherwise!==ft.instance&&t.step(e.STEP_ELSE,n.otherwise,function(t){return n.otherwise=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_CASES?o(t[1])&&t[1]<this.cases.length?t[2]===e.STEP_IF?[3,this.cases[t[1]][0]]:t[2]===e.STEP_THEN?[3,this.cases[t[1]][1]]:null:null:t[0]===e.STEP_ELSE?[1,this.otherwise]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.cases.forEach(function(t){var n=xe(t,2),r=n[0],o=n[1];r.setParent(e),o.setParent(e)}),this.otherwise.setParent(this)},e.prototype.validate=function(t,e,n){var r=this,o=Z.baseType;this.cases.forEach(function(i){var s=xe(i,2),a=s[0],u=s[1];r.validateType(t,e,o,a,n),u.validate(t,e,n)}),this.otherwise.validate(t,e,n)},e.prototype.if=function(t,e){return this.cases.push([t,e||ft.instance]),t.setParent(this),e&&e.setParent(this),this},e.prototype.than=function(t){return this.cases[this.cases.length-1][1]=t,t.setParent(this),this},e.prototype.elseif=function(t,e){return this.cases.push([t,e||ft.instance]),t.setParent(this),e&&e.setParent(this),this},e.prototype.else=function(t){return this.otherwise=t,this.otherwise.setParent(this),this},e.STEP_CASES="cases",e.STEP_IF="if",e.STEP_THEN="then",e.STEP_ELSE="else",e.id="if",e}(V),Ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),we=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e,r.args=n,r}return Ee(e,t),e.decode=function(t,n){return new e(t[1],O(t[2],function(t){return n.getExpression(t)}))},e.encode=function(t){var e=O(t.args,function(t){return t.encode()});return[this.id,t.name,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){var e=t.getFunction(this.name);return e?e.expression.getComplexity(t):0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name,O(this.args,function(t){return t.clone()}))},e.prototype.getType=function(t,e){var n=t.getFunction(this.name),r=O(this.args,function(n){return n.getType(t,e)});return n?n.getReturnType(t,r):null},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return E(e.args,function(n,r){return t.step(r,n,function(t){return e.args[r]=t},function(){return delete e.args[r]})})})},e.prototype.getExpressionFromStep=function(t){return t[0]in this.args?[1,this.args[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.args,function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){var r=this,o=t.getFunction(this.name);if(o){var i={};E(o.params.options.props,function(o,s){var a=r.args[s];r.validateType(t,e,o,a,n),a&&(i[s]=a.getType(t,e))})}else n({type:k.MISSING_FUNCTION,severity:j.HIGH,context:e,subject:this})},e.prototype.named=function(t){return this.name=t,this},e.prototype.arg=function(t,e){var n,r=i(t)?((n={})[t]=e,n):t;for(var o in r){var s=wn.parse(r[o]);this.args[o]=s,s.setParent(this)}return this},e.id="invoke",e}(V),Se=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pe=function(t){function e(e){var n=t.call(this)||this;return n.expressions=e,n}return Se(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.expressions.map(function(t){return t.encode()});return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.expressions.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expressions.map(function(t){return t.clone()}))},e.prototype.getType=function(t,e){var n=this.expressions.map(function(n){return n.getType(t,e)}).concat(Z.baseType).filter(function(t){return!!t});return Ti.mergeMany(n,ct.baseType)},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return e.expressions.forEach(function(n,r){return t.step(r,n,function(t){return e.expressions.splice(r,1,t)},function(){return e.expressions.splice(r,1)})})})},e.prototype.getExpressionFromStep=function(t){return o(t[0])&&t[0]<this.expressions.length?[1,this.expressions[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.expressions.forEach(function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){var r=this,o=Z.baseType;this.expressions.forEach(function(i){r.validateType(t,e,o,i,n)})},e.id="or",e}(V),_e=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Me=function(){return(Me=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ie=function(t){function e(e,n,r){void 0===r&&(r={});var o=t.call(this)||this;return o.name=e,o.params=n,o.scopeAlias=r,o}return _e(e,t),e.decode=function(t,n){return new e(t[1],O(t[2],function(t){return n.getExpression(t)}),t[3]||{})},e.encode=function(t){var e=O(t.params,function(t){return t.encode()});return v(t.scopeAlias)?[this.id,t.name,e]:[this.id,t.name,e,t.scopeAlias]},e.create=function(t,n,r){return void 0===r&&(r=Object.create(null)),new e(t.id,n,r)},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){var e=t.getOperation(this.name),n=e?e.complexity:0;for(var r in this.params)n=Math.max(n,this.params[r].getComplexity(t));return n},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name,O(this.params,function(t){return t.clone()}),Me({},this.scopeAlias))},e.prototype.getType=function(t,e){return t.getOperationReturnType(this.name,this.params,this.scopeAlias,e)},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return E(e.params,function(n,r){return t.step(r,n,function(t){return e.params[r]=t},function(){return delete e.params[r]})})})},e.prototype.getExpressionFromStep=function(t){return t[0]in this.params?[1,this.params[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.params,function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){var r=this.name,o=this.params,i=this.scopeAlias,s=t.getOperation(r),a=t.getOperationTypes(r);if(s){var u=t.getOperationExpectedTypes(r,o,i,e),p=s.hasScope.length>0?t.getOperationScopeContext(r,u,i,e):e;for(var c in u){var l=-1!==s.optional.indexOf(c),f=u[c],y=l?Ti.optional(f):f,d=o[c],h=-1!==s.hasScope.indexOf(c)?p:e;this.validateType(t,h,y,d,n)}for(var c in o){d=o[c];var v=a.params[c];if(!(c in u)&&v){h=-1!==s.hasScope.indexOf(c)?p:e;n({type:k.MISSING_EXPRESSION,severity:j.HIGH,context:h,subject:d,parent:this}),o[c].validate(t,h,n)}}}else n({type:k.MISSING_OPERATION,severity:j.HIGH,context:e,subject:this})},e.prototype.param=function(t,e){var n=wn.parse(e);return this.params[t]=n,n.setParent(this),this},e.prototype.alias=function(t,e){return this.scopeAlias[t]=e,this},e.prototype.and=function(t){var e=s(t)?t:[t];return new rt([this].concat(e))},e.prototype.or=function(t){var e=s(t)?t:[t];return new Pe([this].concat(e))},e.prototype.not=function(){return new et(this)},e.id="op",e}(V),Ce=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),De=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return Ce(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]))},e.encode=function(t){var e=t.value.encode();return void 0!==e?[this.id,e]:[this.id]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.value.getComplexity(t)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.value.encode())},e.prototype.getType=function(t,e){return this.value?this.value.getType(t,e):null},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){return t.step(e.STEP_VALUE,n.value,function(t){return n.value=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_VALUE?[1,this.value]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.value.setParent(this)},e.prototype.validate=function(t,e,n){this.value.validate(t,e,n)},e.STEP_VALUE="value",e.id="return",e}(V),je=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ke=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ae=function(t){function e(e,n){var r=t.call(this)||this;return r.path=e,r.value=n,r}return je(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}),n.getExpression(t[2]))},e.encode=function(t){var e=t.path.map(function(t){return t.encode()});return[this.id,e,t.value.encode()]},e.create=function(t,n){return new e(wn.parse(t),wn.parse(n))},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.path.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},this.value.getComplexity(t))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.path.map(function(t){return t.clone()}),this.value.clone())},e.prototype.getType=function(t,e){return Z.baseType},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_PATH,function(){return n.path.forEach(function(e,r){return t.step(r,e,function(t){return n.path.splice(r,1,t)},function(){return n.path.splice(r,1)})})}),t.step(e.STEP_VALUE,n.value,function(t){return n.value=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_PATH?o(t[1])&&t[1]<this.path.length?[2,this.path[t[1]]]:null:t[0]===e.STEP_VALUE?[1,this.value]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.path.forEach(function(t){return t.setParent(e)}),this.value.setParent(this)},e.prototype.validate=function(t,e,n){this.validatePath(t,e,e,this.path,n);var r=t.getPathType(this.path,e);r&&this.validateType(t,e,r,this.value,n)},e.prototype.add=function(t){var e,n,r=s(t)?t:[t];try{for(var o=ke(r),i=o.next();!i.done;i=o.next()){var a=i.value,u=wn.parse(a);this.path.push(u),u.setParent(this)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},e.prototype.to=function(t){return this.value=wn.parse(t),this.value.setParent(this),this},e.STEP_PATH="path",e.STEP_VALUE="value",e.id="set",e}(V),Ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Le=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Re=function(t){function e(e,n){var r=t.call(this)||this;return r.value=e,r.path=n,r}return Ne(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),t[2].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.value.encode(),n=t.path.map(function(t){return t.encode()});return[this.id,e,n]},e.create=function(t,n){return new e(wn.parse(t),wn.parse(n))},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.path.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},this.value.getComplexity(t))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.value.clone(),this.path.map(function(t){return t.clone()}))},e.prototype.getType=function(t,e){var n=this.value.getType(t,e);return n?t.getPathType(this.path,n):null},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_VALUE,n.value,function(t){return n.value=t}),t.step(e.STEP_PATH,function(){n.path.forEach(function(e,r){return t.step(r,e,function(t){return n.path.splice(r,1,t)},function(){return n.path.splice(r,1)})})})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_PATH?o(t[1])&&t[1]<this.path.length?[2,this.path[t[1]]]:null:t[0]===e.STEP_VALUE?[1,this.value]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.value.setParent(this),this.path.forEach(function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){var r=this.value.getType(t,e);this.validatePath(t,e,r,this.path,n),this.value.validate(t,e,n)},e.prototype.with=function(t){return this.value=wn.parse(t),this.value.setParent(this),this},e.prototype.sub=function(t){var e,n,r=s(t)?t:[t];try{for(var o=Le(r),i=o.next();!i.done;i=o.next()){var a=i.value,u=wn.parse(a);this.path.push(u),u.setParent(this)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},e.STEP_PATH="path",e.STEP_VALUE="value",e.id="sub",e}(V),qe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ve=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Fe=function(t){function e(e,n,r,o){var i=t.call(this)||this;return i.value=e,i.op=n,i.cases=r,i.defaultCase=o,i}return qe(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),t[2],t[3].map(function(t){var e=Ve(t,2),r=e[0],o=e[1];return[r.map(function(t){return n.getExpression(t)}),n.getExpression(o)]}),n.getExpression(t[4]))},e.encode=function(t){var e=t.value.encode(),n=t.cases.map(function(t){var e=Ve(t,2),n=e[0],r=e[1];return[n.map(function(t){return t.encode()}),r.encode()]});return Ht.has(t.defaultCase,void 0)?[this.id,e,t.op,n]:[this.id,e,t.op,n,t.defaultCase.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.cases.reduce(function(e,n){var r=Ve(n,2),o=r[0],i=r[1];return Math.max(e,i.getComplexity(t),o.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0))},Math.max(this.value.getComplexity(t),this.defaultCase.getComplexity(t)))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.value.clone(),this.op,this.cases.map(function(t){var e=Ve(t,2),n=e[0],r=e[1];return[n.map(function(t){return t.clone()}),r.clone()]}),this.defaultCase.clone())},e.prototype.getType=function(t,e){var n=this.cases.map(function(t){var e=Ve(t,2);e[0];return e[1]}).concat(this.defaultCase).filter(function(t){return!!t}).map(function(n){return n.getType(t,e)}).filter(function(t){return!!t});return Ti.mergeMany(n,ct.baseType)},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_VALUE,n.value,function(t){return n.value=t}),t.step(e.STEP_CASES,function(){return n.cases.forEach(function(r,o){var i=Ve(r,2),s=i[0],a=i[1];return t.step(o,function(){t.step(e.STEP_CASE,function(){return s.forEach(function(e,n){return t.step(n,e,function(t){return s.splice(n,1,t)},function(){return s.splice(n,1)})})}),t.step(e.STEP_RESULT,a,function(t){return n.cases[o].splice(1,1,t)})})})}),t.step(e.STEP_DEFAULT,n.defaultCase,function(t){return n.defaultCase=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_VALUE?[1,this.value]:t[0]===e.STEP_CASES?o(t[1])&&t[1]<this.cases.length?t[2]===e.STEP_CASE?o(t[3])&&t[3]<this.cases[t[1]][0].length?[4,this.cases[t[1]][0][t[3]]]:null:t[2]===e.STEP_RESULT?[3,this.cases[t[1]][1]]:null:null:t[0]===e.STEP_DEFAULT?[1,this.defaultCase]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.value.setParent(this),this.cases.forEach(function(t){var n=Ve(t,2),r=n[0],o=n[1];r.forEach(function(t){return t.setParent(e)}),o.setParent(e)}),this.defaultCase.setParent(this)},e.prototype.validate=function(t,e,n){this.value.validate(t,e,n),this.cases.forEach(function(r){var o=Ve(r,2),i=o[0],s=o[1];i.forEach(function(r){return r.validate(t,e,n)}),s.validate(t,e,n)}),this.defaultCase.validate(t,e,n)},e.prototype.val=function(t,e){return this.value=wn.parse(t),this.value.setParent(this),this.op=e?e.id:this.op,this},e.prototype.case=function(t){var e=this.cases.length-1,n=wn.parse(t);return n.setParent(this),e>=0&&this.cases[e][1]===ft.instance?this.cases[e][0].push(n):this.cases.push([[n],ft.instance]),this},e.prototype.than=function(t){var e=wn.parse(t);return this.cases[this.cases.length-1][1]=e,e.setParent(this),this},e.prototype.default=function(t){return this.defaultCase=wn.parse(t),this.defaultCase.setParent(this),this},e.STEP_VALUE="value",e.STEP_CASES="cases",e.STEP_CASE="case",e.STEP_RESULT="result",e.STEP_DEFAULT="default",e.id="switch",e}(V),Ye=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ge=function(t){function e(e,n){var r=t.call(this)||this;return r.template=e,r.params=n,r}return Ye(e,t),e.decode=function(t,n){return new e(t[1],O(t[2],function(t){return n.getExpression(t)}))},e.encode=function(t){var e=O(t.params,function(t){return t.encode()});return[this.id,t.template,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){var e=0;for(var n in this.params)e=Math.max(e,this.params[n].getComplexity(t));return e},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.template,O(this.params,function(t){return t.clone()}))},e.prototype.getType=function(t,e){return Lt.baseType.newInstance()},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return E(e.params,function(n,r){return t.step(r,n,function(t){return e.params[r]=t},function(){return delete e.params[r]})})})},e.prototype.getExpressionFromStep=function(t){return t[0]in this.params?[1,this.params[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.params,function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){var r=this;E(this.params,function(o){r.validateType(t,e,Lt.baseType,o,n)})},e.prototype.param=function(t,e){var n,r=i(t)?((n={})[t]=e,n):t;for(var o in r){var s=wn.parse(r[o]);this.params[o]=s,s.setParent(this)}return this},e.id="tmpl",e}(V),Be=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},We="current",He=function(t){function e(e,n,r){void 0===r&&(r=We);var o=t.call(this)||this;return o.path=e,o.value=n,o.currentVariable=r,o}return Be(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}),n.getExpression(t[2]),t[3]||We)},e.encode=function(t){var e=t.path.map(function(t){return t.encode()}),n=t.value.encode();return t.currentVariable===We?[this.id,e,n]:[this.id,e,n,t.currentVariable]},e.create=function(t,n,r){return void 0===r&&(r=We),new e(wn.parse(t),wn.parse(n),r)},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.path.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},this.value.getComplexity(t))},e.prototype.getScope=function(){var t;return(t={})[this.currentVariable]=dt.baseType,t},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.path.map(function(t){return t.clone()}),this.value.clone(),this.currentVariable)},e.prototype.getType=function(t,e){return Z.baseType},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_PATH,function(){return n.path.forEach(function(e,r){return t.step(r,e,function(t){return n.path.splice(r,1,t)},function(){return n.path.splice(r,1)})})}),t.step(e.STEP_VALUE,n.value,function(t){return n.value=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_PATH?o(t[1])&&t[1]<this.path.length?[2,this.path[t[1]]]:null:t[0]===e.STEP_VALUE?[1,this.value]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.path.forEach(function(t){return t.setParent(e)}),this.value.setParent(this)},e.prototype.validate=function(t,e,n){var r;this.validatePath(t,e,e,this.path,n);var o=t.getPathType(this.path,e);if(o){var i=t.getContext(e,((r={})[this.currentVariable]=o,r));this.validateType(t,i,o,this.value,n)}},e.prototype.add=function(t){var e,n,r=s(t)?t:[t];try{for(var o=Ue(r),i=o.next();!i.done;i=o.next()){var a=i.value,u=wn.parse(a);this.path.push(u),u.setParent(this)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},e.prototype.to=function(t,e){return this.value=wn.parse(t),this.value.setParent(this),this.currentVariable=e||this.currentVariable,this},e.prototype.withVariable=function(t){return this.currentVariable=t,this},e.STEP_PATH="path",e.STEP_VALUE="value",e.id="up",e}(V),Je=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ke=1e5,ze="break",Xe=function(t){function e(e,n,r,o){void 0===r&&(r=ze),void 0===o&&(o=Ke);var i=t.call(this)||this;return i.condition=e,i.body=n,i.breakVariable=r,i.maxIterations=o,i}return Je(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),n.getExpression(t[2]),t[3]||ze,parseInt(t[4])||this.MAX_ITERATIONS)},e.encode=function(t){var e=[this.id,t.condition.encode(),t.body.encode()],n=t.maxIterations!==this.MAX_ITERATIONS;return(t.breakVariable!==ze||n)&&e.push(t.breakVariable),n&&e.push(t.maxIterations),e},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return Math.max(this.condition.getComplexity(t),this.body.getComplexity(t))+1},e.prototype.getScope=function(){var t;return(t={})[this.breakVariable]=Z.baseType,t},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.condition.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},e.prototype.getType=function(t,e){var n=t.getContextWithScope(e,this.getScope()).context,r=this.body.getType(t,n);return r?Ti.optional(r):null},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_CONDITION,n.condition,function(t){return n.condition=t}),t.step(e.STEP_BODY,n.body,function(t){return n.body=t})})},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_CONDITION?[1,this.condition]:t[0]===e.STEP_BODY?[1,this.body]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.condition.setParent(this),this.body.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,Z.baseType,this.condition,n);var r=t.getContext(e,this.getScope());this.body.validate(t,r,n)},e.prototype.while=function(t){return this.condition=t,this.condition.setParent(this),this},e.prototype.do=function(t){return this.body=t,this.body.setParent(this),this},e.prototype.withBreak=function(t){return this.breakVariable=t,this},e.prototype.withMax=function(t){return this.maxIterations=t,this},e.STEP_CONDITION="condition",e.STEP_BODY="body",e.MAX_ITERATIONS=Ke,e.id="while",e}(V),$e=new G(U.Tuple+U.Delimiter),Qe=new B(U.Tuple+U.Delimiter),Ze=$e,tn={create:Ze.set("create"),maybe:Ze.set("maybe",{},["value"]),cmp:Ze.set("cmp",{},["value","test"]),copy:Ze.set("copy",{},["value"]),build:Ze.set("build",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),get:Ze.set("get",{},["value","index"]),set:Ze.set("set",{mutates:["value"]},["value","index","element"]),isValid:Ze.set("?",{},["value"]),isEqual:Ze.set("=",{},["value","test"]),isNotEqual:Ze.set("!=",{},["value","test"]),isLess:Ze.set("<",{},["value","test"]),isLessOrEqual:Ze.set("<=",{},["value","test"]),isGreater:Ze.set(">",{},["value","test"]),isGreaterOrEqual:Ze.set(">=",{},["value","test"]),asAny:Ze.set("~"+U.Any,{},["value"]),asBoolean:Ze.set("~"+U.Boolean,{},["value"]),asColor:Ze.set("~"+U.Color,{},["value"]),asDate:Ze.set("~"+U.Date,{},["value"]),asList:Ze.set("~"+U.List,{},["value"]),asMap:Ze.set("~"+U.Map,{},["value"]),asNumber:Ze.set("~"+U.Number,{},["value"]),asObject:Ze.set("~"+U.Object,{},["value"]),asText:Ze.set("~"+U.Text,{},["value"]),asTuple:Ze.set("~"+U.Tuple,{},["value"]),asSet:Ze.set("~"+U.Set,{},["value"])};Qe.set("copy",tn.copy);var en=new G(U.Number+U.Delimiter),nn=new B(U.Number+U.Delimiter),rn=en,on={create:rn.set("create"),pi:rn.set("pi"),pi2:rn.set("2pi"),piHalf:rn.set("hpi"),e:rn.set("e"),sqrt2:rn.set("sqrt2"),sqrt12:rn.set("sqrt1/2"),ln2:rn.set("ln2"),ln10:rn.set("ln10"),log2e:rn.set("log2e"),log10e:rn.set("log10e"),add:rn.set("+",{},["value","addend"]),sub:rn.set("-",{},["value","subtrahend"]),mul:rn.set("*",{},["value","multiplier"]),div:rn.set("/",{},["value","divisor"]),mod:rn.set("%",{},["value","divisor"]),min:rn.set("min",{},["a","b"]),max:rn.set("max",{},["a","b"]),pow:rn.set("^^",{},["value","exponent"]),atan2:rn.set("atan2",{},["x","y"]),hypot:rn.set("hyp",{},["a","b"]),choose:rn.set("choose",{complexity:1},["n","k"]),gcd:rn.set("gcd",{complexity:1},["a","b"]),bitAnd:rn.set("&",{},["a","b"]),bitOr:rn.set("|",{},["a","b"]),bitXor:rn.set("^",{},["a","b"]),cmp:rn.set("cmp",{},["value","test"]),maybe:rn.set("maybe",{},["value"]),sqrt:rn.set("sqrt",{},["value"]),sq:rn.set("^2",{},["value"]),cbrt:rn.set("cbrt",{},["value"]),floor:rn.set("floor",{},["value"]),ceil:rn.set("ceil",{},["value"]),up:rn.set("up",{},["value"]),down:rn.set("down",{},["value"]),round:rn.set("round",{},["value"]),abs:rn.set("abs",{},["value"]),neg:rn.set("neg",{},["value"]),sign:rn.set("sign",{},["value"]),log:rn.set("log",{},["value"]),sin:rn.set("sin",{},["value"]),cos:rn.set("cos",{},["value"]),tan:rn.set("tan",{},["value"]),sinh:rn.set("sinh",{},["value"]),cosh:rn.set("cosh",{},["value"]),asin:rn.set("asin",{},["value"]),acos:rn.set("acos",{},["value"]),atan:rn.set("atan",{},["value"]),factorial:rn.set("!",{},["value"]),bitFlip:rn.set("~",{},["value"]),clamp:rn.set("clamp",{},["value","min","max"]),triangleHeight:rn.set("triangleHeight",{},["base","side1","side2"]),lerp:rn.set("lerp",{},["delta","start","end"]),rnd:rn.set("rnd",{},[],["min","max","whole","includeMax"]),toBaseText:rn.set("toBaseText",{},["value"],["base","minDigits"]),toText:rn.set("toText",{},["value"],["prefix","suffix","minPlaces","maxPlaces","useExponent","thousandSeparator"]),toPercent:rn.set("toPercent",{},["value"],["minPlaces","maxPlaces","thousandSeparator"]),fromPercent:rn.set("fromPercent",{},["value"]),isValid:rn.set("?",{},["value"]),isZero:rn.set("0?",{},["value"],["epsilon"]),isEqual:rn.set("=",{},["value","test"],["epsilon"]),isNotEqual:rn.set("!=",{},["value","test"],["epsilon"]),isLess:rn.set("<",{},["value","test"]),isLessOrEqual:rn.set("<=",{},["value","test"]),isGreater:rn.set(">",{},["value","test"]),isGreaterOrEqual:rn.set(">=",{},["value","test"]),isBetween:rn.set("><",{},["value","min","max"],["minInclusive","maxInclusive"]),isWhole:rn.set("w?",{},["value"],["epsilon"]),isDecimal:rn.set("d?",{},["value"],["epsilon"]),isPositive:rn.set("+?",{},["value"]),isNegative:rn.set("-?",{},["value"]),isDivisible:rn.set("%?",{},["value","by"],["epsilon"]),bitCompare:rn.set("bit",{},["value","method","test"]),asAny:rn.set("~"+U.Any,{},["value"]),asBoolean:rn.set("~"+U.Boolean,{},["value"]),asColor:rn.set("~"+U.Color,{},["value"]),asDate:rn.set("~"+U.Date,{},["value"]),asList:rn.set("~"+U.List,{},["value"]),asMap:rn.set("~"+U.Map,{},["value"]),asNumber:rn.set("~"+U.Number,{},["value"]),asObject:rn.set("~"+U.Object,{},["value"]),asText:rn.set("~"+U.Text,{},["value"]),asTuple:rn.set("~"+U.Tuple,{},["value"]),asSet:rn.set("~"+U.Set,{},["value"])};nn.set("floor",on.floor),nn.set("ceil",on.ceil),nn.set("up",on.up),nn.set("down",on.down),nn.set("round",on.round),nn.set("abs",on.abs),nn.set("negate",on.neg),nn.set("sign",on.sign),nn.set("isZero",on.isZero),nn.set("isWhole",on.isWhole),nn.set("isDecimal",on.isDecimal),nn.set("isPositive",on.isPositive),nn.set("isNegative",on.isNegative),nn.set("toText",on.toText);var sn=new G(U.List+U.Delimiter),an=new B(U.List+U.Delimiter),un=sn,pn={create:un.set("create"),createLike:un.set("createLike",{},["list"],[],[],[],["list"]),createFor:un.set("createFor",{},["item"],[],[],[],["item"]),maybe:un.set("maybe",{},["value"]),build:un.set("new",{},["count","item"],["sameItem"],["list","index","last","count"],["item"],["item"]),get:un.set("get",{},["list","index"],[],[],[],["list"]),set:un.set("set",{},["list","index","value"],[],[],[],["list"]),add:un.set("+",{mutates:["list"]},["list","item"],[],[],[],["list"]),addFirst:un.set("+f",{mutates:["list"]},["list","item"],[],[],[],["list"]),addLast:un.set("+l",{mutates:["list"]},["list","item"],[],[],[],["list"]),insert:un.set("+@",{mutates:["list"]},["list","item","index"],[],[],[],["list"]),remove:un.set("-",{mutates:["list"],complexity:1},["list","item","isEqual"],[],["list","value","test"],["isEqual"],["list"]),removeFirst:un.set("-f",{mutates:["list"]},["list"],[],[],[],["list"]),removeLast:un.set("-l",{mutates:["list"]},["list"],[],[],[],["list"]),removeAt:un.set("-@",{mutates:["list"]},["list","index"],[],[],[],["list"]),removeWhere:un.set("-?",{mutates:["list"]},["list","where"],[],["list","item","index"],["where"],["list"]),clear:un.set("clear",{mutates:["list"]},["list"],[],[],[],["list"]),contains:un.set("contains",{complexity:1},["list","item","isEqual"],[],["list","value","test"],["isEqual"]),find:un.set("find",{complexity:1},["list","where"],["start","reverse"],["list","item","index"],["where"],["list"]),copy:un.set("copy",{complexity:1},["list"],["deepCopy"],["copy"],["deepCopy"],["list"]),reverse:un.set("reverse",{complexity:.5},["list"],[],[],[],["list"]),exclude:un.set("exclude",{mutates:["list"],complexity:2},["list","exclude","isEqual"],[],["list","value","test"],["isEqual"],["list"]),overlap:un.set("overlap",{complexity:2},["list","overlap","isEqual"],[],["list","value","test"],["isEqual"],["list"]),sort:un.set("sort",{mutates:["list"],complexity:1},["list","compare"],[],["list","value","test"],["compare"],["list"]),shuffle:un.set("shuffle",{mutates:["list"],complexity:1},["list"],["times"],[],[],["list"]),unique:un.set("unique",{complexity:2},["list","isEqual"],[],["list","value","test"],["isEqual"],["list"]),duplicates:un.set("dupes",{complexity:2},["list","isEqual"],["once"],["list","value","test"],["isEqual"],["list"]),take:un.set("take",{},["list","count"],[],[],[],["list"]),skip:un.set("skip",{},["list","count"],[],[],[],["list"]),drop:un.set("drop",{},["list","count"],[],[],[],["list"]),append:un.set("append",{},["list","append"],[],[],[],["list"]),prepend:un.set("prepend",{},["list","prepend"],[],[],[],["list"]),indexOf:un.set("indexOf",{complexity:1},["list","item","isEqual"],["start"],["list","value","test"],["isEqual"],["list"]),lastIndexOf:un.set("lastIndexOf",{complexity:1},["list","item","isEqual"],["start"],["list","value","test"],["isEqual"],["list"]),findIndex:un.set("findIndex",{complexity:1},["list","where"],["reverse","start"],["list","item","index"],["where"]),last:un.set("last",{},["list"],[],[],[],["list"]),first:un.set("first",{},["list"],[],[],[],["list"]),count:un.set("count",{},["list"]),randomList:un.set("randomList",{},["list","count"],[],[],[],["list"]),random:un.set("random",{},["list"],[],[],[],["list"]),join:un.set("join",{complexity:1},["list"],["delimiter","toText","prefix","suffix"],["list","item","index"],["toText"]),each:un.set("each",{complexity:1},["list","each"],["reverse"],["list","item","index"],["each"],["list"]),filter:un.set("filter",{complexity:1},["list","filter"],[],["list","item","index"],["filter"],["list"]),not:un.set("not",{complexity:1},["list","not"],[],["list","item","index"],["not"],["list"]),map:un.set("map",{complexity:1},["list","transform"],[],["list","item","index"],["transform"],["list"]),split:un.set("split",{complexity:1},["list","pass"],[],["list","item","index"],["pass"],["list"]),reduce:un.set("reduce",{complexity:1},["list","reduce","initial"],[],["list","item","index","reduced"],["reduce"],["reduce"]),cmp:un.set("cmp",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),group:un.set("group",{complexity:1},["list","by"],["getValue"],["list","item","index"],["by","getValue"],["list","by","getValue"]),toListMap:un.set("toListMap",{complexity:1},["list","getKey"],["getValue"],["list","item","index"],["getKey","getValue"],["list","getKey","getValue"]),toMap:un.set("toMap",{complexity:1},["list","getKey"],["getValue"],["list","item","index"],["getKey","getValue"],["list","getKey","getValue"]),joinInner:un.set("joinInner",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinLeft:un.set("joinLeft",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinRight:un.set("joinRight",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinFull:un.set("joinFull",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinCross:un.set("joinCross",{complexity:2},["a","b","join"],[],["joinA","joinB"],["join"],["join"]),min:un.set("min",{complexity:1},["list","value"],[],["list","item","index"],["value"]),max:un.set("max",{complexity:1},["list","value"],[],["list","item","index"],["value"]),sum:un.set("sum",{complexity:1},["list","value"],[],["list","item","index"],["value"]),avg:un.set("avg",{complexity:1},["list","value"],[],["list","item","index"],["value"]),std:un.set("std",{complexity:1},["list","value"],[],["list","item","index"],["value"]),variance:un.set("variance",{complexity:1},["list","value"],[],["list","item","index"],["value"]),median:un.set("median",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitand:un.set("band",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitor:un.set("bor",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitxor:un.set("bxor",{complexity:1},["list","value"],[],["list","item","index"],["value"]),isValid:un.set("?",{},["value"]),isEmpty:un.set("0?",{},["list"]),isNotEmpty:un.set("!0",{},["list"]),isEqual:un.set("=",{complexity:1},["list","test","isEqual"],[],["list","value","test"],["isEqual"]),isNotEqual:un.set("!=",{complexity:1},["list","test","isEqual"],[],["list","value","test"],["isEqual"]),isLess:un.set("<",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isLessOrEqual:un.set("<=",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isGreater:un.set(">",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isGreaterOrEqual:un.set(">=",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),asAny:un.set("~"+U.Any,{},["value"]),asBoolean:un.set("~"+U.Boolean,{},["value"]),asColor:un.set("~"+U.Color,{},["value"]),asDate:un.set("~"+U.Date,{},["value"]),asList:un.set("~"+U.List,{},["value"]),asMap:un.set("~"+U.Map,{},["value"]),asNumber:un.set("~"+U.Number,{},["value"]),asObject:un.set("~"+U.Object,{},["value"]),asText:un.set("~"+U.Text,{},["value"]),asTuple:un.set("~"+U.Tuple,{},["value"]),asSet:un.set("~"+U.Set,{},["value"])};an.set("copy",pn.copy),an.set("reversed",pn.reverse),an.set("shuffled",pn.shuffle),an.set("first",pn.first),an.set("last",pn.last),an.set("random",pn.random),an.set("isEmpty",pn.isEmpty),an.set("isNotEmpty",pn.isNotEmpty);var cn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ln=function(){return(ln=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},fn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},yn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},dn=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(yn(arguments[e]));return t},hn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cn(e,t),e.decode=function(t,n){var r=n.getType(t[1]),o=t[2]||{};return new e(ln({item:r},o))},e.encode=function(t){var e=ln({},t.options),n=e.item;return delete e.item,v(e)?[this.id,n.encode()]:[this.id,n.encode(),e]},e.describe=function(t,n){if(!s(t))return null;for(var r=n.describe(t[0]),o=1;o<t.length;o++)r=n.merge(r,t[o]);return new e({item:r,min:t.length,max:t.length})},e.register=function(){$.addJson({priority:8,toJson:function(t,e){if(s(t))return t.map(e)},fromJson:function(t,e){if(s(t))return t.map(e)}}),$.addCompare({priority:8,type:"object",compare:function(t,e,n){var r=s(t),o=s(e);if(r!==o)return(r?1:0)-(o?1:0);if(r){var i=t.length-e.length;if(0===i){for(var a=0,u=0,p=0;p<t.length;p++){var c=n(t[p],e[p]);c<0&&a++,c>0&&u++}i=$.getCompare(a,u)}return i}}}),$.addEquals({priority:8,type:"object",equals:function(t,e,n){var r=s(t);if(r!==s(e))return!1;if(r){if(t.length!==e.length)return!1;for(var o=0;o<t.length;o++)if(!n(t[o],e[o]))return!1;return!0}}}),$.addCopier({priority:8,copy:function(t,e,n){var r,o;if(s(t)){var i=[];n(t,i);try{for(var a=fn(t),u=a.next();!u.done;u=a.next()){var p=u.value;i.push(e(p))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}}})},e.forItem=function(t){return new e({item:Ti.parse(t)})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.item=Ti.merge(e.item,n.item),e.min=Math.min(e.min,n.min),e.max=Math.max(e.max,n.max)},e.prototype.getSubType=function(t,e,n){var r=this;if(Ht.is(t)){if("length"===t.value)return Ti.LENGTH;if(o(t.value))return o(this.options.min)&&t.value<this.options.min?this.options.item:Ti.optional(this.options.item)}var i=t.getType(e,n);if(i){if((i=i.getRequired())instanceof Pn)return Ti.optional(this.options.item);if(i instanceof Ut){var s=Array.from(i.options.constants.values());if(i.options.value instanceof Pn)return o(this.options.min)&&!s.some(function(t){return t>=r.options.min})?this.options.item:Ti.optional(this.options.item);if(i.options.value instanceof Lt&&1===s.length&&"length"===s[0])return Ti.LENGTH}}return null},e.prototype.getSubTypes=function(t){for(var e=this.options,n=e.min,r=e.item,i=o(n)&&n>0&&n<=10?n:0,s=[],a=0;a<i;a++)s.push({key:a,value:r});return dn(s,[{key:"length",value:Ti.LENGTH},{key:Ti.INDEX,value:Ti.optional(r)}])},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){var r=this.options,o=r.item,i=r.min,s=r.max;if(!n.strict&&!n.exact&&t instanceof Tn&&!t.options.some(function(t){return!o.isCompatible(t,n)}))return!0;if(!(t instanceof e))return!1;if(!o.isCompatible(t.options.item,n))return!1;if(n.value){var a=t.options.min;if(i&&(!a||a<i))return!1;var u=t.options.max;if(s&&(!u||u<s))return!1}return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){return t.step(e.STEP_ITEM,n.options.item,function(t){return n.options.item=t})})},e.prototype.getTypeFromStep=function(t){return t===e.STEP_ITEM?this.options.item:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.item.setParent(this)},e.prototype.removeDescribedRestrictions=function(){var t=this.options.item;t.removeDescribedRestrictions(),this.options={item:t}},e.prototype.getCreateExpression=function(){return wn.op(pn.create,{})},e.prototype.getValidateExpression=function(){return wn.and(wn.op(pn.isValid,{value:wn.get("value")}),wn.not(wn.op(pn.contains,{list:wn.get("value"),item:wn.null(),isEqual:wn.not(this.options.item.getValidateExpression())},{value:"ignore",test:"value"})))},e.prototype.getCompareExpression=function(){return wn.op(pn.cmp,{value:wn.get("value"),test:wn.get("test"),compare:this.options.item.getCompareExpression()})},e.prototype.getValueChangeExpression=function(t,e,n){return wn.op(pn.map,{list:wn.get("value"),transform:t},{item:"value"})},e.prototype.isValid=function(t){var e,n;if(!Array.isArray(t))return!1;var r=this.options,i=r.item,s=r.min,a=r.max;if(o(s)&&t.length<s)return!1;if(o(a)&&t.length>a)return!1;try{for(var u=fn(t),p=u.next();!p.done;p=u.next()){var c=p.value;if(!i.isValid(c))return!1}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return!0},e.prototype.normalize=function(t){if(s(t))for(var e=this.options.item,n=0;n<t.length;n++)t[n]=e.normalize(t[n]);return t},e.prototype.newInstance=function(){return new e({item:this.options.item.newInstance()})},e.prototype.clone=function(){var t=this.options,n=t.item,r=t.min,o=t.max;return new e({item:n.clone(),min:r,max:o})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return[]},e.prototype.random=function(t){for(var e=this.options,n=e.min,r=e.max,o=M(n,2),i=M(r,5),s=t(Math.min(o,i),Math.max(o,i)+1,!0),a=[],u=0;u<s;u++)a.push(this.options.item.random(t));return a},e.prototype.fromJson=function(t){var e=this;return t?t.map(function(t){return e.options.item.fromJson(t)}):null},e.prototype.toJson=function(t){var e=this;return t?t.map(function(t){return e.options.item.toJson(t)}):null},e.STEP_ITEM="item",e.id=U.List,e.operations=sn,e.computeds=an,e.baseType=new e({item:dt.baseType}),e.describePriority=6,e.registered=!1,e}(R),vn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},gn=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(mn(arguments[e]));return t},Tn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vn(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getType(t)}))},e.encode=function(t){var e=t.options.map(function(t){return t.encode()});return[this.id,e]},e.describe=function(t,e){return null},e.register=function(){},e.forItem=function(t){return new e(t.map(function(t){return Ti.parse(t)}))},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){var r=this;if(Ht.is(t)){if("length"===t.value)return Ti.LENGTH;if(o(t.value))return this.options[t.value]}var i=t.getType(e,n);if(i){if((i=i.getRequired())instanceof Pn)return Ti.mergeMany(this.options,ct.baseType);if(i instanceof Ut){if(i.options.value instanceof Pn){var s=(a=Array.from(i.options.constants.values())).map(function(t){return r.options[t]}).filter(function(t){return!!t});return Ti.mergeMany(s,ct.baseType)}var a;if(i.options.value instanceof Lt)if(1===(a=Array.from(i.options.constants.values())).length&&"length"===a[0])return Ti.LENGTH}}},e.prototype.getSubTypes=function(t){return gn(this.options.map(function(t,e){return{key:e,value:t}}),[{key:"length",value:Ti.LENGTH},{key:new Ut({key:Pn.baseType,value:Pn.baseType,constants:new Map(this.options.map(function(t,e){return[e,e]}))}),value:Ti.mergeMany(this.options,ct.baseType)},{key:Ti.INDEX,value:Ti.optional(Ti.mergeMany(this.options,ct.baseType))}])},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.getCreateExpression=function(){return wn.tuple.apply(wn,gn(this.options.map(function(t){return t.getCreateExpression()})))},e.prototype.getValidateExpression=function(){return wn.op(tn.isValid,{value:wn.get("value")}).and(this.options.map(function(t,e){return wn.define({value:wn.get("value",e)}).run(t.getValidateExpression())}))},e.prototype.getCompareExpression=function(){return wn.or.apply(wn,gn([wn.op(on.cmp,{value:wn.get("value","length"),test:wn.get("test","length")})],this.options.map(function(t,e){return wn.define({value:wn.get("value",e),test:wn.get("test",e)}).run(t.getCompareExpression())})))},e.prototype.getValueChangeExpression=function(t,e,n){var r=o(e),i=o(n);return!r&&i?wn.define({parent:wn.get("value")},wn.op(pn.insert,{list:wn.get("value"),index:n,item:t})):r&&!i?wn.body(wn.op(pn.removeAt,{list:wn.get("value"),index:e}),wn.get("value")):e===n&&r?wn.body(wn.update("value",e).to(t,"value"),wn.get("value")):t},e.prototype.isDeepCompatible=function(t,n){if(!n.exact&&!n.strict&&t instanceof hn&&!this.options.some(function(e){return!e.isCompatible(t.options.item,n)})&&o(t.options.min)&&t.options.min>=this.options.length)return!0;if(!(t instanceof e))return!1;var r=this.options,i=t.options;if(i.length<r.length||n.exact&&r.length!==i.length)return!1;for(var s=0;s<r.length;s++)if(!r[s].isCompatible(i[s],n))return!1;return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return e.options.map(function(n,r){return t.step(r,n,function(t){return e.options.splice(r,1,t)},function(){return e.options.splice(r,1)})})})},e.prototype.getTypeFromStep=function(t){return this.options[t]||null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.options.forEach(function(t){return t.setParent(e)})},e.prototype.removeDescribedRestrictions=function(){this.options.forEach(function(t){return t.removeDescribedRestrictions()})},e.prototype.isValid=function(t){if(!s(t))return!1;for(var e=this.options,n=0;n<e.length;n++)if(!e[n].isValid(t[n]))return!1;return!0},e.prototype.normalize=function(t){if(!s(t))return t;for(var e=this.options,n=0;n<e.length;n++)t[n]=e[n].normalize(t[n]);return t},e.prototype.newInstance=function(){return new e([])},e.prototype.clone=function(){return new e(this.options.map(function(t){return t.clone()}))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.options.map(function(t){return t.create()})},e.prototype.random=function(t){return this.options.map(function(e){return e.random(t)})},e.prototype.fromJson=function(t){return this.options.map(function(e,n){return e.fromJson(t[n])})},e.prototype.toJson=function(t){return this.options.map(function(e,n){return e.toJson(t[n])})},e.id=U.Tuple,e.operations=$e,e.computeds=Qe,e.baseType=new e([]),e.describePriority=-1,e.registered=!1,e}(R),bn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xn=function(t){function e(e){var n=t.call(this)||this;return n.expressions=e,n}return bn(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getExpression(t)}))},e.encode=function(t){var e=t.expressions.map(function(t){return t.encode()});return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return this.expressions.reduce(function(e,n){return Math.max(e,n.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expressions.map(function(t){return t.clone()}))},e.prototype.getType=function(t,e){return new Tn(this.expressions.map(function(n){return Ti.simplify(n.getType(t,e))}))},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return e.expressions.forEach(function(n,r){return t.step(r,n,function(t){return e.expressions.splice(r,1,t)},function(){return e.expressions.splice(r,1)})})})},e.prototype.getExpressionFromStep=function(t){return o(t[0])&&t[0]<this.expressions.length?[1,this.expressions[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.expressions.forEach(function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){this.expressions.forEach(function(r){r.validate(t,e,n)})},e.id="tuple",e}(V),On=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),En=function(t){function e(e){var n=t.call(this)||this;return n.props=e,n}return On(e,t),e.decode=function(t,n){return new e(O(t[1],function(t){return n.getExpression(t)}))},e.encode=function(t){var e=O(t.props,function(t){return t.encode()});return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return S(this.props,function(e,n,r){return Math.max(r,e.getComplexity(t))},0)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(O(this.props,function(t){return t.clone()}))},e.prototype.getType=function(t,e){return new ye({props:O(this.props,function(n){return Ti.simplify(n.getType(t,e))})})},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return E(e.props,function(n,r){return t.step(r,n,function(t){return e.props[r]=t},function(){return delete e.props[r]})})})},e.prototype.getExpressionFromStep=function(t){return t[0]in this.props?[1,this.props[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.props,function(t){return t.setParent(e)})},e.prototype.validate=function(t,e,n){E(this.props,function(r){return r.validate(t,e,n)})},e.id="obj",e}(V),wn=function(){function t(){}return t.setParent=function(t,e){return void 0===e&&(e=!1),(this.autoSetParent||e)&&t.setParent(),t},t.parse=function(t){var e=this;return s(t)?t.map(function(t){return e.parse(t)}):t instanceof V?t:f(t)?O(t,function(t){return e.parse(t)}):new Ht(t)},t.cast=function(t,e,n){void 0===n&&(n=!0);var r=t.getId()+":~"+e.getId(),o=t.getOperations()[r];return o?this.op(o,{value:this.get("value")}):n?this.setParent(e.getCreateExpression()):null},t.and=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new rt(t))},t.body=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new wt(t))},t.const=function(t){return new Ht(t)},t.define=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=ft.instance),this.setParent(new mt([],e).with(t))},t.do=function(t,e,n,r){return void 0===e&&(e=ft.instance),this.setParent(new xt(e,t,n,r))},t.for=function(t,e,n,r,o,i){return void 0===e&&(e=new Ht(0)),void 0===n&&(n=new Ht(0)),void 0===r&&(r=ft.instance),this.setParent(new Xt(t,this.parse(e),this.parse(n),r,o,i))},t.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new Zt(this.parse(t)))},t.sub=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this.setParent(new Re(this.parse(t),this.parse(e)))},t.computed=function(t,e){return this.setParent(new Mt(this.parse(e),t))},t.if=function(t,e,n){return void 0===e&&(e=ft.instance),void 0===n&&(n=ft.instance),this.setParent(new Oe([[t,e]],n))},t.invoke=function(t,e){return void 0===e&&(e={}),this.setParent(new we(t,this.parse(e)))},t.noop=function(){return ft.instance},t.not=function(t){return this.setParent(new et(t))},t.object=function(t){return this.setParent(new En(this.parse(t)))},t.op=function(t,e,n){return void 0===n&&(n=Object.create(null)),this.setParent(new Ie(t.id,this.parse(e),n))},t.or=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new Pe(t))},t.return=function(t){return void 0===t&&(t=ft.instance),this.setParent(new De(this.parse(t)))},t.set=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new Ae(this.parse(t),ft.instance))},t.switch=function(t,e){return this.setParent(new Fe(t,e.id,[],ft.instance))},t.template=function(t,e){return void 0===e&&(e={}),this.setParent(new Ge(t,this.parse(e)))},t.tuple=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new xn(this.parse(t)))},t.update=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new He(this.parse(t),ft.instance))},t.while=function(t,e,n,r){return void 0===e&&(e=ft.instance),this.setParent(new Xe(t,e,n,r))},t.undefined=function(){return this.const(void 0)},t.null=function(){return this.const(null)},t.true=function(){return this.const(!0)},t.false=function(){return this.const(!1)},t.zero=function(){return this.const(0)},t.one=function(){return this.const(1)},t.compareEqual=function(){return this.const(1)},t.compareLess=function(){return this.const(-1)},t.compareGreater=function(){return this.const(1)},t.string=function(){return this.const("")},t.comment=function(t){return new Pt(t)},t.entity=function(t){return new me(t)},t.relation=function(t){return new Te(t)},t.data=function(t){return new ee(t)},t.autoSetParent=!0,t}(),Sn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Sn(e,t),e.decode=function(t){return new e(t[1]||{})},e.encode=function(t){return v(t.options)?this.id:[this.id,t.options]},e.describe=function(t,n){return o(t)?new e({min:t,max:t,whole:Math.abs(Math.floor(t)-t)<=e.WHOLE_EPSILON}):null},e.register=function(){var t=this;$.addCompare({priority:0,type:"number",compare:function(e,n){return e<n?n-e<t.COMPARES_EPSILON?0:-1:e-n<t.COMPARES_EPSILON?0:1}}),$.addEquals({priority:0,type:"number",equals:function(e,n){return Math.abs(e-n)<t.EQUALS_EPSILON}}),$.addCompare({priority:0,type:"bigint",compare:function(t,e){return t-e}}),$.addEquals({priority:0,type:"bigint",equals:function(t,e){return t===e}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.max=Math.max(e.max,n.max),e.min=Math.min(e.min,n.min),e.whole=e.whole&&n.whole},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){if(!(t instanceof e))return!1;if(n.value){var r=this.options.min,i=t.options.min;if(o(r)&&(!o(i)||i<r))return!1;var s=this.options.max,a=t.options.max;if(o(s)&&(!o(a)||a<s))return!1}return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){this.options={}},e.prototype.getCreateExpression=function(){return wn.op(on.create,{})},e.prototype.getValidateExpression=function(){return wn.op(on.isValid,{value:wn.get("value")})},e.prototype.getCompareExpression=function(){return wn.op(on.cmp,{value:wn.get("value"),test:wn.get("test")})},e.prototype.isValid=function(t){if(!o(t))return!1;var e=this.options,n=e.min,r=e.max,i=e.whole;return!(o(n)&&t<n)&&(!(o(r)&&t>r)&&!(i&&!h(t)))},e.prototype.normalize=function(t){return t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e($.copy(this.options))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return 0},e.prototype.random=function(t){var e=this.options,n=e.min,r=e.max,o=e.whole;return t(M(n,0),M(r,10),o)},e.prototype.fromJson=function(t){return t},e.prototype.toJson=function(t){return t},e.WHOLE_EPSILON=1e-6,e.id=U.Number,e.operations=en,e.computeds=nn,e.baseType=new e({}),e.describePriority=4,e.registered=!1,e.EQUALS_EPSILON=1e-6,e.COMPARES_EPSILON=1e-6,e}(R),_n=["th","st","nd","rd","th","th","th","th","th","th"],Mn={weekStartsOn:0,firstWeekContainsDate:4,am:"am",pm:"pm",formatLT:"h:mm A",formatLTS:"h:mm:ss A",formatL:"MM/DD/Y",formatl:"M/D/Y",formatLL:"MMMM D, Y",formatll:"MMM D, Y",formatLLL:"MMMM D, Y h:mm A",formatlll:"MMM D, Y h:mm A",formatLLLL:"dddd, MMMM D, Y h:mm A",formatllll:"ddd, MMM D, Y h:mm A",suffix:function(t){return t+(t>=11&&t<=13?"th":_n[t%_n.length])},list:function(t){for(var e=t.length-1,n=t[0],r=1;r<e;r++)n+=", "+t[r];return e>0&&(n+=" and "+t[e]),n},months:[["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["Ja","F","Mr","Ap","My","Je","Jl","Ag","S","O","N","D"]],weekdays:[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Su","M","Tu","W","Th","F","Sa"]]},In=1e3,Cn=7,Dn=60*In,jn=60*Dn,kn=24*jn,An=3,Nn=12,Ln=1,Rn=31,qn=23,Vn=59,Fn=59,Yn=999,Gn=6,Bn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Un=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Wn=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Un(arguments[e]));return t},Hn={none:function(t){return t},floor:function(t){return Math.floor(t)},ceil:function(t){return Math.ceil(t)},round:function(t){return Math.round(t)},truncate:function(t){return t<0?Math.ceil(t):Math.floor(t)},down:function(t){return t<0?Math.ceil(t):Math.floor(t)},up:function(t){return t<0?Math.floor(t):Math.ceil(t)}},Jn={timestamp:function(t){return t.valueOf()},timestampSeconds:function(t){return Math.floor(t.valueOf()/In)},millis:function(t){return t.getMilliseconds()},second:function(t){return t.getSeconds()},minute:function(t){return t.getMinutes()},hour:function(t){return t.getHours()},day:function(t){return t.getDay()},dayOfMonth:function(t){return t.getDate()},lastDayOfMonth:ur,dayOfYear:Pr,dayOfWeek:Sr,week:lr,weekOfMonth:br,weekspanOfMonth:vr,fullWeekOfMonth:gr,lastWeekspanOfMonth:mr,lastFullWeekOfMonth:Tr,weekOfYear:cr,weekspanOfYear:fr,fullWeekOfYear:yr,lastWeekspanOfYear:pr,lastFullWeekOfYear:hr,month:function(t){return t.getMonth()},quarter:Nr,year:function(t){return t.getFullYear()},timeIdentifier:rr,dayIdentifier:or,weekIdentifier:ir,monthIdentifier:sr,quarterIdentifier:ar},Kn={timestamp:function(t,e){return Zn(t,function(t){return t.setTime(e)})},timestampSeconds:function(t,e){return Zn(t,function(t){return t.setTime(1e3*e)})},millis:function(t,e){return Zn(t,function(t){return t.setMilliseconds(e)})},second:function(t,e){return Zn(t,function(t){return t.setSeconds(e)})},minute:function(t,e){return Zn(t,function(t){return t.setMinutes(e)})},hour:function(t,e){return Zn(t,function(t){return t.setHours(e)})},day:function(t,e){return Zn(t,function(t){return $n.day(t,e-t.getDay())})},dayOfMonth:function(t,e){return Zn(t,function(t){return t.setDate(e)})},lastDayOfMonth:function(t,e){return Zn(t,function(t){return $n.day(t,e-ur(t))})},dayOfYear:function(t,e){return Zn(t,function(t){return $n.day(t,e-Pr(t))})},dayOfWeek:function(t,e){return Zn(t,function(t){return $n.day(t,e-Sr(t))})},week:function(t,e){return Zn(t,function(t){return $n.week(t,e-lr(t))})},weekOfMonth:function(t,e){return Zn(t,function(t){return $n.week(t,e-br(t))})},weekspanOfMonth:function(t,e){return Zn(t,function(t){return $n.week(t,e-vr(t))})},fullWeekOfMonth:function(t,e){return Zn(t,function(t){return $n.week(t,e-gr(t))})},lastWeekspanOfMonth:function(t,e){return Zn(t,function(t){return $n.week(t,e-mr(t))})},lastFullWeekOfMonth:function(t,e){return Zn(t,function(t){return $n.week(t,e-Tr(t))})},weekOfYear:function(t,e){return Zn(t,function(t){return $n.week(t,e-cr(t))})},weekspanOfYear:function(t,e){return Zn(t,function(t){return $n.week(t,e-fr(t))})},fullWeekOfYear:function(t,e){return Zn(t,function(t){return $n.week(t,e-yr(t))})},lastWeekspanOfYear:function(t,e){return Zn(t,function(t){return $n.week(t,e-pr(t))})},lastFullWeekOfYear:function(t,e){return Zn(t,function(t){return $n.week(t,e-hr(t))})},month:function(t,e){return Zn(t,function(t){return t.setMonth(e)})},quarter:function(t,e){return Zn(t,function(t){return $n.quarter(t,e-Nr(t))})},year:function(t,e){return Zn(t,function(t){return t.setFullYear(e)})}},zn={millis:function(t){return t},second:Lr,minute:Rr,hour:qr,day:Vr,week:Fr,month:Yr,quarter:Gr,year:Br},Xn={millis:function(t){return t},second:Ur,minute:Wr,hour:Hr,day:Jr,week:Kr,month:zr,quarter:Xr,year:$r},$n={millis:Qr,second:Zr,minute:to,hour:eo,day:no,week:ro,month:oo,quarter:io,year:so},Qn={millis:ao,second:uo,minute:po,hour:co,day:lo,week:fo,month:yo,quarter:ho,year:vo};function Zn(t,e,n){var r=new Date(t.getTime());return e(r,n),r}function tr(t,e,n,r){void 0===n&&(n="millis"),void 0===r&&(r=Mn);var o=zn[n],i=Zn(t,o,r),s=Zn(e,o,r);return i.getTime()-s.getTime()}var er=[{pattern:/^(\d{4})[-\/](\d{1,22})[-\/](\d{1,2})(|[T ](\d{1,2})((|:(\d{1,2})(|:(\d{1,2})(|\.(\d+)Z?)))))$/,groups:[1,2,3,5,8,10,12]},{pattern:/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{4})(|[T ](\d{1,2})((|:(\d{1,2})(|:(\d{1,2})(|\.(\d+)Z?)))))$/,groups:[3,1,2,5,8,10,12]}];function nr(t,e){var n,r;if(void 0===e&&(e=!1),a(t))return t;if(o(t)&&t>0)return new Date(t);if(i(t)){try{for(var s=Bn(er),u=s.next();!u.done;u=s.next()){var p=u.value,c=p.pattern,l=p.groups,f=c.exec(t);if(f){for(var y=[0,0,1,0,0,0,0],d=0;d<y.length;d++){var h=parseInt(f[l[d]]);isFinite(h)&&(y[d]=1===d?h-1:h)}return e?new Date(Date.UTC.apply(Date,Wn(y))):new(Date.bind.apply(Date,Wn([void 0],y)))}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}if(e){var v=t+" UTC",m=Date.parse(v);if(isFinite(m))return new Date(m)}var g=Date.parse(t);if(isFinite(g))return new Date(g)}return null}function rr(t){return 1e8*t.getFullYear()+1e6*(t.getMonth()+1)+1e4*t.getDate()+100*t.getHours()+t.getMinutes()}function or(t){return 1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate()}function ir(t){return 1e3*t.getFullYear()+lr(t)}function sr(t){return 100*t.getFullYear()+(t.getMonth()+1)}function ar(t){return 10*t.getFullYear()+Nr(t)}function ur(t){return jr(t)-t.getDate()+1}function pr(t){var e=Cr(t)-Pr(t);return Math.floor(e/Cn)}function cr(t,e){return void 0===e&&(e=Mn),Or(Zn(t,Br),Pr(t),e)}function lr(t,e){return void 0===e&&(e=Mn),Er(Zn(t,Br),Pr(t),e)}function fr(t){return Math.floor((Pr(t)-1)/Cn)}function yr(t,e){return void 0===e&&(e=Mn),wr(Zn(t,Br),Cr(t),e)}function dr(t,e){return void 0===e&&(e=Mn),cr(Zn(t,$r),e)+1}function hr(t,e){void 0===e&&(e=Mn);var n=Zn(t,$r),r=cr(t,e),o=cr(n,e)-r;return Sr(n,e)===Gn?o+1:o}function vr(t){return Math.floor((t.getDate()-1)/Cn)}function mr(t){var e=jr(t)-t.getDate();return Math.floor(e/Cn)}function gr(t,e){return void 0===e&&(e=Mn),wr(Zn(t,Yr),t.getDate(),e)}function Tr(t,e){void 0===e&&(e=Mn);var n=jr(t)-t.getDate(),r=Gn-Sr(t,e);return Math.floor((n-r+Cn)/Cn)}function br(t,e){return void 0===e&&(e=Mn),Or(Zn(t,Yr),t.getDate(),e)}function xr(t,e){return void 0===e&&(e=Mn),Er(Zn(t,Yr),t.getDate(),e)}function Or(t,e,n){void 0===n&&(n=Mn);var r=n.firstWeekContainsDate,o=Sr(t,n),i=Cn-o<r?o-1:o-1+Cn;return Math.floor((e+i)/Cn)}function Er(t,e,n){var r=Sr(t,n)-1+Cn;return Math.floor((e+r)/Cn)}function wr(t,e,n){void 0===n&&(n=Mn);var r=Sr(t,n),o=0!==r?r-1:r-1+Cn;return Math.floor((e+o)/Cn)}function Sr(t,e){void 0===e&&(e=Mn);var n=e.weekStartsOn,r=t.getDay();return r<n?r-n+Cn:r-n}function Pr(t){return Math.round(lo(t,Zn(t,Br)))+1}function _r(t){return 15*-Math.round(t.getTimezoneOffset()/15)}function Mr(t){var e=_r(t);return e>_r(Zn(t,function(t){return t.setMonth(0)}))||e>_r(Zn(t,function(t){return t.setMonth(5)}))}function Ir(t){var e=t.getFullYear();return e%400==0||e%4==0&&e%100!=0}function Cr(t){return Ir(t)?366:365}var Dr=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]];function jr(t){return Dr[Ir(t)?1:0][t.getMonth()]}function kr(t){return t.getTime()-Ar(t)}function Ar(t){var e=new Date(t.getTime()),n=e.getTimezoneOffset();e.setSeconds(0,0);var r=e.getTime()%Dn;return n*Dn+r}function Nr(t){return Math.floor(t.getMonth()/An)}function Lr(t){t.setMilliseconds(0)}function Rr(t){t.setSeconds(0,0)}function qr(t){t.setMinutes(0,0,0)}function Vr(t){t.setHours(0,0,0,0)}function Fr(t,e){void 0===e&&(e=Mn);var n=Sr(t,e);t.setDate(t.getDate()-n),t.setHours(0,0,0,0)}function Yr(t){t.setDate(Ln),t.setHours(0,0,0,0)}function Gr(t){var e=t.getMonth();t.setMonth(e-e%An,Ln),t.setHours(0,0,0,0)}function Br(t){var e=t.getFullYear();t.setTime(0),t.setFullYear(e,0,1),t.setHours(0,0,0,0)}function Ur(t){t.setMilliseconds(Yn)}function Wr(t){t.setSeconds(Fn,Yn)}function Hr(t){t.setMinutes(Vn,Fn,Yn)}function Jr(t){t.setHours(qn,Vn,Fn,Yn)}function Kr(t,e){void 0===e&&(e=Mn);var n=Sr(t,e);t.setDate(t.getDate()+(Gn-n)),Jr(t)}function zr(t){t.setFullYear(t.getFullYear(),t.getMonth()+1,0),Jr(t)}function Xr(t){var e=t.getMonth();t.setMonth(e-e%An+An,Ln),Jr(t)}function $r(t){t.setFullYear(t.getFullYear()+1,0,0),Jr(t)}function Qr(t,e){t.setTime(t.getTime()+e)}function Zr(t,e){Qr(t,e*In)}function to(t,e){Qr(t,e*Dn)}function eo(t,e){Qr(t,e*jn)}function no(t,e){t.setDate(t.getDate()+e)}function ro(t,e){no(t,e*Cn)}function oo(t,e){var n=t.getMonth()+e,r=new Date(0);r.setFullYear(r.getFullYear(),n,1),r.setHours(0,0,0,0);var o=jr(r);t.setMonth(n,Math.min(o,t.getDate()))}function io(t,e){oo(t,e*An)}function so(t,e){oo(t,e*Nn)}function ao(t,e){return t.getTime()-e.getTime()}function uo(t,e){return ao(t,e)/In}function po(t,e){return ao(t,e)/Dn}function co(t,e){return ao(t,e)/jn}function lo(t,e){return(kr(t)-kr(e))/kn}function fo(t,e){return lo(t,e)/Cn}function yo(t,e){var n=t.getFullYear()-e.getFullYear(),r=t.getMonth()-e.getMonth(),o=(t.getDate()-e.getDate())/Rn;return n*Nn+r+o}function ho(t,e){return yo(t,e)/An}function vo(t,e){return yo(t,e)/Nn}var mo=new G(U.Date+U.Delimiter),go=new B(U.Date+U.Delimiter),To=mo,bo={create:To.set("create"),now:To.set("now"),today:To.set("today"),tomorrow:To.set("today+"),yesterday:To.set("today-"),maybe:To.set("maybe",{},["value"]),parse:To.set("parse",{},["value"],["parseAsUTC"]),fromText:To.set(">txt",{},["value"],["parseAsUTC"]),fromTimestamp:To.set(">tms",{},["value"]),fromTimestampSeconds:To.set(">tmss",{},["value"]),min:To.set("min",{},["value","test"]),max:To.set("max",{},["value","test"]),get:To.set("get",{},["value","property"]),set:To.set("set",{},["value","property","set"]),add:To.set("+",{},["value","unit"],["amount"]),sub:To.set("-",{},["value","unit"],["amount"]),startOf:To.set("startOf",{},["value","unit"]),endOf:To.set("endOf",{},["value","unit"],["inclusive"]),daysInMonth:To.set("dim",{},["value"]),daysInYear:To.set("diy",{},["value"]),weeksInYear:To.set("wiy",{},["value"]),copy:To.set("copy",{},["value"]),cmp:To.set("cmp",{},["value","test"],["unit"]),diff:To.set("diff",{},["value","test"],["unit","absolute","adjust"]),timezoneOffset:To.set("offset",{},["value"]),toText:To.set("toText",{},["value","format"]),toISOText:To.set("toISOText",{},["value"]),isValid:To.set("?",{},["value"]),isEqual:To.set("=",{},["value","test"],["unit"]),isBefore:To.set("<",{},["value","test"],["unit"]),isBeforeOrEqual:To.set("<=",{},["value","test"],["unit"]),isAfter:To.set(">",{},["value","test"],["unit"]),isAfterOrEqual:To.set(">=",{},["value","test"],["unit"]),isBetween:To.set("between",{},["value","start","end"],["unit","startInclusive","endInclusive"]),isStartOf:To.set("startOf?",{},["value","unit"]),isEndOf:To.set("endOf?",{},["value","unit"],["inclusive"]),isDST:To.set("dst?",{},["value"]),isLeapYear:To.set("leap?",{},["value"]),asAny:To.set("~"+U.Any,{},["value"]),asBoolean:To.set("~"+U.Boolean,{},["value"]),asColor:To.set("~"+U.Color,{},["value"]),asDate:To.set("~"+U.Date,{},["value"]),asList:To.set("~"+U.List,{},["value"]),asMap:To.set("~"+U.Map,{},["value"]),asNumber:To.set("~"+U.Number,{},["value"]),asObject:To.set("~"+U.Object,{},["value"]),asText:To.set("~"+U.Text,{},["value"]),asTuple:To.set("~"+U.Tuple,{},["value"]),asSet:To.set("~"+U.Set,{},["value"])};go.set("timestamp",bo.get,"value",{property:"timestamp"}),go.set("timestampSeconds",bo.get,"value",{property:"timestampSeconds"}),go.set("millis",bo.get,"value",{property:"millis"}),go.set("second",bo.get,"value",{property:"second"}),go.set("minute",bo.get,"value",{property:"minute"}),go.set("hour",bo.get,"value",{property:"hour"}),go.set("day",bo.get,"value",{property:"day"}),go.set("dayOfMonth",bo.get,"value",{property:"dayOfMonth"}),go.set("lastDayOfMonth",bo.get,"value",{property:"lastDayOfMonth"}),go.set("dayOfYear",bo.get,"value",{property:"dayOfYear"}),go.set("dayOfWeek",bo.get,"value",{property:"dayOfWeek"}),go.set("week",bo.get,"value",{property:"week"}),go.set("weekOfMonth",bo.get,"value",{property:"weekOfMonth"}),go.set("weekspanOfMonth",bo.get,"value",{property:"weekspanOfMonth"}),go.set("fullWeekOfMonth",bo.get,"value",{property:"fullWeekOfMonth"}),go.set("lastWeekspanOfMonth",bo.get,"value",{property:"lastWeekspanOfMonth"}),go.set("lastFullWeekOfMonth",bo.get,"value",{property:"lastFullWeekOfMonth"}),go.set("weekOfYear",bo.get,"value",{property:"weekOfYear"}),go.set("weekspanOfYear",bo.get,"value",{property:"weekspanOfYear"}),go.set("fullWeekOfYear",bo.get,"value",{property:"fullWeekOfYear"}),go.set("lastWeekspanOfYear",bo.get,"value",{property:"lastWeekspanOfYear"}),go.set("lastFullWeekOfYear",bo.get,"value",{property:"lastFullWeekOfYear"}),go.set("month",bo.get,"value",{property:"month"}),go.set("quarter",bo.get,"value",{property:"quarter"}),go.set("year",bo.get,"value",{property:"year"}),go.set("timeIdentifier",bo.get,"value",{property:"timeIdentifier"}),go.set("dayIdentifier",bo.get,"value",{property:"dayIdentifier"}),go.set("weekIdentifier",bo.get,"value",{property:"weekIdentifier"}),go.set("monthIdentifier",bo.get,"value",{property:"monthIdentifier"}),go.set("quarterIdentifier",bo.get,"value",{property:"quarterIdentifier"}),go.set("startOfSecond",bo.startOf,"value",{unit:"second"}),go.set("startOfMinute",bo.startOf,"value",{unit:"minute"}),go.set("startOfHour",bo.startOf,"value",{unit:"hour"}),go.set("startOfDay",bo.startOf,"value",{unit:"day"}),go.set("startOfWeek",bo.startOf,"value",{unit:"week"}),go.set("startOfMonth",bo.startOf,"value",{unit:"month"}),go.set("startOfQuarter",bo.startOf,"value",{unit:"quarter"}),go.set("startOfYear",bo.startOf,"value",{unit:"year"}),go.set("endOfSecond",bo.endOf,"value",{unit:"second"}),go.set("endOfMinute",bo.endOf,"value",{unit:"minute"}),go.set("endOfHour",bo.endOf,"value",{unit:"hour"}),go.set("endOfDay",bo.endOf,"value",{unit:"day"}),go.set("endOfWeek",bo.endOf,"value",{unit:"week"}),go.set("endOfMonth",bo.endOf,"value",{unit:"month"}),go.set("endOfQuarter",bo.endOf,"value",{unit:"quarter"}),go.set("endOfYear",bo.endOf,"value",{unit:"year"}),go.set("daysInMonth",bo.daysInMonth),go.set("daysInYear",bo.daysInYear),go.set("weeksInYear",bo.weeksInYear),go.set("timezoneOffset",bo.timezoneOffset),go.set("toISOText",bo.toISOText),go.set("isDST",bo.isDST),go.set("isLeapYear",bo.isLeapYear);var xo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oo=function(){return(Oo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Eo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xo(e,t),e.decode=function(t,n){return new e(this.decodeOptions(t[1]||{}))},e.encode=function(t){return v(t.options)?this.id:[this.id,this.encodeOptions(t.options)]},e.decodeOptions=function(t){return t.validateMin&&(t.validateMin=new Date(t.validateMin)),t.validateMax&&(t.validateMax=new Date(t.validateMax)),t.forceMin&&(t.forceMin=new Date(t.forceMin)),t.forceMax&&(t.forceMax=new Date(t.forceMax)),t},e.encodeOptions=function(t){var e=Oo({},t);return e.validateMin&&(e.validateMin=e.validateMin.toISOString()),e.validateMax&&(e.validateMax=e.validateMax.toISOString()),e.forceMin&&(e.forceMin=e.forceMin.toISOString()),e.forceMax&&(e.forceMax=e.forceMax.toISOString()),e},e.describe=function(t,n){return a(t)?new e({validateMin:new Date(t.getTime()),validateMax:new Date(t.getTime())}):null},e.register=function(){$.addCompare({priority:9,type:"object",compare:function(t,e){var n=a(t),r=a(e);return n!==r?(n?1:0)-(r?1:0):n?t.getTime()-e.getTime():void 0}}),$.addEquals({priority:9,type:"object",equals:function(t,e){var n=a(t);return n===a(e)&&(n?t.getTime()===e.getTime():void 0)}}),$.addJson({priority:9,fromJson:function(t){if(f(t)&&i(t.$any)&&"date"===t.$any)return new Date(t.value)},toJson:function(t){if(a(t))return{$any:"date",value:t.toISOString()}}}),$.addCopier({priority:9,copy:function(t,e,n){if(a(t)){var r=new Date(t.getTime());return n(t,r),r}}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.parseAsUTC=e.parseAsUTC&&n.parseAsUTC,e.validateMin&&n.validateMin&&e.validateMin.setTime(Math.min(e.validateMin.getTime(),n.validateMin.getTime())),e.validateMax&&n.validateMax&&e.validateMax.setTime(Math.max(e.validateMax.getTime(),n.validateMax.getTime()))},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){if(void 0===n&&(n={}),!(t instanceof e))return!1;if(n.value){if(t.options.withTime&&!this.options.withTime)return!1;var r=this.getMin(),o=t.getMin();if(r&&(!o||o.getTime()<r.getTime()))return!1;var i=this.getMax(),s=t.getMax();if(i&&(!s||s.getTime()>i.getTime()))return!1;var a=this.options,u=a.forceStartOf,p=a.forceEndOf;if(u&&u!==t.options.forceStartOf)return!1;if(p&&p!==t.options.forceEndOf)return!1}return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){var t=this.options,e=t.parseAsUTC,n=t.withTime;this.options={parseAsUTC:e,withTime:n}},e.prototype.getCreateExpression=function(){return wn.op(bo.create,{})},e.prototype.getValidateExpression=function(){return wn.op(bo.isValid,{value:wn.get("value")})},e.prototype.getCompareExpression=function(){return wn.op(bo.cmp,{value:wn.get("value"),test:wn.get("test")})},e.prototype.isValid=function(t){var e=this.options,n=e.parseAsUTC,r=e.validateMin,o=e.validateMax,i=nr(t,n);return!!i&&(!(r&&i.getTime()<r.getTime())&&!(o&&i.getTime()>o.getTime()))},e.prototype.normalize=function(t){var e=this.options,n=e.parseAsUTC,r=e.forceMin,o=e.forceMax,i=e.forceStartOf,s=e.forceEndOf,a=nr(t,n);return a?(r&&a.getTime()<r.getTime()&&a.setTime(r.getTime()),o&&a.getTime()>o.getTime()&&a.setTime(o.getTime()),i&&zn[i](a),s&&Xn[s](a),a):t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e($.copy(this.options))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return new Date},e.prototype.random=function(t){var e=new Date,n=this.getMin(),r=this.getMax(),o=n?n.getTime():e.getTime(),i=r?r.getTime():e.getTime();return new Date(t(o,i,!0))},e.prototype.getMin=function(){return this.options.validateMin||this.options.forceMin},e.prototype.getMax=function(){return this.options.validateMax||this.options.forceMax},e.prototype.fromJson=function(t){return new Date(t)},e.prototype.toJson=function(t){return t?t.toISOString():null},e.id=U.Date,e.operations=mo,e.computeds=go,e.baseType=new e({}),e.describePriority=6,e.registered=!1,e}(R),wo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),So=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Po=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},_o=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Po(arguments[e]));return t},Mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return wo(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getType(t)}))},e.encode=function(t){var e=t.options.map(function(t){return t.encode()});return[this.id,e]},e.describe=function(t,e){return null},e.register=function(){},e.prototype.getOperations=function(){var t=this;return this.operations||(this.operations={},this.options.forEach(function(e){var n=e.getOperations();for(var r in n)t.operations[r]=n[r]})),this.operations},e.prototype.forMany=function(t,e){var n,r,o=this.options;try{for(var i=So(o),s=i.next();!s.done;s=i.next()){var a=e(s.value);if(void 0!==a)return a}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){var r,o;try{for(var i=So(this.options),s=i.next();!s.done;s=i.next()){var a=s.value.getSubType(t,e,n);if(a)return a}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return null},e.prototype.getSubTypes=function(t){var e=[];return this.options.forEach(function(n){n.getSubTypes(t).forEach(function(t){e.find(function(e){return e.key===t.key||e.key instanceof R&&t.key instanceof R&&d(e.key,t.key)})||e.push(t)})}),e.sort(function(t,e){return(t.key instanceof R?1:0)-(e.key instanceof R?1:0)}),e},e.prototype.getExactType=function(t){return this.forMany(this,function(e){return e.isValid(t)?e:void 0})},e.prototype.getSimplifiedType=function(){return 1===this.options.length?this.options[0]:this},e.prototype.getRequired=function(){return this.isOptional()?new e(this.options.map(function(t){return t.getRequired()})):this},e.prototype.isDeepCompatible=function(t,e){return this.forMany(!1,function(n){return!!n.isCompatible(t,e)||void 0})},e.prototype.isOptional=function(){return this.forMany(!0,function(t){return!!t.isOptional()&&void 0})},e.prototype.isSimple=function(){return this.forMany(!0,function(t){return!!t.isSimple()&&void 0})},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return e.options.map(function(n,r){return t.step(r,n,function(t){return e.options.splice(r,1,t)},function(){return e.options.splice(r,1)})})})},e.prototype.getTypeFromStep=function(t){return this.options[t]||null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.options.forEach(function(t){return t.setParent(e)})},e.prototype.removeDescribedRestrictions=function(){this.options.forEach(function(t){return t.removeDescribedRestrictions()})},e.prototype.getCreateExpression=function(){return this.options[0].getCreateExpression()},e.prototype.getValidateExpression=function(){return wn.or.apply(wn,_o(this.options.map(function(t){return t.getValidateExpression()})))},e.prototype.getCompareExpression=function(){return wn.op(ut.cmp,{value:wn.get("value"),test:wn.get("test")})},e.prototype.getValueChangeExpression=function(t,e,n){var r=o(e),i=o(n);if(r&&!i){var s=0===e?this.options[1]:this.options[0],a=this.options[e],u=wn.cast(a,s);return wn.if(s.getValidateExpression()).than(wn.get("value")).else(u)}return!r&&i?t:n===e&&r?wn.if(wn.not(this.getValidateExpression())).than(t).else(wn.get("value")):t},e.prototype.isValid=function(t){return this.forMany(!1,function(e){return!!e.isValid(t)||void 0})},e.prototype.normalize=function(t){return this.forMany(t,function(e){return e.isValid(t)?e.normalize(t):void 0})},e.prototype.newInstance=function(){return new e([])},e.prototype.clone=function(){return new e(this.options.map(function(t){return t.clone()}))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.options.length>0?this.options[0].create():null},e.prototype.random=function(t){var e=this.options;return e[t(0,e.length,!0)].random(t)},e.prototype.fromJson=function(t){var e,n,r=this.options;try{for(var o=So(r),i=o.next();!i.done;i=o.next()){var s=i.value.normalize(t);if(null!=s)return s}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return t},e.prototype.toJson=function(t){var e,n,r=this.options;try{for(var o=So(r),i=o.next();!i.done;i=o.next()){var s=i.value;if(s.isValid(t))return s.toJson(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return t},e.id=U.Many,e.operations=new G(U.Many+U.Delimiter),e.computeds=new B(U.Many+U.Delimiter),e.baseType=new e([dt.baseType]),e.describePriority=-1,e.registered=!1,e}(R),Io=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Co=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Do=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},jo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Io(e,t),e.decode=function(t,n){var r=n.getType(t[1]);return new e({key:t[2]?n.getType(t[2]):Lt.baseType,value:r})},e.encode=function(t){var e=t.options,n=e.key,r=e.value;return n!==Lt.baseType?[this.id,r.encode()]:[this.id,r.encode(),n.encode()]},e.describe=function(t,n){var r,o;if(!u(t))return null;var i=new dt({}),s=new dt({});try{for(var a=Co(t.entries()),p=a.next();!p.done;p=a.next()){var c=Do(p.value,2),l=c[0],f=c[1];i=n.merge(i,l),s=n.merge(s,f)}}catch(t){r={error:t}}finally{try{p&&!p.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return new e({key:i,value:s})},e.register=function(){$.addJson({priority:10,fromJson:function(t,e){if(f(t)&&i(t.$any)&&"map"===t.$any)return new Map(t.value.map(function(t){var n=Do(t,2),r=n[0],o=n[1];return[e(r),e(o)]}))},toJson:function(t,e){if(u(t))return{$any:"map",value:Array.from(t.entries()).map(function(t){var n=Do(t,2),r=n[0],o=n[1];return[e(r),e(o)]})}}}),$.addCopier({priority:10,copy:function(t,e,n){var r,o;if(u(t)){var i=new Map;n(t,i);try{for(var s=Co(t.entries()),a=s.next();!a.done;a=s.next()){var p=Do(a.value,2),c=p[0],l=p[1];i.set(e(c),e(l))}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}}}),$.addCompare({priority:10,type:"object",compare:function(t,e,n){var r,o,i,s,a=u(t),p=u(e);if(a!==p)return(a?1:0)-(p?1:0);if(u(t)&&u(e)){var c=0,l=0;try{for(var f=Co(t.keys()),y=f.next();!y.done;y=f.next()){var d=y.value;e.has(d)||c++}}catch(t){r={error:t}}finally{try{y&&!y.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}try{for(var h=Co(e.keys()),v=h.next();!v.done;v=h.next()){d=v.value;if(t.has(d)){var m=n(t.get(d),e.get(d));m<0&&c++,m>0&&l++}else l++}}catch(t){i={error:t}}finally{try{v&&!v.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}return $.getCompare(c,l)}}}),$.addEquals({priority:10,type:"object",equals:function(t,e,n){var r,o;if(u(t)!==u(e))return!1;if(u(t)&&u(e)){if(t.size!==e.size)return!1;try{for(var i=Co(t.entries()),s=i.next();!s.done;s=i.next()){var a=Do(s.value,2),p=a[0],c=a[1];if(!e.has(p))return!1;if(!n(c,e.get(p)))return!1}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!0}}})},e.forItem=function(t,n){void 0===n&&(n=Lt);var r=Ti.parse(t);return new e({key:Ti.parse(n),value:r})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.key=Ti.merge(e.key,n.key),e.value=Ti.merge(e.value,n.value)},e.prototype.getSubType=function(t,e,n){if(Ht.is(t)&&this.options.key.isValid(t.value))return this.options.value;var r=t.getType(e,n);return r&&d(r=r.getRequired(),this.options.key)?this.options.value:null},e.prototype.getSubTypes=function(t){return[{key:this.options.key,value:this.options.value}]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){return t instanceof e&&this.options.key.isCompatible(t.options.key,n)&&this.options.value.isCompatible(t.options.value,n)},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_KEY,n.options.key,function(t){return n.options.key=t}),t.step(e.STEP_VALUE,n.options.value,function(t){return n.options.value=t})})},e.prototype.getTypeFromStep=function(t){return t===e.STEP_KEY?this.options.key:t===e.STEP_VALUE?this.options.value:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.key.setParent(this),this.options.value.setParent(this)},e.prototype.removeDescribedRestrictions=function(){this.options.key.removeDescribedRestrictions(),this.options.value.removeDescribedRestrictions()},e.prototype.getCreateExpression=function(){return wn.op(Ft.create,{})},e.prototype.getValidateExpression=function(){return wn.and(wn.op(Ft.isValid,{value:wn.get("value")}),wn.not(wn.op(pn.contains,{list:wn.op(Ft.values,{map:wn.get("value")}),item:wn.null(),isEqual:wn.not(this.options.value.getValidateExpression())},{value:"ignore",test:"value"})),wn.not(wn.op(pn.contains,{list:wn.op(Ft.keys,{map:wn.get("value")}),item:wn.null(),isEqual:wn.not(this.options.key.getValidateExpression())},{value:"ignore",test:"value"})))},e.prototype.getCompareExpression=function(){return wn.op(Ft.cmp,{value:wn.get("value"),test:wn.get("test"),compare:this.options.value.getValidateExpression()})},e.prototype.getValueChangeExpression=function(t,n,r){return n===e.STEP_KEY?wn.op(Ft.map,{map:wn.get("value"),transformKey:t},{key:"value",value:"actualValue"}):wn.op(Ft.map,{map:wn.get("value"),transform:t})},e.prototype.isValid=function(t){if(t instanceof Map||f(t)){var e=this.options,n=e.key,r=e.value;return this.iterate(t,!0,function(t,e){if(!n.isValid(t)||!r.isValid(e))return!1})}return!1},e.prototype.normalize=function(t){var e=this.options,n=e.key,r=e.value,o=[];return this.iterate(t,void 0,function(t,e){o.push([n.normalize(t),r.normalize(e)])}),new Map(o)},e.prototype.iterate=function(t,e,n){var r,o,i,s;if(t instanceof Map)try{for(var a=Co(t.entries()),u=a.next();!u.done;u=a.next()){var p=Do(u.value,2);if(void 0!==(y=n(p[0],p[1])))return y}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}else if(f(t))try{for(var c=Co(t),l=c.next();!l.done;l=c.next()){var y,d=l.value;if(void 0!==(y=n(d,t[d])))return y}}catch(t){i={error:t}}finally{try{l&&!l.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}return e},e.prototype.newInstance=function(){var t=this.options,n=t.key,r=t.value;return new e({key:n.newInstance(),value:r.newInstance()})},e.prototype.clone=function(){var t=this.options,n=t.key,r=t.value;return new e({key:n.clone(),value:r.clone()})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return new Map},e.prototype.random=function(t){for(var e=this.options,n=e.key,r=e.value,o=t(2,6,!0),i=new Map,s=0;s<o;s++){var a=n.random(t),u=r.random(t);i.set(a,u)}return i},e.prototype.fromJson=function(t){var e=this.options,n=e.key,r=e.value;return new Map(t.map(function(t){var e=Do(t,2),o=e[0],i=e[1];return[n.fromJson(o),r.fromJson(i)]}))},e.prototype.toJson=function(t){var e=this.options,n=e.key,r=e.value;return Array.from(t.entries()).map(function(t){var e=Do(t,2),o=e[0],i=e[1];return[n.toJson(o),r.toJson(i)]})},e.STEP_KEY="key",e.STEP_VALUE="value",e.id=U.Map,e.operations=Rt,e.computeds=qt,e.baseType=new e({key:Lt.baseType,value:dt.baseType}),e.describePriority=7,e.registered=!1,e}(R),ko=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ao=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ko(e,t),e.decode=function(t,n){return new e(n.getType(t[1]))},e.encode=function(t){return[this.id,t.options.encode()]},e.describe=function(t,e){return null},e.register=function(){},e.for=function(t){return new e(Ti.parse(t))},e.prototype.getOperations=function(){return this.options.getOperations()},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return this.options.getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.options.getSubTypes(t)},e.prototype.getExactType=function(t){return this.options.getExactType(t)},e.prototype.getSimplifiedType=function(){return this},e.prototype.getRequired=function(){return this.options},e.prototype.isDeepCompatible=function(t,n){return t instanceof e?this.options.isCompatible(t.options,n):this.options.isCompatible(t,n)},e.prototype.isOptional=function(){return!0},e.prototype.isSimple=function(){return this.options.isSimple()},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){return t.step(e.STEP_OPTIONAL,n.options,function(t){return n.options=t})})},e.prototype.getTypeFromStep=function(t){return t===e.STEP_OPTIONAL?this.options:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.setParent(this)},e.prototype.removeDescribedRestrictions=function(){this.options.removeDescribedRestrictions()},e.prototype.getCreateExpression=function(){return this.options.getCreateExpression()},e.prototype.getValidateExpression=function(){return wn.or(wn.op(ut.isEqual,{value:wn.get("value"),test:wn.undefined()}),this.options.getValidateExpression())},e.prototype.getCompareExpression=function(){return wn.define({valueMissing:wn.op(ut.isEqual,{value:wn.get("value"),test:wn.undefined()}),testMissing:wn.op(ut.isEqual,{value:wn.get("test"),test:wn.undefined()})},wn.if(wn.and(wn.get("valueMissing"),wn.get("testMissing"))).than(wn.compareEqual()).if(wn.get("valueMissing")).than(wn.compareLess()).if(wn.get("testMissing")).than(wn.compareGreater()).else(this.options.getCompareExpression()))},e.prototype.getValueChangeExpression=function(t,e,n){return wn.if(this.options.getValidateExpression()).than(t).else(wn.get("value"))},e.prototype.isValid=function(t){return null==t||this.options.isValid(t)},e.prototype.normalize=function(t){return null==t?t:this.options.normalize(t)},e.prototype.newInstance=function(){return new e(this.options.newInstance())},e.prototype.clone=function(){return new e(this.options.clone())},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.options?this.options.create():void 0},e.prototype.random=function(t){return this.options&&t(0,1,!1)>.3?this.options.random(t):void 0},e.prototype.fromJson=function(t){return null==t?void 0:this.options.fromJson(t)},e.prototype.toJson=function(t){return null==t?void 0:this.options.toJson(t)},e.STEP_OPTIONAL="optional",e.id=U.Optional,e.operations=new G(U.Optional+U.Delimiter),e.computeds=new B(U.Optional+U.Delimiter),e.baseType=new e(dt.baseType),e.describePriority=-1,e.registered=!1,e}(R),No=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lo=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ro=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return No(e,t),e.decode=function(t,n){return new e(t[1].map(function(t){return n.getType(t)}))},e.encode=function(t){var e=t.options.map(function(t){return t.encode()});return[this.id,e]},e.describe=function(t,e){return null},e.register=function(){},e.prototype.getOperations=function(){return{}},e.prototype.forNot=function(t,e){var n,r,o=this.options;try{for(var i=Lo(o),s=i.next();!s.done;s=i.next()){var a=e(s.value);if(void 0!==a)return a}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,e){return this.forNot(!0,function(n){return!n.isCompatible(t,e)&&void 0})},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.isOptional=function(){return!0},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var e=this;return t.enter(this,function(){return e.options.map(function(n,r){return t.step(r,n,function(t){return e.options.splice(r,1,t)},function(){return e.options.splice(r,1)})})})},e.prototype.getTypeFromStep=function(t){return this.options[t]||null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.options.forEach(function(t){return t.setParent(e)})},e.prototype.removeDescribedRestrictions=function(){this.options.forEach(function(t){return t.removeDescribedRestrictions()})},e.prototype.getCreateExpression=function(){return ft.instance},e.prototype.getValidateExpression=function(){return ft.instance},e.prototype.getCompareExpression=function(){return ft.instance},e.prototype.isValid=function(t){return this.forNot(!0,function(e){return!e.isValid(t)&&void 0})},e.prototype.normalize=function(t){return this.forNot(t,function(e){return e.isValid(t)?null:void 0})},e.prototype.newInstance=function(){return new e([])},e.prototype.clone=function(){return new e(this.options.map(function(t){return t.clone()}))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return null},e.prototype.random=function(t){return null},e.prototype.fromJson=function(t){return dt.baseType.fromJson(t)},e.prototype.toJson=function(t){return dt.baseType.toJson(t)},e.id=U.Not,e.operations=new G(U.Not+U.Delimiter),e.computeds=new B(U.Not+U.Delimiter),e.baseType=new e([dt.baseType]),e.describePriority=-1,e.registered=!1,e}(R),qo=new G(U.Color+U.Delimiter),Vo=new B(U.Color+U.Delimiter),Fo=qo,Yo={create:Fo.set("create",{}),maybe:Fo.set("maybe",{},["value"]),cmp:Fo.set("cmp",{},["value","test"]),copy:Fo.set("copy",{},["value"]),build:Fo.set("build",{},["r","g","b"],["a"]),map:Fo.set("map",{},["value","r","g","b"],["a"],["value","component"],["r","g","b","a"]),op:Fo.set("op",{},["value","test","r","g","b"],["a"],["value","test","component"],["r","g","b","a"]),clamp:Fo.set("clamp",{},["value"]),add:Fo.set("+",{},["value","addend"],["alpha"]),adds:Fo.set("+*",{},["value","addend","addendScale"],["alpha"]),sub:Fo.set("-",{},["value","subtrahend"],["alpha"]),mul:Fo.set("*",{},["value","multiplier"],["alpha"]),div:Fo.set("/",{},["value","divisor"],["alpha"]),mod:Fo.set("%",{},["value","divisor"],["alpha"]),format:Fo.set("format",{},["value","format"]),parse:Fo.set("parse",{},["value"]),lerp:Fo.set("lerp",{},["start","end","delta"]),lighten:Fo.set("lighten",{},["value","amount"]),darken:Fo.set("darken",{},["value","amount"]),toHSL:Fo.set("->hsl",{},["value"]),fromHSL:Fo.set("<-hsl",{},["value"]),luminance:Fo.set("luminance",{},["value"]),contrast:Fo.set("contrast",{},["value","test"]),invert:Fo.set("invert",{},["value"],["alpha"]),opaque:Fo.set("opaque",{},["value"]),alpha:Fo.set("alpha",{},["value","alpha"]),distance:Fo.set("distance",{},["value","test"]),named:Fo.set("named",{},["name"]),getName:Fo.set("getName",{},["value"]),blend:Fo.set("blend",{},["top","bottom","mode"]),isValid:Fo.set("?",{},["value"]),isEqual:Fo.set("=",{},["value","test"],["epsilon"]),isNotEqual:Fo.set("!=",{},["value","test"],["epsilon"]),isLess:Fo.set("<",{},["value","test"]),isLessOrEqual:Fo.set("<=",{},["value","test"]),isGreater:Fo.set(">",{},["value","test"]),isGreaterOrEqual:Fo.set(">=",{},["value","test"]),asAny:Fo.set("~"+U.Any,{},["value"]),asBoolean:Fo.set("~"+U.Boolean,{},["value"]),asColor:Fo.set("~"+U.Color,{},["value"]),asDate:Fo.set("~"+U.Date,{},["value"]),asList:Fo.set("~"+U.List,{},["value"]),asMap:Fo.set("~"+U.Map,{},["value"]),asNumber:Fo.set("~"+U.Number,{},["value"]),asObject:Fo.set("~"+U.Object,{},["value"]),asText:Fo.set("~"+U.Text,{},["value"]),asTuple:Fo.set("~"+U.Tuple,{},["value"]),asSet:Fo.set("~"+U.Set,{},["value"])};Vo.set("toHSL",Yo.toHSL),Vo.set("luminance",Yo.luminance),Vo.set("inverted",Yo.invert),Vo.set("opaque",Yo.opaque),Vo.set("name",Yo.getName);var Go=0,Bo=255;function Uo(t){return f(t)&&o(t.r)&&o(t.g)&&o(t.b)}function Wo(t){return m(Math.round(t),Go,Bo)}var Ho=function(){function t(t,e){this.code=t,this.name=e,this.formatMap={},this.formats=[]}return t.prototype.setType=function(t){return this.type=t,this},t.prototype.setToColor=function(t){return this.toColor=t,this},t.prototype.setFromColor=function(t){return this.fromColor=t,this},t.prototype.addFormat=function(t){return this.formatMap[t.code]=t,this.formats.push(t),this},t}(),Jo=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ko=new Ho("rgb","RGB").setToColor(function(t){return t}).setFromColor(function(t){return t}).addFormat({code:"default",name:"Default",parser:function(t){return Uo(t)?t:null},formatter:function(t){return t}}).addFormat({code:"bestfit",name:"Best Fit",parser:function(t){return null},formatter:function(t){return t.a===Bo?"#"+Xo(t.r)+Xo(t.g)+Xo(t.b):"rgba("+Wo(t.r)+","+Wo(t.g)+","+Wo(t.b)+","+Wo(t.a)/Bo+")"}}).addFormat({code:"hexShort",name:"Hex (#rgb)",parser:function(t){if(!i(t))return null;var e=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t);if(!e)return null;var n=Jo(e,4),r=n[1],o=n[2],s=n[3];return{r:parseInt(r+r,16),g:parseInt(o+o,16),b:parseInt(s+s,16),a:Bo}},formatter:function(t){return"#"+Xo(t.r).substring(0,1)+Xo(t.g).substring(0,1)+Xo(t.b).substring(0,1)}}).addFormat({code:"hex",name:"Hex (#rrggbb)",parser:function(t){if(!i(t))return null;var e=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t);if(!e)return null;var n=Jo(e,4),r=n[1],o=n[2],s=n[3];return{r:parseInt(r,16),g:parseInt(o,16),b:parseInt(s,16),a:Bo}},formatter:function(t){return"#"+Xo(t.r)+Xo(t.g)+Xo(t.b)}}).addFormat({code:"hexLong",name:"Hex (#rrggbbaa)",parser:function(t){if(!i(t))return null;var e=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t);if(!e)return null;var n=Jo(e,5),r=n[1],o=n[2],s=n[3],a=n[4];return{r:parseInt(r,16),g:parseInt(o,16),b:parseInt(s,16),a:parseInt(a,16)}},formatter:function(t){return"#"+Xo(t.r)+Xo(t.g)+Xo(t.b)+Xo(t.a)}}).addFormat({code:"rgb",name:"rgb(r, g, b)",parser:function(t){if(!i(t))return null;var e=/^rgb\(\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*\)$/i.exec(t);if(!e)return null;var n=Jo(e,4),r=n[1],o=n[2],s=n[3];return{r:zo(r),g:zo(o),b:zo(s),a:Bo}},formatter:function(t){return"rgb("+Wo(t.r)+","+Wo(t.g)+","+Wo(t.b)+")"}}).addFormat({code:"rgba",name:"rgba(r, g, b, a)",parser:function(t){if(!i(t))return null;var e=/^rgb\(\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*([01]?\.?[0-9]*)\s*\)$/i.exec(t);if(!e)return null;var n=Jo(e,5),r=n[1],o=n[2],s=n[3],a=n[4];return{r:zo(r),g:zo(o),b:zo(s),a:Wo(Math.floor(parseFloat(a)*Bo))}},formatter:function(t){return"rgba("+Wo(t.r)+","+Wo(t.g)+","+Wo(t.b)+","+Wo(t.a)/Bo+")"}});function zo(t){return-1===t.indexOf("%")?Wo(parseInt(t,10)):Wo(2.55*parseInt(t.substring(0,t.length-1),10))}function Xo(t){return C(Wo(t).toString(16),2,"0",!0)}var $o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function Qo(t){return f(t)&&o(t.h)&&o(t.s)&&o(t.l)}var Zo=new Ho("hsl","HSL").setType(new ye({props:{h:new Pn({min:0,max:360,whole:!0}),s:new Pn({min:0,max:100,whole:!0}),l:new Pn({min:0,max:100,whole:!0}),a:new Pn({min:0,max:255,whole:!0})}})).setToColor(function(t){var e=ti(t.h),n=ei(t.l)/100,r=ei(t.s)/100,o=(1-Math.abs(2*n-1))*r,i=o*(1-Math.abs(e/60%2-1)),s=n-o/2,a=e>=240?0:e>=60&&e<180?o:i,u=e<=120?0:e>=180&&e<300?o:i;return{r:Wo(((e<60||e>=300?o:e>=120&&e<240?0:i)+s)*Bo),g:Wo((a+s)*Bo),b:Wo((u+s)*Bo),a:t.a}}).setFromColor(function(t){var e=Wo(t.r),n=Wo(t.g),r=Wo(t.b),o=e/Bo,i=n/Bo,s=r/Bo,a=Math.max(o,i,s),u=Math.min(o,i,s),p=a-u,c=(a+u)/2,l=0===p?0:a===o?(i-s)/p%6:a===i?(s-o)/p+2:(o-i)/p+4,f=0===p?0:p/(1-Math.abs(2*c-1));return{h:ti(Math.round(60*l)),s:ei(Math.round(100*f)),l:ei(Math.round(100*c)),a:t.a}}).addFormat({code:"hsl",name:"HSL",parser:function(t){if(!i(t))return null;var e=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*\)$/i.exec(t);if(!e)return null;var n=$o(e,4),r=n[1],o=n[2],s=n[3];return{h:ti(parseInt(r,10)),s:ei(parseInt(o,10)),l:ei(parseInt(s,10)),a:Bo}},formatter:function(t){return"hsl("+ti(Math.round(t.h))+","+ei(Math.round(t.s))+"%,"+ei(Math.round(t.l))+"%)"}}).addFormat({code:"hsla",name:"HSLA",parser:function(t){if(!i(t))return null;var e=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*,\s*([01]?\.?[0-9]*)\s*\)$/i.exec(t);if(!e)return null;var n=$o(e,5),r=n[1],o=n[2],s=n[3],a=n[4];return{h:ti(parseInt(r,10)),s:ei(parseInt(o,10)),l:ei(parseInt(s,10)),a:Wo(Math.floor(parseFloat(a)*Bo))}},formatter:function(t){return"hsla("+ti(Math.round(t.h))+","+ei(Math.round(t.s))+"%,"+ei(Math.round(t.l))+"%,"+Wo(t.a)/Bo+")"}});function ti(t){return t<0?360-Math.abs(t%360):t%360}function ei(t){return m(t,0,100)}var ni=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ri=function(){return(ri=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},oi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ii=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},si=function(t){function e(n){return void 0===n&&(n={}),t.call(this,ri(ri({},n),{props:e.componentProps}))||this}return ni(e,t),e.decode=function(t){return new e(t[1]||{})},e.encode=function(t){return t.options.hasAlpha?[this.id,{hasAlpha:!0}]:this.id},e.describe=function(t){var n=e.baseType.normalize(t);return n?new e({hasAlpha:n.a!==Bo}):null},e.register=function(){},e.getFormat=function(t){var e=oi(t.split(":"),2),n=e[0],r=e[1],o=this.spaces.find(function(t){return t.code===n});return o?o.formatMap[r]:void 0},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.hasAlpha=e.hasAlpha||n.hasAlpha},e.prototype.isDeepCompatible=function(t,n){return t instanceof e||!(n.strict||n.exact||!(t instanceof ye)||!t.isCompatible(this))},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.removeDescribedRestrictions=function(){t.prototype.removeDescribedRestrictions.call(this),delete this.options.hasAlpha},e.prototype.getCreateExpression=function(){return wn.op(Yo.create,{})},e.prototype.getValidateExpression=function(){return wn.op(Yo.isValid,{value:wn.get("value")})},e.prototype.getCompareExpression=function(){return wn.op(Yo.cmp,{value:wn.get("value"),test:wn.get("test")})},e.prototype.isValid=function(t){return void 0!==this.normalize(t)},e.prototype.normalize=function(t){var n,r,o,i;try{for(var s=ii(e.spaces),a=s.next();!a.done;a=s.next()){var u=a.value;try{for(var p=(o=void 0,ii(u.formats)),c=p.next();!c.done;c=p.next()){var l=c.value.parser(t);if(null!==l)return u.toColor(l)}}catch(t){o={error:t}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e({hasAlpha:this.options.hasAlpha})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return{r:0,g:0,b:0,a:0}},e.prototype.random=function(t){return{r:t(Go,Bo,!0),g:t(Go,Bo,!0),b:t(Go,Bo,!0),a:Bo}},e.prototype.fromJson=function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}},e.prototype.toJson=function(t){return t?{r:t.r,g:t.g,b:t.b,a:t.a}:null},e.componentType=new Pn({min:Go,max:Bo,whole:!0}),e.componentProps={r:e.componentType,g:e.componentType,b:e.componentType,a:e.componentType},e.spaces=[Ko,Zo],e.id=U.Color,e.operations=qo,e.computeds=Vo,e.baseType=new e({hasAlpha:!0}),e.describePriority=7,e.registered=!1,e}(ye);Ko.setType(si.baseType);var ai=new G(U.Set+U.Delimiter),ui=new B(U.Set+U.Delimiter),pi=ai,ci={create:pi.set("create"),createLike:pi.set("createLike",{},["set"],[],[],[],["set"]),createFor:pi.set("createFor",{},["value"],[],[],[],["value"]),maybe:pi.set("maybe",{},["value"]),add:pi.set("add",{mutates:["set"]},["set","value"],[],[],[],["set"]),has:pi.set("has",{},["set","value"]),delete:pi.set("delete",{mutates:["set"]},["set","value"]),values:pi.set("values",{complexity:1},["set"],[],[],[],["set"]),clear:pi.set("clear",{mutates:["set"]},["set"],[],[],[],["set"]),count:pi.set("count",{},["set"]),cmp:pi.set("cmp",{complexity:1},["value","test"]),copy:pi.set("copy",{complexity:1},["set"],["deepCopy"],["set","value"],["deepCopy"],["set"]),map:pi.set("map",{complexity:1},["set"],["transform"],["set","value"],["transform"],["set"]),isValid:pi.set("?",{},["value"]),isEqual:pi.set("=",{complexity:1},["value","test"]),isNotEqual:pi.set("!=",{complexity:1},["value","test"]),isLess:pi.set("<",{complexity:1},["value","test"]),isLessOrEqual:pi.set("<=",{complexity:1},["value","test"]),isGreater:pi.set(">",{complexity:1},["value","test"]),isGreaterOrEqual:pi.set(">=",{complexity:1},["value","test"]),asAny:pi.set("~"+U.Any,{},["value"]),asBoolean:pi.set("~"+U.Boolean,{},["value"]),asColor:pi.set("~"+U.Color,{},["value"]),asDate:pi.set("~"+U.Date,{},["value"]),asList:pi.set("~"+U.List,{},["value"]),asMap:pi.set("~"+U.Map,{},["value"]),asNumber:pi.set("~"+U.Number,{},["value"]),asObject:pi.set("~"+U.Object,{},["value"]),asText:pi.set("~"+U.Text,{},["value"]),asTuple:pi.set("~"+U.Tuple,{},["value"]),asSet:pi.set("~"+U.Set,{},["value"])};ui.set("copy",ci.copy),ui.set("values",ci.values),ui.set("count",ci.count);var li,fi,yi,di=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hi=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},mi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return di(e,t),e.decode=function(t,n){return new e({value:n.getType(t[1])})},e.encode=function(t){var e=t.options.value;return[this.id,e.encode()]},e.describe=function(t,n){var r,o;if(!p(t))return null;var i=new dt({});try{for(var s=hi(t.entries()),a=s.next();!a.done;a=s.next()){var u=vi(a.value,1)[0];i=n.merge(i,u)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return new e({value:i})},e.register=function(){$.addJson({priority:11,fromJson:function(t,e){if(f(t)&&i(t.$any)&&"set"===t.$any)return new Set(t.value.map(e))},toJson:function(t,e){if(p(t))return{$any:"set",value:Array.from(t.entries()).map(e)}}}),$.addCopier({priority:11,copy:function(t,e,n){var r,o;if(p(t)){var i=new Set;n(t,i);try{for(var s=hi(t.entries()),a=s.next();!a.done;a=s.next()){var u=vi(a.value,1)[0];i.add(e(u))}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}}}),$.addCompare({priority:11,type:"object",compare:function(t,e,n){var r=p(t),o=p(e);if(r!==o)return(r?1:0)-(o?1:0);if(p(t)&&p(e)){var i=t.size-e.size;if(0===i){for(var s=0,a=0,u=Array.from(t),c=Array.from(e),l=0;l<u.length;l++){var f=n(u[l],c[l]);f<0&&s++,f>0&&a++}i=$.getCompare(s,a)}return i}}}),$.addEquals({priority:11,type:"object",equals:function(t,e,n){var r,o;if(p(t)!==p(e))return!1;if(p(t)&&p(e)){if(t.size!==e.size)return!1;try{for(var i=hi(t),s=i.next();!s.done;s=i.next()){var a=s.value;if(!e.has(a))return!1}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!0}}})},e.forItem=function(t){return new e({value:Ti.parse(t)})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.value=Ti.merge(e.value,n.value)},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){return t instanceof e&&this.options.value.isCompatible(t.options.value,n)},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){t.step(e.STEP_VALUE,n.options.value,function(t){return n.options.value=t})})},e.prototype.getTypeFromStep=function(t){return t===e.STEP_VALUE?this.options.value:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.value.setParent(this)},e.prototype.removeDescribedRestrictions=function(){this.options.value.removeDescribedRestrictions()},e.prototype.getCreateExpression=function(){return wn.op(ci.create,{})},e.prototype.getValidateExpression=function(){return wn.and(wn.op(ci.isValid,{value:wn.get("value")}),wn.not(wn.op(pn.contains,{list:wn.op(ci.values,{set:wn.get("value")}),item:wn.null(),isEqual:wn.not(this.options.value.getValidateExpression())},{value:"ignore",test:"value"})))},e.prototype.getCompareExpression=function(){return wn.op(ci.cmp,{value:wn.get("value"),test:wn.get("test")})},e.prototype.getValueChangeExpression=function(t,e,n){return wn.op(ci.map,{set:wn.get("value"),transform:t},{value:"value"})},e.prototype.isValid=function(t){if(t instanceof Set||s(t)){var e=this.options.value;return!Array.from(t).some(function(t){return!e.isValid(t)})}return!1},e.prototype.normalize=function(t){var e=this.options.value;return new Set(Array.from(t).map(function(t){return e.normalize(t)}))},e.prototype.newInstance=function(){return new e({value:this.options.value.newInstance()})},e.prototype.clone=function(){return new e({value:this.options.value.clone()})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return new Set},e.prototype.random=function(t){for(var e=this.options.value,n=t(2,6,!0),r=new Set,o=0;o<n;o++){var i=e.random(t);r.add(i)}return r},e.prototype.fromJson=function(t){var e=this.options.value;return new Set(t.map(function(t){return e.fromJson(t)}))},e.prototype.toJson=function(t){var e=this.options.value;return Array.from(t.entries()).map(function(t){return e.toJson(t)})},e.STEP_VALUE="value",e.id=U.Set,e.operations=ai,e.computeds=ui,e.baseType=new e({value:dt.baseType}),e.describePriority=7,e.registered=!1,e}(R),gi=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ti=function(){function t(){}return t.setParent=function(t,e){return void 0===e&&(e=!1),(this.autoSetParent||e)&&t.setParent(),t},t.any=function(){return new dt({})},t.bool=function(t,e){return new Z({true:t,false:e})},t.date=function(t){return void 0===t&&(t={}),new Eo(t)},t.enum=function(t,e,n){return void 0===e&&(e=Lt),void 0===n&&(n=new Map([])),this.setParent(new Ut({value:this.parse(t),key:this.parse(e),constants:g(n)}))},t.enumForText=function(t){return this.setParent(new Ut({value:this.text(),key:this.text(),constants:u(t)?t:s(t[0])?new Map(t):new Map(t.map(function(t){return[t,t]}))}))},t.list=function(t,e,n){return this.setParent(new hn({item:this.parse(t),min:e,max:n}))},t.many=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.setParent(new Mo(s(e[0])?e[0].map(function(e){return t.parse(e)}):e.map(function(e){return t.parse(e)})))},t.not=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.setParent(new Ro(s(e[0])?e[0].map(function(e){return t.parse(e)}):e.map(function(e){return t.parse(e)})))},t.map=function(t,e){return void 0===e&&(e=Lt),this.setParent(new jo({key:this.parse(e),value:this.parse(t)}))},t.null=function(){return ct.baseType},t.number=function(t,e,n){return new Pn({min:t,max:e,whole:n})},t.int=function(t,e){return new Pn({min:t,max:e,whole:!0})},t.index=function(t){return new Pn({min:0,max:t,whole:!0})},t.char=function(){return new Lt({min:1,max:1})},t.object=function(t){return void 0===t&&(t={}),this.setParent(new ye({props:this.resolve(t)}))},t.optional=function(t){var e=this.parse(t);return this.setParent(e.isOptional()?e:new Ao(e))},t.color=function(t){return void 0===t&&(t={}),this.setParent(new si(t))},t.set=function(t){return this.setParent(new mi({value:this.parse(t)}))},t.text=function(t){return void 0===t&&(t={}),new Lt(t)},t.tuple=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.setParent(new Tn(s(e[0])?e[0].map(function(e){return t.parse(e)}):e.map(function(e){return t.parse(e)})))},t.parse=function(t){return t instanceof R?t:t.baseType.newInstance()},t.simplify=function(t){return t?t.getSimplifiedType():null},t.resolve=function(t){var e,n=this;return t&&(t instanceof R?e=t:t.baseType instanceof R?e=t.baseType.newInstance():s(t)?e=t.map(function(t){return n.resolve(t)}):f(t)&&(e=O(t,function(t){return n.resolve(t)}))),e},t.reduce=function(t){return 1===t.length?t[0]:new Mo(t)},t.explode=function(t){return t instanceof Mo?t.options:[t]},t.maybe=function(t,e){if(t instanceof e)return t;if(t instanceof Ao&&t.options instanceof e)return t;if(t instanceof Mo){var n=t.options.find(function(t){return t instanceof e});if(n)return this.optional(n);var r=t.options.find(function(t){return t instanceof Ao&&t.options instanceof e});if(r)return r}return this.optional(e)},t.mergeMany=function(t,e){var n=this;return void 0===e&&(e=null),0===t.length?e:t.find(function(t){return t instanceof dt})?dt.baseType:t.map(function(t){return t?t.clone():null}).reduce(function(t,e){return t&&e?n.merge(t,e):t||e})},t.merge=function(t,e){var n,r;if(t instanceof dt)return e;var o=t instanceof Ao||e instanceof Ao,i=t.getRequired(),s=e.getRequired();if(d(i,s))return i.merge(s),o?this.optional(i):i;if(i instanceof Mo||s instanceof Mo){var a=this.explode(i),u=this.explode(s),p=a.length;try{for(var c=gi(u),l=c.next();!l.done;l=c.next()){for(var f=l.value,y=!1,h=f instanceof Ao,v=h?f.options:f,m=0;m<p;m++){var g=a[m],T=g instanceof Ao,b=T?g.options:g;d(b,v)&&(y=!0,b.merge(v),h&&!T&&(a[m]=this.optional(b)))}y||a.push(f)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return o?this.optional(this.reduce(a)):this.reduce(a)}return this.many(t,e)},t.INDEX=t.index(),t.LENGTH=t.index(),t.CHAR=t.char(),t.autoSetParent=!0,t}(),bi=function(){function t(t){this.value=t,this.next=this.prev=this}return t.prototype.isEmpty=function(){return this.next===this},t.prototype.clear=function(){this.next=this.prev=this},t.prototype.addLast=function(e){var n=new t(e);return n.linkAfter(this.prev),n},t.prototype.addFirst=function(e){var n=new t(e);return n.linkAfter(this),n},t.prototype.each=function(t){for(var e=this.next,n=0;e!==this;){var r=e.next;t(e.value,n,e),e=r,n++}return n},t.prototype.isRemoved=function(){return this.next===this},t.prototype.remove=function(){this.isRemoved()||(this.next.prev=this.prev,this.prev.next=this.next,this.next=this.prev=this)},t.prototype.linkAfter=function(t){this.remove(),this.next=t.next,this.prev=t,t.next.prev=this,t.next=this},t}(),xi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Oi=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(xi(arguments[e]));return t},Ei=function(){function t(){this.listeners=Object.create(null)}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.getListeners(t,!1),o=[];return r&&r.each(function(n){return o.push(n.apply(void 0,Oi([t],e)))}),o},t.prototype.hasListeners=function(t){return null!==this.getListeners(t)},t.prototype.getListeners=function(t,e){void 0===e&&(e=!0);var n=this.listeners[t];return!n&&e&&(n=this.listeners[t]=new bi(function(){})),n||null},t.prototype.on=function(t,e){var n=this,r=(s(t)?t:[t]).map(function(t){return n.getListeners(t,!0).addLast(e)});return function(){return r.forEach(function(t){return t.remove()})}},t.prototype.once=function(t,e){var n=this.on(t,function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return n(),e.apply(void 0,Oi([t],r))});return n},t.prototype.off=function(t,e){var n=this;if(t)if(Array.isArray(t))t.forEach(function(t){return n.off(t,e)});else{var r=this.listeners[t];r&&(e?r.each(function(t,n,r){t===e&&r.remove()}):r.clear())}else this.listeners=Object.create(null);return this},t}(),wi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Si=function(){return(Si=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Pi=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e.name,r.description=e.description,r.meta=e.meta,r.params=n.getTypeKind(e.params,ye,Ti.object()),r.expression=n.getExpression(e.expression),r.defaults=r.params.fromJson(e.defaults),r.tests=e.tests.map(function(t){return Si(Si({},t),{args:r.params.fromJson(t.args)})}),r}return wi(e,t),e.create=function(t,n){return void 0===n&&(n={}),new e(Si({name:"",description:"",meta:null,params:Ti.object(),expression:wn.noop(),defaults:{},tests:[]},n),t)},e.prototype.sync=function(t,n){var r=this;this.hasChanges(t)&&(this.name=t.name,this.description=t.description,this.meta=t.meta,this.params=t instanceof e?t.params:n.getTypeKind(t.params,ye,Ti.object()),this.expression=t instanceof e?t.expression:n.getExpression(t.expression),this.defaults=t instanceof e?t.defaults:this.params.fromJson(t.defaults),b(this.tests,t instanceof e?t.tests:t.tests.map(function(t){return Si(Si({},t),{args:r.params.fromJson(t.args)})}),function(t,e){return t.name===e.name||$.equals(t.args,e.args)},function(t,e){return r.addTest(e,!0)},function(t,e){return r.removeTest(e,!0)},function(t,e,n,o){return r.updateTest(n,o,!0)}),this.trigger("sync",this,t,n),this.changed())},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.trigger("changed",this)},e.prototype.encode=function(){var t=this,e=t.name,n=t.description,r=t.meta,o=t.params,i=t.expression,s=t.defaults,a=t.tests;return{name:e,description:n,meta:r,params:o.encode(),expression:i.encode(),defaults:o.toJson(s),tests:a.map(function(t){return Si(Si({},t),{args:o.toJson(t.args)})})}},e.prototype.renameParameter=function(t,e){var n=this.params.options.props[t];return n&&(this.params.options.props[e]=n,delete this.params.options.props[t],t in this.defaults&&(this.defaults[e]=this.defaults[t],delete this.defaults[t]),this.trigger("renameParameter",this,e,t),this.changed()),!!n},e.prototype.removeParameter=function(t){var e=t in this.params.options.props[t];return e&&(delete this.params.options.props[t],delete this.defaults[t],this.trigger("removeParameter",this,t),this.changed()),e},e.prototype.addTest=function(t,e){void 0===e&&(e=!1),this.tests.push(t),this.trigger("addTest",this,t),e||this.changed()},e.prototype.updateTest=function(t,e,n){void 0===n&&(n=!1);var r=o(t)?this.tests[t]:t,i=!!r;return i&&(Object.assign(r,e),this.trigger("updateTest",this,r),n||this.changed()),i},e.prototype.removeTest=function(t,e){void 0===e&&(e=!1);var n=o(t)?t:this.tests.indexOf(t),r=n>=0&&n<this.tests.length;if(r){var i=this.tests[n];this.trigger("removeTest",this,i),e||this.changed()}return r},e.prototype.getReturnType=function(t,e){void 0===e&&(e={});var n=Ti.object(Si(Si({},this.params.options.props),e));return this.expression.getType(t,n)},e.prototype.getParamTypes=function(){var t=this;return v(this.defaults)?this.params:Ti.object(O(this.params.options.props,function(e,n){return t.getParamType(n)}))},e.prototype.getParamType=function(t){var e=this.params.options.props[t];return e.isOptional()&&t in this.defaults&&e.isValid(this.defaults[t])?e.getRequired():e},e.prototype.getArguments=function(t,e){void 0===e&&(e=!0);var n=e?Si({},t):t;for(var r in this.defaults){this.params.options.props[r].getRequired().isValid(n[r])||(n[r]=$.copy(this.defaults[r]))}return n},e.prototype.refactor=function(t,e){var n=e.getCommand(t);this.tests.forEach(function(t){t.args=n({value:t.args})}),this.changed()},e}(Ei),_i=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mi=function(){return(Mi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};!function(t){t[t.PRIMARY=0]="PRIMARY",t[t.FOREIGN=1]="FOREIGN",t[t.NONE=2]="NONE"}(fi||(fi={})),function(t){t[t.GIVEN=0]="GIVEN",t[t.AUTO_INCREMENT=1]="AUTO_INCREMENT",t[t.UUID=2]="UUID"}(yi||(yi={}));var Ii,Ci,Di=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e.name,r.description=e.description,r.meta=e.meta,r.type=n.getTypeKind(e.type,ye,Ti.object()),r.instances=e.instances&&e.instances.length?e.instances.map(function(t){return r.type.fromJson(t)}):[],r.methods=r.decodeMethods(n,e.methods),r.transcoders=r.decodeTranscoders(n,e.transcoders),r.indexes=r.decodeIndexes(e.indexes),r.primaryType=o(e.primaryType)?e.primaryType:yi.AUTO_INCREMENT,r.key=e.key?n.getExpression(e.key):r.getPrimaryKeyExpression(),r.keyType=r.key.getType(n,r.getKeyContext()),r.describe=e.describe?n.getExpression(e.describe):wn.noop(),r}return _i(e,t),e.create=function(t,n){return void 0===n&&(n={}),new e(Mi({name:"",description:"",meta:null,type:Ti.object(),instances:[],methods:Object.create(null)},n),t)},e.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},e.prototype.sync=function(t,n){var r=this;this.hasChanges(t)&&(this.name=t.name,this.description=t.description,this.meta=t.meta,this.type=n.getTypeKind(t.type,ye,Ti.object()),this.instances=t instanceof e?t.instances:t.instances&&t.instances.length?t.instances.map(function(t){return r.type.fromJson(t)}):[],x(this.methods,this.decodeMethods(n,t.methods),function(t,e,n){return r.addMethod(n,!0)},function(t,e){return r.removeMethod(e,!0)},function(t,e,r,o){return r.sync(o,n)}),x(this.transcoders,this.decodeTranscoders(n,t.transcoders),function(t,e,o){return r.addTranscoder(n,e,o,!0)},function(t,e){return r.removeTranscoder(e,!0)},function(t,e,o,i){return r.addTranscoder(n,e,i,!0)}),x(this.indexes,this.decodeIndexes(t.indexes),function(t,e,n){return r.addIndex(e,n,!0)},function(t,e){return r.removeIndex(e,!0)},function(t,e,n,o){return r.addIndex(e,o,!0)}),this.primaryType=o(t.primaryType)?t.primaryType:yi.AUTO_INCREMENT,this.key=t.key?n.getExpression(t.key):this.getPrimaryKeyExpression(),this.keyType=this.key.getType(n,this.getKeyContext()),this.describe=t.describe?n.getExpression(t.describe):wn.noop(),this.trigger("sync",this,t,n),this.trigger("change",this))},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.trigger("change",this)},e.prototype.decodeMethods=function(t,e){var n=this;return e?O(e,function(e){return n.decodeMethod(t,e)}):{}},e.prototype.decodeMethod=function(t,e){return e instanceof Pi?e:Pi.create(t,e)},e.prototype.decodeTranscoders=function(t,e){var n=this;return e?O(e,function(e){return n.decodeTranscoder(t,e)}):{}},e.prototype.decodeTranscoder=function(t,e){return e.encode instanceof V?e:{encode:t.getExpression(e.encode),decode:t.getExpression(e.decode),encodedType:t.getType(e.encodedType)}},e.prototype.decodeIndexes=function(t){return t?O(t,function(t,e){var n=t.unique,r=t.primary;return{name:e,props:t.props,unique:n,primary:r}}):{}},e.prototype.encode=function(){var t=this,e=t.name,n=t.description,r=t.meta,o=t.type,i=t.instances,s=t.methods,a=t.key,u=t.describe,p=t.transcoders,c=t.indexes;return{name:e,description:n,meta:r,type:o.encode(),instances:i.map(function(t){return o.toJson(t)}),methods:O(s,function(t){return t.encode()}),key:a.encode(),describe:u.encode(),transcoders:O(p,function(t){var e=t.encode,n=t.decode,r=t.encodedType;return{encode:e.encode(),decode:n.encode(),encodedType:r.encode()}}),indexes:O(c,function(t){return{props:t.props,unique:t.unique,primary:t.primary}})}},e.prototype.canStore=function(t){if(!(this.primaryType!==yi.GIVEN||this.keyType&&t.keyExpectedType.acceptsType(this.keyType)))return!1;var e=this.describe.getType(t,this.getDescribeContext());return!(!e||!t.describeExpectedType.acceptsType(e))},e.prototype.updateKeyType=function(t){var e=this.key.getType(t,this.getKeyContext());e&&(this.keyType=e)},e.prototype.renameProp=function(t,e){var n=this,r=!1,o=this.transcoders[t];o&&(delete this.transcoders[t],this.transcoders[e]=o,r=!0),E(this.indexes,function(o){var i=o.props.indexOf(t);-1!==i&&(o.props[i]=e,n.updateIndex(o.name,!0),r=!0)}),this.trigger("renameProp",this,e,t),r&&this.changed()},e.prototype.removeProp=function(t){var e=this,n=!1;t in this.transcoders&&(this.removeTranscoder(t,!0),n=!0),E(this.indexes,function(r,o){var i=r.props.indexOf(t);-1!==i&&(r.props.splice(i,1),n=!0,0===r.props.length?e.removeIndex(o,!0):e.updateIndex(o,!0))}),this.trigger("removeProp",this,t),n&&this.changed()},e.prototype.getEntityProps=function(){var t=this,e=this.getPrimary(),n=e.props.map(function(n,r){return[n,e.types&&e.types[r]?e.types[r]:t.type.options.props[n]]});return{type:fi.PRIMARY,props:n}},e.prototype.getKey=function(t,e){var n=this.type,r=this.key;return t.run(r,{instance:e,type:n})},e.prototype.setKey=function(t){if(this.primaryType!==yi.GIVEN){var n=this.getDynamicPrimaryKey();if(!t[n])switch(this.primaryType){case yi.AUTO_INCREMENT:t[n]=this.instances.reduce(function(t,e){return Math.max(t,e[n])},0)+1;break;case yi.UUID:t[n]=e.uuid()}}},e.prototype.getDescribe=function(t,e){var n=this.type,r=this.describe;return t.run(r,{instance:e,type:n})},e.prototype.getDecodedPropertyTypes=function(){return this.type.options.props},e.prototype.getPropertyTypeFor=function(t){return t?Ti.enumForText([t]):this.getPropertyType()},e.prototype.getEncodedPropertyTypes=function(){var t=this;return O(this.type.options.props,function(e,n){return n in t.transcoders?t.transcoders[n].encodedType:e})},e.prototype.getEncodedType=function(){return Ti.object(this.getEncodedPropertyTypes())},e.prototype.getDecodedType=function(){return this.type},e.prototype.getProperties=function(){return Object.keys(this.getDecodedPropertyTypes())},e.prototype.getPropertyType=function(){return Ti.enumForText(this.getProperties())},e.prototype.getKeyReturnType=function(){return this.keyType},e.prototype.getKeyContext=function(){return Ti.object({instance:this.type,type:Ti.text()})},e.prototype.getDescribeContext=function(){return Ti.object({instance:this.type,type:Ti.text()})},e.prototype.getEncoded=function(t,e){var n={};for(var r in this.getDecodedPropertyTypes())n[r]=this.getEncodedValue(t,e,r);return n},e.prototype.getEncodedValue=function(t,e,n){var r=this.name,o=this.transcoders,i=n in o?o[n].encode:null,s=e[n];return i?t.run(i,{name:r,instance:e,property:n,value:s}):s},e.prototype.getEncodeContext=function(t){var e=Ti.enumForText([this.name]),n=this.getDecodedType(),r=this.getPropertyTypeFor(t),o=this.getDecodeExpected(t);return Ti.object({name:e,instance:n,property:r,value:o})},e.prototype.getEncodeExpected=function(t,e){return void 0===e&&(e=Ti.any()),t&&t in this.transcoders?this.transcoders[t].encodedType:e},e.prototype.getDecoded=function(t,e){var n={};for(var r in this.getDecodedPropertyTypes())n[r]=this.getDecodedValue(t,e,r);return n},e.prototype.getDecodedValue=function(t,e,n){var r=this.name,o=this.transcoders,i=n in o?o[n].decode:null,s=e[n];return i?t.run(i,{name:r,instance:e,property:n,value:s}):s},e.prototype.getDecodeContext=function(t,e){var n=Ti.enumForText([this.name]),r=this.getEncodedType(),o=this.getPropertyTypeFor(t),i=this.getEncodeExpected(t,e);return Ti.object({name:n,instance:r,property:o,value:i})},e.prototype.getDecodeExpected=function(t){return t&&this.type.options.props[t]||Ti.any()},e.prototype.getIndexExpectedType=function(){return Ti.set(this.getPropertyType())},e.prototype.getDynamicPrimaryKey=function(){var t=this.type.options.props;return"id"in t?"_id"in t?"__id":"_id":"id"},e.prototype.getPrimaryKeyExpression=function(t,e){void 0===t&&(t="/"),void 0===e&&(e="primary");var n=this.getPrimary(e);return n.props.length>1?wn.op(pn.join,{list:n.props.map(function(t){return wn.get("instance",t)}),delimiter:wn.const(t),toText:wn.op(ut.asText,{value:wn.get("item")})}):wn.get("instance",n.props[0])},e.prototype.getPrimary=function(t,n){void 0===t&&(t="primary"),void 0===n&&(n=!0);var r=t in this.indexes?this.indexes[t]:S(this.indexes,function(t,e,n){return n||(t.primary?t:n)},null);return r||(n?{name:t,props:[this.getDynamicPrimaryKey()],types:[e.PRIMARY_TYPES[this.primaryType]],unique:!0,primary:!0}:null)},e.prototype.getUniqueIndexes=function(){return S(this.indexes,function(t,e,n){return t.unique&&n.push(t),n},[])},e.prototype.addPrimary=function(t){return this.addIndex("primary",{props:s(t)?t:[t],unique:!0,primary:!0}),this.primaryType=yi.GIVEN,this},e.prototype.addIndex=function(t,e,n){void 0===n&&(n=!1);var r=this.indexes[t],o=Mi(Mi({},e),{name:t});return this.indexes[t]=o,r?this.trigger("updateIndex",this,o,r):this.trigger("addIndex",this,o),n||this.changed(),this},e.prototype.updateIndex=function(t,e){void 0===e&&(e=!1);var n=this.indexes[t];return this.trigger("updateIndex",this,n,n),e||this.changed(),this},e.prototype.removeIndex=function(t,e){void 0===e&&(e=!1);var n=this.indexes[t];return delete this.indexes[t],this.trigger("removeIndex",this,n),e||this.changed(),this},e.prototype.renameIndex=function(t,e){var n=this.indexes[t];if(n&&t!==e){var r=Mi(Mi({},n),{props:n.props.slice()});n.name=e,delete this.indexes[t],this.indexes[e]=n,this.trigger("updateIndex",this,n,r),this.changed()}return this},e.prototype.addTranscoder=function(t,e,n,r){void 0===r&&(r=!1);var o=this.transcoders[e],i=this.decodeTranscoder(t,n);return this.transcoders[e]=i,o?this.trigger("updateTranscoder",this,name,i,o):this.trigger("addTranscoder",this,name,i),r||this.changed(),this},e.prototype.removeTranscoder=function(t,e){void 0===e&&(e=!1);var n=this.transcoders[t];return n&&(delete this.transcoders[t],this.trigger("removeTranscoder",this,t,n),e||this.changed()),this},e.prototype.updateTranscoder=function(t,e){void 0===e&&(e=!1);var n=this.transcoders[t];return n&&(this.trigger("updateTranscoder",this,t,n,n),e||this.changed()),this},e.prototype.addMethod=function(t,e){void 0===e&&(e=!1);var n=this.methods[t.name];return this.methods[t.name]=t,n?this.trigger("updateMethod",this,t,n):this.trigger("addMethod",this,t),e||this.changed(),this},e.prototype.renameMethod=function(t,e,n){void 0===n&&(n=!1);var r=this.methods[t];return r&&t!==e&&(r.name=e,delete this.methods[t],this.methods[e]=r,this.trigger("updateMethod",this,r,r),n||this.changed()),this},e.prototype.removeMethod=function(t,e){void 0===e&&(e=!1);var n=this.methods[t];return n&&(delete this.methods[t],this.trigger("removeMethod",this,n),e||this.changed()),this},e.PRIMARY_TYPES=((li={})[yi.GIVEN]=null,li[yi.AUTO_INCREMENT]=Ti.int(1),li[yi.UUID]=Ti.text({min:36,max:36,forceLower:!0,matches:/^[\da-f]{8}\-[\da-f]{4}\-[\da-f]{4}\-[\da-f]{4}\-[\da-f]{12}$/i}),li),e}(Ei),ji=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ki=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};!function(t){t[t.HAS_MANY=0]="HAS_MANY",t[t.BELONGS_TO=1]="BELONGS_TO",t[t.HAS_ONE=2]="HAS_ONE",t[t.ONE=3]="ONE",t[t.HAS_ONE_POLYMORPHIC=4]="HAS_ONE_POLYMORPHIC",t[t.ONE_POLYMORPHIC=5]="ONE_POLYMORPHIC"}(Ii||(Ii={})),function(t){t[t.NONE=0]="NONE",t[t.CASCADE=1]="CASCADE",t[t.SET_NULL=2]="SET_NULL",t[t.RESTRICT=3]="RESTRICT"}(Ci||(Ci={}));var Ai=function(t){function e(e,n){var r=t.call(this)||this;return r.defs=e,r.name=n.name,r.kind=n.kind,r.subject=n.subject,r.subjectRelationName=n.subjectRelationName||n.related[0].name,r.morphs=n.morphs?r.decodeTypePair(n.morphs):null,r.morphsToRelated=g(n.morphsToRelated),r.related=n.related,r.relatedRelationName=n.relatedRelationName||n.subject.name,r.relatedToMorphs=T(r.morphsToRelated),r.multiple=!!n.multiple,r.required=!!n.required,r.owns=!!n.owns,r.extension=!!n.extension,r}return ji(e,t),e.prototype.sync=function(t,e){this.hasChanges(t)&&(this.name=t.name,this.kind=t.kind,this.subject=t.subject,this.subjectRelationName=t.subjectRelationName||t.related[0].name,this.morphs=t.morphs?this.decodeTypePair(t.morphs):null,this.morphsToRelated=g(t.morphsToRelated),this.related=t.related,this.relatedRelationName=t.relatedRelationName||t.subject.name,this.relatedToMorphs=T(this.morphsToRelated),this.multiple=!!t.multiple,this.required=!!t.required,this.owns=!!t.owns,this.extension=!!t.extension,this.trigger("sync",this,t,e),this.changed())},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.trigger("changed",this)},e.prototype.decodeTypePair=function(t){var e=ki(t,2),n=e[0],r=e[1];return[n,this.defs.getType(r)]},e.prototype.encodeTypePair=function(t){return t?[t[0],t[1].encode()]:null},e.prototype.encode=function(){var t=this,e=t.name,n=t.kind,r=t.subject,o=t.subjectRelationName,i=t.morphs,s=t.morphsToRelated,a=t.related,u=t.relatedRelationName,p=t.multiple,c=t.required,l=t.owns,f=t.extension;return{name:e,kind:n,subject:r,subjectRelationName:o,morphs:this.encodeTypePair(i),morphsToRelated:Array.from(s.entries()),related:a,relatedRelationName:u,multiple:p,required:c,owns:l,extension:f}},e.prototype.getRelatedWithName=function(t,e){return e.find(function(e){return e.name===t})},e.prototype.rename=function(t,e){this.renameReference(t,e,[this.subject]),this.renameReference(t,e,this.related),this.changed()},e.prototype.renameReference=function(t,e,n){var r=this.getRelatedWithName(t,n);r&&(r.name=e)},e.prototype.remove=function(t){this.removeReference(t,[this.subject]),this.removeReference(t,this.related),this.changed()},e.prototype.removeReference=function(t,e){var n=e.findIndex(function(e){return e.name===t});-1!==n&&(e.splice(n,1),e[n].props=[])},e.prototype.renameProp=function(t,e,n){this.renamePropReference(t,e,n,[this.subject]),this.renamePropReference(t,e,n,this.related),this.changed()},e.prototype.renamePropReference=function(t,e,n,r){var o=this.getRelatedWithName(t,r);if(o){var i=o.props.indexOf(e);-1!==i&&(o.props[i]=n)}},e.prototype.removeProp=function(t,e){this.removePropReference(t,e,[this.subject]),this.removePropReference(t,e,this.related),this.changed()},e.prototype.removePropReference=function(t,e,n){var r=n.findIndex(function(e){return e.name===t});if(-1!==r){var o=n[r],i=o.props.indexOf(e);if(-1!==i&&(o.props.splice(i,1),0===o.props.length))return n.splice(r,1),!0}return!1},e.prototype.getPropTypes=function(t){var e=this,n=[];return t.forEach(function(t){var r=t.name,o=t.props,i=e.defs.getEntity(r).getEntityProps();o.forEach(function(t,e){var r=i.props[e][1];n[e]=n[e]?Ti.merge(n[e],r):r.clone()})}),n},e.prototype.isEmpty=function(){return 0===this.subject.props.length||0===this.related.length},e.prototype.getItemType=function(t){var e=this,n=t.map(function(t){return e.defs.getType(t.name)});return n.length>1?Ti.many(n):n[0]},e.prototype.getSubjectRelation=function(t){if(this.subject.name!==t)return null;var e=this.subjectRelationName,n=this.subject.props,r=this.related,o=this.getItemType(r),i=this.owns&&this.multiple?Ci.CASCADE:this.required?Ci.RESTRICT:Ci.SET_NULL,s=this.required?o:Ti.optional(o),a={relation:this,name:e,kind:this.kind===Ii.HAS_MANY?Ii.BELONGS_TO:this.kind,local:n,cascade:i,related:r,itemType:o,relationType:s};return this.morphs&&(a.morphs=this.morphs,a.morphsToRelated=this.morphsToRelated,a.relatedToMorphs=this.relatedToMorphs),a},e.prototype.getRelatedRelation=function(t){var e=this.getRelatedWithName(t,this.related);if(!e)return null;var n=this.relatedRelationName,r=e.props,o=[this.subject],i=this.getItemType(o),s=Ci.NONE,a=this.multiple?Ti.list(i):this.required?i:Ti.optional(i),u={relation:this,name:n,kind:this.kind===Ii.HAS_MANY?Ii.HAS_MANY:this.morphs?Ii.ONE_POLYMORPHIC:Ii.ONE,local:r,cascade:s,related:o,itemType:i,relationType:a};return this.morphs&&(u.where=[this.morphs[0],this.relatedToMorphs.get(t)]),u},e.prototype.getTypeProps=function(t){var e=[];if(this.subject.name===t){var n=this.getPropTypes(this.related),r=this.subject.props.map(function(t,e){return[t,n[e]]});e.push({type:fi.FOREIGN,props:r,relation:this}),this.morphs&&e.push({type:fi.NONE,props:[this.morphs],relation:this})}return e},e.hasMany=function(t,n){var r=n.oneRelationName||n.many,o=n.manyRelationName||n.one,i=n.foreignKeyPrefix||o+"_",s=n.name||o+"_hasMany_"+r,a=t.getEntity(n.one).getPrimary().props,u=a.map(function(t){return i+t});return new e(t,{name:s,kind:Ii.HAS_MANY,subject:{name:n.many,props:u},subjectRelationName:o,related:[{name:n.one,props:a}],relatedRelationName:r,multiple:!0,owns:!1!==n.owns,required:!1!==n.owns})},e.belongsTo=function(t,e){return this.hasMany(t,{name:e.name,one:e.belongsTo,many:e.oneOfMany,oneRelationName:e.belongsToRelationName,manyRelationName:e.oneOfManyRelationName,foreignKeyPrefix:e.foreignKeyPrefix,owns:e.owns})},e.hasOne=function(t,n){var r=n.oneRelationName||n.hasOne,o=n.hasOneRelationName||n.one,i=n.foreignKeyPrefix||o+"_",s=n.name||o+"_hasOne_"+r,a=t.getEntity(n.one).getPrimary().props,u=a.map(function(t){return i+t});return new e(t,{name:s,kind:Ii.HAS_ONE,subject:{name:n.hasOne,props:u},subjectRelationName:o,related:[{name:n.one,props:a}],relatedRelationName:r,required:n.required,owns:n.owns})},e.belongsToOne=function(t,e){return this.hasOne(t,{name:e.name,hasOne:e.belongsTo,one:e.one,required:e.required,owns:e.owns,hasOneRelationName:e.belongsToRelationName,oneRelationName:e.oneRelationName,foreignKeyPrefix:e.foreignKeyPrefix})},e.hasOnePolymorphic=function(t,n){var r=n.hasOneRelationName,o=n.polyRelationName||n.hasOne,i=n.name||r+"_hasOnePolymorphic_"+o,s=n.foreignKeyPrefix||r+"_",a=n.poly.map(function(e){return{name:e,props:t.getEntity(e).getPrimary().props}}),u=a[0].props.map(function(t){return s+t});return new e(t,{name:i,kind:Ii.HAS_ONE_POLYMORPHIC,subject:{name:n.hasOne,props:u},subjectRelationName:r,related:a,relatedRelationName:o,morphs:n.morphs,morphsToRelated:n.morphsToRelated,required:n.required,owns:n.owns})},e}(Ei),Ni=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Li=function(){return(Li=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ri=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e.name,r.author=e.author,r.description=e.description,r.meta=e.meta,r.created=e.created,r.updated=e.updated,r.dataType=n.getType(e.dataType),r.expression=n.getExpression(e.expression),r.datasets=e.datasets.map(function(t){return Li(Li({},t),{data:r.dataType.fromJson(t.data)})}),r}return Ni(e,t),e.create=function(t,n){void 0===n&&(n={});var r=(new Date).getTime();return new e(Li({name:name,author:"",description:"",meta:null,created:r,updated:r,dataType:Ti.object(),datasets:[{name:"Data Set #1",data:Object.create(null),created:r,updated:r,meta:null}],expression:ft.instance},n),t)},e.prototype.sync=function(t,n){var r=this;this.hasChanges(t)&&(this.name=t.name,this.author=t.author,this.description=t.description,this.meta=t.meta,this.created=t.created,this.updated=t.updated,this.dataType=t instanceof e?t.dataType:n.getType(t.dataType),this.expression=t instanceof e?t.expression:n.getExpression(t.expression),b(this.datasets,t instanceof e?t.datasets:t.datasets.map(function(t){return Li(Li({},t),{data:r.dataType.fromJson(t.data)})}),function(t,e){return t.name===e.name||t.created===e.created},function(t,e){return r.addDataset(e,!0)},function(t,e,n){return r.removeDataset(e,!0)},function(t,e,n,o){return r.updateDataset(n,o,!0)}),this.trigger("sync",this,t,n),this.changed())},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.trigger("changed",this)},e.prototype.encode=function(){var t=this,e=t.name,n=t.author,r=t.description,o=t.meta,i=t.created,s=t.updated,a=t.dataType,u=t.datasets,p=t.expression;return{name:e,author:n,description:r,meta:o,created:i,updated:s,dataType:a.encode(),datasets:u.map(function(t){return Li(Li({},t),{data:a.toJson(t.data)})}),expression:p.encode()}},e.prototype.addDataset=function(t,e){void 0===e&&(e=!1),this.datasets.push(t),this.trigger("addDataset",this,t),e||this.changed()},e.prototype.updateDataset=function(t,e,n){void 0===n&&(n=!1);var r=o(t)?this.datasets[t]:t,i=!!r;return i&&(Object.assign(r,e),this.trigger("updateDataset",this,r),n||this.changed()),i},e.prototype.removeDataset=function(t,e){void 0===e&&(e=!1);var n=o(t)?t:this.datasets.indexOf(t),r=n>=0&&n<this.datasets.length;if(r){var i=this.datasets[n];this.trigger("removeDataset",this,i),e||this.changed()}return r},e.prototype.refactor=function(t,e){var n=e.getCommand(t);this.datasets.forEach(function(t){t.data=n({value:t.data})}),this.changed()},e}(Ei),qi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vi=function(){return(Vi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Fi=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e.name,r.meta=e.meta,r.dataType=n.getType(e.dataType),r.data=r.dataType.fromJson(e.data),r}return qi(e,t),e.create=function(t,n){return void 0===n&&(n={}),new e(Vi({name:"",dataType:Ti.object(),data:Object.create(null),meta:null},n),t)},e.prototype.sync=function(t,n){this.hasChanges(t)&&(this.name=t.name,this.meta=t.meta,this.dataType=t instanceof e?t.dataType:n.getType(t.dataType),this.data=t instanceof e?t.data:this.dataType.fromJson(t.data),this.trigger("sync",this,t,n),this.changed())},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.trigger("changed",this)},e.prototype.encode=function(){var t=this.name,e=this.meta,n=this.dataType,r=this.data;return{name:t,meta:e,dataType:n.encode(),data:n.toJson(r)}},e.prototype.refactor=function(t,e){this.data=e.run(t,{value:this.data}),this.changed()},e}(Ei),Yi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gi=function(t){function e(e,n){var r=t.call(this,e)||this;return r.provider=n,r}return Yi(e,t),e.decode=function(t,n){return new e(t[1],n)},e.encode=function(t){return[this.id,t.options]},e.describe=function(t,e){return null},e.register=function(){},e.prototype.getType=function(){if(!this.provider)return ct.baseType;var t=this.provider.getData(this.options);return t?t.dataType:ct.baseType},e.prototype.getOperations=function(){return this.getType().getOperations()},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return this.getType().getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.getType().getSubTypes(t)},e.prototype.getExactType=function(t){return this.getType().getExactType(t)},e.prototype.getSimplifiedType=function(){return this.getType().getSimplifiedType()},e.prototype.isDeepCompatible=function(t,n){return t instanceof e?this.getType().isCompatible(t.getType(),n):this.getType().isCompatible(t,n)},e.prototype.isOptional=function(){return this.getType().isOptional()},e.prototype.isSimple=function(){return this.getType().isSimple()},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.traverse=function(t){var n=this;return t.enter(this,function(){return t.step(e.STEP_REFERENCED,n.getType(),function(t){return t instanceof e?n.options=t.options:0})})},e.prototype.getTypeFromStep=function(t){return t===e.STEP_REFERENCED?this.getType():null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return this.getType().getCreateExpression()},e.prototype.getValidateExpression=function(){return this.getType().getValidateExpression()},e.prototype.getCompareExpression=function(){return this.getType().getCompareExpression()},e.prototype.getValueChangeExpression=function(t,e,n){return t},e.prototype.isValid=function(t){return this.getType().isValid(t)},e.prototype.normalize=function(t){return this.getType().normalize(t)},e.prototype.newInstance=function(){return new e(this.options,this.provider)},e.prototype.clone=function(){return new e(this.options,this.provider)},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.getType().create()},e.prototype.random=function(t){return this.getType().random(t)},e.prototype.fromJson=function(t){return this.getType().fromJson(t)},e.prototype.toJson=function(t){return this.getType().toJson(t)},e.STEP_REFERENCED="referenced",e.id=U.Reference,e.operations=new G(U.Reference+U.Delimiter),e.computeds=new B(U.Reference+U.Delimiter),e.baseType=new e("",null),e.describePriority=-1,e.registered=!1,e}(R),Bi=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ui=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Wi=function(){function t(t){this.clear(),t&&this.merge(t)}return t.prototype.reset=function(t){this.clear(),this.merge(t)},t.prototype.merge=function(e){var n,r,o,i;if(e instanceof Map)try{for(var a=Bi(e.entries()),u=a.next();!u.done;u=a.next()){var p=Ui(u.value,2),c=p[0],l=p[1];this.set(c,l)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}else if(e instanceof t)for(var y=0;y<e.length();y++)this.set(e.keyAt(y),e.valueAt(y));else if(s(e))try{for(var d=Bi(e),h=d.next();!h.done;h=d.next()){var v=Ui(h.value,2);c=v[0],l=v[1];this.set(c,l)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}else if(f(e))for(var c in e)this.set(c,e[c])},t.prototype.sync=function(e,n){var r=this,o=new t(e);this.filter(function(t,e){return o.has(e)}),o.forEach(function(t,e){r.has(e)&&n?n(r.get(e),t):r.set(e,t)})},t.prototype.clear=function(){this.indexes=Object.create(null),this.keys=[],this.values=[]},t.prototype.length=function(){return this.keys.length},t.prototype.valueAt=function(t){return this.values[t]},t.prototype.keyAt=function(t){return this.keys[t]},t.prototype.pairAt=function(t){return[this.keys[t],this.values[t]]},t.prototype.has=function(t){return i(t)?t in this.indexes:this.values.includes(t)},t.prototype.set=function(t,e){var n=this.indexes[t];o(n)?this.values.splice(n,1,e):(this.indexes[t]=this.values.length,this.values.push(e),this.keys.push(t))},t.prototype.rekey=function(t,e){var n=this.indexOf(t),r=-1!==n;return r&&(delete this.indexes[this.keys[n]],this.indexes[e]=n,this.keys.splice(n,1,e)),r},t.prototype.sort=function(t){this.reset(this.toPairs().sort(function(e,n){var r=Ui(e,2),o=(r[0],r[1]),i=Ui(n,2),s=(i[0],i[1]);return t(o,s)}))},t.prototype.sortByKey=function(t){void 0===t&&(t=function(t,e){return t.localeCompare(e)}),this.reset(this.toPairs().sort(function(e,n){var r=Ui(e,2),o=r[0],i=(r[1],Ui(n,2)),s=i[0];i[1];return t(o,s)}))},t.prototype.reindex=function(){for(var t=this.keys,e=Object.create(null),n=0;n<t.length;n++)e[t[n]]=n;this.indexes=e},t.prototype.swap=function(t,e){if(t===e||t<0||e<0||t>=this.keys.length||e>=this.keys.length)return!1;var n=this.keys[t],r=this.values[t],o=this.keys[e],i=this.values[e];return this.indexes[n]=e,this.indexes[o]=t,this.keys.splice(t,1,o),this.keys.splice(e,1,n),this.values.splice(t,1,i),this.values.splice(e,1,r),!0},t.prototype.get=function(t,e){return i(t)?this.values[this.indexes[t]]||e:t},t.prototype.remove=function(t,e){void 0===e&&(e=!1);var n=this.indexOf(t);if(-1!==n){var r=this.keys,o=this.values,i=o[n];if(e)this.removeAt(n);else{delete this.indexes[r[n]];var s=r.pop(),a=o.pop();n!==r.length&&(r.splice(n,1,s),o.splice(n,1,a),this.indexes[s]=n)}return i}},t.prototype.removeAt=function(t){var e=this.keys,n=this.values;if(t<0||t>=e.length)return!1;for(delete this.indexes[e[t]],e.splice(t,1),n.splice(t,1);++t<e.length;)this.indexes[e[t]]--;return!0},t.prototype.move=function(t,e){var n=this.keys,r=this.values;if(t<0||e<0||t>=n.length||e>=n.length)return!1;if(t!==e){var o=r[t],i=n[t];r.splice(t,1),n.splice(t,1),r.splice(e,0,o),n.splice(e,0,i),this.reindex()}return!0},t.prototype.moveToFront=function(t){var e=this.indexOf(t);return-1!==e&&this.move(e,0)},t.prototype.moveToBack=function(t){var e=this.indexOf(t);return-1!==e&&this.move(e,this.keys.length-1)},t.prototype.indexOf=function(t){return i(t)?t in this.indexes?this.indexes[t]:-1:this.values.indexOf(t)},t.prototype.keyOf=function(t){var e=this.values.indexOf(t);return-1===e?void 0:this.keys[e]},t.prototype.toPairs=function(){var t=this;return this.values.map(function(e,n){return[t.keys[n],e]})},t.prototype.toMap=function(){return new Map(this.toPairs())},t.prototype.toObject=function(){for(var t=Object.create(null),e=0;e<this.keys.length;e++)t[this.keys[e]]=this.values[e];return t},t.prototype.clone=function(){return new t(this)},t.prototype.forEach=function(t){for(var e=this.keys,n=this.values,r=0;r<e.length;){var o=e[r];t(n[r],o),e[r]===o&&r++}},t.prototype.filter=function(t){for(var e=this.values,n=this.keys,r=this.indexes,o=0,i=0;i<e.length;i++){var s=e[i],a=n[i];t(s,a)?(e[o]=s,n[o]=a,r[a]=o,o++):delete r[a]}o<e.length&&(e.splice(o,e.length-o),n.splice(o,n.length-o))},t}(),Hi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ji=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ki=function(t){function e(e){var n=t.call(this)||this;return e&&n.merge(e),n}return Hi(e,t),e.isNamedArray=function(t){return s(t)&&t.length>0&&i(t[0].name)},e.prototype.reset=function(t){this.clear(),this.merge(t)},e.prototype.merge=function(n){var r,o;if(e.isNamedArray(n))try{for(var i=Ji(n),s=i.next();!s.done;s=i.next()){var a=s.value;this.add(a)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}else t.prototype.merge.call(this,n)},e.prototype.sync=function(n,r){t.prototype.sync.call(this,new e(n),r)},e.prototype.syncManual=function(t,n,r,o,i){var s=this,a=new e(t);return i?b(this.values,a.values,i,function(t,e){return n(s,e,e.name)},function(t,e,n){return r(s,n,n.name)},function(t,e,n,r){return o(s,n,r,n.name)}):(this.forEach(function(t,e){var n=a.get(e);void 0===n?r(s,t,e):o(s,t,n,e)}),a.forEach(function(t,e){s.has(e)||n(s,t,e)})),this},e.prototype.rename=function(t,e){var n=this.get(t),r=!!n&&n.name!==e;return r&&(this.rekey(n,e),n.name=e),r},e.prototype.has=function(t){return this.nameOf(t)in this.indexes},e.prototype.add=function(t){this.set(t.name,t)},e.prototype.nameOf=function(t){return i(t)?t:t.name},e.prototype.valueOf=function(t){return i(t)?this.get(t):t},e.prototype.indexOf=function(t){var e=this.indexes[this.nameOf(t)];return o(e)?e:-1},e.prototype.keyOf=function(t){return t.name},e.prototype.clone=function(){return new e(this)},e}(Wi),zi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xi=function(){return(Xi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},$i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Qi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Zi=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Qi(arguments[e]));return t},ts=function(t){function e(e){var n=t.call(this)||this;return n.types=Object.create(null),n.typeList=[],n.describers=[],n.expressions=Object.create(null),n.operations=new G(""),n.computeds=new B(""),n.parsers=Object.create(null),n.entities=new Ki,n.functions=new Ki,n.relations=new Ki,n.programs=new Ki,n.data=new Ki,n.keyExpectedType=Ti.many(Ti.text(),Ti.number()),n.describeExpectedType=Ti.text(),e&&n.add(e),n}return zi(e,t),e.prototype.encodeMap=function(t,e){return void 0===e&&(e=!0),O(t.toObject(),function(t){return e?t.encode():t})},e.prototype.extend=function(t,n){void 0===t&&(t=!1);var r=new e({types:w(this.types),expressions:w(this.expressions),entities:this.encodeMap(this.entities,t),functions:this.encodeMap(this.functions,t),relations:this.encodeMap(this.relations,t),programs:this.encodeMap(this.programs,t),data:this.encodeMap(this.data,t)});return n&&r.add(n),r},e.prototype.changed=function(){this.trigger("changed",this)},e.prototype.add=function(t){var e=this;t.types&&t.types.forEach(function(t){return e.addType(t,!0)}),this.sortDescribers(),t.expressions&&t.expressions.forEach(function(t){return e.addExpression(t)}),this.import(t)},e.prototype.describe=function(t){var e,n;try{for(var r=$i(this.describers),o=r.next();!o.done;o=r.next()){var i=o.value.describe(t,this);if(i)return i}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return dt.baseType},e.prototype.merge=function(t,e){return Ti.merge(t,this.describe(e))},e.prototype.sortDescribers=function(){this.describers.sort(function(t,e){return e.describePriority-t.describePriority})},e.prototype.addType=function(t,e){void 0===e&&(e=!1),this.types[t.id]=t,this.typeList.push(t),this.parsers[t.id]=function(e,n){return t.decode(e,n)},this.describers.push(t),e||this.sortDescribers(),t.registered||(t.registered=!0,t.register())},e.prototype.findEntity=function(t,e){void 0===e&&(e={strict:!0,value:!1,exact:!1});var n=this.entities.values.find(function(n){return n.type.isCompatible(t,e)});return!!n&&n.name},e.prototype.addData=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Fi?t:Fi.create(this,t),o=this.data.get(r.name);return o?(e?o.sync(r,this):this.data.add(r),this.trigger("updateData",this,r)):(this.data.add(r),this.trigger("addData",this,r)),this.trigger("changedData",this),n||this.changed(),this},e.prototype.getData=function(t){return this.data.get(t,null)},e.prototype.getDatas=function(){return this.data},e.prototype.removeData=function(t,e,n,r){void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.data.valueOf(t);return!o||!(e&&this.getDataReferences(o).length>0)&&(this.data.remove(o,n),this.trigger("removeData",this,o),this.trigger("changedData",this),r||this.changed(),!0)},e.prototype.clearData=function(t){void 0===t&&(t=!1);var e=this.data.values.slice();this.data.clear(),this.trigger("clearData",this,e),this.trigger("changedData",this),t||this.changed()},e.prototype.renameData=function(t,e,n){void 0===n&&(n=!1);var r=this.data.valueOf(t),o=r.name;if(!this.data.rename(r,e))return!1;var i=this.getDataReferences(r);return i.forEach(function(t){t.value instanceof Gi?t.value.options=e:t.value.name=e}),r.trigger("renamed",r,o),r.changed(),this.trigger("renameData",this,r,o),this.trigger("changedData",this),n||this.changed(),i},e.prototype.addFunction=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Pi?t:Pi.create(this,t),o=this.functions.get(r.name);return o?(e?o.sync(r,this):this.functions.add(r),this.trigger("updateFunction",this,r)):(this.functions.add(r),this.trigger("addFunction",this,r)),this.trigger("changedFunctions",this),n||this.changed(),this},e.prototype.getFunction=function(t){return this.functions.get(t,null)},e.prototype.getFunctions=function(){return this.functions},e.prototype.addProgram=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Ri?t:Ri.create(this,t),o=this.programs.get(r.name);return o?(e?o.sync(r,this):this.programs.add(r),this.trigger("updateProgram",this,r)):(this.programs.add(r),this.trigger("addProgram",this,r)),this.trigger("changedPrograms",this),n||this.changed(),this},e.prototype.getProgram=function(t){return this.programs.get(t,null)},e.prototype.getPrograms=function(){return this.programs},e.prototype.removeProgram=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r=this.programs.valueOf(t);return!r||(this.programs.remove(r,e),this.trigger("removeProgram",this,r),this.trigger("changedPrograms",this),n||this.changed(),!0)},e.prototype.clearPrograms=function(t){void 0===t&&(t=!1);var e=this.programs.values.slice();this.programs.clear(),this.trigger("clearPrograms",this,e),this.trigger("changedPrograms",this),t||this.changed()},e.prototype.addEntity=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Di?t:Di.create(this,t),o=this.entities.get(r.name);return o?(e?o.sync(r,this):this.entities.add(r),this.trigger("updateEntity",this,r)):(this.entities.add(r),this.trigger("addEntity",this,r)),this.trigger("changedEntities",this),n||this.changed(),this},e.prototype.getEntity=function(t){return this.entities.get(t,null)},e.prototype.getEntities=function(){return this.entities},e.prototype.addRelation=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Ai?t:new Ai(this,t),o=this.relations.get(r.name);return o?(e?o.sync(r,this):this.relations.add(r),this.trigger("updateRelation",this,r)):(this.relations.add(r),this.trigger("addRelation",this,r)),this.trigger("changedRelations",this),n||this.changed(),this},e.prototype.getRelation=function(t){return this.relations.get(t,null)},e.prototype.getRelations=function(t){var e=[];return this.relations.forEach(function(n){var r=n.getSubjectRelation(t);r&&e.push(r);var o=n.getRelatedRelation(t);o&&e.push(o)}),e},e.prototype.getEntityProps=function(t){var e=[],n=this.entities.get(t);return n&&(e.push(n.getEntityProps()),this.relations.forEach(function(n){e.push.apply(e,Zi(n.getTypeProps(t)))})),e},e.prototype.removeRelation=function(t,e,n,r){void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.relations.valueOf(t);return!o||!(e&&this.getRelationReferences(o).length>0)&&(this.relations.remove(o,n),this.trigger("removeRelation",this,o),this.trigger("changedRelations",this),r||this.changed(),!0)},e.prototype.clearRelations=function(t){void 0===t&&(t=!1);var e=this.relations.values.slice();this.relations.clear(),this.trigger("clearRelations",this,e),this.trigger("changedRelations",this),t||this.changed()},e.prototype.renameProgram=function(t,e,n){void 0===n&&(n=!1);var r=this.programs.valueOf(t),o=r.name;return!!this.programs.rename(r,e)&&(r.trigger("renamed",r,o),r.changed(),this.trigger("renameProgram",this,r,o),this.trigger("changedPrograms",this),n||this.changed(),!0)},e.prototype.renameEntity=function(t,e,n){void 0===n&&(n=!1);var r=this.entities.valueOf(t),o=r.name;if(!this.entities.rename(r,e))return!1;this.relations.forEach(function(t){t.rename(name,e)});var i=this.getEntityReferences(name);return i.forEach(function(t){t.value instanceof he?t.value.options=e:t.value.name=e}),r.trigger("renamed",r,o),r.changed(),this.trigger("renameEntity",this,r,o),this.trigger("changedEntities",this),n||this.changed(),i},e.prototype.renameEntityProp=function(t,e,n){var r=this.entities.get(t);r&&(r.renameProp(e,n),this.relations.forEach(function(t){t.renameProp(r.name,e,n)}))},e.prototype.removeEntityProp=function(t,e){var n=this,r=this.entities.get(t);r&&(r.removeProp(e),this.relations.forEach(function(t){t.removeProp(r.name,e),t.isEmpty()&&n.relations.remove(t)}))},e.prototype.removeEntity=function(t,e,n,r){var o=this;void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.entities.valueOf(t);return!i||!(e&&this.getEntityReferences(i).length>0)&&(this.entities.remove(i,n),this.relations.forEach(function(t){t.remove(name),t.isEmpty()&&o.relations.remove(t,n)}),this.trigger("removeEntity",this,i),this.trigger("changedEntities",this),r||this.changed(),!0)},e.prototype.clearEntities=function(t){void 0===t&&(t=!1);var e=this.entities.values.slice();this.entities.clear(),this.trigger("clearEntities",this,e),this.trigger("changedEntities",this),t||this.changed()},e.prototype.refactorEntity=function(t,e,n){var r=this.getEntityDataReferences(t);return r.forEach(function(t){t.root.setParent();var r=t.type.getValueChangeAt(e);t.data=n.run(r,{value:t.data})}),r},e.prototype.renameRelation=function(t,e,n){void 0===n&&(n=!1);var r=this.relations.valueOf(t),o=r.name;if(!this.relations.rename(r,e))return!1;var i=this.getRelationReferences(r);return i.forEach(function(t){t.value.name=e}),r.trigger("renamed",r,o),r.changed(),this.trigger("renameRelation",this,r,o),this.trigger("changedRelations",this),n||this.changed(),i},e.prototype.renameFunction=function(t,e,n){void 0===n&&(n=!1);var r=this.functions.valueOf(t),o=r.name;if(!this.functions.rename(r,e))return!1;var i=this.getFunctionReferences(r);return i.forEach(function(t){t.value.name=e}),r.trigger("renamed",r,o),r.changed(),this.trigger("renameFunction",this,r,o),this.trigger("changedFunctions",this),n||this.changed(),i},e.prototype.renameFunctionParameter=function(t,e,n){var r=this.functions.get(t);if(!r)return!1;if(!r.renameParameter(e,n))return!1;var o=this.getFunctionReferences(t,e);return o.forEach(function(t){t.value.args[n]=t.value.args[e],delete t.value.args[e]}),o},e.prototype.removeFunctionParameter=function(t,e){var n=this.functions.get(t);if(!n)return!1;if(!n.removeParameter(e))return!1;var r=this.getFunctionReferences(t,e);return r.forEach(function(t){delete t.value.args[e]}),r},e.prototype.removeFunction=function(t,e,n,r){void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.functions.valueOf(t);return!o||!(e&&this.getFunctionReferences(o).length>0)&&(this.functions.remove(o,n),this.trigger("removeFunction",this,o),this.trigger("changedFunctions",this),r||this.changed(),!0)},e.prototype.clearFunctions=function(t){void 0===t&&(t=!1);var e=this.functions.values.slice();this.functions.clear(),this.trigger("clearFunctions",this,e),this.trigger("changedFunctions",this),t||this.changed()},e.prototype.getTypeKind=function(t,e,n){void 0===n&&(n=null);var r=this.getType(t);return r instanceof e?r:n},e.prototype.getType=function(t,e){if(t instanceof R)return t;var n=s(t)?t[0]:t,r=s(t)?t:[],o=this.parsers[n];if(!o){if(this.entities.has(n))return this.entities.get(n).type;if(e)return e;throw new Error("No parser found for "+n+" with payload "+JSON.stringify(r))}return o(r,this)},e.prototype.getBaseTypes=function(){return this.typeList.map(function(t){return t.baseType})},e.prototype.getSimpleTypes=function(){return this.getBaseTypes().filter(function(t){return t.isSimple()})},e.prototype.getComplexTypes=function(){return this.getBaseTypes().filter(function(t){return!t.isSimple()})},e.prototype.getSimpleTypeClasses=function(){return this.typeList.filter(function(t){return t.baseType.isSimple()})},e.prototype.getComplexTypeClasses=function(){return this.typeList.filter(function(t){return!t.baseType.isSimple()})},e.prototype.getComputed=function(t){var e=this.computeds.get(t);if(e)return e;var n=Qi(t.split(U.Delimiter),1)[0],r=this.types[n];return r?r.computeds.get(t):null},e.prototype.getComputedReturnType=function(t,e){var n;void 0===e&&(e=null);var r=this.getComputed(t);if(!r)return null;var o=this.getOperation(r.op),i=this.getOperationTypes(r.op);return o&&i?this.getOperationInputType(i.returnType,((n={})[r.value]=e,n)):null},e.prototype.getComputedsFor=function(t){var e=this.types[t.getId()];return e?e.computeds.list:[]},e.prototype.hasComputed=function(t,e){var n=this.types[t.getId()];return!!n&&!!n.computeds.get(e)},e.prototype.getOperation=function(t){var e=this.operations.get(t);if(e)return e;var n=Qi(t.split(U.Delimiter),1)[0],r=this.types[n];return r?r.operations.get(t):null},e.prototype.getOperationTypes=function(t){var e=this.operations.getTypes(t);if(e)return e;var n=Qi(t.split(U.Delimiter),1)[0],r=this.types[n];return r?r.operations.getTypes(t):null},e.prototype.getOperationReturnType=function(t,e,n,r){var o=this.getOperation(t),i=this.getOperationTypes(t);if(!o||!i)return null;var s=i.returnType;if(s instanceof R)return s;if(!F(s))return s.baseType.newInstance();var a=o.resultDependency.length>0?this.getOperationParamTypes(t,e,n,r,i.rawTypes):{};return this.getOperationInputType(i.returnType,a)},e.prototype.getOperationExpectedTypes=function(t,e,n,r,o){var i=this;void 0===o&&(o=!1);var s=this.getOperationTypes(t);if(!s)return{};var a=this.getOperationParamTypes(t,e,n,r,o);return O(a,function(t,e){return i.getOperationInputType(s.params[e]||s.optional[e]||t,a)})},e.prototype.getOperationParamTypes=function(t,e,n,r,o){var i,s,a,u,p,c;void 0===o&&(o=!1);var l={},f=this.getOperation(t),y=this.getOperationTypes(t);if(!f||!y)return l;for(var d in e){if(-1===f.hasScope.indexOf(d))(O=e[d].getType(this,r))&&(l[d]=o?O:O.getSimplifiedType())}var h=this.getContextWithScope(r),v=h.context,m=h.scope;try{for(var g=$i(f.scope),T=g.next();!T.done;T=g.next()){var b=T.value,x=this.getOperationInputType(y.scope[b],l);if(x)m[n[b]||b]=o?x:x.getSimplifiedType()}}catch(t){i={error:t}}finally{try{T&&!T.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}for(var d in e){var O;if(-1!==f.hasScope.indexOf(d))(O=e[d].getType(this,v))&&(l[d]=o?O:O.getSimplifiedType())}try{for(var E=$i(f.params),w=E.next();!w.done;w=E.next()){l[d=w.value]||(l[d]=this.getOperationInputType(y.params[d],l))}}catch(t){a={error:t}}finally{try{w&&!w.done&&(u=E.return)&&u.call(E)}finally{if(a)throw a.error}}try{for(var S=$i(f.optional),P=S.next();!P.done;P=S.next()){l[d=P.value]||(l[d]=this.getOperationInputType(y.optional[d],l))}}catch(t){p={error:t}}finally{try{P&&!P.done&&(c=S.return)&&c.call(S)}finally{if(p)throw p.error}}return l},e.prototype.getOperationScopeContext=function(t,e,n,r){var o,i,s=this.getOperation(t),a=this.getOperationTypes(t),u=this.getContextWithScope(r),p=u.context,c=u.scope;try{for(var l=$i(s.scope),f=l.next();!f.done;f=l.next()){var y=f.value,d=this.getOperationInputType(a.scope[y],e);if(d)c[n[y]||y]=d.getSimplifiedType()}}catch(t){o={error:t}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return p},e.prototype.getContextWithScope=function(t,e){return void 0===e&&(e={}),{context:t instanceof ye?new ye({props:e=Xi(Xi({},t.options.props),e)}):new Mo([new ye({props:e}),t]),scope:e}},e.prototype.getContext=function(t,e){return this.getContextWithScope(t,e).context},e.prototype.getOperationMapping=function(t,e,n){var r,o,i,s,a=this,u=this.getOperation(t),p=this.getOperationTypes(n),c=u.params.concat(u.optional),l=this.getOperation(n),f=this.getOperationTypes(n),y=Object.create(null),d=Object.create(null),h=w(e,function(t,e){return[e,t,c.indexOf(e)]}).filter(function(t){return Qi(t,3)[2]>=0}).sort(function(t,e){return Qi(t,3)[2]-Qi(e,3)[2]}),v=function(t,e){if(0===h.length)return null;var n=-1;if(F(e))-1===(n=h.findIndex(function(n){var r,o=Qi(n,2)[1];return o.acceptsType(Ti.parse(e(Xi(Xi({},d),((r={})[t]=o,r)),a)))}))&&(n=h.findIndex(function(n){var r,o=Qi(n,2)[1];return Ti.parse(e(Xi(Xi({},d),(r={},r[t]=o,r)),a)).acceptsType(o)}));else{var r=Ti.parse(e);n=h.findIndex(function(t){var e=Qi(t,2)[1];return r.acceptsType(e)})}if(-1===n)return null;var o=h[n];h.splice(n,1),y[o[0]]=t,d[t]=o[1]};try{for(var m=$i(l.params),g=m.next();!g.done;g=m.next()){var T=g.value;if(null===v(T,f.params[T]))return null}}catch(t){r={error:t}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var b=$i(l.optional),x=b.next();!x.done;x=b.next()){var O=x.value;v(O,f.optional[O])}}catch(t){i={error:t}}finally{try{x&&!x.done&&(s=b.return)&&s.call(b)}finally{if(i)throw i.error}}var E=h.map(function(t){return Qi(t,1)[0]});return{from:u,fromTypes:p,to:l,toTypes:f,mapping:y,unmapped:E}},e.prototype.getOperationInputType=function(t,e){return t instanceof R?t:"baseType"in t?t.baseType.clone():e?Ti.parse(t(e,this)):null},e.prototype.getOperationsForExpression=function(t,e){var n=t.getType(this,e);return n?this.getOperationsForType(n.getSimplifiedType()):[]},e.prototype.getOperationsWithMapping=function(t,e){var n=this;return this.getOperations().map(function(r){var o=r.op;return n.getOperationMapping(t,e,o.id)}).filter(function(t){return!!t})},e.prototype.getOperationsForType=function(t,e){var n=this;return void 0===e&&(e=!1),this.getOperations(function(r){var o,i=r.op,s=r.types,a=i.params[0],u=s.params[a];if(u){var p=n.getOperationInputType(u,((o={})[a]=t,o));if(p){if(t.acceptsType(p))return!0;if(e&&i.resultDependency.length>0&&F(s.returnType)&&(p instanceof dt||p instanceof ct))return!0}}return!1})},e.prototype.getOperationsWithReturnExpression=function(t,e,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var o=t.getType(this,e);return o?this.getOperationsWithReturnType(o.getSimplifiedType(),n,r):[]},e.prototype.getOperationsWithReturnType=function(t,e,n){var r=this;return void 0===e&&(e={}),void 0===n&&(n=!1),this.getOperations(function(o){var i=o.op,s=o.types,a=r.getOperationInputType(s.returnType,e);if(a){if(t.acceptsType(a))return!0;if(n&&i.resultDependency.length>0&&F(s.returnType)&&(a instanceof dt||a instanceof ct))return!0}return!1})},e.prototype.getOperationsForParamExpressions=function(t,e){var n=this;return this.getOperationsForParamTypes(O(t,function(t){var r=t.getType(n,e);return r?r.getSimplifiedType():void 0}))},e.prototype.getOperationsForParamTypes=function(t){var e=this,n=Object.keys(t);return this.getOperations(function(r){var o,i,s=r.types;try{for(var a=$i(n),u=a.next();!u.done;u=a.next()){var p=u.value,c=s.params[p]||s.optional[p];if(!c)return!1;var l=e.getOperationInputType(c,t);if(!l||!t[p].acceptsType(l))return!1}}catch(t){o={error:t}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return!0})},e.prototype.getOperations=function(t){void 0===t&&(t=function(){return!0});var e=[],n=function(n){var r=n.map;for(var o in r){var i={op:r[o],types:n.types[o]};t(i)&&e.push(i)}};return n(this.operations),E(this.types,function(t){return n(t.operations)}),e},e.prototype.getPathType=function(t,e,n){void 0===n&&(n=t.length);for(var r=!1,o=e,i=0;i<n;i++){if(!(o=o.getSubType(t[i],this,e)))return null;r=r||o.isOptional()}return r&&!o.isOptional()?Ti.optional(o):o},e.prototype.addExpression=function(t){this.expressions[t.id]=t},e.prototype.getExpression=function(t){if(t instanceof V)return t;if(s(t)){var e=this.expressions[t[0]];if(!e)throw new Error("An expression was not found for: "+JSON.stringify(t));return e.decode(t,this)}return new Ht(t)},e.prototype.getEntityReferences=function(t){var e=t?this.entities.nameOf(t):void 0,n=this.getTypeClassReferences(he).filter(function(t){return!e||e===t.value.options}),r=this.getExpressionClassReferences(me).filter(function(t){return!e||e===t.value.name});return n.concat(r)},e.prototype.getDataReferences=function(t){var e=t?this.data.nameOf(t):void 0,n=this.getTypeClassReferences(Gi).filter(function(t){return!e||e===t.value.options}),r=this.getExpressionClassReferences(ee).filter(function(t){return!e||e===t.value.name});return n.concat(r)},e.prototype.getEntityDataReferences=function(t){var e=t?this.entities.nameOf(t):void 0;return this.getDataTypeClassReferences(he).filter(function(t){return!e||e===t.type.options})},e.prototype.getRelationReferences=function(t){var e=t?this.relations.nameOf(t):void 0;return this.getExpressionClassReferences(Te).filter(function(t){return!e||e===t.value.name})},e.prototype.getFunctionReferences=function(t,e){var n=t?this.functions.nameOf(t):void 0;return this.getExpressionClassReferences(we).filter(function(t){return(!n||n===t.value.name)&&(!e||e in t.value.args)})},e.prototype.getTypeClassReferences=function(t){var e=[];return this.getTypeInstances().forEach(function(n){n.type.traverse(new L(function(r){r instanceof t&&e.push({value:r,root:n.type,source:n.source})}))}),e},e.prototype.getDataTypeClassReferences=function(t){var e=[];return this.getDataInstances().forEach(function(n){n.type.traverse(new L(function(r){r instanceof t&&e.push({type:r,data:n.data,root:n.type,source:n.source})}))}),e},e.prototype.getExpressionClassReferences=function(t){var e=[];return this.getExpressionInstances().forEach(function(n){n.expr.traverse(new L(function(r){r instanceof t&&e.push({value:r,root:n.expr,source:n.source})}))}),e},e.prototype.getDataInstances=function(){var t=this,e=[];return this.programs.forEach(function(t){t.datasets.forEach(function(n){e.push({data:n.data,type:t.dataType,source:[t,n]})})}),this.functions.forEach(function(n){var r=n.getReturnType(t);n.tests.forEach(function(t){e.push({data:t.args,type:n.params,source:[n,t,"args"]}),e.push({data:t.expected,type:r,source:[n,t,"expected"]})})}),this.data.forEach(function(t){e.push({data:t.data,type:t.dataType,source:t})}),this.entities.forEach(function(n){n.instances&&n.instances.length>0&&e.push({data:n.instances,type:Ti.list(n.type),source:n}),E(n.methods,function(r){var o=r.getReturnType(t);r.tests.forEach(function(t){e.push({data:t.args,type:r.params,source:[n,r,t,"args"]}),e.push({data:t.expected,type:o,source:[n,r,t,"expected"]})})})}),e},e.prototype.getTypeInstances=function(t){var e=this;void 0===t&&(t=!1);var n=[];return this.programs.forEach(function(t){n.push({type:t.dataType,source:t})}),this.functions.forEach(function(r){n.push({type:r.params,source:[r,"params"]}),t&&n.push({type:r.getReturnType(e),source:[r,"returnType"]})}),this.data.forEach(function(t){n.push({type:t.dataType,source:t})}),this.entities.forEach(function(r){n.push({type:r.type,source:r}),E(r.methods,function(o){n.push({type:o.params,source:[r,o,"params"]}),t&&n.push({type:o.getReturnType(e),source:[r,o,"returnType"]})}),t&&(r.key!==ft.instance&&n.push({type:r.getKeyContext(),source:[r,"key"]}),r.describe!==ft.instance&&n.push({type:r.getDescribeContext(),source:[r,"describe"]})),E(r.transcoders,function(t,e){n.push({type:t.encodedType,source:[r,e,t]})})}),t&&this.relations.forEach(function(t){t.morphs&&n.push({type:t.morphs[1],source:t})}),n},e.prototype.getExpressionInstances=function(){var t=this,e=[];return this.programs.forEach(function(t){e.push({context:t.dataType,expr:t.expression,source:t})}),this.functions.forEach(function(t){e.push({context:t.params,expr:t.expression,source:t})}),this.entities.forEach(function(n){E(n.methods,function(t){e.push({context:t.getParamTypes(),expr:t.expression,source:[n,t]})}),n.canStore(t)&&(e.push({context:n.getKeyContext(),expr:n.key,source:[n,"key"]}),e.push({context:n.getDescribeContext(),expr:n.describe,source:[n,"describe"]}),E(n.transcoders,function(t,r){e.push({context:n.getEncodeContext(r),expr:t.encode,source:[n,r,t,"encode"]}),e.push({context:n.getDecodeContext(r),expr:t.decode,source:[n,r,t,"decode"]})}))}),e},e.prototype.export=function(){return{entities:this.encodeMap(this.entities),functions:this.encodeMap(this.functions),relations:this.encodeMap(this.relations),programs:this.encodeMap(this.programs),data:this.encodeMap(this.data)}},e.prototype.sync=function(t){var e=this;t.data&&this.data.syncManual(t.data,function(t,n){return e.addData(n,!1,!0)},function(t,n){return e.removeData(n,!1,!0,!0)},function(t,n,r){return e.addData(r,!0,!0)}),t.functions&&this.functions.syncManual(t.functions,function(t,n){return e.addFunction(n,!1,!0)},function(t,n){return e.removeFunction(n,!1,!0,!0)},function(t,n,r){return e.addFunction(r,!0,!0)}),t.entities&&this.entities.syncManual(t.entities,function(t,n){return e.addEntity(n,!1,!0)},function(t,n){return e.removeEntity(n,!1,!0,!0)},function(t,n,r){return e.addEntity(r,!0,!0)}),t.relations&&this.relations.syncManual(t.relations,function(t,n){return e.addRelation(n,!1,!0)},function(t,n){return e.removeRelation(n,!1,!0,!0)},function(t,n,r){return e.addRelation(r,!0,!0)}),t.programs&&this.programs.syncManual(t.programs,function(t,n){return e.addProgram(n,!1,!0)},function(t,n){return e.removeProgram(n,!0,!0)},function(t,n,r){return e.addProgram(r,!0,!0)})},e.prototype.import=function(t){var e=this;t.data&&E(t.data,function(t){return e.addData(t)}),t.functions&&E(t.functions,function(t){return e.addFunction(t)}),t.entities&&E(t.entities,function(t){return e.addEntity(t)}),t.relations&&E(t.relations,function(t){return e.addRelation(t)}),t.programs&&E(t.programs,function(t){return e.addProgram(t)})},e}(Ei),es=function(){function t(e){this.defs=e,this.ops=Object.create(null),this.exprs=Object.create(null),this.returnProperty=t.DEFAULT_RETURN_PROPERTY}return t.prototype.extend=function(e){var n=new t(e||this.defs);return Object.assign(n.ops,this.ops),Object.assign(n.exprs,this.exprs),n.returnProperty=this.returnProperty,n},t.prototype.setOperation=function(t,e){return this.ops[t.id]=e,this},t.prototype.setExpression=function(t,e){return this.exprs[t.id]=e,this},t.prototype.getFunction=function(t){return this.defs.getFunction(t)},t.prototype.getOperation=function(t){return this.ops[t]},t.prototype.getComputed=function(t){return this.defs.getComputed(t)},t.prototype.getOperationScopeDefaults=function(t){var e=this.defs.getOperation(t);return e?e.scopeDefaults:{}},t.prototype.getExpression=function(t){return this.exprs[t]},t.prototype.getCommand=function(t,e){return void 0===e&&(e=this),this.exprs[t.getId()](t,e)},t.prototype.run=function(t,e,n){return void 0===n&&(n=this),this.eval(t,n)(e)},t.prototype.eval=function(t,e){return void 0===e&&(e=this),s(t)?this.getCommand(this.defs.getExpression(t),e):function(){return t}},t.DEFAULT_RETURN_PROPERTY="$$return",t}(),ns=new ts({types:[he,dt,Z,si,Eo,Ut,hn,Mo,jo,Ro,ct,Pn,ye,Ao,Gi,mi,Lt,Tn],expressions:[rt,wt,Pt,Mt,Ht,mt,xt,Xt,Zt,ee,me,Te,Oe,we,ft,et,En,Ie,Pe,De,Ae,Re,Fe,Ge,xn,He,Xe]}),rs=he.operations,os=function(t,e){return t.name instanceof he?t.name:ye.baseType},is=function(t,e){if(t.name instanceof he)return t.name;var n=e.getEntities().values.map(function(t){return new he(t.name,e)});return 0===n.length?ct.baseType:1===n.length?n[0]:Ti.many(n)},ss=function(t,e){if(!(t.name instanceof he))return null;var n=e.getRelations(t.name.options);if(t.relation instanceof Ut){var r=t.relation.options.constants.get("relation");if(r){var o=n.find(function(t){return t.name===r});if(o)return o}}return n},as=function(t,e){var n=ss(t,e);return null===n?ct.baseType:s(n)?Ti.many(n.map(function(t){return Ti.enum(Lt,Lt,[["relation",t.name]])})):t.relation},us=function(t,e){var n=ss(t,e);return null===n||s(n)?ct.baseType:t.related&&n.relationType.acceptsType(t.related)?t.related:n.relationType},ps=function(t,e){var n=ss(t,e);return null===n||s(n)?ct.baseType:t.related&&n.itemType.acceptsType(t.related)?t.related:n.itemType},cs={newInstance:rs.setTypes(ie.newInstance,os,{name:is}),get:rs.setTypes(ie.get,function(t,e){if(!(t.name instanceof he))return dt;var n=e.getEntity(t.name.options);return n?Ti.list(n.type):dt},{name:is},{where:Z},{instance:os}),getKey:rs.setTypes(ie.getKey,function(t,e){if(!(t.name instanceof he))return dt;var n=e.getEntity(t.name.options);return n&&n.key?n.keyType:dt},{name:is,instance:os}),save:rs.setTypes(ie.save,Z,{name:is,instance:os}),remove:rs.setTypes(ie.remove,Z,{name:is,instance:os}),setRelated:rs.setTypes(ie.setRelated,Pn,{name:is,instance:os,relation:as,related:us}),addRelated:rs.setTypes(ie.addRelated,Pn,{name:is,instance:os,relation:as,related:ps}),removeRelated:rs.setTypes(ie.removeRelated,Pn,{name:is,instance:os,relation:as,related:ps}),clearRelated:rs.setTypes(ie.clearRelated,Pn,{name:is,instance:os,relation:as}),getRelated:rs.setTypes(ie.getRelated,function(t,e){return us(t,e)},{name:is,instance:os,relation:as}),isRelated:rs.setTypes(ie.isRelated,Pn,{name:is,instance:os,relation:as,related:ps})};cs.newInstance.rawTypes=!0,cs.get.rawTypes=!0,cs.getKey.rawTypes=!0,cs.save.rawTypes=!0,cs.remove.rawTypes=!0,cs.setRelated.rawTypes=!0,cs.addRelated.rawTypes=!0,cs.removeRelated.rawTypes=!0,cs.clearRelated.rawTypes=!0,cs.getRelated.rawTypes=!0,cs.isRelated.rawTypes=!0;var ls=dt.operations,fs={cmp:ls.setTypes(ut.cmp,Pn,{value:dt,test:dt}),copy:ls.setTypes(ut.copy,dt,{value:dt}),isDefined:ls.setTypes(ut.isDefined,Z,{value:dt}),getDefined:ls.setTypes(ut.getDefined,Z,{value:dt,defined:dt},{},{defined:function(t){return t.value instanceof Ao?t.value.options:t.value}}),coalesce:ls.setTypes(ut.coalesce,function(t){var e=!0,n=[],r=function(t){if(e&&t){var r=t instanceof Ao,o=r?t.options:t;o instanceof Mo&&o.options.forEach(function(t){var e=t instanceof Ao,o=e?t.options:t;r=r||e,n.some(function(t){return t.exactType(o)})||n.push(o)}),e=e&&r,n.some(function(t){return t.exactType(o)})||n.push(o)}};return r(t.a),r(t.b),r(t.c),r(t.d),r(t.e),n.length>1?e?Ti.optional(new Mo(n)):new Mo(n):1===n.length?e?Ti.optional(n[0]):n[0]:ct},{a:dt,b:dt},{c:dt,d:dt,e:dt}),require:ls.setTypes(ut.require,function(t){return t.value instanceof Ao?t.value.options:t.value||dt},{value:function(t){return t.value||dt}}),ternary:ls.setTypes(ut.ternary,function(t){return t.truthy&&t.falsy?Ti.mergeMany([t.truthy,t.falsy]):t.truthy?t.truthy:t.falsy?t.falsy:dt},{condition:Z,truthy:function(t){return t.truthy||dt},falsy:function(t){return t.falsy||dt}}),isValid:ls.setTypes(ut.isValid,Z,{value:dt}),isEqual:ls.setTypes(ut.isEqual,Z,{value:dt,test:dt}),isNotEqual:ls.setTypes(ut.isNotEqual,Z,{value:dt,test:dt}),isLess:ls.setTypes(ut.isLess,Z,{value:dt,test:dt}),isLessOrEqual:ls.setTypes(ut.isLessOrEqual,Z,{value:dt,test:dt}),isGreater:ls.setTypes(ut.isGreater,Z,{value:dt,test:dt}),isGreaterOrEqual:ls.setTypes(ut.isGreaterOrEqual,Z,{value:dt,test:dt}),asAny:ls.setTypes(ut.asAny,function(t){return t.value||dt},{value:dt}),asBoolean:ls.setTypes(ut.asBoolean,Z,{value:dt}),asColor:ls.setTypes(ut.asColor,si,{value:dt}),asDate:ls.setTypes(ut.asDate,Eo,{value:dt}),asList:ls.setTypes(ut.asList,function(t){return hn.forItem(t.value||dt)},{value:dt}),asMap:ls.setTypes(ut.asMap,function(t){return jo.forItem(t.value||dt)},{value:dt}),asNumber:ls.setTypes(ut.asNumber,Pn,{value:dt}),asObject:ls.setTypes(ut.asObject,ye,{value:dt}),asText:ls.setTypes(ut.asText,Lt,{value:dt}),asTuple:ls.setTypes(ut.asTuple,function(t){return Tn.forItem([t.value||dt])},{value:dt}),asSet:ls.setTypes(ut.asSet,function(t){return mi.forItem(t.value||dt)},{value:dt})},ys=Z.operations,ds={create:ys.setTypes(K.create,Z),maybe:ys.setTypes(K.maybe,function(t){return Ti.maybe(t.value,Z)},{value:dt}),and:ys.setTypes(K.and,Z,{a:Z,b:Z}),or:ys.setTypes(K.or,Z,{a:Z,b:Z}),xor:ys.setTypes(K.xor,Z,{a:Z,b:Z}),not:ys.setTypes(K.not,Z,{a:Z}),cmp:ys.setTypes(K.cmp,Pn,{value:Z,test:Z}),isValid:ys.setTypes(K.isValid,Z,{value:dt}),isTrue:ys.setTypes(K.isTrue,Z,{value:Z}),isFalse:ys.setTypes(K.isFalse,Z,{value:Z}),isEqual:ys.setTypes(K.isEqual,Z,{value:Z,test:Z}),isNotEqual:ys.setTypes(K.isNotEqual,Z,{value:Z,test:Z}),asAny:ys.setTypes(K.asAny,dt,{value:Z}),asBoolean:ys.setTypes(K.asBoolean,function(t){return t.value||Z},{value:Z}),asColor:ys.setTypes(K.asColor,si,{value:Z}),asDate:ys.setTypes(K.asDate,Eo,{value:Z}),asList:ys.setTypes(K.asList,function(t){return hn.forItem(t.value||Z)},{value:Z}),asMap:ys.setTypes(K.asMap,function(t){return jo.forItem(t.value||Z)},{value:Z}),asNumber:ys.setTypes(K.asNumber,Pn,{value:Z}),asObject:ys.setTypes(K.asObject,ye,{value:Z}),asText:ys.setTypes(K.asText,Lt,{value:Z}),asTuple:ys.setTypes(K.asTuple,function(t){return Tn.forItem([t.value||Z])},{value:Z}),asSet:ys.setTypes(K.asSet,function(t){return mi.forItem(t.value||dt)},{value:Z})},hs=si.operations,vs=new Ut({key:Lt.baseType,value:Lt.baseType,constants:new Map([["r","r"],["g","g"],["b","b"],["a","a"]])}),ms=new Mo([si.baseType,new Pn({})]),gs=new Ut({key:Lt.baseType,value:Lt.baseType,constants:new Map([["Best Fit: #rrggbb or rgb()","rgb:bestfit"],["#rgb","rgb:hexShort"],["#rrggbb","rgb:hex"],["#rrggbbaa","rgb:hexLong"],["rgb(r, g, b)","rgb:rgb"],["rgba(r, g, b, a)","rgb:rgba"],["hsl(h, s, l)","hsl:hsl"],["hsla(h, s, l, a)","hsl:hsla"]])}),Ts=new Ut({key:Lt.baseType,value:si.baseType,constants:new Map([["Transparent",{r:255,g:255,b:255,a:0}],["Alice Blue",{r:240,g:248,b:255,a:255}],["Antique White",{r:250,g:235,b:215,a:255}],["Aqua",{r:0,g:255,b:255,a:255}],["Aquamarine",{r:127,g:255,b:212,a:255}],["Azure",{r:240,g:255,b:255,a:255}],["Beige",{r:245,g:245,b:220,a:255}],["Bisque",{r:255,g:228,b:196,a:255}],["Black",{r:0,g:0,b:0,a:255}],["Blanched Almond",{r:255,g:235,b:205,a:255}],["Blue",{r:0,g:0,b:255,a:255}],["Blue Violet",{r:138,g:43,b:226,a:255}],["Brown",{r:165,g:42,b:42,a:255}],["Burly Wood",{r:222,g:184,b:135,a:255}],["Cadet Blue",{r:95,g:158,b:160,a:255}],["Chartreuse",{r:127,g:255,b:0,a:255}],["Chocolate",{r:210,g:105,b:30,a:255}],["Coral",{r:255,g:127,b:80,a:255}],["Cornflower Blue",{r:100,g:149,b:237,a:255}],["Cornsilk",{r:255,g:248,b:220,a:255}],["Crimson",{r:220,g:20,b:60,a:255}],["Cyan",{r:0,g:255,b:255,a:255}],["Dark Blue",{r:0,g:0,b:139,a:255}],["Dark Cyan",{r:0,g:139,b:139,a:255}],["Dark Goldenrod",{r:184,g:134,b:11,a:255}],["Dark Gray",{r:169,g:169,b:169,a:255}],["Dark Green",{r:0,g:100,b:0,a:255}],["Dark Khaki",{r:189,g:183,b:107,a:255}],["Dark Magenta",{r:139,g:0,b:139,a:255}],["Dark Olive Green",{r:85,g:107,b:47,a:255}],["Dark Orange",{r:255,g:140,b:0,a:255}],["Dark Orchid",{r:153,g:50,b:204,a:255}],["Dark Red",{r:139,g:0,b:0,a:255}],["Dark Salmon",{r:233,g:150,b:122,a:255}],["Dark Sea Green",{r:143,g:188,b:139,a:255}],["Dark Slate Blue",{r:72,g:61,b:139,a:255}],["Dark Slate Gray",{r:47,g:79,b:79,a:255}],["Dark Turquoise",{r:0,g:206,b:209,a:255}],["Dark Violet",{r:148,g:0,b:211,a:255}],["Deep Pink",{r:255,g:20,b:147,a:255}],["Deep Sky Blue",{r:0,g:191,b:255,a:255}],["Dim Gray",{r:105,g:105,b:105,a:255}],["Dodger Blue",{r:30,g:144,b:255,a:255}],["Firebrick",{r:178,g:34,b:34,a:255}],["Floral White",{r:255,g:250,b:240,a:255}],["Forest Green",{r:34,g:139,b:34,a:255}],["Fuchsia",{r:255,g:0,b:255,a:255}],["Gainsboro",{r:220,g:220,b:220,a:255}],["Ghost White",{r:248,g:248,b:255,a:255}],["Gold",{r:255,g:215,b:0,a:255}],["Goldenrod",{r:218,g:165,b:32,a:255}],["Gray",{r:128,g:128,b:128,a:255}],["Green",{r:0,g:128,b:0,a:255}],["Green Yellow",{r:173,g:255,b:47,a:255}],["Honeydew",{r:240,g:255,b:240,a:255}],["Hot Pink",{r:255,g:105,b:180,a:255}],["Indian Red",{r:205,g:92,b:92,a:255}],["Indigo",{r:75,g:0,b:130,a:255}],["Ivory",{r:255,g:255,b:240,a:255}],["Khaki",{r:240,g:230,b:140,a:255}],["Lavender",{r:230,g:230,b:250,a:255}],["Lavender Blush",{r:255,g:240,b:245,a:255}],["Lawn Green",{r:124,g:252,b:0,a:255}],["Lemon Chiffon",{r:255,g:250,b:205,a:255}],["Light Blue",{r:173,g:216,b:230,a:255}],["Light Coral",{r:240,g:128,b:128,a:255}],["Light Cyan",{r:224,g:255,b:255,a:255}],["Light Goldenrod Yellow",{r:250,g:250,b:210,a:255}],["Light Gray",{r:211,g:211,b:211,a:255}],["Light Green",{r:144,g:238,b:144,a:255}],["Light Pink",{r:255,g:182,b:193,a:255}],["Light Salmon",{r:255,g:160,b:122,a:255}],["Light Sea Green",{r:32,g:178,b:170,a:255}],["Light Sky Blue",{r:135,g:206,b:250,a:255}],["Light Slate Gray",{r:119,g:136,b:153,a:255}],["Light Steel Blue",{r:176,g:196,b:222,a:255}],["Light Yellow",{r:255,g:255,b:224,a:255}],["Lime",{r:0,g:255,b:0,a:255}],["LimeGreen",{r:50,g:205,b:50,a:255}],["Linen",{r:250,g:240,b:230,a:255}],["Magenta",{r:255,g:0,b:255,a:255}],["Maroon",{r:128,g:0,b:0,a:255}],["Medium Aquamarine",{r:102,g:205,b:170,a:255}],["Medium Blue",{r:0,g:0,b:205,a:255}],["Medium Orchid",{r:186,g:85,b:211,a:255}],["Medium Purple",{r:147,g:112,b:219,a:255}],["Medium Sea Green",{r:60,g:179,b:113,a:255}],["Medium Slate Blue",{r:123,g:104,b:238,a:255}],["Medium Spring Green",{r:0,g:250,b:154,a:255}],["Medium Turquoise",{r:72,g:209,b:204,a:255}],["Medium VioletRed",{r:199,g:21,b:133,a:255}],["Midnight Blue",{r:25,g:25,b:112,a:255}],["Mint Cream",{r:245,g:255,b:250,a:255}],["Misty Rose",{r:255,g:228,b:225,a:255}],["Moccasin",{r:255,g:228,b:181,a:255}],["Navajo White",{r:255,g:222,b:173,a:255}],["Navy",{r:0,g:0,b:128,a:255}],["Old Lace",{r:253,g:245,b:230,a:255}],["Olive",{r:128,g:128,b:0,a:255}],["Olive Drab",{r:107,g:142,b:35,a:255}],["Orange",{r:255,g:165,b:0,a:255}],["Orange Red",{r:255,g:69,b:0,a:255}],["Orchid",{r:218,g:112,b:214,a:255}],["Pale Goldenrod",{r:238,g:232,b:170,a:255}],["Pale Green",{r:152,g:251,b:152,a:255}],["Pale Turquoise",{r:175,g:238,b:238,a:255}],["Pale Violet Red",{r:219,g:112,b:147,a:255}],["Papaya Whip",{r:255,g:239,b:213,a:255}],["Peach Puff",{r:255,g:218,b:185,a:255}],["Peru",{r:205,g:133,b:63,a:255}],["Pink",{r:255,g:192,b:203,a:255}],["Plum",{r:221,g:160,b:221,a:255}],["Powder Blue",{r:176,g:224,b:230,a:255}],["Purple",{r:128,g:0,b:128,a:255}],["Red",{r:255,g:0,b:0,a:255}],["Rosy Brown",{r:188,g:143,b:143,a:255}],["Royal Blue",{r:65,g:105,b:225,a:255}],["Saddle Brown",{r:139,g:69,b:19,a:255}],["Salmon",{r:250,g:128,b:114,a:255}],["Sandy Brown",{r:244,g:164,b:96,a:255}],["Sea Green",{r:46,g:139,b:87,a:255}],["Sea Shell",{r:255,g:245,b:238,a:255}],["Sienna",{r:160,g:82,b:45,a:255}],["Silver",{r:192,g:192,b:192,a:255}],["Sky Blue",{r:135,g:206,b:235,a:255}],["Slate Blue",{r:106,g:90,b:205,a:255}],["Slate Gray",{r:112,g:128,b:144,a:255}],["Snow",{r:255,g:250,b:250,a:255}],["Spring Green",{r:0,g:255,b:127,a:255}],["Steel Blue",{r:70,g:130,b:180,a:255}],["Tan",{r:210,g:180,b:140,a:255}],["Teal",{r:0,g:128,b:128,a:255}],["Thistle",{r:216,g:191,b:216,a:255}],["Tomato",{r:255,g:99,b:71,a:255}],["Turquoise",{r:64,g:224,b:208,a:255}],["Violet",{r:238,g:130,b:238,a:255}],["Wheat",{r:245,g:222,b:179,a:255}],["White",{r:255,g:255,b:255,a:255}],["White Smoke",{r:245,g:245,b:245,a:255}],["Yellow",{r:255,g:255,b:0,a:255}],["Yellow Green",{r:154,g:205,b:50,a:255}]])}),bs=new Ut({key:Lt.baseType,value:Lt.baseType,constants:new Map([["Multiply","multiply"],["Screen","screen"],["Overlay","overlay"],["Hard Light","hard"],["Soft Light","soft"],["Dodge","dodge"],["Burn","burn"],["Divide","divide"],["Addition","add"],["Subtract","sub"],["Difference","diff"],["Darken Only","darken"],["Lighten Only","lighten"]])}),xs={create:hs.setTypes(Yo.create,si),maybe:hs.setTypes(Yo.maybe,function(t){return Ti.maybe(t.value,si)},{value:dt}),cmp:hs.setTypes(Yo.cmp,Pn,{value:si,test:si}),copy:hs.setTypes(Yo.copy,si,{value:si}),build:hs.setTypes(Yo.build,si,{r:Pn,g:Pn,b:Pn},{a:Pn}),map:hs.setTypes(Yo.map,si,{value:si,r:Pn,g:Pn,b:Pn},{a:Pn},{value:Pn,component:vs}),op:hs.setTypes(Yo.op,si,{value:si,test:si,r:Pn,g:Pn,b:Pn},{a:Pn},{value:Pn,test:Pn,component:vs}),clamp:hs.setTypes(Yo.clamp,si,{value:si}),add:hs.setTypes(Yo.add,si,{value:si,addend:ms},{alpha:Z}),adds:hs.setTypes(Yo.adds,si,{value:si,addend:ms,addendScale:ms},{alpha:Z}),sub:hs.setTypes(Yo.sub,si,{value:si,subtrahend:ms},{alpha:Z}),mul:hs.setTypes(Yo.mul,si,{value:si,multiplier:ms},{alpha:Z}),div:hs.setTypes(Yo.div,si,{value:si,divisor:ms},{alpha:Z}),mod:hs.setTypes(Yo.mod,si,{value:si,divisor:ms},{alpha:Z}),format:hs.setTypes(Yo.format,Lt,{value:si,format:gs}),parse:hs.setTypes(Yo.parse,Ti.optional(si),{value:dt}),lerp:hs.setTypes(Yo.lerp,si,{start:si,end:si,delta:Pn}),lighten:hs.setTypes(Yo.lighten,si,{value:si,amount:Pn}),darken:hs.setTypes(Yo.darken,si,{value:si,amount:Pn}),toHSL:hs.setTypes(Yo.toHSL,Zo.type,{value:si}),fromHSL:hs.setTypes(Yo.fromHSL,si,{value:Zo.type}),luminance:hs.setTypes(Yo.luminance,Pn,{value:si}),contrast:hs.setTypes(Yo.contrast,Pn,{value:si,test:si}),invert:hs.setTypes(Yo.invert,si,{value:si},{alpha:Z}),opaque:hs.setTypes(Yo.opaque,si,{value:si}),alpha:hs.setTypes(Yo.alpha,si,{value:si,alpha:Pn}),distance:hs.setTypes(Yo.distance,Pn,{value:si,test:si}),named:hs.setTypes(Yo.named,si,{name:Ts}),getName:hs.setTypes(Yo.getName,Lt,{value:si}),blend:hs.setTypes(Yo.blend,si,{top:si,bottom:si,mode:bs}),isValid:hs.setTypes(Yo.isValid,Z,{value:dt}),isEqual:hs.setTypes(Yo.isEqual,Z,{value:si,test:si},{epsilon:Pn}),isNotEqual:hs.setTypes(Yo.isNotEqual,Z,{value:si,test:si},{epsilon:Pn}),isLess:hs.setTypes(Yo.isLess,Z,{value:si,test:si}),isLessOrEqual:hs.setTypes(Yo.isLessOrEqual,Z,{value:si,test:si}),isGreater:hs.setTypes(Yo.isGreater,Z,{value:si,test:si}),isGreaterOrEqual:hs.setTypes(Yo.isGreaterOrEqual,Z,{value:si,test:si}),asAny:hs.setTypes(Yo.asAny,dt,{value:si}),asBoolean:hs.setTypes(Yo.asBoolean,Z,{value:si}),asColor:hs.setTypes(Yo.asColor,si,{value:si}),asDate:hs.setTypes(Yo.asDate,Eo,{value:si}),asList:hs.setTypes(Yo.asList,function(t){return hn.forItem(t.value||si)},{value:si}),asMap:hs.setTypes(Yo.asMap,function(t){return jo.forItem(t.value||si)},{value:si}),asNumber:hs.setTypes(Yo.asNumber,Pn,{value:si}),asObject:hs.setTypes(Yo.asObject,function(t){return t.value||si},{value:si}),asText:hs.setTypes(Yo.asText,Lt,{value:si}),asTuple:hs.setTypes(Yo.asTuple,function(t){return Tn.forItem([t.value||si])},{value:si}),asSet:hs.setTypes(Yo.asSet,function(t){return mi.forItem(t.value||dt)},{value:si})},Os=Eo.operations,Es=new Ut({key:Lt.baseType.newInstance(),value:Lt.baseType.newInstance(),constants:new Map([["Timestamp","timestamp"],["Timestamp (seconds)","timestampSeconds"],["Millisecond","millis"],["Second","second"],["Minute","minute"],["Hour","hour"],["Day","day"],["Day of Month","dayOfMonth"],["Last Day of Month","lastDayOfMonth"],["Day of Year","dayOfYear"],["Day of Week","dayOfWeek"],["Week","week"],["Week of Month","weekOfMonth"],["Weekspan of Month","weekspanOfMonth"],["Full Week of Month","fullWeekOfMonth"],["Last Weekspan of Month","lastWeekspanOfMonth"],["Last Full Week of Month","lastFullWeekOfMonth"],["Week of Year","weekOfYear"],["Weekspan of Year","weekspanOfYear"],["Full Week of Year","fullWeekOfYear"],["Last Weekspan of Year","lastWeekspanOfYear"],["Last Full Week of Year","lastFullWeekOfYear"],["Month","month"],["Quarter","quarter"],["Year","year"],["Time Identifier","timeIdentifier"],["Day Identifier","dayIdentifier"],["Week Identifier","weekIdentifier"],["Month Identifier","monthIdentifier"],["Quarter Identifier","quarterIdentifier"]])}),ws=new Ut({key:Lt.baseType.newInstance(),value:Lt.baseType.newInstance(),constants:new Map([["Millisecond","millis"],["Second","second"],["Minute","minute"],["Hour","hour"],["Day","day"],["Week","week"],["Month","month"],["Quarter","quarter"],["Year","year"]])}),Ss=new Ut({key:Lt.baseType.newInstance(),value:Lt.baseType.newInstance(),constants:new Map([["None","none"],["Floor","floor"],["Ceil","ceil"],["Round","round"],["Truncate","truncate"],["Up","up"],["Down","down"]])}),Ps={create:Os.setTypes(bo.create,Eo),now:Os.setTypes(bo.now,Eo),today:Os.setTypes(bo.today,Eo),tomorrow:Os.setTypes(bo.tomorrow,Eo),yesterday:Os.setTypes(bo.yesterday,Eo),maybe:Os.setTypes(bo.maybe,function(t){return Ti.maybe(t.value,Z)},{value:dt}),parse:Os.setTypes(bo.parse,Ti.optional(Eo),{value:new Mo([Eo.baseType,Pn.baseType,Lt.baseType])},{parseAsUTC:Z}),fromText:Os.setTypes(bo.fromText,Ti.optional(Eo),{value:Lt},{parseAsUTC:Z}),fromTimestamp:Os.setTypes(bo.fromTimestamp,Eo,{value:Pn}),fromTimestampSeconds:Os.setTypes(bo.fromTimestampSeconds,Eo,{value:Pn}),min:Os.setTypes(bo.min,Eo,{value:Eo,test:Eo}),max:Os.setTypes(bo.max,Eo,{value:Eo,test:Eo}),get:Os.setTypes(bo.get,Pn,{value:Eo,property:Es}),set:Os.setTypes(bo.set,Eo,{value:Eo,property:Es,set:Pn}),add:Os.setTypes(bo.add,Eo,{value:Eo,unit:ws},{amount:Pn}),sub:Os.setTypes(bo.sub,Eo,{value:Eo,unit:ws},{amount:Pn}),startOf:Os.setTypes(bo.startOf,Eo,{value:Eo,unit:ws}),endOf:Os.setTypes(bo.endOf,Eo,{value:Eo,unit:ws},{inclusive:Z}),daysInMonth:Os.setTypes(bo.daysInMonth,Pn,{value:Eo}),daysInYear:Os.setTypes(bo.daysInYear,Pn,{value:Eo}),weeksInYear:Os.setTypes(bo.weeksInYear,Pn,{value:Eo}),copy:Os.setTypes(bo.copy,Eo,{value:Eo}),cmp:Os.setTypes(bo.cmp,Pn,{value:Eo,test:Eo},{unit:ws}),diff:Os.setTypes(bo.diff,Pn,{value:Eo,test:Eo},{unit:ws,absolute:Z,adjust:Ss}),timezoneOffset:Os.setTypes(bo.timezoneOffset,Pn,{value:Eo}),toText:Os.setTypes(bo.toText,Lt,{value:Eo,format:Lt}),toISOText:Os.setTypes(bo.toISOText,Lt,{value:Eo}),isValid:Os.setTypes(bo.isValid,Z,{value:dt}),isEqual:Os.setTypes(bo.isEqual,Z,{value:Eo,test:Eo},{unit:ws}),isBefore:Os.setTypes(bo.isBefore,Z,{value:Eo,test:Eo},{unit:ws}),isBeforeOrEqual:Os.setTypes(bo.isBeforeOrEqual,Z,{value:Eo,test:Eo},{unit:ws}),isAfter:Os.setTypes(bo.isAfter,Z,{value:Eo,test:Eo},{unit:ws}),isAfterOrEqual:Os.setTypes(bo.isAfterOrEqual,Z,{value:Eo,test:Eo},{unit:ws}),isBetween:Os.setTypes(bo.isBetween,Z,{value:Eo,start:Eo,end:Eo},{unit:ws,startInclusive:Z,endInclusive:Z}),isStartOf:Os.setTypes(bo.isStartOf,Z,{value:Eo,unit:ws}),isEndOf:Os.setTypes(bo.isEndOf,Z,{value:Eo,unit:ws},{inclusive:Z}),isDST:Os.setTypes(bo.isDST,Z,{value:Eo}),isLeapYear:Os.setTypes(bo.isLeapYear,Z,{value:Eo}),asAny:Os.setTypes(bo.asAny,dt,{value:Eo}),asBoolean:Os.setTypes(bo.asBoolean,Z,{value:Eo}),asColor:Os.setTypes(bo.asColor,si,{value:Eo}),asDate:Os.setTypes(bo.asDate,function(t){return t.value||Eo},{value:Eo}),asList:Os.setTypes(bo.asList,function(t){return hn.forItem(t.value||Eo)},{value:Eo}),asMap:Os.setTypes(bo.asMap,function(t){return jo.forItem(t.value||Eo)},{value:Eo}),asNumber:Os.setTypes(bo.asNumber,Pn,{value:Eo}),asObject:Os.setTypes(bo.asObject,ye,{value:Eo}),asText:Os.setTypes(bo.asText,Lt,{value:Eo}),asTuple:Os.setTypes(bo.asTuple,function(t){return Tn.forItem([t.value||Eo])},{value:Eo}),asSet:Os.setTypes(bo.asSet,function(t){return mi.forItem(t.value||dt)},{value:Eo})},_s=hn.operations,Ms=function(t,e){return t instanceof hn?t:e},Is=function(t,e){return t instanceof hn?t.options.item:e},Cs=function(t){return Ms(t.list)||hn},Ds=function(t){return Ms(t.value)||hn},js=function(t){return Ms(t.list)?t.list.options.item:dt},ks=function(t){return Ti.optional(js(t))},As=function(t){return Ms(t.value)?t.value.options.item:dt},Ns=function(t){return t.reduce||t.initial||dt},Ls={list:Cs,value:js,test:js},Rs={list:Ds,value:As,test:As},qs={list:Cs,item:js,index:Pn},Vs={create:_s.setTypes(pn.create,hn),createLike:_s.setTypes(pn.createLike,Cs,{list:Cs}),createFor:_s.setTypes(pn.createFor,function(t){return hn.forItem(t.item||dt)},{item:function(t){return t.item||dt}}),maybe:_s.setTypes(pn.maybe,function(t){return Ti.maybe(t.value,hn)},{value:dt}),build:_s.setTypes(pn.build,function(t){return hn.forItem(t.item||dt)},{count:Pn,item:function(t){return t.item||dt}},{sameItem:Z},{list:function(t){return hn.forItem(t.item||dt)},index:Pn,last:function(t){return t.item||dt},count:Pn}),get:_s.setTypes(pn.get,ks,{list:Cs,index:Pn}),set:_s.setTypes(pn.set,ks,{list:Cs,index:Pn,value:js}),add:_s.setTypes(pn.add,Cs,{list:Cs,item:js}),addFirst:_s.setTypes(pn.addFirst,Cs,{list:Cs,item:js}),addLast:_s.setTypes(pn.addLast,Cs,{list:Cs,item:js}),insert:_s.setTypes(pn.insert,Cs,{list:Cs,item:js,index:Pn}),remove:_s.setTypes(pn.remove,Pn,{list:Cs,item:js,isEqual:Z},{},Ls),removeFirst:_s.setTypes(pn.removeFirst,ks,{list:Cs}),removeLast:_s.setTypes(pn.removeLast,ks,{list:Cs}),removeAt:_s.setTypes(pn.removeAt,ks,{list:Cs,index:Pn}),removeWhere:_s.setTypes(pn.removeWhere,Cs,{list:Cs,where:Z},{},qs),clear:_s.setTypes(pn.clear,Cs,{list:Cs}),contains:_s.setTypes(pn.contains,Z,{list:Cs,item:js,isEqual:Z},{},Ls),find:_s.setTypes(pn.find,ks,{list:Cs,where:Z},{reverse:Z,start:Pn},qs),copy:_s.setTypes(pn.copy,Cs,{list:Cs},{deepCopy:js},{copy:js}),reverse:_s.setTypes(pn.reverse,Cs,{list:Cs}),exclude:_s.setTypes(pn.exclude,Cs,{list:Cs,exclude:Cs,isEqual:Z},{},Ls),overlap:_s.setTypes(pn.overlap,Cs,{list:Cs,overlap:Cs,isEqual:Z},{},Ls),sort:_s.setTypes(pn.sort,Cs,{list:Cs,compare:Pn},{},Ls),shuffle:_s.setTypes(pn.shuffle,Cs,{list:Cs},{times:Pn}),unique:_s.setTypes(pn.unique,Cs,{list:Cs,isEqual:Z},{},Ls),duplicates:_s.setTypes(pn.duplicates,Cs,{list:Cs,isEqual:Z},{once:Z},Ls),take:_s.setTypes(pn.take,Cs,{list:Cs,count:Pn}),skip:_s.setTypes(pn.skip,Cs,{list:Cs,count:Pn}),drop:_s.setTypes(pn.drop,Cs,{list:Cs,count:Pn}),append:_s.setTypes(pn.append,Cs,{list:Cs,append:Cs}),prepend:_s.setTypes(pn.prepend,Cs,{list:Cs,prepend:Cs}),indexOf:_s.setTypes(pn.indexOf,Pn,{list:Cs,item:js,isEqual:Z},{start:Pn},Ls),lastIndexOf:_s.setTypes(pn.lastIndexOf,Pn,{list:Cs,item:js,isEqual:Z},{start:Pn},Ls),findIndex:_s.setTypes(pn.findIndex,Pn,{list:Cs,where:Z},{reverse:Z,start:Pn},qs),last:_s.setTypes(pn.last,ks,{list:Cs}),first:_s.setTypes(pn.first,ks,{list:Cs}),count:_s.setTypes(pn.count,Pn,{list:Cs}),randomList:_s.setTypes(pn.randomList,Cs,{list:Cs,count:Pn}),random:_s.setTypes(pn.random,ks,{list:Cs}),join:_s.setTypes(pn.join,Lt,{list:Cs},{delimiter:Lt,toText:Lt,prefix:Lt,suffix:Lt},qs),each:_s.setTypes(pn.each,Cs,{list:Cs,each:dt},{reverse:Z},qs),filter:_s.setTypes(pn.filter,Cs,{list:Cs,filter:Z},{},qs),not:_s.setTypes(pn.not,Cs,{list:Cs,not:Z},{},qs),map:_s.setTypes(pn.map,function(t){return hn.forItem(t.transform||dt)},{list:Cs,transform:function(t){return t.transform||dt}},{},qs),split:_s.setTypes(pn.split,function(t){return Ti.object({pass:Cs(t),fail:Cs(t)})},{list:Cs,pass:Z},{},qs),reduce:_s.setTypes(pn.reduce,Ns,{list:Cs,reduce:Ns,initial:Ns},{},{list:Cs,item:js,reduced:Ns,index:Pn}),cmp:_s.setTypes(pn.cmp,Z,{value:Ds,test:Ds,compare:Pn},{},Rs),group:_s.setTypes(pn.group,function(t){return hn.forItem(Ti.object({by:t.by||dt,group:hn.forItem(t.getValue||js(t))}))},{list:Cs,by:function(t){return t.by||dt}},{getValue:function(t){return t.getValue||js(t)}},qs),toListMap:_s.setTypes(pn.toListMap,function(t){return jo.forItem(hn.forItem(t.getValue||js(t)),t.getKey||dt)},{list:Cs,getKey:function(t){return t.getKey||dt}},{getValue:function(t){return t.getValue||js(t)}},qs),toMap:_s.setTypes(pn.toMap,function(t){return jo.forItem(t.getValue||js(t),t.getKey||dt)},{list:Cs,getKey:function(t){return t.getKey||dt}},{getValue:function(t){return t.getValue||js(t)}},qs),joinInner:_s.setTypes(pn.joinInner,function(t){return hn.forItem(t.join||dt)},{a:function(t){return Ms(t.a,hn)},b:function(t){return Ms(t.b,hn)},on:Z,join:dt},{},{onA:function(t){return Is(t.a,dt)},onB:function(t){return Is(t.b,dt)},joinA:function(t){return Is(t.a,dt)},joinB:function(t){return Is(t.b,dt)}}),joinLeft:_s.setTypes(pn.joinLeft,function(t){return hn.forItem(t.join||dt)},{a:function(t){return Ms(t.a,hn)},b:function(t){return Ms(t.b,hn)},on:Z,join:dt},{},{onA:function(t){return Is(t.a,dt)},onB:function(t){return Is(t.b,dt)},joinA:function(t){return Is(t.a,dt)},joinB:function(t){return Ti.optional(Is(t.b,dt))}}),joinRight:_s.setTypes(pn.joinRight,function(t){return hn.forItem(t.join||dt)},{a:function(t){return Ms(t.a,hn)},b:function(t){return Ms(t.b,hn)},on:Z,join:dt},{},{onA:function(t){return Is(t.a,dt)},onB:function(t){return Is(t.b,dt)},joinA:function(t){return Ti.optional(Is(t.a,dt))},joinB:function(t){return Is(t.b,dt)}}),joinFull:_s.setTypes(pn.joinFull,function(t){return hn.forItem(t.join||dt)},{a:function(t){return Ms(t.a,hn)},b:function(t){return Ms(t.b,hn)},on:Z,join:dt},{},{onA:function(t){return Is(t.a,dt)},onB:function(t){return Is(t.b,dt)},joinA:function(t){return Ti.optional(Is(t.a,dt))},joinB:function(t){return Ti.optional(Is(t.b,dt))}}),joinCross:_s.setTypes(pn.joinCross,function(t){return hn.forItem(t.join||dt)},{a:function(t){return Ms(t.a,hn)},b:function(t){return Ms(t.b,hn)},join:dt},{},{joinA:function(t){return Is(t.a,dt)},joinB:function(t){return Is(t.b,dt)}}),min:_s.setTypes(pn.min,Ti.optional(Pn),{list:Cs,value:Pn},{},qs),max:_s.setTypes(pn.max,Ti.optional(Pn),{list:Cs,value:Pn},{},qs),sum:_s.setTypes(pn.sum,Ti.optional(Pn),{list:Cs,value:Pn},{},qs),avg:_s.setTypes(pn.avg,Ti.optional(Pn),{list:Cs,value:Pn},{},qs),std:_s.setTypes(pn.std,Ti.optional(Pn),{list:Cs,value:Pn},{},qs),variance:_s.setTypes(pn.variance,Ti.optional(Pn),{list:Cs,value:Pn},{},qs),median:_s.setTypes(pn.median,Ti.optional(Pn),{list:Cs,value:Pn},{},qs),bitand:_s.setTypes(pn.bitand,Pn,{list:Cs,value:Pn},{},qs),bitor:_s.setTypes(pn.bitor,Pn,{list:Cs,value:Pn},{},qs),bitxor:_s.setTypes(pn.bitxor,Pn,{list:Cs,value:Pn},{},qs),isValid:_s.setTypes(pn.isValid,Z,{value:dt}),isEmpty:_s.setTypes(pn.isEmpty,Z,{list:Cs}),isNotEmpty:_s.setTypes(pn.isNotEmpty,Z,{list:Cs}),isEqual:_s.setTypes(pn.isEqual,Z,{list:Cs,test:Cs,isEqual:Z},{},Ls),isNotEqual:_s.setTypes(pn.isNotEqual,Z,{list:Cs,test:Cs,isEqual:Z},{},Ls),isLess:_s.setTypes(pn.isLess,Z,{value:Ds,test:Ds,compare:Pn},{},Rs),isLessOrEqual:_s.setTypes(pn.isLessOrEqual,Z,{value:Ds,test:Ds,compare:Pn},{},Rs),isGreater:_s.setTypes(pn.isGreater,Z,{value:Ds,test:Ds,compare:Pn},{},Rs),isGreaterOrEqual:_s.setTypes(pn.isGreaterOrEqual,Z,{value:Ds,test:Ds,compare:Pn},{},Rs),asAny:_s.setTypes(pn.asAny,dt,{value:Ds}),asBoolean:_s.setTypes(pn.asBoolean,Z,{value:Ds}),asColor:_s.setTypes(pn.asColor,si,{value:Ds}),asDate:_s.setTypes(pn.asDate,Eo,{value:Ds}),asList:_s.setTypes(pn.asList,Ds,{value:Ds}),asMap:_s.setTypes(pn.asMap,function(t){return jo.forItem(As(t))},{value:Ds}),asNumber:_s.setTypes(pn.asNumber,Pn,{value:Ds}),asObject:_s.setTypes(pn.asObject,ye,{value:Ds}),asText:_s.setTypes(pn.asText,Lt,{value:Ds}),asTuple:_s.setTypes(pn.asTuple,Tn,{value:Ds}),asSet:_s.setTypes(pn.asSet,function(t){return mi.forItem(As(t))},{value:Ds})},Fs=jo.operations,Ys=function(t){return t instanceof jo?t:void 0},Gs=function(t){return Ys(t.map)||jo},Bs=function(t){return Ys(t.map)?t.map.options.value:dt},Us=function(t){return Ti.optional(Bs(t))},Ws=function(t){return Ys(t.map)?t.map.options.key:Lt},Hs={map:Gs,key:Ws,value:Bs},Js=function(t){return Ys(t.value)||jo},Ks=function(t){return Ys(t.value)?t.value.options.value:dt},zs={key:function(t){return Ys(t.value)?t.value.options.key:Lt},value:Ks,test:Ks},Xs={create:Fs.setTypes(Ft.create,jo),createLike:Fs.setTypes(Ft.createLike,Gs,{map:Gs}),createFor:Fs.setTypes(Ft.createFor,function(t){return jo.forItem(t.value||dt,t.key||Lt)},{value:function(t){return t.value||dt}},{key:function(t){return t.key||Lt}}),maybe:Fs.setTypes(Ft.maybe,function(t){return Ti.maybe(t.value,jo)},{value:dt}),get:Fs.setTypes(Ft.get,Us,{map:Gs,key:Ws}),set:Fs.setTypes(Ft.set,Us,{map:Gs,key:Ws,value:Bs},{},{existingValue:Bs}),has:Fs.setTypes(Ft.has,Z,{map:Gs,key:Ws}),delete:Fs.setTypes(Ft.delete,Z,{map:Gs,key:Ws}),keys:Fs.setTypes(Ft.keys,function(t){return hn.forItem(Ws(t))},{map:Gs}),values:Fs.setTypes(Ft.values,function(t){return hn.forItem(Bs(t))},{map:Gs}),entries:Fs.setTypes(Ft.entries,function(t){return Ti.object({keys:hn.forItem(Ws(t)),values:hn.forItem(Bs(t))})},{map:Gs}),pairs:Fs.setTypes(Ft.pairs,function(t){return hn.forItem(Ti.object({key:Ws(t),value:Bs(t)}))},{map:Gs}),clear:Fs.setTypes(Ft.clear,Gs,{map:Gs}),count:Fs.setTypes(Ft.count,Pn,{map:Gs}),cmp:Fs.setTypes(Ft.cmp,Pn,{value:Js,test:Js,compare:Pn},{},zs),copy:Fs.setTypes(Ft.copy,Gs,{map:Gs},{deepCopy:Bs,deepCopyKey:Ws},Hs),map:Fs.setTypes(Ft.map,function(t){return jo.forItem(t.transform||Bs(t),t.transformKey||Ws(t))},{map:Gs},{transform:function(t){return t.transform||Bs(t)},transformKey:function(t){return t.transformKey||Ws(t)}},Hs),toPlainObject:Fs.setTypes(Ft.toPlainObject,dt,{map:Gs}),fromPlainObject:Fs.setTypes(Ft.fromPlainObject,function(t){if(!(t.object instanceof ye))return jo;var e=w(t.object.options.props);return jo.forItem(Ti.mergeMany(e,Lt.baseType))},{object:function(t){return t.object||ye}}),isValid:Fs.setTypes(Ft.isValid,Z,{value:dt}),isEqual:Fs.setTypes(Ft.isEqual,Z,{value:Js,test:Js,isEqual:Z},{},zs),isNotEqual:Fs.setTypes(Ft.isNotEqual,Z,{value:Js,test:Js,isEqual:Z},{},zs),isLess:Fs.setTypes(Ft.isLess,Z,{value:Js,test:Js,compare:Pn},{},zs),isLessOrEqual:Fs.setTypes(Ft.isLessOrEqual,Z,{value:Js,test:Js,compare:Pn},{},zs),isGreater:Fs.setTypes(Ft.isGreater,Z,{value:Js,test:Js,compare:Pn},{},zs),isGreaterOrEqual:Fs.setTypes(Ft.isGreaterOrEqual,Z,{value:Js,test:Js,compare:Pn},{},zs),asAny:Fs.setTypes(Ft.asAny,dt,{value:jo}),asBoolean:Fs.setTypes(Ft.asBoolean,Z,{value:jo}),asColor:Fs.setTypes(Ft.asColor,si,{value:jo}),asDate:Fs.setTypes(Ft.asDate,Eo,{value:jo}),asList:Fs.setTypes(Ft.asList,function(t){return hn.forItem(Ks(t))},{value:jo}),asMap:Fs.setTypes(Ft.asMap,function(t){return t.value||jo},{value:jo}),asNumber:Fs.setTypes(Ft.asNumber,function(t){return Pn},{value:jo}),asObject:Fs.setTypes(Ft.asObject,ye,{value:jo}),asText:Fs.setTypes(Ft.asText,Lt,{value:jo}),asTuple:Fs.setTypes(Ft.asTuple,function(t){return Tn.forItem([t.value||jo])},{value:jo}),asSet:Fs.setTypes(Ft.asSet,function(t){return mi.forItem(Ks(t))},{value:jo})},$s=Pn.operations,Qs=new Ut({key:Lt.baseType.newInstance(),value:Lt.baseType.newInstance(),constants:new Map([["has the bits","contain"],["does not have the bits","notcontain"],["has some of the bits","overlap"],["has none of the bits","none"],["has the same bits","equal"],["does not have the same bits","not"],["has all bits in","subset"]])}),Zs={create:$s.setTypes(on.create,Pn),pi:$s.setTypes(on.pi,Pn),pi2:$s.setTypes(on.pi2,Pn),piHalf:$s.setTypes(on.piHalf,Pn),e:$s.setTypes(on.e,Pn),sqrt2:$s.setTypes(on.sqrt2,Pn),sqrt12:$s.setTypes(on.sqrt12,Pn),ln2:$s.setTypes(on.ln2,Pn),ln10:$s.setTypes(on.ln10,Pn),log2e:$s.setTypes(on.log2e,Pn),log10e:$s.setTypes(on.log10e,Pn),add:$s.setTypes(on.add,Pn,{value:Pn,addend:Pn}),sub:$s.setTypes(on.sub,Pn,{value:Pn,subtrahend:Pn}),mul:$s.setTypes(on.mul,Pn,{value:Pn,multiplier:Pn}),div:$s.setTypes(on.div,Pn,{value:Pn,divisor:Pn}),mod:$s.setTypes(on.mod,Pn,{value:Pn,divisor:Pn}),min:$s.setTypes(on.min,Pn,{a:Pn,b:Pn}),max:$s.setTypes(on.max,Pn,{a:Pn,b:Pn}),pow:$s.setTypes(on.pow,Pn,{value:Pn,exponent:Pn}),atan2:$s.setTypes(on.atan2,Pn,{x:Pn,y:Pn}),hypot:$s.setTypes(on.hypot,Pn,{a:Pn,b:Pn}),choose:$s.setTypes(on.choose,Pn,{n:Pn,k:Pn}),gcd:$s.setTypes(on.gcd,Pn,{a:Pn,b:Pn}),bitAnd:$s.setTypes(on.bitAnd,Pn,{a:Pn,b:Pn}),bitOr:$s.setTypes(on.bitOr,Pn,{a:Pn,b:Pn}),bitXor:$s.setTypes(on.bitXor,Pn,{a:Pn,b:Pn}),cmp:$s.setTypes(on.cmp,Pn,{value:Pn,test:Pn}),maybe:$s.setTypes(on.maybe,function(t){return Ti.maybe(t.value,Pn)},{value:dt}),sqrt:$s.setTypes(on.sqrt,Pn,{value:Pn}),sq:$s.setTypes(on.sq,Pn,{value:Pn}),cbrt:$s.setTypes(on.cbrt,Pn,{value:Pn}),floor:$s.setTypes(on.floor,Pn,{value:Pn}),ceil:$s.setTypes(on.ceil,Pn,{value:Pn}),up:$s.setTypes(on.up,Pn,{value:Pn}),down:$s.setTypes(on.down,Pn,{value:Pn}),round:$s.setTypes(on.round,Pn,{value:Pn}),abs:$s.setTypes(on.abs,Pn,{value:Pn}),neg:$s.setTypes(on.neg,Pn,{value:Pn}),sign:$s.setTypes(on.sign,Pn,{value:Pn}),log:$s.setTypes(on.log,Pn,{value:Pn}),sin:$s.setTypes(on.sin,Pn,{value:Pn}),cos:$s.setTypes(on.cos,Pn,{value:Pn}),tan:$s.setTypes(on.tan,Pn,{value:Pn}),sinh:$s.setTypes(on.sinh,Pn,{value:Pn}),cosh:$s.setTypes(on.cosh,Pn,{value:Pn}),asin:$s.setTypes(on.asin,Pn,{value:Pn}),acos:$s.setTypes(on.acos,Pn,{value:Pn}),atan:$s.setTypes(on.atan,Pn,{value:Pn}),factorial:$s.setTypes(on.factorial,Pn,{value:Pn}),bitFlip:$s.setTypes(on.bitFlip,Pn,{value:Pn}),clamp:$s.setTypes(on.clamp,Pn,{value:Pn,min:Pn,max:Pn}),triangleHeight:$s.setTypes(on.triangleHeight,Pn,{base:Pn,side1:Pn,side2:Pn}),lerp:$s.setTypes(on.lerp,Pn,{delta:Pn,start:Pn,end:Pn}),rnd:$s.setTypes(on.rnd,Pn,{},{min:Pn,max:Pn,whole:Z,includeMax:Z}),toBaseText:$s.setTypes(on.toBaseText,Lt,{value:Pn},{base:Pn,minDigits:Pn}),toText:$s.setTypes(on.toText,Lt,{value:Pn},{prefix:Lt,suffix:Lt,minPlaces:Pn,maxPlaces:Pn,useExponent:Z,thousandSeparator:Lt}),toPercent:$s.setTypes(on.toPercent,Lt,{value:Pn},{minPlaces:Pn,maxPlaces:Pn,thousandSeparator:Lt}),fromPercent:$s.setTypes(on.fromPercent,Ti.optional(Pn),{value:Lt}),isValid:$s.setTypes(on.isValid,Z,{value:dt}),isZero:$s.setTypes(on.isZero,Z,{value:Pn},{epsilon:Pn}),isEqual:$s.setTypes(on.isEqual,Z,{value:Pn,test:Pn},{epsilon:Pn}),isNotEqual:$s.setTypes(on.isNotEqual,Z,{value:Pn,test:Pn},{epsilon:Pn}),isLess:$s.setTypes(on.isLess,Z,{value:Pn,test:Pn}),isLessOrEqual:$s.setTypes(on.isLessOrEqual,Z,{value:Pn,test:Pn}),isGreater:$s.setTypes(on.isGreater,Z,{value:Pn,test:Pn}),isGreaterOrEqual:$s.setTypes(on.isGreaterOrEqual,Z,{value:Pn,test:Pn}),isBetween:$s.setTypes(on.isBetween,Z,{value:Pn,min:Pn,max:Pn},{minInclusive:Z,maxInclusive:Z}),isWhole:$s.setTypes(on.isWhole,Z,{value:Pn},{epsilon:Pn}),isDecimal:$s.setTypes(on.isDecimal,Z,{value:Pn},{epsilon:Pn}),isPositive:$s.setTypes(on.isPositive,Z,{value:Pn}),isNegative:$s.setTypes(on.isNegative,Z,{value:Pn}),isDivisible:$s.setTypes(on.isDivisible,Z,{value:Pn,by:Pn},{epsilon:Pn}),bitCompare:$s.setTypes(on.bitCompare,Z,{value:Pn,method:Qs,test:Pn}),asAny:$s.setTypes(on.asAny,dt,{value:Pn}),asBoolean:$s.setTypes(on.asBoolean,Z,{value:Pn}),asColor:$s.setTypes(on.asColor,si,{value:Pn}),asDate:$s.setTypes(on.asDate,Eo,{value:Pn}),asList:$s.setTypes(on.asList,function(t){return hn.forItem(t.value||Pn)},{value:Pn}),asMap:$s.setTypes(on.asMap,function(t){return jo.forItem(t.value||Pn)},{value:Pn}),asNumber:$s.setTypes(on.asNumber,function(t){return t.value||Pn},{value:Pn}),asObject:$s.setTypes(on.asObject,ye,{value:Pn}),asText:$s.setTypes(on.asText,Lt,{value:Pn}),asTuple:$s.setTypes(on.asTuple,function(t){return Tn.forItem([t.value||Pn])},{value:Pn}),asSet:$s.setTypes(on.asSet,function(t){return mi.forItem(t.value||Pn)},{value:Pn})},ta=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ea=ye.operations,na=function(t){return t.object||ye},ra={create:ea.setTypes(pe.create,na),maybe:ea.setTypes(pe.maybe,function(t){return Ti.maybe(t.value,ye)},{value:dt}),has:ea.setTypes(pe.has,Z,{object:na,key:Lt}),get:ea.setTypes(pe.get,dt,{object:na,key:Lt}),set:ea.setTypes(pe.set,na,{object:na,key:Lt,value:dt},{},{existingValue:dt}),delete:ea.setTypes(pe.delete,dt,{object:na,key:Lt}),cmp:ea.setTypes(pe.cmp,Pn,{value:ye,test:ye}),copy:ea.setTypes(pe.copy,na,{object:na}),merge:ea.setTypes(pe.merge,function(t){var e,n,r={};try{for(var o=ta(["a","b","c","d","e"]),i=o.next();!i.done;i=o.next()){var s=t[i.value];if(s instanceof he&&(s=s.getType()),s instanceof ye){var a=s.options.props;for(var u in a){var p=a[u];r[u]=u in r&&p instanceof Ao?Ti.mergeMany([p,r[u]]):p}}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return new ye({props:r})},{a:ye,b:ye},{c:ye,d:ye,e:ye}),isValid:ea.setTypes(pe.isValid,Z,{value:dt}),isEqual:ea.setTypes(pe.isEqual,Z,{value:ye,test:ye}),isNotEqual:ea.setTypes(pe.isNotEqual,Z,{value:ye,test:ye}),isLess:ea.setTypes(pe.isLess,Z,{value:ye,test:ye}),isLessOrEqual:ea.setTypes(pe.isLessOrEqual,Z,{value:ye,test:ye}),isGreater:ea.setTypes(pe.isGreater,Z,{value:ye,test:ye}),isGreaterOrEqual:ea.setTypes(pe.isGreaterOrEqual,Z,{value:ye,test:ye}),asAny:ea.setTypes(pe.asAny,dt,{value:ye}),asBoolean:ea.setTypes(pe.asBoolean,Z,{value:ye}),asColor:ea.setTypes(pe.asColor,si,{value:ye}),asDate:ea.setTypes(pe.asDate,Eo,{value:ye}),asList:ea.setTypes(pe.asList,function(t){return hn.forItem(t.value||ye)},{value:ye}),asMap:ea.setTypes(pe.asMap,function(t){return jo.forItem(t.value||ye)},{value:ye}),asNumber:ea.setTypes(pe.asNumber,Pn,{value:ye}),asObject:ea.setTypes(pe.asObject,function(t){return t.value||ye},{value:ye}),asText:ea.setTypes(pe.asText,Lt,{value:ye}),asTuple:ea.setTypes(pe.asTuple,function(t){return Tn.forItem([t.value||ye])},{value:ye}),asSet:ea.setTypes(pe.asSet,function(t){return mi.forItem(t.value||ye)},{value:ye})},oa=mi.operations,ia=function(t){return t instanceof mi?t:void 0},sa=function(t){return ia(t.set)||mi},aa=function(t){return ia(t.set)?t.set.options.value:dt},ua={set:sa,value:aa},pa=function(t){return ia(t.value)||mi},ca=function(t){return ia(t.value)?t.value.options.value:dt},la={create:oa.setTypes(ci.create,mi),createLike:oa.setTypes(ci.createLike,sa,{set:sa}),createFor:oa.setTypes(ci.createFor,function(t){return hn.forItem(t.value||dt)},{value:function(t){return t.value||dt}}),maybe:oa.setTypes(ci.maybe,function(t){return Ti.maybe(t.value,mi)},{value:dt}),add:oa.setTypes(ci.add,sa,{set:sa,value:aa}),has:oa.setTypes(ci.has,Z,{set:sa,value:aa}),delete:oa.setTypes(ci.delete,Z,{set:sa,value:aa}),values:oa.setTypes(ci.values,function(t){return hn.forItem(aa(t))},{set:sa}),clear:oa.setTypes(ci.clear,sa,{set:sa}),count:oa.setTypes(ci.count,Pn,{set:sa}),cmp:oa.setTypes(ci.cmp,Pn,{value:pa,test:pa}),copy:oa.setTypes(ci.copy,sa,{set:sa},{deepCopy:aa},ua),map:oa.setTypes(ci.map,function(t){return mi.forItem(t.transform||aa(t))},{set:sa},{transform:function(t){return t.transform||aa(t)}},ua),isValid:oa.setTypes(ci.isValid,Z,{value:dt}),isEqual:oa.setTypes(ci.isEqual,Z,{value:pa,test:pa}),isNotEqual:oa.setTypes(ci.isNotEqual,Z,{value:pa,test:pa}),isLess:oa.setTypes(ci.isLess,Z,{value:pa,test:pa}),isLessOrEqual:oa.setTypes(ci.isLessOrEqual,Z,{value:pa,test:pa}),isGreater:oa.setTypes(ci.isGreater,Z,{value:pa,test:pa}),isGreaterOrEqual:oa.setTypes(ci.isGreaterOrEqual,Z,{value:pa,test:pa}),asAny:oa.setTypes(ci.asAny,dt,{value:mi}),asBoolean:oa.setTypes(ci.asBoolean,Z,{value:mi}),asColor:oa.setTypes(ci.asColor,si,{value:mi}),asDate:oa.setTypes(ci.asDate,Eo,{value:mi}),asList:oa.setTypes(ci.asList,function(t){return hn.forItem(ca(t))},{value:mi}),asMap:oa.setTypes(ci.asMap,function(t){return jo.forItem(ca(t),ca(t))},{value:mi}),asNumber:oa.setTypes(ci.asNumber,function(t){return Pn},{value:mi}),asObject:oa.setTypes(ci.asObject,ye,{value:mi}),asText:oa.setTypes(ci.asText,Lt,{value:mi}),asTuple:oa.setTypes(ci.asTuple,function(t){return Tn.forItem([t.value||mi])},{value:mi}),asSet:oa.setTypes(ci.asSet,function(t){return t.value||mi},{value:mi})},fa=Lt.operations,ya=hn.forItem(Lt),da=Ti.object({index:Pn,lastIndex:Pn,input:Lt,groups:ya}),ha={create:fa.setTypes(jt.create,Lt),uuid:fa.setTypes(jt.uuid,Lt),maybe:fa.setTypes(jt.maybe,function(t){return Ti.maybe(t.value,Lt)},{value:dt}),append:fa.setTypes(jt.append,Lt,{value:Lt,append:Lt}),prepend:fa.setTypes(jt.prepend,Lt,{value:Lt,prepend:Lt}),lower:fa.setTypes(jt.lower,Lt,{value:Lt}),upper:fa.setTypes(jt.upper,Lt,{value:Lt}),char:fa.setTypes(jt.char,Lt,{value:Lt,index:Pn},{outside:Lt}),replace:fa.setTypes(jt.replace,Lt,{value:Lt,find:Lt,replace:Lt}),repeat:fa.setTypes(jt.repeat,Lt,{value:Lt,times:Pn}),split:fa.setTypes(jt.split,ya,{value:Lt,by:Lt},{limit:Pn}),chars:fa.setTypes(jt.chars,ya,{value:Lt}),sub:fa.setTypes(jt.sub,Lt,{value:Lt},{start:Pn,end:Pn}),indexOf:fa.setTypes(jt.indexOf,Pn,{value:Lt,search:Lt},{start:Pn}),lastIndexOf:fa.setTypes(jt.lastIndexOf,Pn,{value:Lt,search:Lt},{start:Pn}),trim:fa.setTypes(jt.trim,Lt,{value:Lt},{start:Z,end:Z}),startsWith:fa.setTypes(jt.startsWith,Z,{value:Lt,test:Lt}),endsWith:fa.setTypes(jt.endsWith,Z,{value:Lt,test:Lt}),soundex:fa.setTypes(jt.soundex,Lt,{value:Lt},{max:Pn,min:Pn}),metaphone:fa.setTypes(jt.metaphone,Lt,{value:Lt}),distance:fa.setTypes(jt.distance,Pn,{value:Lt,test:Lt}),length:fa.setTypes(jt.length,Pn,{value:Lt}),compare:fa.setTypes(jt.compare,Pn,{value:Lt,test:Lt},{ignoreCase:Z}),like:fa.setTypes(jt.like,Z,{value:Lt,pattern:Lt},{ignoreCase:Z}),pad:fa.setTypes(jt.pad,Lt,{value:Lt,padding:Lt,min:Pn},{max:Pn,append:Z}),regexTest:fa.setTypes(jt.regexTest,Z,{value:Lt,regex:Lt},{ignoreCase:Z,multiline:Z}),regexSplit:fa.setTypes(jt.regexSplit,ya,{value:Lt,regex:Lt},{limit:Pn,ignoreCase:Z,multiline:Z}),regexMatch:fa.setTypes(jt.regexMatch,ya,{value:Lt,regex:Lt},{ignoreCase:Z,multiline:Z}),regexMatchAll:fa.setTypes(jt.regexMatchAll,hn.forItem(da),{value:Lt,regex:Lt},{ignoreCase:Z,multiline:Z}),regexReplace:fa.setTypes(jt.regexReplace,Lt,{value:Lt,regex:Lt,replacement:Lt},{all:Z,ignoreCase:Z,multiline:Z}),regexReplaceDynamic:fa.setTypes(jt.regexReplaceDynamic,Lt,{value:Lt,regex:Lt,replace:Lt},{all:Z,ignoreCase:Z,multiline:Z},{match:da}),regexIndexOf:fa.setTypes(jt.regexIndexOf,Pn,{value:Lt,regex:Lt},{ignoreCase:Z,multiline:Z}),base64:fa.setTypes(jt.base64,Lt,{value:Lt}),unbase64:fa.setTypes(jt.unbase64,Lt,{value:Lt}),encodeURI:fa.setTypes(jt.encodeURI,Lt,{value:Lt}),decodeURI:fa.setTypes(jt.decodeURI,Lt,{value:Lt}),encodeURIComponent:fa.setTypes(jt.encodeURIComponent,Lt,{value:Lt}),decodeURIComponent:fa.setTypes(jt.decodeURIComponent,Lt,{value:Lt}),md5:fa.setTypes(jt.md5,Lt,{value:Lt}),encrypt:fa.setTypes(jt.encrypt,Lt,{value:Lt,secret:Lt}),decrypt:fa.setTypes(jt.decrypt,Lt,{value:Lt,secret:Lt}),toNumber:fa.setTypes(jt.toNumber,Pn,{value:Lt},{invalidValue:Pn}),isValid:fa.setTypes(jt.isValid,Z,{value:dt}),isEmpty:fa.setTypes(jt.isEmpty,Z,{value:Lt}),isNotEmpty:fa.setTypes(jt.isNotEmpty,Z,{value:Lt}),isEqual:fa.setTypes(jt.isEqual,Z,{a:Lt,b:Lt},{ignoreCase:Z}),isNotEqual:fa.setTypes(jt.isNotEqual,Z,{a:Lt,b:Lt},{ignoreCase:Z}),isLess:fa.setTypes(jt.isLess,Z,{value:Lt,test:Lt},{ignoreCase:Z}),isLessOrEqual:fa.setTypes(jt.isLessOrEqual,Z,{value:Lt,test:Lt},{ignoreCase:Z}),isGreater:fa.setTypes(jt.isGreater,Z,{value:Lt,test:Lt},{ignoreCase:Z}),isGreaterOrEqual:fa.setTypes(jt.isGreaterOrEqual,Z,{value:Lt,test:Lt},{ignoreCase:Z}),isLower:fa.setTypes(jt.isLower,Z,{value:Lt}),isUpper:fa.setTypes(jt.isUpper,Z,{value:Lt}),isUuid:fa.setTypes(jt.isUuid,Z,{value:Lt}),asAny:fa.setTypes(jt.asAny,dt,{value:Lt}),asBoolean:fa.setTypes(jt.asBoolean,Z,{value:Lt}),asColor:fa.setTypes(jt.asColor,si,{value:Lt}),asDate:fa.setTypes(jt.asDate,Eo,{value:Lt}),asList:fa.setTypes(jt.asList,function(t){return hn.forItem(t.value||Lt)},{value:Lt}),asMap:fa.setTypes(jt.asMap,function(t){return jo.forItem(t.value||Lt)},{value:Lt}),asNumber:fa.setTypes(jt.asNumber,Pn,{value:Lt}),asObject:fa.setTypes(jt.asObject,ye,{value:Lt}),asText:fa.setTypes(jt.asText,function(t){return t.value||Lt},{value:Lt}),asTuple:fa.setTypes(jt.asTuple,function(t){return Tn.forItem([t.value||Lt])},{value:Lt}),asSet:fa.setTypes(jt.asSet,function(t){return mi.forItem(t.value||Lt)},{value:Lt})},va=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ma=Tn.operations,ga={create:ma.setTypes(tn.create,Tn),maybe:ma.setTypes(tn.maybe,function(t){return Ti.maybe(t.value,Tn)},{value:dt}),cmp:ma.setTypes(tn.cmp,Pn,{value:Tn,test:Tn}),copy:ma.setTypes(tn.copy,Tn,{value:Tn}),build:ma.setTypes(tn.build,function(t){var e,n,r=[],o=!1;try{for(var i=va(["a","b","c","d","e"]),s=i.next();!s.done;s=i.next()){var a=t[s.value];a&&(a instanceof Tn?r=r.concat(a.options):a instanceof hn?(o=!0,r.push(a.options.item)):r.push(a))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o?hn.forItem(Ti.mergeMany(r,ct.baseType)):new Tn(r)},{a:dt,b:dt},{c:dt,d:dt,e:dt}),get:ma.setTypes(tn.get,dt,{value:Tn,index:Pn}),set:ma.setTypes(tn.set,dt,{value:Tn,index:Pn,element:dt}),isValid:ma.setTypes(tn.isValid,Z,{value:dt}),isEqual:ma.setTypes(tn.isEqual,Z,{value:Tn,test:Tn}),isNotEqual:ma.setTypes(tn.isNotEqual,Z,{value:Tn,test:Tn}),isLess:ma.setTypes(tn.isLess,Z,{value:Tn,test:Tn}),isLessOrEqual:ma.setTypes(tn.isLessOrEqual,Z,{value:Tn,test:Tn}),isGreater:ma.setTypes(tn.isGreater,Z,{value:Tn,test:Tn}),isGreaterOrEqual:ma.setTypes(tn.isGreaterOrEqual,Z,{value:Tn,test:Tn}),asAny:ma.setTypes(tn.asAny,dt,{value:Tn}),asBoolean:ma.setTypes(tn.asBoolean,Z,{value:Tn}),asColor:ma.setTypes(tn.asColor,si,{value:Tn}),asDate:ma.setTypes(tn.asDate,Eo,{value:Tn}),asList:ma.setTypes(tn.asList,function(t){return hn.forItem(t.value||Tn)},{value:Tn}),asMap:ma.setTypes(tn.asMap,function(t){return jo.forItem(t.value||Tn)},{value:Tn}),asNumber:ma.setTypes(tn.asNumber,Pn,{value:Tn}),asObject:ma.setTypes(tn.asObject,ye,{value:Tn}),asText:ma.setTypes(tn.asText,Lt,{value:Tn}),asTuple:ma.setTypes(tn.asTuple,function(t){return t.value||Tn},{value:Tn}),asSet:ma.setTypes(tn.asSet,function(t){return mi.forItem(t.value||Tn)},{value:Tn})},Ta=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ba=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},xa=function(){function t(t,e){void 0===e&&(e={}),this.cached={},this.sections=[],this.add(t),this.escapes=e}return t.prototype.add=function(t,e){if(i(t))this.getSection(t.length).formats[t]=e;else for(var n in t)this.getSection(n.length).formats[n]=t[n];return this},t.prototype.getSection=function(t){var e,n,r=this.sections.length-t,o=this.sections[r];if(o&&o.size===t)return o;try{for(var i=Ta(this.sections),s=i.next();!s.done;s=i.next()){var a=s.value;if(a.size===t)return a}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}var u={size:t,formats:{}};return this.sections.push(u),this.sortBySize(),u},t.prototype.sortBySize=function(){this.sections.sort(function(t,e){return e.size-t.size})},t.prototype.getEscaped=function(t,e){var n=t.charAt(e),r=this.escapes[n];if(!r)return!1;var o=r.start,i=r.end,s=r.startEscape,a=r.endEscape;if(t.substring(e,e+o.length)!==o)return!1;var u=e-s.indexOf(o);if(t.substring(u,u+s.length)===s)return!1;e+=o.length;var p=a.indexOf(i),c=t.indexOf(i,e),l=t.substring(e,c);for(e=c-p;-1!==c&&t.substring(e,e+a.length)===a;)l=l.substring(0,l.length-p),l+=i,e+=a.length,c=t.indexOf(i,e),l+=t.substring(e,c),e=c-p;return-1!==c&&[l,c+i.length]},t.prototype.getFormatter=function(t,e){if(void 0===e&&(e=!1),t in this.cached)return this.cached[t];for(var n,r=this.sections,o=[],i="",s=function(e){var s=a.getEscaped(t,e);if(!1!==s){var u=ba(s,2),p=u[0],c=u[1];return i+=p,n=e=c-1,"continue"}for(var l=!1,f=0;f<r.length&&!l;f++){var y=r[f],d=t.substring(e,e+y.size);if(d.length===y.size){var h=y.formats[d];h&&(o.push(h),e+=y.size-1,l=!0)}}if(l){if(i){var v=i;o.splice(o.length-1,0,function(){return v}),i=""}}else i+=t.charAt(e);n=e},a=this,u=0;u<t.length;u++)s(u),u=n;i&&o.push(function(){return i});var p=function(t){var e,n,r="";try{for(var i=Ta(o),s=i.next();!s.done;s=i.next()){r+=(0,s.value)(t)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r};return e&&(this.cached[t]=p),p},t.prototype.format=function(t,e,n){return void 0===n&&(n=!1),this.getFormatter(t,n)(e)},t}(),Oa=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ea=new xa({M:function(t){return Oa(t,1)[0].getMonth()+1+""},Mo:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(n.getMonth()+1)},MM:function(t){return I(Oa(t,1)[0].getMonth()+1,2)},MMm:function(t){var e=Oa(t,2),n=e[0];return e[1].months[3][n.getMonth()]},MMM:function(t){var e=Oa(t,2),n=e[0];return e[1].months[2][n.getMonth()]},MMMm:function(t){var e=Oa(t,2),n=e[0];return e[1].months[1][n.getMonth()]},MMMM:function(t){var e=Oa(t,2),n=e[0];return e[1].months[0][n.getMonth()]},Q:function(t){return Nr(Oa(t,1)[0])+1+""},Qo:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(Nr(n)+1)},D:function(t){return Oa(t,1)[0].getDate()+""},Do:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(n.getDate())},DD:function(t){return I(Oa(t,1)[0].getDate(),2)},DDD:function(t){return Pr(Oa(t,1)[0])+""},DDDo:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(Pr(n))},DDDD:function(t){return I(Pr(Oa(t,1)[0]),3)},d:function(t){return Oa(t,1)[0].getDay()+""},do:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(n.getDay())},dd:function(t){var e=Oa(t,2),n=e[0];return e[1].weekdays[3][n.getDay()]},ddd:function(t){var e=Oa(t,2),n=e[0];return e[1].weekdays[2][n.getDay()]},dddd:function(t){var e=Oa(t,2),n=e[0];return e[1].weekdays[0][n.getDay()]},e:function(t){return Sr(Oa(t,1)[0])+""},E:function(t){return Sr(Oa(t,1)[0])+1+""},eo:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(Sr(n))},Eo:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(Sr(n)+1)},w:function(t){return lr(Oa(t,1)[0])+""},wo:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(lr(n))},ww:function(t){return I(lr(Oa(t,1)[0]),2)},W:function(t){return cr(Oa(t,1)[0])+""},Wo:function(t){var e=Oa(t,2),n=e[0];return e[1].suffix(cr(n))},WW:function(t){return I(cr(Oa(t,1)[0]),2)},Y:function(t){return Oa(t,1)[0].getFullYear()+""},YY:function(t){return I(Oa(t,1)[0].getFullYear()%100,2)},YYYY:function(t){return I(Oa(t,1)[0].getFullYear(),4,10)},gg:function(t){return I(Oa(t,1)[0].getFullYear()%100,2)},gggg:function(t){return I(Oa(t,1)[0].getFullYear(),4,10)},GG:function(t){return I(Oa(t,1)[0].getFullYear()%100,2)},GGGG:function(t){return I(Oa(t,1)[0].getFullYear(),4,10)},a:function(t){var e=Oa(t,2),n=e[0],r=e[1];return n.getHours()<12?r.am:r.pm},A:function(t){var e=Oa(t,2),n=e[0],r=e[1];return n.getHours()<12?r.am.toUpperCase():r.pm.toUpperCase()},H:function(t){return Oa(t,1)[0].getHours()+""},HH:function(t){return I(Oa(t,1)[0].getHours(),2)},h:function(t){return(Oa(t,1)[0].getHours()%12||12)+""},hh:function(t){return I(Oa(t,1)[0].getHours()%12||12,2)},k:function(t){return Oa(t,1)[0].getHours()+1+""},kk:function(t){return I(Oa(t,1)[0].getHours()+1,2)},m:function(t){return Oa(t,1)[0].getMinutes()+""},mm:function(t){return I(Oa(t,1)[0].getMinutes(),2)},s:function(t){return Oa(t,1)[0].getSeconds()+""},ss:function(t){return I(Oa(t,1)[0].getSeconds(),2)},S:function(t){return I(Oa(t,1)[0].getMilliseconds(),3,1)},SS:function(t){return I(Oa(t,1)[0].getMilliseconds(),3,2)},SSS:function(t){return I(Oa(t,1)[0].getMilliseconds(),3)},SSSS:function(t){return I(Oa(t,1)[0].getMilliseconds(),3)+"0"},SSSSS:function(t){return I(Oa(t,1)[0].getMilliseconds(),3)+"00"},SSSSSS:function(t){return I(Oa(t,1)[0].getMilliseconds(),3)+"000"},SSSSSSS:function(t){return I(Oa(t,1)[0].getMilliseconds(),3)+"0000"},SSSSSSSS:function(t){return I(Oa(t,1)[0].getMilliseconds(),3)+"00000"},SSSSSSSSS:function(t){return I(Oa(t,1)[0].getMilliseconds(),3)+"000000"},z:function(t){return Oa(t,1)[0].toLocaleTimeString("en-us",{timeZoneName:"short"}).split(" ")[2]},zz:function(t){return Oa(t,1)[0].toLocaleTimeString("en-us",{timeZoneName:"long"}).split(" ")[2]},Z:function(t){return Sa(Oa(t,1)[0],":")},ZZ:function(t){return Sa(Oa(t,1)[0],"")},X:function(t){var e=Oa(t,1)[0];return Math.floor(e.valueOf()/1e3)+""},x:function(t){return Oa(t,1)[0].valueOf()+""},LT:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatLT,[n,r])},LTS:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatLTS,[n,r])},L:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatL,[n,r])},l:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatl,[n,r])},LL:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatLL,[n,r])},ll:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatll,[n,r])},LLL:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatLLL,[n,r])},lll:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatlll,[n,r])},LLLL:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatLLLL,[n,r])},llll:function(t){var e=Oa(t,2),n=e[0],r=e[1];return wa.format(r.formatllll,[n,r])}},{"[":{start:"[",startEscape:"\\[",end:"]",endEscape:"\\]"},"'":{start:"'",startEscape:"''",end:"'",endEscape:"''"}}),wa=Ea;function Sa(t,e){var n=_r(t),r=Math.floor(Math.abs(n)/100),o=Math.abs(n)%100;return(n<0?"-":"+")+I(r,2)+e+I(o,2)}n.d(e,"isNumber",function(){return o}),n.d(e,"isString",function(){return i}),n.d(e,"isArray",function(){return s}),n.d(e,"isDate",function(){return a}),n.d(e,"isMap",function(){return u}),n.d(e,"isSet",function(){return p}),n.d(e,"isBoolean",function(){return c}),n.d(e,"isFunction",function(){return l}),n.d(e,"isObject",function(){return f}),n.d(e,"isUndefined",function(){return y}),n.d(e,"isSameClass",function(){return d}),n.d(e,"isWhole",function(){return h}),n.d(e,"isEmpty",function(){return v}),n.d(e,"clamp",function(){return m}),n.d(e,"toMap",function(){return g}),n.d(e,"reverseMap",function(){return T}),n.d(e,"arraySync",function(){return b}),n.d(e,"objectSync",function(){return x}),n.d(e,"objectMap",function(){return O}),n.d(e,"objectEach",function(){return E}),n.d(e,"objectValues",function(){return w}),n.d(e,"objectReduce",function(){return S}),n.d(e,"objectFromProps",function(){return P}),n.d(e,"objectToArray",function(){return _}),n.d(e,"coalesce",function(){return M}),n.d(e,"padNumber",function(){return I}),n.d(e,"pad",function(){return C}),n.d(e,"toString",function(){return D}),n.d(e,"Definitions",function(){return ts}),n.d(e,"DataTypeRegistry",function(){return X}),n.d(e,"DataTypes",function(){return $}),n.d(e,"EntityKeyType",function(){return fi}),n.d(e,"EntityPrimaryType",function(){return yi}),n.d(e,"Entity",function(){return Di}),n.d(e,"EventBase",function(){return Ei}),n.d(e,"Expression",function(){return V}),n.d(e,"Exprs",function(){return wn}),n.d(e,"Func",function(){return Pi}),n.d(e,"LinkedNode",function(){return bi}),n.d(e,"isOperationTypeFunction",function(){return F}),n.d(e,"Operations",function(){return G}),n.d(e,"Computeds",function(){return B}),n.d(e,"Program",function(){return Ri}),n.d(e,"ReferenceData",function(){return Fi}),n.d(e,"RelationKind",function(){return Ii}),n.d(e,"RelationCascade",function(){return Ci}),n.d(e,"Relation",function(){return Ai}),n.d(e,"Runtime",function(){return es}),n.d(e,"Type",function(){return R}),n.d(e,"Types",function(){return Ti}),n.d(e,"TraverseRemoveNoop",function(){return A}),n.d(e,"TraverseReplaceNoop",function(){return N}),n.d(e,"Traverser",function(){return L}),n.d(e,"ValidationSeverity",function(){return j}),n.d(e,"ValidationType",function(){return k}),n.d(e,"FastMap",function(){return Wi}),n.d(e,"NamedMap",function(){return Ki}),n.d(e,"ID",function(){return U}),n.d(e,"EntityType",function(){return he}),n.d(e,"AnyType",function(){return dt}),n.d(e,"BooleanType",function(){return Z}),n.d(e,"ColorType",function(){return si}),n.d(e,"DateType",function(){return Eo}),n.d(e,"EnumType",function(){return Ut}),n.d(e,"ListType",function(){return hn}),n.d(e,"ManyType",function(){return Mo}),n.d(e,"MapType",function(){return jo}),n.d(e,"NotType",function(){return Ro}),n.d(e,"NullType",function(){return ct}),n.d(e,"NumberType",function(){return Pn}),n.d(e,"ObjectType",function(){return ye}),n.d(e,"OptionalType",function(){return Ao}),n.d(e,"SetType",function(){return mi}),n.d(e,"TextType",function(){return Lt}),n.d(e,"TupleType",function(){return Tn}),n.d(e,"AndExpression",function(){return rt}),n.d(e,"ChainExpression",function(){return wt}),n.d(e,"CommentExpression",function(){return Pt}),n.d(e,"ComputedExpression",function(){return Mt}),n.d(e,"ConstantExpression",function(){return Ht}),n.d(e,"DefineExpression",function(){return mt}),n.d(e,"DoExpression",function(){return xt}),n.d(e,"ForExpression",function(){return Xt}),n.d(e,"GetExpression",function(){return Zt}),n.d(e,"GetDataExpression",function(){return ee}),n.d(e,"GetEntityExpression",function(){return me}),n.d(e,"GetRelationExpression",function(){return Te}),n.d(e,"IfExpression",function(){return Oe}),n.d(e,"InvokeExpression",function(){return we}),n.d(e,"NoExpression",function(){return ft}),n.d(e,"NotExpression",function(){return et}),n.d(e,"ObjectExpression",function(){return En}),n.d(e,"OperationExpression",function(){return Ie}),n.d(e,"OrExpression",function(){return Pe}),n.d(e,"ReturnExpression",function(){return De}),n.d(e,"SetExpression",function(){return Ae}),n.d(e,"SubExpression",function(){return Re}),n.d(e,"SwitchExpression",function(){return Fe}),n.d(e,"TemplateExpression",function(){return Ge}),n.d(e,"TupleExpression",function(){return xn}),n.d(e,"UpdateExpression",function(){return He}),n.d(e,"WhileExpression",function(){return Xe}),n.d(e,"defs",function(){return ns}),n.d(e,"EntityOperations",function(){return ne}),n.d(e,"EntityComputeds",function(){return re}),n.d(e,"EntityOps",function(){return ie}),n.d(e,"AnyOperations",function(){return ot}),n.d(e,"AnyComputeds",function(){return it}),n.d(e,"AnyOps",function(){return ut}),n.d(e,"BooleanOperations",function(){return W}),n.d(e,"BooleanComputeds",function(){return H}),n.d(e,"BooleanOps",function(){return K}),n.d(e,"ColorOperations",function(){return qo}),n.d(e,"ColorComputeds",function(){return Vo}),n.d(e,"ColorOps",function(){return Yo}),n.d(e,"DateOperations",function(){return mo}),n.d(e,"DateComputeds",function(){return go}),n.d(e,"DateOps",function(){return bo}),n.d(e,"ListOperations",function(){return sn}),n.d(e,"ListComputeds",function(){return an}),n.d(e,"ListOps",function(){return pn}),n.d(e,"MapOperations",function(){return Rt}),n.d(e,"MapComputeds",function(){return qt}),n.d(e,"MapOps",function(){return Ft}),n.d(e,"NumberOperations",function(){return en}),n.d(e,"NumberComputeds",function(){return nn}),n.d(e,"NumberOps",function(){return on}),n.d(e,"ObjectOperations",function(){return se}),n.d(e,"ObjectComputeds",function(){return ae}),n.d(e,"ObjectOps",function(){return pe}),n.d(e,"SetOperations",function(){return ai}),n.d(e,"SetComputeds",function(){return ui}),n.d(e,"SetOps",function(){return ci}),n.d(e,"TextOperations",function(){return It}),n.d(e,"TextComputeds",function(){return Ct}),n.d(e,"TextOps",function(){return jt}),n.d(e,"TupleOperations",function(){return $e}),n.d(e,"TupleComputeds",function(){return Qe}),n.d(e,"TupleOps",function(){return tn}),n.d(e,"EntityOpsTypes",function(){return cs}),n.d(e,"AnyOpsTypes",function(){return fs}),n.d(e,"BooleanOpsTypes",function(){return ds}),n.d(e,"ColorComponentEnum",function(){return vs}),n.d(e,"ColorOrNumber",function(){return ms}),n.d(e,"ColorFormats",function(){return gs}),n.d(e,"ColorNames",function(){return Ts}),n.d(e,"ColorBlendModes",function(){return bs}),n.d(e,"ColorOpsTypes",function(){return xs}),n.d(e,"DateOpsTypes",function(){return Ps}),n.d(e,"ListOpsTypes",function(){return Vs}),n.d(e,"MapOpsTypes",function(){return Xs}),n.d(e,"NumberOpsTypes",function(){return Zs}),n.d(e,"ObjectOpsTypes",function(){return ra}),n.d(e,"SetOpsTypes",function(){return la}),n.d(e,"TextOpsTypes",function(){return ha}),n.d(e,"TupleOpsTypes",function(){return ga}),n.d(e,"currentLocale",function(){return Mn}),n.d(e,"COMPONENT_MIN",function(){return Go}),n.d(e,"COMPONENT_MAX",function(){return Bo}),n.d(e,"isColor",function(){return Uo}),n.d(e,"clampComponent",function(){return Wo}),n.d(e,"ColorSpace",function(){return Ho}),n.d(e,"isColorHSL",function(){return Qo}),n.d(e,"ColorSpaceHSL",function(){return Zo}),n.d(e,"ColorSpaceRGB",function(){return Ko}),n.d(e,"MILLIS_IN_SECOND",function(){return In}),n.d(e,"SECONDS_IN_MINUTE",function(){return 60}),n.d(e,"HOURS_IN_DAY",function(){return 24}),n.d(e,"DAYS_IN_WEEK",function(){return Cn}),n.d(e,"MILLIS_IN_MINUTE",function(){return Dn}),n.d(e,"MILLIS_IN_HOUR",function(){return jn}),n.d(e,"MILLIS_IN_DAY",function(){return kn}),n.d(e,"MONTHS_IN_QUARTER",function(){return An}),n.d(e,"MONTHS_IN_YEAR",function(){return Nn}),n.d(e,"DAY_MIN",function(){return Ln}),n.d(e,"DAY_MAX",function(){return Rn}),n.d(e,"HOUR_MAX",function(){return qn}),n.d(e,"MINUTE_MAX",function(){return Vn}),n.d(e,"SECOND_MAX",function(){return Fn}),n.d(e,"MILLIS_MAX",function(){return Yn}),n.d(e,"WEEKDAY_MAX",function(){return Gn}),n.d(e,"DateFormat",function(){return Ea}),n.d(e,"adjusters",function(){return Hn}),n.d(e,"getters",function(){return Jn}),n.d(e,"setters",function(){return Kn}),n.d(e,"startOf",function(){return zn}),n.d(e,"endOf",function(){return Xn}),n.d(e,"add",function(){return $n}),n.d(e,"diff",function(){return Qn}),n.d(e,"mutate",function(){return Zn}),n.d(e,"compareDates",function(){return tr}),n.d(e,"DateParsers",function(){return er}),n.d(e,"parse",function(){return nr}),n.d(e,"getTimeIdentifier",function(){return rr}),n.d(e,"getDayIdentifier",function(){return or}),n.d(e,"getWeekIdentifier",function(){return ir}),n.d(e,"getMonthIdentifier",function(){return sr}),n.d(e,"getQuarterIdentifier",function(){return ar}),n.d(e,"getLastDayOfMonth",function(){return ur}),n.d(e,"getLastWeekspanOfYear",function(){return pr}),n.d(e,"getWeekOfYearISO",function(){return cr}),n.d(e,"getWeekOfYear",function(){return lr}),n.d(e,"getWeekspanOfYear",function(){return fr}),n.d(e,"getFullWeekOfYear",function(){return yr}),n.d(e,"getWeeksInYear",function(){return dr}),n.d(e,"getLastFullWeekOfYear",function(){return hr}),n.d(e,"getWeekspanOfMonth",function(){return vr}),n.d(e,"getLastWeekspanOfMonth",function(){return mr}),n.d(e,"getFullWeekOfMonth",function(){return gr}),n.d(e,"getLastFullWeekOfMonth",function(){return Tr}),n.d(e,"getWeekOfMonthISO",function(){return br}),n.d(e,"getWeekOfMonth",function(){return xr}),n.d(e,"getWeekISO",function(){return Or}),n.d(e,"getWeek",function(){return Er}),n.d(e,"getFullWeekOf",function(){return wr}),n.d(e,"getDayOfWeek",function(){return Sr}),n.d(e,"getDayOfYear",function(){return Pr}),n.d(e,"getDateOffset",function(){return _r}),n.d(e,"isDaylightSavingTime",function(){return Mr}),n.d(e,"isLeapYear",function(){return Ir}),n.d(e,"getDaysInYear",function(){return Cr}),n.d(e,"daysInMonth",function(){return Dr}),n.d(e,"getDaysInMonth",function(){return jr}),n.d(e,"getAbsoluteTimestamp",function(){return kr}),n.d(e,"getTimezoneOffsetInMilliseconds",function(){return Ar}),n.d(e,"getQuarter",function(){return Nr}),n.d(e,"startOfSecond",function(){return Lr}),n.d(e,"startOfMinute",function(){return Rr}),n.d(e,"startOfHour",function(){return qr}),n.d(e,"startOfDay",function(){return Vr}),n.d(e,"startOfWeek",function(){return Fr}),n.d(e,"startOfMonth",function(){return Yr}),n.d(e,"startOfQuarter",function(){return Gr}),n.d(e,"startOfYear",function(){return Br}),n.d(e,"endOfSecond",function(){return Ur}),n.d(e,"endOfMinute",function(){return Wr}),n.d(e,"endOfHour",function(){return Hr}),n.d(e,"endOfDay",function(){return Jr}),n.d(e,"endOfWeek",function(){return Kr}),n.d(e,"endOfMonth",function(){return zr}),n.d(e,"endOfQuarter",function(){return Xr}),n.d(e,"endOfYear",function(){return $r}),n.d(e,"addMilliseconds",function(){return Qr}),n.d(e,"addSeconds",function(){return Zr}),n.d(e,"addMinutes",function(){return to}),n.d(e,"addHours",function(){return eo}),n.d(e,"addDays",function(){return no}),n.d(e,"addWeeks",function(){return ro}),n.d(e,"addMonths",function(){return oo}),n.d(e,"addQuarters",function(){return io}),n.d(e,"addYears",function(){return so}),n.d(e,"diffMilliseconds",function(){return ao}),n.d(e,"diffSeconds",function(){return uo}),n.d(e,"diffMinutes",function(){return po}),n.d(e,"diffHours",function(){return co}),n.d(e,"diffDays",function(){return lo}),n.d(e,"diffWeeks",function(){return fo}),n.d(e,"diffMonths",function(){return yo}),n.d(e,"diffQuarters",function(){return ho}),n.d(e,"diffYears",function(){return vo}),n.d(e,"Format",function(){return xa})}])});
//# sourceMappingURL=expangine-runtime.js.map