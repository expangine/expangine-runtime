!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["expangine-runtime"]=e():t["expangine-runtime"]=e()}(self,(function(){return(()=>{"use strict";var t={961:(t,e,n)=>{n.r(e),n.d(e,{AndExpression:()=>rt,AnyComputeds:()=>it,AnyOperations:()=>ot,AnyOps:()=>ut,AnyOpsTypes:()=>ds,AnyType:()=>ht,AssertExpression:()=>_n,BooleanComputeds:()=>U,BooleanOperations:()=>B,BooleanOps:()=>K,BooleanOpsTypes:()=>ms,BooleanType:()=>Z,COMPONENT_MAX:()=>Xo,COMPONENT_MIN:()=>zo,ChainExpression:()=>St,ColorBlendModes:()=>Es,ColorComponentEnum:()=>Ts,ColorComputeds:()=>Uo,ColorFormats:()=>xs,ColorNames:()=>Os,ColorOperations:()=>Bo,ColorOps:()=>Ko,ColorOpsTypes:()=>ws,ColorOrNumber:()=>bs,ColorSpace:()=>Zo,ColorSpaceHSL:()=>si,ColorSpaceRGB:()=>ei,ColorType:()=>fi,CommentExpression:()=>_t,ComputedExpression:()=>re,Computeds:()=>H,ConstantExpression:()=>Kt,DAYS_IN_WEEK:()=>Vn,DAY_MAX:()=>Jn,DAY_MIN:()=>Un,DataTypeRegistry:()=>X,DataTypes:()=>$,DateComputeds:()=>_o,DateFormat:()=>Sa,DateOperations:()=>Po,DateOps:()=>Mo,DateOpsTypes:()=>Ms,DateParsers:()=>cr,DateType:()=>jo,DefineExpression:()=>Tt,Definitions:()=>rs,DoExpression:()=>Ot,Entity:()=>Li,EntityComputeds:()=>ce,EntityKeyType:()=>gi,EntityOperations:()=>pe,EntityOps:()=>fe,EntityOpsTypes:()=>ys,EntityPrimaryType:()=>Ti,EntityType:()=>Oe,EnumType:()=>Ut,EventBase:()=>Mi,Expression:()=>F,Exprs:()=>jn,FastMap:()=>Xi,FlowExpression:()=>Ge,FlowType:()=>A,ForExpression:()=>se,Format:()=>Ea,Func:()=>ji,FunctionExpression:()=>Mn,FunctionType:()=>Re,GenericType:()=>De,GetDataExpression:()=>ue,GetEntityExpression:()=>we,GetExpression:()=>Ct,GetRelationExpression:()=>Pe,HOURS_IN_DAY:()=>Fn,HOUR_MAX:()=>Kn,ID:()=>G,IfExpression:()=>Me,InvokeExpression:()=>Ne,LinkedNode:()=>Pi,ListComputeds:()=>cn,ListOperations:()=>pn,ListOps:()=>fn,ListOpsTypes:()=>Gs,ListType:()=>mn,MILLIS_IN_DAY:()=>Hn,MILLIS_IN_HOUR:()=>Wn,MILLIS_IN_MINUTE:()=>Yn,MILLIS_IN_SECOND:()=>Ln,MILLIS_MAX:()=>$n,MINUTE_MAX:()=>zn,MONTHS_IN_QUARTER:()=>Gn,MONTHS_IN_YEAR:()=>Bn,ManyType:()=>ko,MapComputeds:()=>Vt,MapOperations:()=>Ft,MapOps:()=>Wt,MapOpsTypes:()=>ea,MapType:()=>Vo,MethodExpression:()=>Le,NamedMap:()=>Qi,NoExpression:()=>ft,NotExpression:()=>et,NotType:()=>Go,NullType:()=>ct,NumberComputeds:()=>sn,NumberOperations:()=>on,NumberOps:()=>un,NumberOpsTypes:()=>oa,NumberType:()=>An,ObjectComputeds:()=>he,ObjectExpression:()=>Sn,ObjectOperations:()=>ye,ObjectOps:()=>ve,ObjectOpsTypes:()=>aa,ObjectType:()=>be,OperationExpression:()=>We,Operations:()=>W,OptionalType:()=>Wo,OrExpression:()=>Fe,PathExpression:()=>ee,Program:()=>Wi,ReferenceData:()=>Bi,Relation:()=>Fi,RelationCascade:()=>ki,RelationKind:()=>Ni,Runtime:()=>os,SECONDS_IN_MINUTE:()=>qn,SECOND_MAX:()=>Xn,SetComputeds:()=>hi,SetExpression:()=>Xt,SetOperations:()=>yi,SetOps:()=>vi,SetOpsTypes:()=>da,SetType:()=>Ei,SwitchExpression:()=>Ke,TemplateExpression:()=>Xe,TextComputeds:()=>jt,TextOperations:()=>Dt,TextOps:()=>At,TextOpsTypes:()=>Ta,TextType:()=>qt,TraverseRemoveNoop:()=>N,TraverseReplaceNoop:()=>k,Traverser:()=>L,TupleComputeds:()=>en,TupleExpression:()=>En,TupleOperations:()=>tn,TupleOps:()=>rn,TupleOpsTypes:()=>xa,TupleType:()=>xn,Type:()=>q,Types:()=>Si,ValidationSeverity:()=>j,ValidationType:()=>R,WEEKDAY_MAX:()=>Qn,WhileExpression:()=>Ze,add:()=>sr,addBackwardsCompatibility:()=>Ma,addDays:()=>lo,addHours:()=>co,addMilliseconds:()=>ao,addMinutes:()=>po,addMonths:()=>yo,addQuarters:()=>ho,addSeconds:()=>uo,addWeeks:()=>fo,addYears:()=>vo,adjusters:()=>er,arraySync:()=>b,clamp:()=>m,clampComponent:()=>Qo,coalesce:()=>I,compareDates:()=>pr,currentLocale:()=>kn,daysInMonth:()=>Vr,defs:()=>is,diff:()=>ar,diffDays:()=>xo,diffHours:()=>bo,diffMilliseconds:()=>mo,diffMinutes:()=>To,diffMonths:()=>Eo,diffQuarters:()=>wo,diffSeconds:()=>go,diffWeeks:()=>Oo,diffYears:()=>So,endOf:()=>ir,endOfDay:()=>no,endOfHour:()=>eo,endOfMinute:()=>to,endOfMonth:()=>oo,endOfQuarter:()=>io,endOfSecond:()=>Zr,endOfWeek:()=>ro,endOfYear:()=>so,getAbsoluteTimestamp:()=>Wr,getDateOffset:()=>kr,getDayIdentifier:()=>yr,getDayOfWeek:()=>Ar,getDayOfYear:()=>Nr,getDaysInMonth:()=>Yr,getDaysInYear:()=>Fr,getFullWeekOf:()=>Rr,getFullWeekOfMonth:()=>_r,getFullWeekOfYear:()=>Or,getLastDayOfMonth:()=>mr,getLastFullWeekOfMonth:()=>Ir,getLastFullWeekOfYear:()=>wr,getLastWeekspanOfMonth:()=>Pr,getLastWeekspanOfYear:()=>gr,getMonthIdentifier:()=>dr,getQuarter:()=>Gr,getQuarterIdentifier:()=>vr,getTimeIdentifier:()=>fr,getTimezoneOffsetInMilliseconds:()=>Hr,getWeek:()=>jr,getWeekISO:()=>Dr,getWeekIdentifier:()=>hr,getWeekOfMonth:()=>Cr,getWeekOfMonthISO:()=>Mr,getWeekOfYear:()=>br,getWeekOfYearISO:()=>Tr,getWeeksInYear:()=>Er,getWeekspanOfMonth:()=>Sr,getWeekspanOfYear:()=>xr,getters:()=>nr,isArray:()=>i,isBoolean:()=>p,isColor:()=>$o,isColorHSL:()=>ii,isDate:()=>s,isDaylightSavingTime:()=>Lr,isEmpty:()=>d,isFunction:()=>c,isLeapYear:()=>qr,isMap:()=>a,isNumber:()=>r,isObject:()=>l,isOperationTypeFunction:()=>V,isSameClass:()=>y,isSet:()=>u,isString:()=>o,isUndefined:()=>f,isWhole:()=>h,mutate:()=>ur,now:()=>v,objectEach:()=>E,objectFromProps:()=>P,objectMap:()=>O,objectReduce:()=>S,objectSync:()=>x,objectToArray:()=>_,objectValues:()=>w,pad:()=>C,padNumber:()=>M,parse:()=>lr,reverseMap:()=>T,setters:()=>rr,startOf:()=>or,startOfDay:()=>Kr,startOfHour:()=>Jr,startOfMinute:()=>Ur,startOfMonth:()=>Xr,startOfQuarter:()=>$r,startOfSecond:()=>Br,startOfWeek:()=>zr,startOfYear:()=>Qr,toMap:()=>g,toString:()=>D});function r(t){return"number"==typeof t&&isFinite(t)}function o(t){return"string"==typeof t}function i(t){return Array.isArray(t)}function s(t){return t instanceof Date}function a(t){return t instanceof Map}function u(t){return t instanceof Set}function p(t){return"boolean"==typeof t}function c(t){return"function"==typeof t}function l(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function f(t){return void 0===t}function y(t,e){return t.constructor===e.constructor}function h(t,e){return void 0===e&&(e=1e-6),Math.abs(t-Math.round(t))<=e}function d(t){if(i(t))return 0===t.length;if(l(t)){for(var e in t)return!1;return!0}return null==t}function v(){return(new Date).getTime()}function m(t,e,n){return t<e?e:t>n?n:t}function g(t){return i(t)?new Map(t):a(t)?t:l(t)?new Map(_(t,(function(t,e){return[e,t]}))):new Map}function T(t){return new Map(Array.from(t.entries()).map((function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(t,2),n=e[0];return[e[1],n]})))}function b(t,e,n,r,o,i){for(var s=e.map((function(){return!1})),a=function(r){var a=t[r],u=e.findIndex((function(t){return n(a,t)}));-1!==u?(i(t,r,a,e[u]),s[u]=!0):o(t,r,a)},u=t.length-1;u>=0;u--)a(u);for(u=0;u<e.length;u++)s[u]||r(t,e[u]);return t}function x(t,e,n,r,o){for(var i in t)i in e||r(t,i,t[i]);for(var i in e)i in t?o(t,i,t[i],e[i]):n(t,i,e[i]);return t}function O(t,e,n){return S(t,(function(t,r,o){return o[n?n(r,t):r]=e(t,r),o}),Object.create(null))}function E(t,e){return S(t,(function(n,r){return e(n,r,t)}),void 0)}function w(t,e){return void 0===e&&(e=function(t){return t}),S(t,(function(t,n,r){return r.push(e(t,n)),r}),[])}function S(t,e,n){for(var r in t)n=e(t[r],r,n);return n}function P(t,e){for(var n=Object.create(null),r=0;r<t.length;r++){var o=t[r];n[o]=e(o,r)}return n}function _(t,e){var n=[];for(var r in t)n.push(e(t[r],r));return n}function I(t,e){return void 0===t?e:t}function M(t,e,n){return void 0===n&&(n=e),C(t+"",e,"0",!0).substring(0,n)}function C(t,e,n,r){for(;t.length<e;)r?t=n+t:t+=n;return t}function D(t){return i(t)||l(t)?JSON.stringify(t):t+""}var j,R,A,N=function(){},k=function(){},L=function(){function t(t,e){this.remove=N,this.replace=k,this.callback=t,this.stack=[],this.path=[],this.stopped=!1,this.result=e}return t.isTraversable=function(t){return t&&c(t.traverse)},t.prototype.enter=function(t,e){return this.stopped||(this.callback(t,this.stack,this.path,this),this.remove=N,this.replace=k,e&&!this.stopped&&(this.stack.push(t),e(),this.stack.pop())),this.result},t.prototype.step=function(e,n,r,o){return void 0===r&&(r=k),void 0===o&&(o=N),this.stopped||(this.path.push(e),this.remove=o,this.replace=r,t.isTraversable(n)?n.traverse(this):n(),this.path.pop()),this},t.prototype.modify=function(t){var e=t(this.result);return void 0!==e&&(this.result=e),this},t.prototype.stop=function(t){return this.result=t,this},t.prototype.getResult=function(){return this.result},t.prototype.removeOrReplace=function(t){var e=this.canRemove(),n=this.canReplace();return!(!e&&!n||(e?this.remove():this.replace(c(t)?t():t),0))},t.prototype.canRemove=function(){return this.remove!==N},t.prototype.canReplace=function(){return this.replace!==k},t.prototype.filterClass=function(t,e){return void 0===e&&(e=this.result),this.filter((function(e){return e.constructor===t}),e)},t.prototype.filter=function(e,n){var r=this;return void 0===n&&(n=this.result),new t((function(t,n,o,i){e(t,n,o)&&r.callback(t,n,o,i)}),n)},t.list=function(){var e=[];return new t((function(t,n,r){e.push({value:t,stack:n.slice(),path:r.slice()})}),e)},t.count=function(){return new t((function(t,e,n,r){return r.result++}),0)},t.some=function(e){return new t((function(t,n,r,o){e(t)&&o.stop(!0)}),!1)},t.someInstance=function(e){return new t((function(t,n,r,o){t.constructor===e&&o.stop(!0)}),!1)},t.find=function(e){return new t((function(t,n,r,o){e(t)&&o.stop(t)}),null)},t}(),q=function(){function t(t){this.parent=null,this.options=t}return t.prototype.getChildType=function(t){return null},t.prototype.getChildTypes=function(){return[]},t.prototype.getParentOfType=function(t){for(var e=this.parent;e;){if(e.constructor===t)return e;e=e.parent}return null},t.prototype.getRequired=function(){return this},t.prototype.isWrapper=function(){return!1},t.prototype.getWrappedType=function(){return this},t.prototype.isCompatible=function(t,e){return void 0===e&&(e={}),t===this||!(e.exact||!t.isWrapper()||!this.isCompatible(t.getWrappedType(),e))||!(e.strict&&!y(this,t)&&!this.acceptsOtherTypes())&&this.isDeepCompatible(t,e)},t.prototype.acceptsOtherTypes=function(){return!1},t.prototype.acceptsType=function(t){return this.isCompatible(t,{strict:!0})},t.prototype.acceptsData=function(t){return this.isCompatible(t,{strict:!0,value:!0})},t.prototype.exactType=function(t){return this.isCompatible(t,{exact:!0,strict:!0})},t.prototype.exactData=function(t){return this.isCompatible(t,{exact:!0,strict:!0,value:!0})},t.prototype.getValueChangeExpression=function(t,e,n){return t},t.prototype.getValueChangeAt=function(t){for(var e=this.parent,n=this.getPath();e;){var r=n.pop();t=e.getValueChangeExpression(t,r,r),e=e.parent}return t},t.prototype.getPath=function(){var t=this;return this.getRootType().traverse(new L((function(e,n,r,o){e===t&&o.stop(r.slice())})))},t.prototype.getTypeFromPath=function(t){if(0===t.length)return this;var e=this.getTypeFromStep(t[0]);return e?e.getTypeFromPath(t.slice(1)):null},t.prototype.getTypeFromStep=function(t){return null},t.prototype.getRootType=function(){for(var t=this;t.parent;)t=t.parent;return t},t}();!function(t){t[t.LOW=1]="LOW",t[t.MEDIUM=2]="MEDIUM",t[t.HIGH=3]="HIGH"}(j||(j={})),function(t){t[t.UNSAFE_OPERATION=1]="UNSAFE_OPERATION",t[t.POSSIBLY_NULL=2]="POSSIBLY_NULL",t[t.INCOMPATIBLE_TYPES=3]="INCOMPATIBLE_TYPES",t[t.INVALID_EXPRESSION=4]="INVALID_EXPRESSION",t[t.MISSING_FUNCTION=5]="MISSING_FUNCTION",t[t.MISSING_EXPRESSION=6]="MISSING_EXPRESSION",t[t.MISSING_OPERATION=7]="MISSING_OPERATION",t[t.MISSING_TYPE_NAME=8]="MISSING_TYPE_NAME",t[t.MISSING_TYPE=9]="MISSING_TYPE",t[t.MISSING_RELATION_NAME=10]="MISSING_RELATION_NAME",t[t.MISSING_RELATION=11]="MISSING_RELATION",t[t.MISSING_DATA_NAME=12]="MISSING_DATA_NAME",t[t.MISSING_DATA=13]="MISSING_DATA",t[t.OUTSIDE_PATH=14]="OUTSIDE_PATH",t[t.READONLY=15]="READONLY",t[t.EMPTY_PATH=16]="EMPTY_PATH",t[t.INVALID_THIS=17]="INVALID_THIS",t[t.MISSING_METHOD=18]="MISSING_METHOD"}(R||(R={})),function(t){t.CONTINUE="continue",t.BREAK="break",t.RETURN="return",t.EXIT="exit"}(A||(A={}));var F=function(){function t(){this.parent=null}return t.prototype.hasExpression=function(t){return this.traverse(new L((function(e,n,r,o){(c(t)?t(e):t.id===e.getId())&&o.stop(!0)}),!1))},t.prototype.isValidFlow=function(t,e,n){return e===A.EXIT||!!this.parent&&this.parent.isValidFlow(t,e,this)},t.prototype.getContextFor=function(t,e,n,r){return n},t.prototype.isDynamic=function(){return!0},t.prototype.getInnerExpression=function(t,e,n){return!1},t.prototype.isPathStart=function(){return!1},t.prototype.isPathNode=function(){return!1},t.prototype.isPathWritable=function(t){return!0},t.prototype.getPath=function(){var t=this;return this.getRootExpression().traverse(new L((function(e,n,r,o){e===t&&o.stop(r.slice())})))},t.prototype.getExpressionFromPath=function(t){if(0===t.length)return this;var e=this.getExpressionFromStep(t);if(!e||!e[1])return null;var n=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(e,2),r=n[0];return n[1].getExpressionFromPath(t.slice(r))},t.prototype.getExpressionFromStep=function(t){return null},t.prototype.getRootExpression=function(){for(var t=this;t.parent;)t=t.parent;return t},t.prototype.validations=function(t,e){var n=[];return this.validate(t,e,(function(t){return n.push(t)})),n},t.prototype.validateType=function(t,e,n,r,o,i){void 0===i&&(i=this);var s=n?n.getSimplifiedType():null,a=r?r.getType(t,e):null,u=a?a.getSimplifiedType():null,p=u;u?(u.isOptional()&&!s.isOptional()&&(p=p.getRequired()),s.acceptsType(p)?p!==u&&o({type:R.POSSIBLY_NULL,severity:j.MEDIUM,context:e,subject:r,parent:i,expected:s,actual:u}):o({type:R.INCOMPATIBLE_TYPES,severity:s.isCompatible(u)?j.MEDIUM:j.HIGH,context:e,subject:r,parent:i,expected:s,actual:u})):s&&!s.isOptional()&&o({type:R.INCOMPATIBLE_TYPES,severity:j.HIGH,context:e,subject:r,parent:i,expected:s}),r&&r.validate(t,e,o)},t.INSTANCE="instance",t}();function V(t){return!("baseType"in t)&&c(t)}var Y,W=function(){function t(t){this.prefix=t,this.map=Object.create(null),this.types=Object.create(null)}return t.prototype.get=function(t){return this.map[t]||this.map[this.prefix+t]},t.prototype.getTypes=function(t){return this.types[t]||this.types[this.prefix+t]},t.prototype.set=function(t,e,n,r,o,i,s,a){void 0===e&&(e={}),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===o&&(o=[]),void 0===i&&(i=[]),void 0===s&&(s=[]);var u=this.prefix+t,p=e.mutates||[],c=e.complexity||0,l=Object.create(null);o.forEach((function(t){return l[t]=t}));var f={id:u,mutates:p,complexity:c,params:n,optional:r,scope:o,scopeDefaults:l,hasScope:i,resultDependency:s,loop:a};return this.map[u]=f,f},t.prototype.setTypes=function(t,e,n,r,o){void 0===n&&(n=Object.create(null)),void 0===r&&(r=Object.create(null)),void 0===o&&(o=Object.create(null));var i={returnType:e,params:n,optional:r,scope:o};return this.types[t.id]=i,i},t}(),H=function(){function t(t){this.prefix=t,this.map=Object.create(null),this.list=[]}return t.prototype.set=function(t,e,n,r){var o=this.prefix+t,i={id:o,op:e.id,value:n||e.params[0],params:r||{}};return this.map[o]=i,this.list.push(i),i},t.prototype.setWritable=function(t,e,n,r,o){var i=this.prefix+t,s=this.map[i];return s.writeable={op:e.id,value:n,newValue:r,params:o||{}},s},t.prototype.get=function(t){return this.map[t]||this.map[this.prefix+t]},t}(),G={Entity:"@",Any:"any",Boolean:"bool",Color:"color",Date:"date",Enum:"enum",Function:"func",List:"list",Generic:"generic",Many:"many",Not:"not",Map:"map",Null:"null",Number:"num",Object:"obj",Optional:"?",Reference:"ref",Relation:"rel",Set:"set",Text:"text",Tuple:"tuple",Delimiter:":"},B=new W(G.Boolean+G.Delimiter),U=new H(G.Boolean+G.Delimiter),J=B,K={create:J.set("create"),maybe:J.set("maybe",{},["value"]),and:J.set("&",{},["a","b"]),or:J.set("|",{},["a","b"]),xor:J.set("^",{},["a","b"]),not:J.set("!",{},["a"]),cmp:J.set("cmp",{},["value","test"]),isValid:J.set("?",{},["value"]),isTrue:J.set("t?",{},["value"]),isFalse:J.set("f?",{},["value"]),isEqual:J.set("=",{},["value","test"]),isNotEqual:J.set("!=",{},["value","test"]),asAny:J.set("~"+G.Any,{},["value"]),asBoolean:J.set("~"+G.Boolean,{},["value"]),asColor:J.set("~"+G.Color,{},["value"]),asDate:J.set("~"+G.Date,{},["value"]),asList:J.set("~"+G.List,{},["value"]),asMap:J.set("~"+G.Map,{},["value"]),asNumber:J.set("~"+G.Number,{},["value"]),asObject:J.set("~"+G.Object,{},["value"]),asText:J.set("~"+G.Text,{},["value"]),asTuple:J.set("~"+G.Tuple,{},["value"]),asSet:J.set("~"+G.Set,{},["value"])},z=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},X=function(){function t(){this.objectSet=function(t,e,n){return t[e]=n},this.objectRemove=function(t,e){return delete t[e]},this.arrayAdd=function(t,e){return t.push(e)},this.arrayRemove=function(t,e){return t.splice(e,1)[0]},this.arraySet=function(t,e,n){return t.splice(e,1,n)[0]},this.compareTypes=this.createTypeMap((function(t,e){return e})),this.compareMap=this.createTypeMap((function(){return[]})),this.equalsMap=this.createTypeMap((function(){return[]})),this.copyList=[],this.jsonList=[],this.accessorList=[]}return t.prototype.compare=function(t,e){var n=this,r=function(t,e){var o,i,s=typeof t,a=typeof e;if(s!==a)return n.compareTypes[s]-n.compareTypes[a];var u=n.compareMap[s];try{for(var p=z(u),c=p.next();!c.done;c=p.next()){var l=c.value.compare(t,e,r);if(void 0!==l)return l}}catch(t){o={error:t}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return t===e?0:t<e?-1:1};return r(t,e)},t.prototype.getCompare=function(t,e){return 0===t&&0===e?0:t<e?1:-1},t.prototype.addCompare=function(t){return this.addToPriorityList(this.compareMap[t.type],t)},t.prototype.equals=function(t,e){var n=this,r=function(t,e){var o,i;if(t===e)return!0;var s=typeof t;if(s!==typeof e)return!1;var a=n.equalsMap[s];try{for(var u=z(a),p=u.next();!p.done;p=u.next()){var c=p.value.equals(t,e,r);if(void 0!==c)return c}}catch(t){o={error:t}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return!1};return r(t,e)},t.prototype.addEquals=function(t){return this.addToPriorityList(this.equalsMap[t.type],t)},t.prototype.copy=function(t,e){if(void 0===e&&(e=!1),!t)return t;if("object"==typeof t){var n=this.copyList;if(e){var r=new Map,o=function(t,e){r.set(t,e)},i=function(t){var e,s;if(!t)return t;if("object"==typeof t){var a=r.get(t);if(void 0!==a)return a;try{for(var u=z(n),p=u.next();!p.done;p=u.next()){var c=p.value.copy(t,i,o);if(void 0!==c)return c}}catch(t){e={error:t}}finally{try{p&&!p.done&&(s=u.return)&&s.call(u)}finally{if(e)throw e.error}}}return t};return i(t)}var s=function(t,e){},a=function(t){var e,r;if(!t)return t;if("object"==typeof t)try{for(var o=z(n),i=o.next();!i.done;i=o.next()){var u=i.value.copy(t,a,s);if(void 0!==u)return u}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return t};return a(t)}return t},t.prototype.addCopier=function(t){return this.addToPriorityList(this.copyList,t)},t.prototype.toJson=function(t){if(!t)return t;if("object"==typeof t){var e=this.jsonList,n=function(t){var r,o;if(!t)return t;if("object"==typeof t)try{for(var i=z(e),s=i.next();!s.done;s=i.next()){var a=s.value.toJson(t,n);if(void 0!==a)return a}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return t};return n(t)}return t},t.prototype.fromJson=function(t){if(!t)return t;if("object"==typeof t){var e=this.jsonList,n=function(t){var r,o;if(!t)return t;if("object"==typeof t)try{for(var i=z(e),s=i.next();!s.done;s=i.next()){var a=s.value.fromJson(t,n);if(void 0!==a)return a}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return t};return n(t)}return t},t.prototype.addJson=function(t){return this.addToPriorityList(this.jsonList,t)},t.prototype.get=function(t,e){var n,r,o=this.accessorList;try{for(var i=z(o),s=i.next();!s.done;s=i.next()){var a=s.value;if(a.isValid(t,e))return a.get(t,e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.set=function(t,e,n){var r,o,i=this.accessorList;try{for(var s=z(i),a=s.next();!a.done;a=s.next()){var u=a.value;if(u.isValid(t,e))return u.set(t,e,n),!0}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return!1},t.prototype.remove=function(t,e){var n,r,o=this.accessorList;try{for(var i=z(o),s=i.next();!s.done;s=i.next()){var a=s.value;if(a.isValid(t,e))return a.remove(t,e),!0}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1},t.prototype.has=function(t,e,n){var r,o;void 0===n&&(n=!1);var i=this.accessorList;try{for(var s=z(i),a=s.next();!a.done;a=s.next()){var u=a.value;if(u.isValid(t,e))return u.has(t,e)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return n},t.prototype.addAccessor=function(t){return this.addToPriorityList(this.accessorList,t)},t.prototype.createTypeMap=function(e){var n=Object.create(null);return t.TYPES.forEach((function(t,r){n[t]=e(t,r)})),n},t.prototype.addToPriorityList=function(t,e){return t.push(e),t.sort((function(t,e){return e.priority-t.priority})),this},t.TYPES=["boolean","number","bigint","string","symbol","object","undefined","function"],t}(),$=new X,Q=(Y=function(t,e){return(Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}Y(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Q(e,t),e.decode=function(t,n){return new e(t[1]||{})},e.encode=function(t){return d(t.options.true)&&d(t.options.false)?this.id:[this.id,t.options]},e.describe=function(t,e,n){return p(t)?this.baseType:null},e.register=function(){var t="boolean";$.addCompare({priority:0,type:t,compare:function(t,e){return(t?1:0)-(e?1:0)}}),$.addEquals({priority:0,type:t,equals:function(t,e){return t===e}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){return!n.exact&&!n.strict||t instanceof e},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return jn.op(K.create,{})},e.prototype.getValidateExpression=function(){return jn.op(K.isValid,{value:jn.get("value")})},e.prototype.getCompareExpression=function(){return jn.op(K.cmp,{value:jn.get("value"),test:jn.get("test")})},e.prototype.isValid=function(t){if(p(t))return!0;var e=t+"";return!(!this.options.true||!this.options.true[e])||!(!this.options.false||!this.options.false[e])},e.prototype.normalize=function(t){if(!p(t)){var e=t+"";if(this.options.true&&this.options.true[e])return!0;if(this.options.false&&this.options.false[e])return!1}return t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e($.copy(this.options))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return!1},e.prototype.random=function(t){return t(0,1,!1)<.5},e.prototype.fromJson=function(t){return t},e.prototype.toJson=function(t){return t},e.id=G.Boolean,e.operations=B,e.computeds=U,e.baseType=new e({}),e.describePriority=4,e.registered=!1,e}(q),tt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),et=function(t){function e(e){var n=t.call(this)||this;return n.expression=e,n}return tt(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]))},e.encode=function(t){var e=t.expression.encode();return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.expression.getComplexity(t,e)},e.prototype.isDynamic=function(){return this.expression.isDynamic()},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expression.clone())},e.prototype.getType=function(t,e){return Z.baseType},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){return t.step(e.STEP_NOT,n.expression,(function(t){return n.expression=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_NOT?[1,this.expression]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.expression.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,Z.baseType,this.expression,n)},e.prototype.mutates=function(t,e){return this.expression.mutates(t,e)},e.STEP_NOT="not",e.id="not",e}(F),nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rt=function(t){function e(e){var n=t.call(this)||this;return n.expressions=e,n}return nt(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){return n.getExpression(t)})))},e.encode=function(t){var e=t.expressions.map((function(t){return t.encode()}));return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.expressions.reduce((function(n,r){return Math.max(n,r.getComplexity(t,e))}),0)},e.prototype.isDynamic=function(){return this.expressions.some((function(t){return t.isDynamic()}))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expressions.map((function(t){return t.clone()})))},e.prototype.getType=function(t,e){return Z.baseType},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return e.expressions.forEach((function(n,r){return t.step(r,n,(function(t){return e.expressions.splice(r,1,t)}),(function(){return e.expressions.splice(r,1)}))}))}))},e.prototype.getExpressionFromStep=function(t){return r(t[0])&&t[0]<this.expressions.length?[1,this.expressions[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.expressions.forEach((function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n){var r=this,o=Z.baseType;this.expressions.forEach((function(i){r.validateType(t,e,o,i,n)}))},e.prototype.mutates=function(t,e,n){var r,o;try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.expressions),s=i.next();!s.done;s=i.next())if(s.value.mutates(t,e,n))return!0}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},e.id="and",e}(F),ot=new W(G.Any+G.Delimiter),it=new H(G.Any+G.Delimiter),st=ot,at={complexity:2},ut={cmp:st.set("cmp",at,["value","test"]),copy:st.set("copy",at,["value"]),isDefined:st.set("isDefined",{},["value"]),getDefined:st.set("getDefined",{},["value","defined"],[],["defined"],["defined"],["value"]),coalesce:st.set("coalesce",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),require:st.set("require",{},["value"],[],[],[],["value"]),ternary:st.set("ternary",{},["condition","truthy","falsy"],[],[],[],["truthy","falsy"]),isValid:st.set("?",{},["value"]),isEqual:st.set("=",at,["value","test"]),isNotEqual:st.set("!=",at,["value","test"]),isLess:st.set("<",at,["value","test"]),isLessOrEqual:st.set("<=",at,["value","test"]),isGreater:st.set(">",at,["value","test"]),isGreaterOrEqual:st.set(">=",at,["value","test"]),asAny:st.set("~"+G.Any,{},["value"]),asBoolean:st.set("~"+G.Boolean,{},["value"]),asColor:st.set("~"+G.Color,{},["value"]),asDate:st.set("~"+G.Date,{},["value"]),asList:st.set("~"+G.List,{},["value"]),asMap:st.set("~"+G.Map,{},["value"]),asNumber:st.set("~"+G.Number,{},["value"]),asObject:st.set("~"+G.Object,{},["value"]),asText:st.set("~"+G.Text,{},["value"]),asTuple:st.set("~"+G.Tuple,{},["value"]),asSet:st.set("~"+G.Set,{},["value"])},pt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pt(e,t),e.decode=function(t){return e.baseType},e.encode=function(t){return this.id},e.describe=function(t,e,n){return null===t?this.baseType:null},e.register=function(){},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){return t instanceof e},e.prototype.isOptional=function(){return!0},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null)},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return jn.null()},e.prototype.getValidateExpression=function(){return jn.op(ut.isEqual,{value:jn.get("value"),test:jn.null()})},e.prototype.getCompareExpression=function(){return jn.op(ut.cmp,{value:jn.get("value"),test:jn.get("test")})},e.prototype.isValid=function(t){return null==t},e.prototype.normalize=function(t){return t},e.prototype.newInstance=function(){return this},e.prototype.clone=function(){return this},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return null},e.prototype.random=function(t){return null},e.prototype.fromJson=function(t){return null},e.prototype.toJson=function(t){return null},e.id=G.Null,e.operations=new W(G.Null+G.Delimiter),e.computeds=new H(G.Null+G.Delimiter),e.baseType=new e(null),e.describePriority=6,e.registered=!1,e}(q),lt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return lt(e,t),e.decode=function(t,e){return this.instance},e.encode=function(t){return[this.id]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return 0},e.prototype.isDynamic=function(){return!1},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return this},e.prototype.getType=function(t,e){return ct.baseType},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null)},e.prototype.validate=function(t,e,n){},e.prototype.mutates=function(t,e){return!1},e.id="noop",e.instance=new e,e}(F),yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return yt(e,t),e.decode=function(t,e){return this.baseType},e.encode=function(t){return this.id},e.describe=function(t,n,r){return l(t)&&o(t.$any)?new e({}):null},e.register=function(){},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isCompatible=function(t){return!0},e.prototype.isDeepCompatible=function(t,e){return!0},e.prototype.isOptional=function(){return!0},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return jn.string()},e.prototype.getValidateExpression=function(){return jn.true()},e.prototype.getCompareExpression=function(){return jn.op(ut.cmp,{value:jn.get("value"),test:jn.get("test")})},e.prototype.isValid=function(t){return!0},e.prototype.normalize=function(t){return t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e({})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return""},e.prototype.random=function(t){return null},e.prototype.fromJson=function(t){return $.fromJson(t)},e.prototype.toJson=function(t){return $.toJson(t)},e.id=G.Any,e.operations=ot,e.computeds=it,e.baseType=new e({}),e.describePriority=8,e.registered=!1,e}(q),dt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(){return(vt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},mt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},gt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Tt=function(t){function e(e,n){var r=t.call(this)||this;return r.define=e,r.body=n,r}return dt(e,t),e.decode=function(t,n){var r=this;return new e(t[1].map((function(t){var e=mt(t,2),o=e[0],i=e[1];return[r.cloneVar(o),n.getExpression(i)]})),n.getExpression(t[2]))},e.encode=function(t){var e=this,n=t.define.map((function(t){var n=mt(t,2),r=n[0],o=n[1];return[e.cloneVar(r),o.encode()]}));return[this.id,n,t.body.encode()]},e.cloneVar=function(t){return l(t)?vt({},t):t},e.stringifyVar=function(t){return o(t)?t:Object.keys(t).sort().join(",")},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.define.reduce((function(n,r){var o=mt(r,2),i=(o[0],o[1]);return Math.max(n,i.getComplexity(t,e))}),this.body.getComplexity(t,e))},e.prototype.isDynamic=function(){return this.body.isDynamic()},e.prototype.applyToScope=function(t,e,n){if(o(e))t[e]=n;else for(var r in e)t[r]=n.getChildType(e[r])||ht.baseType},e.prototype.getScope=function(){var t=this,e={};return this.define.forEach((function(n){var r=mt(n,2),o=r[0];r[1],t.applyToScope(e,o,ht.baseType)})),e},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.define.map((function(t){var n=mt(t,2),r=n[0],o=n[1];return[e.cloneVar(r),o.clone()]})),this.body.clone())},e.prototype.getType=function(t,e){var n=this,r=t.getContextWithScope(e),o=r.scope,i=r.context;return this.define.forEach((function(e){var r=mt(e,2),s=r[0],a=r[1];n.applyToScope(o,s,a.getType(t,i))})),this.body.getType(t,i)},e.prototype.getContextFor=function(t,n,r,o){var i,s,a=n.getContextWithScope(r);try{for(var u=gt(this.define),p=u.next();!p.done;p=u.next()){var c=mt(p.value,2),l=c[0],f=c[1];if(t[0]===e.STEP_DEFINE&&t[1]===e.stringifyVar(l))break;this.applyToScope(a.scope,l,f.getType(n,a.context))}}catch(t){i={error:t}}finally{try{p&&!p.done&&(s=u.return)&&s.call(u)}finally{if(i)throw i.error}}return a.context},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_DEFINE,(function(){return n.define.forEach((function(r,o){var i=mt(r,2),s=i[0],a=i[1];return t.step(e.stringifyVar(s),a,(function(t){return n.define[o].splice(1,1,t)}),(function(){return n.define.splice(o,1)}))}))})),t.step(e.STEP_BODY,n.body,(function(t){return n.body=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_BODY?[1,this.body]:t[0]===e.STEP_DEFINE?[2,this.define.filter((function(n){var r=mt(n,1)[0];return e.stringifyVar(r)===t[1]})).map((function(t){var e=mt(t,2);return e[0],e[1]}))[0]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.define.forEach((function(t){var n=mt(t,2);return n[0],n[1].setParent(e)})),this.body.setParent(this)},e.prototype.validate=function(t,e,n){var r=this,o=t.getContextWithScope(e);this.define.forEach((function(e){var i=mt(e,2),s=i[0],a=i[1];a.validate(t,o.context,n),r.applyToScope(o.scope,s,a.getType(t,o.context))})),this.body.validate(t,o.context,n)},e.prototype.mutates=function(t,e,n){var r,o;try{for(var i=gt(this.define),s=i.next();!s.done;s=i.next())if(mt(s.value,2)[1].mutates(t,e,n))return!0}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return this.body.mutates(t,e,n)},e.prototype.with=function(t,n){var r,o,s=this,a=function(t,n){var r=jn.parse(n),o=s.define.find((function(n){var r=mt(n,1)[0];return e.stringifyVar(r)===e.stringifyVar(t)}));o?o[1]=r:s.define.push([t,r]),r.setParent(s)};if(void 0!==n)a(name,n);else if(i(t))try{for(var u=gt(t),p=u.next();!p.done;p=u.next()){var c=mt(p.value,2);a(c[0],c[1])}}catch(t){r={error:t}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}else if(l(t))for(var f in t)a(f,t[f]);return this},e.prototype.run=function(t){return this.body=t,this.body.setParent(this),this},e.STEP_DEFINE="define",e.STEP_BODY="body",e.id="def",e}(F),bt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xt=1e5,Ot=function(t){function e(e,n,r){void 0===r&&(r=xt);var o=t.call(this)||this;return o.condition=e,o.body=n,o.maxIterations=r,o}return bt(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),n.getExpression(t[2]),parseInt(t[3])||this.MAX_ITERATIONS)},e.encode=function(t){return t.maxIterations!==this.MAX_ITERATIONS?[this.id,t.condition.encode(),t.body.encode(),t.maxIterations]:[this.id,t.condition.encode(),t.body.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return 1+Math.max(this.condition.getComplexity(t,e),this.body.getComplexity(t,e))},e.prototype.isDynamic=function(){return this.body.isDynamic()},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.condition.clone(),this.body.clone(),this.maxIterations)},e.prototype.getType=function(t,e){var n=t.getContextWithScope(e,this.getScope()).context,r=this.body.getType(t,n);return r?Si.optional(r):null},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_CONDITION,n.condition,(function(t){return n.condition=t})),t.step(e.STEP_BODY,n.body,(function(t){return n.body=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_CONDITION?[1,this.condition]:t[0]===e.STEP_BODY?[1,this.body]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.condition.setParent(this),this.body.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,Z.baseType,this.condition,n);var r=t.getContext(e,this.getScope());this.body.validate(t,r,n)},e.prototype.mutates=function(t,e,n){return this.condition.mutates(t,e,n)||this.body.mutates(t,e,n)},e.prototype.isValidFlow=function(e,n,r){return r===this.body&&(n===A.BREAK||n===A.CONTINUE)||t.prototype.isValidFlow.call(this,e,n)},e.prototype.do=function(t,e){return this.body=t,this.body.setParent(this),e&&(this.condition=e,this.condition.setParent(this)),this},e.prototype.while=function(t){return this.condition=t,this.condition.setParent(this),this},e.prototype.withMax=function(t){return this.maxIterations=t,this},e.STEP_CONDITION="condition",e.STEP_BODY="body",e.MAX_ITERATIONS=xt,e.id="do",e}(F),Et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},St=function(t){function e(e){var n=t.call(this)||this;return n.chain=e,n}return Et(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){return n.getExpression(t)})))},e.encode=function(t){var e=t.chain.map((function(t){return t.encode()}));return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.chain.reduce((function(n,r){return Math.max(n,r.getComplexity(t,e))}),0)},e.prototype.isDynamic=function(){return!!this.chain.length&&this.chain[this.chain.length-1].isDynamic()},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.chain.map((function(t){return t.clone()})))},e.prototype.getType=function(t,e){return this.chain[this.chain.length-1].getType(t,e)},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return e.chain.forEach((function(n,r){return t.step(r,n,(function(t){return e.chain.splice(r,1,t)}),(function(){return e.chain.splice(r,1)}))}))}))},e.prototype.getExpressionFromStep=function(t){return r(t[0])&&t[0]<this.chain.length?[1,this.chain[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.chain.forEach((function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n){this.chain.forEach((function(r){r.validate(t,e,n)}))},e.prototype.mutates=function(t,e,n){var r,o;try{for(var i=wt(this.chain),s=i.next();!s.done;s=i.next())if(s.value.mutates(t,e,n))return!0}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},e.prototype.add=function(t){var e,n,r=i(t)?t:[t];try{for(var o=wt(r),s=o.next();!s.done;s=o.next()){var a=s.value;this.chain.push(a),a.setParent(this)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},e.id="chain",e}(F),Pt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_t=function(t){function e(e){var n=t.call(this)||this;return n.comment=e,n}return Pt(e,t),e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return[this.id,t.comment]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t){return 0},e.prototype.isDynamic=function(){return!1},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.comment)},e.prototype.getType=function(t,e){return ct.baseType},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){},e.prototype.isPathWritable=function(t){return!1},e.prototype.mutates=function(t,e){return!1},e.id="comment",e.instance=new e(""),e}(F),It=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return It(e,t),e.decode=function(t,n){if(t[1]){var r=t[1].map((function(t){return n.getExpression(t)}));return n.setLegacy(),ee.createForLegacy(function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Mt(arguments[e]));return t}([new e],r))}return new e},e.encode=function(t){return[this.id]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e},e.prototype.getType=function(t,e){return e},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.getExpressionFromStep=function(t){return null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){},e.prototype.mutates=function(t,e){return!1},e.prototype.isPathStart=function(){return!0},e.prototype.isPathNode=function(){return!0},e.id="get",e}(F),Dt=new W(G.Text+G.Delimiter),jt=new H(G.Text+G.Delimiter),Rt=Dt,At={create:Rt.set("create"),uuid:Rt.set("uuid"),maybe:Rt.set("maybe",{},["value"]),append:Rt.set("+",{},["value","append"]),prepend:Rt.set("pre",{},["value","prepend"]),lower:Rt.set("lo",{},["value"]),upper:Rt.set("up",{},["value"]),char:Rt.set("@",{},["value","index"],["outside"]),replace:Rt.set("replace",{},["value","find","replace"]),repeat:Rt.set("repeat",{},["value","times"]),split:Rt.set("split",{},["value","by"],["limit"]),chars:Rt.set("chars",{},["value"]),sub:Rt.set("sub",{},["value"],["start","end"]),indexOf:Rt.set("i?",{},["value","search"],["start"]),lastIndexOf:Rt.set("li?",{},["value","search"],["start"]),trim:Rt.set("trim",{},["value"],["start","end"]),startsWith:Rt.set("starts",{},["value","test"]),endsWith:Rt.set("ends",{},["value","test"]),soundex:Rt.set("soundex",{complexity:1},["value"],["max","min"]),metaphone:Rt.set("metaphone",{complexity:1},["value"]),distance:Rt.set("dist",{complexity:1},["value","test"]),length:Rt.set("len",{},["value"]),compare:Rt.set("cmp",{},["value","test"],["ignoreCase"]),like:Rt.set("like",{},["value","pattern"],["ignoreCase"]),pad:Rt.set("pad",{},["value","padding","min"],["max","append"]),regexTest:Rt.set("regexTest",{},["value","regex"],["ignoreCase","multiline"]),regexSplit:Rt.set("regexSplit",{},["value","regex"],["limit","ignoreCase","multiline"]),regexMatch:Rt.set("regexMatch",{},["value","regex"],["ignoreCase","multiline"]),regexMatchAll:Rt.set("regexMatchAll",{},["value","regex"],["ignoreCase","multiline"]),regexReplace:Rt.set("regexReplace",{},["value","regex","replacement"],["all","ignoreCase","multiline"]),regexReplaceDynamic:Rt.set("regexReplaceDynamic",{},["value","regex","replace"],["all","ignoreCase","multiline"],["match"],["replace"]),regexIndexOf:Rt.set("regexIndexOf",{},["value","regex"],["ignoreCase","multiline"]),base64:Rt.set("base64",{},["value"]),unbase64:Rt.set("unbase64",{},["value"]),encodeURI:Rt.set("encodeURI",{},["value"]),decodeURI:Rt.set("decodeURI",{},["value"]),encodeURIComponent:Rt.set("encodeURIComponent",{},["value"]),decodeURIComponent:Rt.set("decodeURIComponent",{},["value"]),md5:Rt.set("md5",{},["value"]),encrypt:Rt.set("encrypt",{},["value","secret"]),decrypt:Rt.set("decrypt",{},["value","secret"]),toNumber:Rt.set("toNumber",{},["value"],["invalidValue"]),isValid:Rt.set("?",{},["value"]),isEmpty:Rt.set("0?",{},["value"]),isNotEmpty:Rt.set("n?",{},["value"]),isEqual:Rt.set("=",{},["a","b"],["ignoreCase"]),isNotEqual:Rt.set("!=",{},["a","b"],["ignoreCase"]),isLess:Rt.set("<",{},["value","test"],["ignoreCase"]),isLessOrEqual:Rt.set("<=",{},["value","test"],["ignoreCase"]),isGreater:Rt.set(">",{},["value","test"],["ignoreCase"]),isGreaterOrEqual:Rt.set(">=",{},["value","test"],["ignoreCase"]),isLower:Rt.set("lo?",{},["value"]),isUpper:Rt.set("up?",{},["value"]),isUuid:Rt.set("uuid?",{},["value"]),asAny:Rt.set("~"+G.Any,{},["value"]),asBoolean:Rt.set("~"+G.Boolean,{},["value"]),asColor:Rt.set("~"+G.Color,{},["value"]),asDate:Rt.set("~"+G.Date,{},["value"]),asList:Rt.set("~"+G.List,{},["value"]),asMap:Rt.set("~"+G.Map,{},["value"]),asNumber:Rt.set("~"+G.Number,{},["value"]),asObject:Rt.set("~"+G.Object,{},["value"]),asText:Rt.set("~"+G.Text,{},["value"]),asTuple:Rt.set("~"+G.Tuple,{},["value"]),asSet:Rt.set("~"+G.Set,{},["value"])};jt.set("toUpper",At.upper),jt.set("toLower",At.lower),jt.set("chars",At.chars),jt.set("trim",At.trim),jt.set("soundex",At.soundex),jt.set("metaphone",At.metaphone),jt.set("base64",At.base64),jt.set("unbase64",At.unbase64),jt.set("encodeURI",At.encodeURI),jt.set("decodeURI",At.decodeURI),jt.set("encodeURIComponent",At.encodeURIComponent),jt.set("decodeURIComponent",At.decodeURIComponent),jt.set("md5",At.md5),jt.set("toNumber",At.toNumber),jt.set("isEmpty",At.isEmpty),jt.set("isNotEmpty",At.isNotEmpty),jt.set("isLower",At.isLower),jt.set("isUpper",At.isUpper);var Nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kt=function(){return(kt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Lt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-+=:.",qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Nt(e,t),e.decode=function(t){return new e(this.decodeOptions(t[1]||{}))},e.encode=function(t){return d(t.options)?this.id:[this.id,this.encodeOptions(t.options)]},e.decodeOptions=function(t){var e=t.matches;return e&&(t.matches=new RegExp(e[0],e[1])),t},e.encodeOptions=function(t){var e=kt({},t),n=e.matches;return n&&(e.matches=[n.source,n.flags]),e},e.describe=function(t,n,r){return o(t)?new e({min:t.length,max:t.length,requireLower:t.toLowerCase()===t,requireUpper:t.toUpperCase()===t}):null},e.register=function(){var t="string";$.addCompare({priority:4,type:t,compare:function(t,e){return t.localeCompare(e)}}),$.addEquals({priority:4,type:t,equals:function(t,e){return t===e}}),$.addAccessor({priority:4,isValid:o,get:function(t,e){return t[e]},set:function(t,e,n){},remove:function(t,e){return t.substring(0,e)+t.substring(e+1)},has:function(t,e){return void 0!==t[e]}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.max=Math.max(e.max,n.max),e.min=Math.min(e.min,n.min),e.requireLower=e.requireLower&&n.requireLower,e.requireUpper=e.requireUpper&&n.requireUpper},e.prototype.getSubType=function(t,n,o){if(Kt.is(t)){if("length"===t.value)return Si.LENGTH;if(r(t.value))return Si.CHAR}var i=t.getType(n,o);if(i){if((i=i.getRequired())instanceof An)return Si.CHAR;if(i instanceof Ut){if(i.options.value instanceof An)return Si.CHAR;if(i.options.value instanceof e){var s=Array.from(i.options.constants.values());if(1===s.length&&"length"===s[0])return Si.LENGTH}}}},e.prototype.getSubTypes=function(t){return[{key:"length",value:Si.LENGTH},{key:Si.INDEX,value:Si.optional(Si.CHAR)}]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){if(!(t instanceof e))return!1;if(n.value){var r=this.options.min,o=t.options.min;if(r&&(!o||o<r))return!1;var i=this.options.max,s=t.options.max;if(i&&(!s||s>i))return!1;var a=this.options.forceLower||this.options.requireUpper,u=t.options.forceLower||t.options.requireLower;if(a&&!u)return!1;var p=this.options.forceUpper||this.options.requireUpper,c=t.options.forceUpper||t.options.requireUpper;if(p&&!c)return!1;var l=this.options.matches,f=t.options.matches;if(l&&(!f||f.source!==l.source))return!1}return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){this.options={}},e.prototype.getCreateExpression=function(){return jn.op(At.create,{})},e.prototype.getValidateExpression=function(){return jn.op(At.isValid,{value:jn.get("value")})},e.prototype.getCompareExpression=function(){return jn.op(At.compare,{value:jn.get("value"),test:jn.get("test"),ignoreCase:jn.true()})},e.prototype.isValid=function(t){if(!o(t))return!1;var e=this.options,n=e.min,i=e.max,s=e.requireLower,a=e.requireUpper,u=e.matches,p=e.forceLower,c=e.forceUpper;return!(r(n)&&t.length<n||r(i)&&t.length>i||s&&t!==t.toLowerCase()&&!p||a&&t!==t.toUpperCase()&&!c||u&&u instanceof RegExp&&!u.test(t))},e.prototype.normalize=function(t){return o(t)&&(this.options.forceLower&&(t=t.toLowerCase()),this.options.forceUpper&&(t=t.toUpperCase())),t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e($.copy(this.options))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return""},e.prototype.random=function(t){for(var e=this.options,n=e.min,r=e.max,o=e.requireLower,i=e.forceLower,s=e.requireUpper,a=e.forceUpper,u=o||i,p=s||a,c=t(I(n,1),I(r,16)+1,!0),l="",f=0;f<c;f++)l+=Lt.charAt(t(0,Lt.length,!0));return u&&(l=l.toLowerCase()),p&&(l=l.toUpperCase()),l},e.prototype.fromJson=function(t){return t},e.prototype.toJson=function(t){return t},e.id=G.Text,e.operations=Dt,e.computeds=jt,e.baseType=new e({}),e.describePriority=3,e.registered=!1,e}(q),Ft=new W(G.Map+G.Delimiter),Vt=new H(G.Map+G.Delimiter),Yt=Ft,Wt={create:Yt.set("create"),createLike:Yt.set("createLike",{},["map"],[],[],[],["map"]),createFor:Yt.set("createFor",{},["value"],["key"],[],[],["value","key"]),maybe:Yt.set("maybe",{},["value"]),get:Yt.set("get",{},["map","key"],[],[],[],["map"]),set:Yt.set("set",{mutates:["map"]},["map","key","value"],[],["existingValue"],["value"],["map"]),has:Yt.set("has",{},["map","key"]),delete:Yt.set("delete",{mutates:["map"]},["map","key"]),keys:Yt.set("keys",{complexity:1},["map"],[],[],[],["map"]),values:Yt.set("values",{complexity:1},["map"],[],[],[],["map"]),entries:Yt.set("entries",{complexity:1},["map"],[],[],[],["map"]),pairs:Yt.set("pairs",{complexity:1},["map"],[],[],[],["map"]),clear:Yt.set("clear",{mutates:["map"]},["map"],[],[],[],["map"]),count:Yt.set("count",{},["map"]),cmp:Yt.set("cmp",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"],[],!0),copy:Yt.set("copy",{complexity:1},["map"],["deepCopy","deepCopyKey"],["map","key","value"],["deepCopy","deepCopyKey"],["map"],!0),map:Yt.set("map",{complexity:1},["map"],["transform","transformKey"],["map","key","value"],["transform","transformKey"],["map"],!0),toPlainObject:Yt.set("plain",{complexity:1},["map"],[],[],[],[],!0),fromPlainObject:Yt.set("fromPlain",{complexity:1},["object"],[],[],[],["object"],!0),isValid:Yt.set("?",{},["value"]),isEqual:Yt.set("=",{complexity:1},["value","test","isEqual"],[],["key","value","test"],["isEqual"],[],!0),isNotEqual:Yt.set("!=",{complexity:1},["value","test","isEqual"],[],["key","value","test"],["isEqual"],[],!0),isLess:Yt.set("<",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"],[],!0),isLessOrEqual:Yt.set("<=",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"],[],!0),isGreater:Yt.set(">",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"],[],!0),isGreaterOrEqual:Yt.set(">=",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"],[],!0),asAny:Yt.set("~"+G.Any,{},["value"]),asBoolean:Yt.set("~"+G.Boolean,{},["value"]),asColor:Yt.set("~"+G.Color,{},["value"]),asDate:Yt.set("~"+G.Date,{},["value"]),asList:Yt.set("~"+G.List,{},["value"]),asMap:Yt.set("~"+G.Map,{},["value"]),asNumber:Yt.set("~"+G.Number,{},["value"]),asObject:Yt.set("~"+G.Object,{},["value"]),asText:Yt.set("~"+G.Text,{},["value"]),asTuple:Yt.set("~"+G.Tuple,{},["value"]),asSet:Yt.set("~"+G.Set,{},["value"])};Vt.set("copy",Wt.copy),Vt.set("keys",Wt.keys),Vt.set("values",Wt.values),Vt.set("entries",Wt.entries),Vt.set("pairs",Wt.pairs),Vt.set("count",Wt.count);var Ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Bt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ht(e,t),e.decode=function(t,n){var r=n.getType(t[1]),o=n.getType(t[2]),i=new Map(t[3].map((function(t){var e=Gt(t,2),n=e[0],i=e[1];return[r.fromJson(n),o.fromJson(i)]})));return new e({key:r,value:o,constants:i})},e.encode=function(t){var e=t.options,n=e.key,r=e.value,o=e.constants;return[this.id,n.encode(),r.encode(),Array.from(o.entries()).map((function(t){var e=Gt(t,2),o=e[0],i=e[1];return[n.toJson(o),r.toJson(i)]}))]},e.describe=function(){return null},e.register=function(){},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return this.options.value.getOperations()},e.prototype.merge=function(t){var e,n,r=this.options.constants,o=t.options.constants;this.options.key=Si.merge(this.options.key,t.options.key),this.options.value=Si.merge(this.options.value,t.options.value);try{for(var i=Bt(o.entries()),s=i.next();!s.done;s=i.next()){var a=Gt(s.value,2),u=a[0],p=a[1];r.set(u,p)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},e.prototype.getSubType=function(t,e,n){return this.options.value.getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.options.value.getSubTypes(t)},e.prototype.getChildType=function(t){switch(t){case e.CHILD_KEY:return this.options.key;case e.CHILD_VALUE:return this.options.value}return null},e.prototype.getChildTypes=function(){return[e.CHILD_KEY,e.CHILD_VALUE]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this.options.value},e.prototype.isWrapper=function(){return!0},e.prototype.getWrappedType=function(){return this.options.value},e.prototype.isDeepCompatible=function(t,n){if(void 0===n&&(n={}),!(t instanceof e))return!1;var r=this.options,o=r.key,i=r.value;return!(n.exact&&!o.isCompatible(t.options.key,n))&&i.isCompatible(t.options.value)},e.prototype.isOptional=function(){return this.options.value.isOptional()},e.prototype.isSimple=function(){return this.options.value.isSimple()},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_KEY,n.options.key,(function(t){return n.options.key=t})),t.step(e.STEP_VALUE,n.options.value,(function(t){return n.options.value=t}))}))},e.prototype.getTypeFromStep=function(t){return t===e.STEP_KEY?this.options.key:t===e.STEP_VALUE?this.options.value:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.key.setParent(this),this.options.value.setParent(this)},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return this.options.value.getCreateExpression()},e.prototype.getValidateExpression=function(){return this.options.value.getValidateExpression()},e.prototype.getCompareExpression=function(){return this.options.value.getCompareExpression()},e.prototype.getValueChangeExpression=function(t,n,r){return n===e.STEP_KEY?jn.op(Wt.map,{map:jn.get("value"),transformKey:t},{key:"value",value:"actualValue"}):jn.op(Wt.map,{map:jn.get("value"),transform:t})},e.prototype.isValid=function(t){var e,n,r=this.options,o=r.constants;if(!r.value.isValid(t))return!1;try{for(var i=Bt(o.values()),s=i.next();!s.done;s=i.next()){var a=s.value;if(0===$.compare(a,t))return!0}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!1},e.prototype.normalize=function(t){return this.options.value.normalize(t)},e.prototype.newInstance=function(){var t=this.options,n=t.key,r=t.value;return new e({key:n.newInstance(),value:r.newInstance(),constants:new Map})},e.prototype.clone=function(){var t=this.options,n=t.key,r=t.value,o=t.constants;return new e({key:n.clone(),value:r.clone(),constants:new Map(o.entries())})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){var t=this.options,e=t.value,n=t.constants,r=n.keys().next().value;return r?n.get(r):e.create()},e.prototype.random=function(t){var e=Array.from(this.options.constants.values());return e[t(0,e.length,!0)]},e.prototype.fromJson=function(t){return this.options.value.fromJson(t)},e.prototype.toJson=function(t){return this.options.value.toJson(t)},e.STEP_KEY="key",e.STEP_VALUE="value",e.CHILD_KEY="key",e.CHILD_VALUE="value",e.id=G.Enum,e.operations=new W(G.Enum+G.Delimiter),e.computeds=new H(G.Enum+G.Delimiter),e.baseType=new e({key:qt.baseType,value:qt.baseType,constants:new Map}),e.describePriority=-1,e.registered=!1,e}(q),Jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kt=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return Jt(e,t),e.has=function(t,n){return t instanceof e&&t.value===n},e.is=function(t){return t instanceof e},e.decode=function(t,n){return new e(ht.baseType.fromJson(t[1]))},e.encode=function(t){var e=ht.baseType.toJson(t.value);return i(e)?[this.id,e]:e},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(){return 0},e.prototype.isDynamic=function(){return!1},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e($.copy(this.value))},e.prototype.getType=function(t,e){var n=this.value;if(o(n))return new Ut({key:qt.baseType.newInstance(),value:qt.baseType.newInstance(),constants:new Map([[n,n]])});if(r(n))return new Ut({key:An.baseType.newInstance(),value:An.baseType.newInstance(),constants:new Map([[n,n]])});var i=t.describe(this.value);return i&&i.removeDescribedRestrictions(),i},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){},e.prototype.mutates=function(t,e){return!1},e.ZERO=new e(0),e.ONE=new e(1),e.id="constant",e}(F),zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xt=function(t){function e(e,n,r){void 0===r&&(r="");var o=t.call(this)||this;return o.path=e,o.value=n,o.currentVariable=r,o}return zt(e,t),e.decode=function(t,n){return new e(ee.fromPartial(t[1],n),n.getExpression(t[2]),t[3])},e.encode=function(t){var e=t.path.encode(),n=t.value.encode();return t.currentVariable?[this.id,e,n,t.currentVariable]:[this.id,e,n]},e.create=function(t,n,r){return void 0===r&&(r=""),new e(jn.path(t),jn.parse(n),r)},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return Math.max(this.path.getComplexity(t,e),this.value.getComplexity(t,e))},e.prototype.getScope=function(){var t;return this.currentVariable?((t={})[this.currentVariable]=ht.baseType,t):null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.path.clone(),this.value.clone(),this.currentVariable)},e.prototype.getType=function(t,e){return Z.baseType},e.prototype.getContextFor=function(t,n,r,o){return t[0]===e.STEP_VALUE&&this.currentVariable?n.getContext(r,this.getScope()):r},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_PATH,n.path,(function(t){return n.path=jn.path([t])})),t.step(e.STEP_VALUE,n.value,(function(t){return n.value=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_PATH?[1,this.path]:t[0]===e.STEP_VALUE?[1,this.value]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.path.setParent(this),this.value.setParent(this)},e.prototype.validate=function(t,e,n){var r;this.path.validate(t,e,n);var o=this.path.getType(t,e);if(this.path.isWritable(t)||n({type:R.READONLY,severity:j.HIGH,context:e,subject:this.path,parent:this}),o){var i=this.currentVariable?t.getContext(e,((r={})[this.currentVariable]=o,r)):e;this.validateType(t,i,o,this.value,n)}else n({type:R.INVALID_EXPRESSION,severity:j.HIGH,context:e,subject:this.path,parent:this})},e.prototype.mutates=function(t,e,n){return this.path.isMutating(e,n)||this.value.mutates(t,e,n)||this.path.mutates(t,e,n)},e.prototype.to=function(t,e){return void 0===e&&(e=""),this.value=jn.parse(t),this.value.setParent(this),this.currentVariable=e,this},e.prototype.withVariable=function(t){return this.currentVariable=t,this},e.STEP_PATH="path",e.STEP_VALUE="value",e.id="set",e}(F),$t=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Zt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Qt(arguments[e]));return t},te=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ee=function(t){function e(e){var n=t.call(this)||this;return n.expressions=e,n}return $t(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){return n.getExpression(t)})))},e.encode=function(t){return[this.id,t.expressions.map((function(t){return t.encode()}))]},e.createForLegacy=function(t){for(var n=t.length-1;n>=0;n--){var r=t[n];r instanceof e&&(0!==r.expressions.length&&r.expressions[0].isPathStart()||t.splice.apply(t,Zt([n,1],r.expressions)))}return new e(t)},e.fromPartial=function(t,n){var r=t[0]===e.id,o=r?e.decode(t,n):e.decode(["path",Zt([new Ct],t)],n);return r&&n.setLegacy(),o},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){var n,r,o=0,i=e;try{for(var s=te(this.expressions),a=s.next();!a.done;a=s.next()){var u=a.value,p=u.getComplexity(t,e,i);p>o&&(o=p),i=u.getType(t,e,i)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expressions.map((function(t){return t.clone()})))},e.prototype.getType=function(t,e){return t.getPathType(this.expressions,e)},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return e.expressions.forEach((function(n,r){return t.step(r,n,(function(t){return e.expressions.splice(r,1,t)}),(function(){return e.expressions.splice(r,1)}))}))}))},e.prototype.getExpressionFromStep=function(t){return r(t[0])&&t[0]<this.expressions.length?[1,this.expressions[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.expressions.forEach((function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n){var r=this.expressions;if(0!==r.length){var o=r[0].getType(t,e);if(o){r[0].validate(t,e,n);for(var i=1;i<r.length;i++){var s=r[i];if(s.validate(t,e,n,o),!(o=s.isPathNode()?s.getType(t,e,o):o.getSubType(s,t,e))){n({type:R.INVALID_EXPRESSION,severity:j.HIGH,context:e,subject:s,parent:this});break}}}else n({type:R.INVALID_EXPRESSION,severity:j.HIGH,context:e,subject:r[0],parent:this})}else n({type:R.EMPTY_PATH,severity:j.HIGH,context:e,subject:this})},e.prototype.mutates=function(t,e,n){var r,o;try{for(var i=te(this.expressions),s=i.next();!s.done;s=i.next())if(s.value.mutates(t,e,n))return!0}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},e.prototype.isWritable=function(t){return this.expressions.length>0&&this.expressions[this.expressions.length-1].isPathWritable(t)},e.prototype.isMutating=function(t,e){void 0===e&&(e=!1);var n=this.expressions[0],r=this.expressions[1],o=this.expressions[2];return n instanceof Ct&&r instanceof Kt&&r.value===t&&(!!e||!!o)},e.prototype.set=function(t,e){return new Xt(this.clone(),t,e)},e.id="path",e}(F),ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return ne(e,t),e.decode=function(t,n){var r=t[1];if(t[2]){var o=n.getExpression(t[2]);return n.setLegacy(),ee.createForLegacy([o,new e(r)])}return new e(r)},e.encode=function(t){return[this.id,t.name]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){var n=t.getComputed(this.name);if(!n)return 0;var r=t.getOperation(n.op);return r?r.complexity:0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name)},e.prototype.getType=function(t,e,n){return n?t.getComputedReturnType(this.name,n):null},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.getExpressionFromStep=function(t){return null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n,r){r?t.hasComputed(r,this.name)||n({type:R.INVALID_EXPRESSION,severity:j.HIGH,context:e,subject:this}):n({type:R.OUTSIDE_PATH,severity:j.HIGH,context:e,subject:this})},e.prototype.mutates=function(t,e){return!1},e.prototype.isPathNode=function(){return!0},e.prototype.isPathWritable=function(t){var e=t.getComputed(this.name);return!e||!!e.writeable},e.STEP_EXPRESSION="expression",e.id="comp",e}(F),oe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ie=1e5,se=function(t){function e(e,n,r,o,i,s){void 0===s&&(s=ie);var a=t.call(this)||this;return a.variable=e,a.start=n,a.end=r,a.body=o,a.by=i,a.maxIterations=s,a}return oe(e,t),e.decode=function(t,n){return new e(t[1],n.getExpression(t[2]),n.getExpression(t[3]),n.getExpression(t[4]),n.getExpression(t[5])||new Kt(1),parseInt(t[6])||this.MAX_ITERATIONS)},e.encode=function(t){var e=[this.id,t.variable,t.start.encode(),t.end.encode(),t.body.encode()],n=!(t.by instanceof Kt)||1!==t.by.value,r=t.maxIterations!==this.MAX_ITERATIONS;return n?e.push(t.by.encode()):r&&e.push(1),r&&e.push(t.maxIterations),e},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return 1+Math.max(this.start.getComplexity(t,e),this.end.getComplexity(t,e),this.body.getComplexity(t,e),this.by.getComplexity(t,e))},e.prototype.isDynamic=function(){return this.body.isDynamic()},e.prototype.getScope=function(){var t;return(t={})[this.variable]=An.baseType.newInstance(),t},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.variable,this.start.clone(),this.end.clone(),this.body.clone(),this.by.clone(),this.maxIterations)},e.prototype.getType=function(t,e){var n=t.getContextWithScope(e,this.getScope()).context,r=this.body.getType(t,n);return r?Si.optional(r):null},e.prototype.getContextFor=function(t,n,r,o){return t[0]===e.STEP_BODY?n.getContext(r,this.getScope()):r},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_START,n.start,(function(t){return n.start=t})),t.step(e.STEP_END,n.end,(function(t){return n.end=t})),t.step(e.STEP_BODY,n.body,(function(t){return n.body=t})),t.step(e.STEP_BY,n.by,(function(t){return n.by=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_START?[1,this.start]:t[0]===e.STEP_END?[1,this.end]:t[0]===e.STEP_BODY?[1,this.body]:t[0]===e.STEP_BY?[1,this.by]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.start.setParent(this),this.end.setParent(this),this.body.setParent(this),this.by.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,An.baseType,this.start,n),this.validateType(t,e,An.baseType,this.end,n),this.validateType(t,e,An.baseType,this.by,n);var r=t.getContext(e,this.getScope());this.body.validate(t,r,n)},e.prototype.mutates=function(t,e,n){return this.start.mutates(t,e,n)||this.end.mutates(t,e,n)||this.body.mutates(t,e,n)||this.by.mutates(t,e,n)},e.prototype.isValidFlow=function(e,n,r){return r===this.body&&(n===A.BREAK||n===A.CONTINUE)||t.prototype.isValidFlow.call(this,e,n)},e.prototype.loop=function(t,e,n,o,i,s){return this.variable=t,this.start=jn.parse(e),this.start.setParent(this),this.end=jn.parse(n),this.end.setParent(this),o&&(this.body=o,this.body.setParent(this)),i&&(this.by=jn.parse(i),this.by.setParent(this)),r(s)&&(this.maxIterations=s),this},e.prototype.startAt=function(t){return this.start=jn.parse(t),this.start.setParent(this),this},e.prototype.endAt=function(t){return this.end=jn.parse(t),this.end.setParent(this),this},e.prototype.inc=function(t){return this.by=jn.parse(t),this.by.setParent(this),this},e.prototype.run=function(t){return this.body=t,this.body.setParent(this),this},e.prototype.withVariable=function(t){return this.variable=t,this},e.prototype.withMax=function(t){return this.maxIterations=t,this},e.STEP_START="start",e.STEP_END="end",e.STEP_BODY="body",e.STEP_BY="by",e.MAX_ITERATIONS=ie,e.id="for",e}(F),ae=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ue=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return ae(e,t),e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return[this.id,t.name]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name)},e.prototype.getType=function(t,e){var n=t.getData(this.name);return n?n.dataType:ct.baseType},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){this.name?t.getData(this.name)||n({type:R.MISSING_DATA,severity:j.HIGH,context:e,parent:this}):n({type:R.MISSING_DATA_NAME,severity:j.HIGH,context:e,parent:this})},e.prototype.mutates=function(t,e){return!1},e.prototype.isPathStart=function(){return!0},e.prototype.isPathNode=function(){return!0},e.id="data",e.instance=new e(""),e}(F),pe=new W(G.Entity+G.Delimiter),ce=new H(G.Entity+G.Delimiter),le=pe,fe={newInstance:le.set("newInstance",{},["name"],["initial"],[],[],["name"]),get:le.set("get",{},["name"],["where"],["instance"],["where"],["name"]),getKey:le.set("getKey",{},["name","instance"],[],[],[],["name"]),save:le.set("save",{mutates:["instance"]},["name","instance"],[],[],[],["name"]),remove:le.set("remove",{mutates:["instance"]},["name","instance"],[],[],[],["name"]),setRelated:le.set("setRelated",{complexity:1,mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),addRelated:le.set("addRelated",{mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),removeRelated:le.set("removeRelated",{mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),clearRelated:le.set("clearRelated",{complexity:1,mutates:["instance"]},["name","instance","relation"],[],[],[],["name","relation"]),getRelated:le.set("getRelated",{complexity:1},["name","instance","relation"],[],[],[],["name","relation"]),isRelated:le.set("isRelated",{},["name","instance","relation","related"],[],[],[],["name","relation"])},ye=new W(G.Object+G.Delimiter),he=new H(G.Object+G.Delimiter),de=ye,ve={create:de.set("create"),maybe:de.set("maybe",{},["value"]),has:de.set("has",{},["object","key"]),get:de.set("get",{},["object","key"]),set:de.set("set",{mutates:["object"]},["object","key","value"],[],["existingValue"],[],["object"]),delete:de.set("del",{mutates:["object"]},["object","key"]),cmp:de.set("cmp",{},["value","test"]),copy:de.set("copy",{},["object"],[],[],[],["object"]),merge:de.set("merge",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),isValid:de.set("?",{},["value"]),isEqual:de.set("=",{},["value","test"]),isNotEqual:de.set("!=",{},["value","test"]),isLess:de.set("<",{},["value","test"]),isLessOrEqual:de.set("<=",{},["value","test"]),isGreater:de.set(">",{},["value","test"]),isGreaterOrEqual:de.set(">=",{},["value","test"]),asAny:de.set("~"+G.Any,{},["value"]),asBoolean:de.set("~"+G.Boolean,{},["value"]),asColor:de.set("~"+G.Color,{},["value"]),asDate:de.set("~"+G.Date,{},["value"]),asList:de.set("~"+G.List,{},["value"]),asMap:de.set("~"+G.Map,{},["value"]),asNumber:de.set("~"+G.Number,{},["value"]),asObject:de.set("~"+G.Object,{},["value"]),asText:de.set("~"+G.Text,{},["value"]),asTuple:de.set("~"+G.Tuple,{},["value"]),asSet:de.set("~"+G.Set,{},["value"])};he.set("copy",ve.copy);var me=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Te=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ge(arguments[e]));return t},be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return me(e,t),e.decode=function(t,n){return new e({props:O(t[1],(function(t){return n.getType(t)}))})},e.encode=function(t){var e=O(t.options.props,(function(t){return t.encode()}));return[this.id,e]},e.describe=function(t,n,r){if(!l(t)||null===t)return null;var o=new e({props:{}});return r.set(t,o),o.options.props=O(t,(function(t){return n.describe(t)})),o},e.register=function(){var t="object";$.addJson({priority:7,fromJson:function(t,e){if(l(t))return O(t,e)},toJson:function(t,e){if(l(t))return O(t,e)}}),$.addCopier({priority:7,copy:function(t,e,n){if(l(t)){var r={};for(var o in n(t,r),t)r[e(o)]=e(t[o]);return r}}}),$.addCompare({priority:7,type:t,compare:function(t,e,n){if(null===t)return 1;if(null===e)return-1;var r=0,o=0;for(var i in t)i in e||r++;for(var i in e)i in t||o++;for(var i in t)if(i in e){var s=n(t[i],e[i]);s<0&&r++,s>0&&o++}return $.getCompare(r,o)}}),$.addEquals({priority:7,type:t,equals:function(t,e,n){if(null===t!=(null===e))return!1;for(var r in t)if(!(r in e))return!1;for(var r in e){if(!(r in t))return!1;if(!n(t[r],e[r]))return!1}return!0}}),$.addAccessor({priority:7,isValid:function(t){return l(t)},get:function(t,e){return t[e]},set:function(t,e,n){return $.objectSet(t,e,n)},remove:function(t,e){return $.objectRemove(t,e)},has:function(t,e){return e in t}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options.props,n=t.options.props;for(var r in e)r in n&&n[r]?e[r]=Si.merge(e[r],n[r]):e[r]&&(e[r]=Si.optional(e[r]));for(var r in n)!(r in e)&&n[r]&&(e[r]=Si.optional(n[r]))},e.prototype.getSubType=function(t,e,n){var r=this;if(Kt.is(t)&&o(t.value))return this.options.props[t.value];var i=t.getType(e,n);if(i){if((i=i.getRequired())instanceof qt){var s=w(this.options.props);return Si.mergeMany(s,ct.baseType)}if(i instanceof Ut)return s=Array.from(i.options.constants.values()).map((function(t){return r.options.props[t]})).filter((function(t){return!!t})),Si.mergeMany(s,ct.baseType)}return this.getWildcardType()},e.prototype.getSubTypes=function(t){var e=w(this.options.props);return Te(w(this.options.props,(function(t,e){return{key:e,value:t}})),[{key:new Ut({key:qt.baseType,value:qt.baseType,constants:new Map(w(this.options.props,(function(t,e){return[e,e]})))}),value:Si.mergeMany(e,ct.baseType)},{key:qt.baseType,value:Si.optional(Si.mergeMany(e,ct.baseType))}])},e.prototype.getChildType=function(t){return this.options.props[t]||null},e.prototype.getChildTypes=function(){return Object.keys(this.options.props)},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return E(e.options.props,(function(n,r){return t.step(r,n,(function(t){return e.options.props[r]=t}),(function(){return $.objectRemove(e.options.props,r)}))}))}))},e.prototype.getTypeFromStep=function(t){return this.options.props[t]||null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.options.props,(function(t){return t?t.setParent(e):0}))},e.prototype.removeDescribedRestrictions=function(){E(this.options.props,(function(t){return t?t.removeDescribedRestrictions():0}))},e.prototype.isDeepCompatible=function(t,n){if(!(t instanceof e))return!1;var r=this.options.props;for(var o in r)if(o!==e.wilcardProperty&&r[o]){if(!t.options.props[o]){if(r[o].isOptional())continue;return!1}if(!r[o].isCompatible(t.options.props[o],n))return!1}var i=this.getWildcardType();if(n.exact){for(var o in t.options.props)if(!r[o]&&t.options.props[o])return!1}else if(i)for(var o in t.options.props)if(!r[o]&&t.options.props[o]&&!i.isCompatible(t.options.props[o],n))return!1;return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.getCreateExpression=function(){return jn.object(O(this.options.props,(function(t){return t?t.getCreateExpression():jn.noop()})))},e.prototype.getValidateExpression=function(){return jn.and.apply(jn,Te([jn.op(ve.isValid,{value:jn.get("value")})],w(this.options.props,(function(t,e){return jn.define({value:jn.get("value",e)}).run(t?t.getValidateExpression():jn.true())}))))},e.prototype.getCompareExpression=function(){return jn.or.apply(jn,Te(w(this.options.props,(function(t,e){return jn.define({value:jn.get("value",e),test:jn.get("test",e)}).run(t?t.getCompareExpression():jn.true())}))))},e.prototype.getValueChangeExpression=function(t,e,n){var r=null!=e,o=null!=n;return!r&&o?jn.define({parent:jn.get("value")},jn.op(ve.set,{object:jn.get("value"),key:n,value:t})):r&&!o?jn.body(jn.op(ve.delete,{object:jn.get("value"),key:e}),jn.get("value")):e!==n?jn.body(jn.op(ve.set,{object:jn.get("value"),key:n,value:jn.get("value",e)}),jn.op(ve.delete,{object:jn.get("value"),key:e}),jn.get("value")):e===n&&r?jn.body(jn.set("value",e).to(t,"value"),jn.get("value")):t},e.prototype.isValid=function(t){if(!l(t))return!1;var n=this.options.props;for(var r in n)if(r!==e.wilcardProperty&&n[r]&&!n[r].isValid(t[r]))return!1;var o=this.getWildcardType();if(o)for(var r in t)if(!n[r]&&!o.isValid(t[r]))return!1;return!0},e.prototype.normalize=function(t){return t},e.prototype.newInstance=function(){return new e({props:{}})},e.prototype.clone=function(){return new e({props:O(this.options.props,(function(t){return t?t.clone():t}))})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){var t=this.options.props,e=Object.create(null);for(var n in t){var r=t[n];r&&!r.isOptional()&&(e[n]=r.create())}return e},e.prototype.random=function(t){var e=this.options.props,n=Object.create(null);for(var r in e)e[r]&&(n[r]=e[r].random(t));return n},e.prototype.fromJson=function(t){var e=this;return O(t,(function(t,n){var r=e.options.props[n];return r?r.fromJson(t):t}))},e.prototype.toJson=function(t){var e=this;return O(t,(function(t,n){var r=e.options.props[n];return r?r.toJson(t):t}))},e.prototype.getWildcardType=function(){return this.options.props[e.wilcardProperty]||null},e.wilcardProperty="*",e.id=G.Object,e.operations=ye,e.computeds=he,e.baseType=new e({props:{}}),e.describePriority=5,e.registered=!1,e}(q),xe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oe=function(t){function e(e,n){var r=t.call(this,e)||this;return r.provider=n,r}return xe(e,t),e.decode=function(t,n){return new e(t[1],n)},e.encode=function(t){return[this.id,t.options]},e.describe=function(t,e,n){return null},e.register=function(){},e.for=function(t,n){return new e(t,n)},e.prototype.getType=function(){return this.provider?this.provider.getType(this.options,ct.baseType):be.baseType},e.prototype.getOperations=function(){return this.getType().getOperations()},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return this.getType().getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.getType().getSubTypes(t)},e.prototype.getExactType=function(t){return this.getType().getExactType(t)},e.prototype.getSimplifiedType=function(){return this},e.prototype.isWrapper=function(){return!0},e.prototype.getWrappedType=function(){return this.getType()},e.prototype.isDeepCompatible=function(t,n){return t instanceof e?this.getType().isCompatible(t.getType(),n):this.getType().isCompatible(t,n)},e.prototype.isOptional=function(){return this.getType().isOptional()},e.prototype.isSimple=function(){return this.getType().isSimple()},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){return t.step(e.STEP_ENTITY,n.getType(),(function(t){return t instanceof e?n.options=t.options:0}))}))},e.prototype.getTypeFromStep=function(t){return t===e.STEP_ENTITY?this.getType():null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return this.getType().getCreateExpression()},e.prototype.getValidateExpression=function(){return this.getType().getValidateExpression()},e.prototype.getCompareExpression=function(){return this.getType().getCompareExpression()},e.prototype.getValueChangeExpression=function(t,e,n){return t},e.prototype.isValid=function(t){return this.getType().isValid(t)},e.prototype.normalize=function(t){return this.getType().normalize(t)},e.prototype.newInstance=function(){return new e(this.options,this.provider)},e.prototype.clone=function(){return new e(this.options,this.provider)},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.getType().create()},e.prototype.random=function(t){return this.getType().random(t)},e.prototype.fromJson=function(t){return this.getType().fromJson(t)},e.prototype.toJson=function(t){return this.getType().toJson(t)},e.STEP_ENTITY="entity",e.id=G.Entity,e.operations=pe,e.computeds=ce,e.baseType=new e("",null),e.describePriority=-1,e.registered=!1,e}(q),Ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),we=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return Ee(e,t),e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return[this.id,t.name]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name)},e.prototype.getType=function(t,e){return new Oe(this.name,t)},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){this.name?t.getEntity(this.name)||n({type:R.MISSING_TYPE,severity:j.HIGH,context:e,parent:this}):n({type:R.MISSING_TYPE_NAME,severity:j.HIGH,context:e,parent:this})},e.prototype.mutates=function(t,e){return!1},e.id="entity",e.instance=new e(""),e}(F),Se=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pe=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return Se(e,t),e.decode=function(t,n){return new e(t[1])},e.encode=function(t){return[this.id,t.name]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return 0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name)},e.prototype.getType=function(t,e){return new Ut({key:qt.baseType,value:qt.baseType,constants:new Map([["relation",this.name]])})},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.validate=function(t,e,n){this.name?t.getRelation(this.name)||n({type:R.MISSING_RELATION,severity:j.HIGH,context:e,parent:this}):n({type:R.MISSING_RELATION_NAME,severity:j.HIGH,context:e,parent:this})},e.prototype.mutates=function(t,e){return!1},e.id="relation",e.instance=new e(""),e}(F),_e=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ie=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Me=function(t){function e(e,n){var r=t.call(this)||this;return r.cases=e,r.otherwise=n,r}return _e(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){var e=Ie(t,2),r=e[0],o=e[1];return[n.getExpression(r),n.getExpression(o)]})),n.getExpression(t[2]))},e.encode=function(t){var e=t.cases.map((function(t){var e=Ie(t,2),n=e[0],r=e[1];return[n.encode(),r.encode()]}));return Kt.has(t.otherwise,void 0)?[this.id,e]:[this.id,e,t.otherwise.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.cases.reduce((function(n,r){var o=Ie(r,2),i=o[0],s=o[1];return Math.max(n,i.getComplexity(t,e),s.getComplexity(t,e))}),this.otherwise.getComplexity(t,e))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.cases.map((function(t){var e=Ie(t,2),n=e[0],r=e[1];return[n.clone(),r.clone()]})),this.otherwise.clone())},e.prototype.getType=function(t,e){var n=this.cases.map((function(t){var e=Ie(t,2);return e[0],e[1]})).concat(this.otherwise).filter((function(t){return!!t})).map((function(n){return n.getType(t,e)})).filter((function(t){return!!t}));return Si.mergeMany(n,ct.baseType)},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_CASES,(function(){return n.cases.forEach((function(r,o){var i=Ie(r,2),s=i[0],a=i[1];return t.step(o,(function(){t.step(e.STEP_IF,s,(function(t){return n.cases[o].splice(0,1,t)})),t.step(e.STEP_THEN,a,(function(t){return n.cases[o].splice(1,1,t)}))}))}))})),n.otherwise!==ft.instance&&t.step(e.STEP_ELSE,n.otherwise,(function(t){return n.otherwise=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_CASES?r(t[1])&&t[1]<this.cases.length?t[2]===e.STEP_IF?[3,this.cases[t[1]][0]]:t[2]===e.STEP_THEN?[3,this.cases[t[1]][1]]:null:null:t[0]===e.STEP_ELSE?[1,this.otherwise]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.cases.forEach((function(t){var n=Ie(t,2),r=n[0],o=n[1];r.setParent(e),o.setParent(e)})),this.otherwise.setParent(this)},e.prototype.validate=function(t,e,n){var r=this,o=Z.baseType;this.cases.forEach((function(i){var s=Ie(i,2),a=s[0],u=s[1];r.validateType(t,e,o,a,n),u.validate(t,e,n)})),this.otherwise.validate(t,e,n)},e.prototype.mutates=function(t,e,n){var r,o;try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.cases),s=i.next();!s.done;s=i.next()){var a=Ie(s.value,2),u=a[0],p=a[1];if(u.mutates(t,e,n)||p.mutates(t,e,n))return!0}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return this.otherwise.mutates(t,e,n)},e.prototype.if=function(t,e){return this.cases.push([t,e||ft.instance]),t.setParent(this),e&&e.setParent(this),this},e.prototype.than=function(t){return this.cases[this.cases.length-1][1]=t,t.setParent(this),this},e.prototype.elseif=function(t,e){return this.cases.push([t,e||ft.instance]),t.setParent(this),e&&e.setParent(this),this},e.prototype.else=function(t){return this.otherwise=t,this.otherwise.setParent(this),this},e.STEP_CASES="cases",e.STEP_IF="if",e.STEP_THEN="then",e.STEP_ELSE="else",e.id="if",e}(F),Ce=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),De=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ce(e,t),e.decode=function(t,n){return new e({path:t[1],base:t[2]?n.getType(t[2]):void 0})},e.encode=function(t){var e=t.options.path.slice();return t.options.base?[this.id,e,t.options.base.encode()]:[this.id,e]},e.describe=function(t,e,n){return null},e.register=function(){},e.prototype.getFunction=function(){for(var t=this.parent;t;){if(t instanceof Re)return t;t=t.parent}return null},e.prototype.getResolvedType=function(){var t,e=this.options,n=e.path,r=e.base;return(null===(t=this.getFunction())||void 0===t?void 0:t.getTypeFromPath(n))||r||ht.baseType},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return this.getResolvedType().getOperations()},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return this.getResolvedType().getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.getResolvedType().getSubTypes(t)},e.prototype.getChildType=function(t){return this.getResolvedType().getChildType(t)},e.prototype.getChildTypes=function(){return this.getResolvedType().getChildTypes()},e.prototype.getExactType=function(t){return this.getResolvedType().getExactType(t)},e.prototype.getSimplifiedType=function(){return this},e.prototype.isWrapper=function(){return!0},e.prototype.getWrappedType=function(){return this.getResolvedType()},e.prototype.isCompatible=function(t){return!0},e.prototype.isDeepCompatible=function(t,e){return!0},e.prototype.isOptional=function(){return this.getResolvedType().isOptional()},e.prototype.isSimple=function(){return this.getResolvedType().isOptional()},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return this.getResolvedType().getCreateExpression()},e.prototype.getValidateExpression=function(){return this.getResolvedType().getValidateExpression()},e.prototype.getCompareExpression=function(){return this.getResolvedType().getCompareExpression()},e.prototype.isValid=function(t){return this.getResolvedType().isValid(t)},e.prototype.normalize=function(t){return this.getResolvedType().normalize(t)},e.prototype.newInstance=function(){return new e({path:[]})},e.prototype.clone=function(){var t;return new e({path:this.options.path.slice(),base:null===(t=this.options.base)||void 0===t?void 0:t.clone()})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.getResolvedType().create()},e.prototype.random=function(t){return this.getResolvedType().random(t)},e.prototype.fromJson=function(t){return this.getResolvedType().fromJson(t)},e.prototype.toJson=function(t){return this.getResolvedType().toJson(t)},e.id=G.Generic,e.operations=new W(G.Generic+G.Delimiter),e.computeds=new H(G.Generic+G.Delimiter),e.baseType=new e({path:[]}),e.describePriority=8,e.registered=!1,e}(q),je=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Re=function(t){function e(e,n){var r=t.call(this,e)||this;return r.provider=n,r}return je(e,t),e.decode=function(t,n){return new e({params:O(t[1],(function(t){return n.getType(t)})),returns:t[2]?n.getType(t[2]):void 0},n)},e.encode=function(t){var e=t.options,n=e.params,r=e.returns,o=O(n,(function(t){return t instanceof q?t.encode():void 0}));return r instanceof q?[this.id,o,r.encode()]:[this.id,o]},e.describe=function(t,e,n){return null},e.register=function(){},e.prototype.getParamTypesType=function(t){return void 0===t&&(t={}),new be({props:this.getParamTypes(t)})},e.prototype.getParamTypes=function(t){void 0===t&&(t={});var e=this.options.params,n=Object.create(null);for(var r in Object.assign(n,t),e){var o=t[r],i=this.getProvided(e[r],n);o&&i.acceptsType(o)||(n[r]=i)}return n},e.prototype.getParamType=function(t,e){return void 0===e&&(e={}),this.getProvided(this.options.params[t],e)},e.prototype.getReturnType=function(t){return void 0===t&&(t={}),this.getProvided(this.options.returns,t)},e.prototype.getProvided=function(t,e){return void 0===e&&(e={}),t instanceof q?t:"function"==typeof t?t(e,this.provider):null},e.prototype.getTypeFromPath=function(t,e){void 0===e&&(e={});for(var n=e[t[0]]instanceof q?e[t[0]]:this.getChildType(t[0]),r=1;r<t.length;r++)n=null==n?void 0:n.getChildType(t[r]);return n||null},e.prototype.getOverloaded=function(t){void 0===t&&(t={});var e=this.clone();return e.traverse(new L((function(n,r,o,i){if(n instanceof De){for(;n&&n instanceof De;){var s=e.getResolvedType(n,t);if(s===n)break;n=s}n&&i.replace(n)}}))),e},e.prototype.getResolvedType=function(t,n){void 0===n&&(n={});var r=t.options,o=r.path,i=r.base,s=this.getTypeFromPath(o,n);if(s===t)return i;for(var a=this;!s&&(a=a.getParentOfType(e));)s=a.getTypeFromPath(o,n);return s||i},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return{}},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getChildType=function(t){var n=this.getParamTypes();return t===e.CHILD_RETURN?this.getReturnType(n):n[t]||null},e.prototype.getChildTypes=function(){var t=this.options.params;return Object.keys(t).concat(e.CHILD_RETURN)},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){if(!(t instanceof e))return!1;var r=t.getParamTypes(),o=this.getOverloaded(r),i=t.getOverloaded(),s=o.options,a=s.params,u=s.returns,p=i.options,c=p.params,l=p.returns;if(Boolean(u)!==Boolean(l))return!1;if(!u.isCompatible(l,n))return!1;for(var f in a)if(a[f]){if(!(f in c)&&(n.exact||!a[f].isOptional()))return!1;var y=a[f],h=c[f];if(!y.isCompatible(h,n))return!1}for(var d in c)if(c[d]&&!a[d]&&(n.exact||!c[d].isOptional()))return!1;return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var n=this,r=this.options.params;return t.enter(this,(function(){E(r,(function(e,o){var i=n.getProvided(e);i&&t.step(o,i,(function(t){return $.objectSet(r,o,t)}),(function(){return $.objectRemove(r,o)}))}));var o=n.getReturnType();o&&t.step(e.STEP_RETURNS,o,(function(t){return $.objectSet(n.options,"returns",t)}),(function(){return $.objectRemove(n.options,"returns")}))}))},e.prototype.getTypeFromStep=function(t){var n=this.options,r=n.params,o=n.returns,i=r[t];return t===e.STEP_RETURNS?o instanceof q?o:null:i instanceof q?i:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t;var e=this.options,n=e.params,r=e.returns;for(var o in n){var i=n[o];i instanceof q&&i.setParent(this)}r&&r instanceof q&&r.setParent(this)},e.prototype.removeDescribedRestrictions=function(){var t=this.options,e=t.params,n=t.returns;for(var r in e){var o=e[r];o instanceof q&&o.removeDescribedRestrictions()}n&&n instanceof q&&n.removeDescribedRestrictions()},e.prototype.getCreateExpression=function(){return jn.null()},e.prototype.getValidateExpression=function(){return jn.null()},e.prototype.getCompareExpression=function(){return jn.null()},e.prototype.isValid=function(t){return c(t)||o(t)||this.provider.isExpression(t)},e.prototype.normalize=function(t){return this.provider.isExpression(t)?this.provider.getExpression(t):t},e.prototype.newInstance=function(){return new e({params:{}},this.provider)},e.prototype.clone=function(){return new e({params:O(this.options.params,(function(t){return t instanceof q?t.clone():t})),returns:this.options.returns instanceof q?this.options.returns.clone():this.options.returns},this.provider)},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return null},e.prototype.random=function(t){return null},e.prototype.fromJsonArguments=function(t){var e=this.options.params,n={};for(var r in e){var o=e[r];o instanceof q&&r in t&&(n[r]=o.fromJson(t[r]))}return n},e.prototype.toJsonArguments=function(t){var e=this.options.params,n={};for(var r in e){var o=e[r];o instanceof q&&r in t&&(n[r]=o.fromJson(t[r]))}return n},e.prototype.fromJson=function(t){return this.provider.isExpression(t)?this.provider.getExpression(t):t},e.prototype.toJson=function(t){return t instanceof F?t.encode():t},e.STEP_RETURNS="returns",e.CHILD_RETURN="returns",e.id=G.Function,e.operations=new W(G.Function+G.Delimiter),e.computeds=new H(G.Function+G.Delimiter),e.baseType=new e({params:{}},null),e.describePriority=6,e.registered=!1,e}(q),Ae=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ne=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e,r.args=n,r}return Ae(e,t),e.decode=function(t,n){return new e(t[1],O(t[2],(function(t){return n.getExpression(t)})))},e.encode=function(t){var e=O(t.args,(function(t){return t.encode()}));return[this.id,t.name,e]},e.prototype.getId=function(){return e.id},e.prototype.getFunction=function(t,e,n){if(this.name){var r=e.getChildType(this.name);return r instanceof Re?{type:r}:t.getFunction(this.name)}if(n instanceof Re)return{type:n}},e.prototype.getComplexity=function(t,e,n){var r=this.getFunction(t,e,n);return(null==r?void 0:r.expression)?r.expression.getComplexity(t,e,n):0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name,O(this.args,(function(t){return t.clone()})))},e.prototype.getType=function(t,e,n){var r,o=this.getFunction(t,e,n);if(!o)return null;var i=O(this.args,(function(n){return n.getType(t,e)}));if(!o.type)return null===(r=o.expression)||void 0===r?void 0:r.getType(t,new be({props:i}));var s=o.type.getOverloaded(i);return s.getReturnType()||(o.expression?o.expression.getType(t,s.getParamTypesType()):null)},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return E(e.args,(function(n,r){return t.step(r,n,(function(t){return e.args[r]=t}),(function(){return $.objectRemove(e.args,r)}))}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]in this.args?[1,this.args[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.args,(function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n,r){var o=this,i=this.getFunction(t,e,r);if(i){var s=O(this.args,(function(n){return n.getType(t,e)}));E(i.type.getOverloaded(s).getParamTypes(),(function(r,i){var s=o.args[i];o.validateType(t,e,r,s,n)}))}else n({type:R.MISSING_FUNCTION,severity:j.HIGH,context:e,subject:this})},e.prototype.mutates=function(t,e,n){var r=t.getFunction(this.name);if(!r)return!1;for(var o in this.args){var i=this.args[o];if(i.mutates(t,e,n)||i instanceof ee&&i.isMutating(e,!0)&&r.mutates(t,o))return!0}return!1},e.prototype.getInnerExpression=function(t,e,n){var r,o=e[this.name];return(n instanceof F?n:o instanceof F?o:null===(r=t.getFunction(this.name))||void 0===r?void 0:r.expression)||"Function does not exist"},e.prototype.named=function(t){return this.name=t,this},e.prototype.arg=function(t,e){var n,r=o(t)?((n={})[t]=e,n):t;for(var i in r){var s=jn.parse(r[i]);this.args[i]=s,s.setParent(this)}return this},e.id="invoke",e}(F),ke=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Le=function(t){function e(e,n,r){var o=t.call(this)||this;return o.entity=e,o.name=n,o.args=r,o}return ke(e,t),e.decode=function(t,n){return new e(t[1],t[2],O(t[3],(function(t){return n.getExpression(t)})))},e.encode=function(t){var e=O(t.args,(function(t){return t.encode()}));return[this.id,t.entity,t.name,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){var n=t.getEntity(this.entity);return n&&n.methods[this.name]?n.methods[this.name].expression.getComplexity(t,e):0},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.entity,this.name,O(this.args,(function(t){return t.clone()})))},e.prototype.getType=function(t,e,n){if(!(n&&n instanceof Oe&&n.options===this.entity))return null;var r=t.getEntity(this.entity);if(!r)return null;var o=r.methods[this.name];if(!o)return null;var i=O(this.args,(function(n){return n.getType(t,e)}));return i[F.INSTANCE]=r.type,o.getReturnType(t,e,i)},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return E(e.args,(function(n,r){return t.step(r,n,(function(t){return e.args[r]=t}),(function(){return $.objectRemove(e.args,r)}))}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]in this.args?[1,this.args[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.args,(function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n,r){var o=this;if(r&&r instanceof Oe&&r.options===this.entity){var i=t.getEntity(this.entity);if(i){var s=i.methods[this.name];if(s){var a={};a[F.INSTANCE]=i.type,E(s.type.options.params,(function(r,i){var s=o.args[i];o.validateType(t,e,r,s,n),s&&(a[i]=s.getType(t,e))}))}else n({type:R.MISSING_METHOD,severity:j.HIGH,context:e,subject:this})}else n({type:R.MISSING_TYPE,severity:j.HIGH,context:e,subject:this})}else n({type:R.INVALID_THIS,severity:j.HIGH,context:e,subject:this})},e.prototype.mutates=function(t,e,n){var r=t.getEntity(this.entity);if(!r)return!1;var o=r.methods[this.name];if(!o)return!1;for(var i in this.args){var s=this.args[i];if(s.mutates(t,e,n)||s instanceof ee&&s.isMutating(e,!0)&&o.mutates(t,i))return!0}return!1},e.prototype.getInnerExpression=function(t,e,n){var r=t.getEntity(this.entity);if(!r)return'Entity "'+this.entity+'" does not exist';var o=r.methods[this.name];return o?o.expression:'Method "'+this.name+'" on Entity "'+this.entity+'" does not exist'},e.prototype.isPathNode=function(){return!0},e.prototype.named=function(t){return this.name=t,this},e.prototype.arg=function(t,e){var n,r=o(t)?((n={})[t]=e,n):t;for(var i in r){var s=jn.parse(r[i]);this.args[i]=s,s.setParent(this)}return this},e.id="method",e}(F),qe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fe=function(t){function e(e){var n=t.call(this)||this;return n.expressions=e,n}return qe(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){return n.getExpression(t)})))},e.encode=function(t){var e=t.expressions.map((function(t){return t.encode()}));return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.expressions.reduce((function(n,r){return Math.max(n,r.getComplexity(t,e))}),0)},e.prototype.isDynamic=function(){return this.expressions.some((function(t){return t.isDynamic()}))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expressions.map((function(t){return t.clone()})))},e.prototype.getType=function(t,e){var n=this.expressions.map((function(n){return n.getType(t,e)})).concat(Z.baseType).filter((function(t){return!!t}));return Si.mergeMany(n,ct.baseType)},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return e.expressions.forEach((function(n,r){return t.step(r,n,(function(t){return e.expressions.splice(r,1,t)}),(function(){return e.expressions.splice(r,1)}))}))}))},e.prototype.getExpressionFromStep=function(t){return r(t[0])&&t[0]<this.expressions.length?[1,this.expressions[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.expressions.forEach((function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n){var r=this,o=Z.baseType;this.expressions.forEach((function(i){r.validateType(t,e,o,i,n)}))},e.prototype.mutates=function(t,e,n){var r,o;try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.expressions),s=i.next();!s.done;s=i.next())if(s.value.mutates(t,e,n))return!0}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},e.id="or",e}(F),Ve=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ye=function(){return(Ye=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},We=function(t){function e(e,n,r){void 0===r&&(r={});var o=t.call(this)||this;return o.name=e,o.params=n,o.scopeAlias=r,o}return Ve(e,t),e.decode=function(t,n){return new e(t[1],O(t[2],(function(t){return n.getExpression(t)})),t[3]||{})},e.encode=function(t){var e=O(t.params,(function(t){return t.encode()}));return d(t.scopeAlias)?[this.id,t.name,e]:[this.id,t.name,e,t.scopeAlias]},e.create=function(t,n,r){return void 0===r&&(r=Object.create(null)),new e(t.id,n,r)},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){var n=t.getOperation(this.name),r=n?n.complexity:0;for(var o in this.params)r=Math.max(r,this.params[o].getComplexity(t,e));return r},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.name,O(this.params,(function(t){return t.clone()})),Ye({},this.scopeAlias))},e.prototype.getType=function(t,e){return t.getOperationReturnType(this.name,this.params,this.scopeAlias,e)},e.prototype.getContextFor=function(t,e,n,r){var o=e.getOperation(this.name),i=e.getOperationTypes(this.name);return o&&i&&-1!==o.hasScope.indexOf(name)?this.getScopedContext(e,n):n},e.prototype.getParamTypes=function(t,e){return t.getOperationExpectedTypes(this.name,this.params,this.scopeAlias,e)},e.prototype.getScopedContext=function(t,e){var n,r,o=t.getOperation(this.name),i=t.getOperationTypes(this.name);if(!o||!i)return e;var s=this.getParamTypes(t,e),a=t.getContextWithScope(e),u=a.context,p=a.scope;try{for(var c=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(o.scope),l=c.next();!l.done;l=c.next()){var f=l.value,y=t.getOperationInputType(i.scope[f],s);y&&(p[this.scopeAlias[f]||f]=y.getSimplifiedType())}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return E(e.params,(function(n,r){return t.step(r,n,(function(t){return e.params[r]=t}),(function(){return $.objectRemove(e.params,r)}))}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]in this.params?[1,this.params[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.params,(function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n){var r=this,o=r.name,i=r.params,s=r.scopeAlias,a=t.getOperation(o),u=t.getOperationTypes(o);if(a){var p=t.getOperationExpectedTypes(o,i,s,e),c=a.hasScope.length>0?t.getOperationScopeContext(o,p,s,e):e;for(var l in p){var f=-1!==a.optional.indexOf(l),y=p[l],h=f?Si.optional(y):y,d=i[l],v=-1!==a.hasScope.indexOf(l)?c:e;this.validateType(t,v,h,d,n)}for(var l in i){d=i[l];var m=u.params[l];!(l in p)&&m&&(v=-1!==a.hasScope.indexOf(l)?c:e,n({type:R.MISSING_EXPRESSION,severity:j.HIGH,context:v,subject:d,parent:this}),i[l].validate(t,v,n))}}else n({type:R.MISSING_OPERATION,severity:j.HIGH,context:e,subject:this})},e.prototype.mutates=function(t,e,n){var r=this.name,o=this.params,i=t.getOperation(r);if(!i)return!1;for(var s in o){var a=o[s];if(a.mutates(t,e,n)||a instanceof ee&&a.isMutating(e,!0)&&-1!==i.mutates.indexOf(s))return!0}return!1},e.prototype.isValidFlow=function(e,n){var r=e.getOperation(name);return!(!r||!r.loop||n!==A.BREAK&&n!==A.CONTINUE)||t.prototype.isValidFlow.call(this,e,n)},e.prototype.param=function(t,e){var n=jn.parse(e);return this.params[t]=n,n.setParent(this),this},e.prototype.alias=function(t,e){return this.scopeAlias[t]=e,this},e.prototype.and=function(t){var e=i(t)?t:[t];return new rt([this].concat(e))},e.prototype.or=function(t){var e=i(t)?t:[t];return new Fe([this].concat(e))},e.prototype.not=function(){return new et(this)},e.id="op",e}(F),He=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ge=function(t){function e(e,n){var r=t.call(this)||this;return r.type=e,r.value=n,r}return He(e,t),e.decode=function(t,n){return new e(t[1],n.getExpression(t[2]))},e.encode=function(t){var e=t.value.encode();return void 0!==e?[this.id,t.type,e]:[this.id,t.type]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.value.getComplexity(t,e)},e.prototype.isDynamic=function(){return this.value.isDynamic()},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.type,this.value.encode())},e.prototype.getType=function(t,e){return this.value?this.value.getType(t,e):null},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){return t.step(e.STEP_VALUE,n.value,(function(t){return n.value=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_VALUE?[1,this.value]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.value.setParent(this)},e.prototype.validate=function(t,e,n){this.value.validate(t,e,n)},e.prototype.mutates=function(t,e,n){return this.value.mutates(t,e,n)},e.prototype.isPathWritable=function(t){return!1},e.STEP_VALUE="value",e.id="flow",e}(F),Be=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Je=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ke=function(t){function e(e,n,r,o){var i=t.call(this)||this;return i.value=e,i.op=n,i.cases=r,i.defaultCase=o,i}return Be(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),t[2],t[3].map((function(t){var e=Ue(t,2),r=e[0],o=e[1];return[r.map((function(t){return n.getExpression(t)})),n.getExpression(o)]})),n.getExpression(t[4]))},e.encode=function(t){var e=t.value.encode(),n=t.cases.map((function(t){var e=Ue(t,2),n=e[0],r=e[1];return[n.map((function(t){return t.encode()})),r.encode()]}));return Kt.has(t.defaultCase,void 0)?[this.id,e,t.op,n]:[this.id,e,t.op,n,t.defaultCase.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.cases.reduce((function(n,r){var o=Ue(r,2),i=o[0],s=o[1];return Math.max(n,s.getComplexity(t,e),i.reduce((function(n,r){return Math.max(n,r.getComplexity(t,e))}),0))}),Math.max(this.value.getComplexity(t,e),this.defaultCase.getComplexity(t,e)))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.value.clone(),this.op,this.cases.map((function(t){var e=Ue(t,2),n=e[0],r=e[1];return[n.map((function(t){return t.clone()})),r.clone()]})),this.defaultCase.clone())},e.prototype.getType=function(t,e){var n=this.cases.map((function(t){var e=Ue(t,2);return e[0],e[1]})).concat(this.defaultCase).filter((function(t){return!!t})).map((function(n){return n.getType(t,e)})).filter((function(t){return!!t}));return Si.mergeMany(n,ct.baseType)},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_VALUE,n.value,(function(t){return n.value=t})),t.step(e.STEP_CASES,(function(){return n.cases.forEach((function(r,o){var i=Ue(r,2),s=i[0],a=i[1];return t.step(o,(function(){t.step(e.STEP_CASE,(function(){return s.forEach((function(e,n){return t.step(n,e,(function(t){return s.splice(n,1,t)}),(function(){return s.splice(n,1)}))}))})),t.step(e.STEP_RESULT,a,(function(t){return n.cases[o].splice(1,1,t)}))}))}))})),t.step(e.STEP_DEFAULT,n.defaultCase,(function(t){return n.defaultCase=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_VALUE?[1,this.value]:t[0]===e.STEP_CASES?r(t[1])&&t[1]<this.cases.length?t[2]===e.STEP_CASE?r(t[3])&&t[3]<this.cases[t[1]][0].length?[4,this.cases[t[1]][0][t[3]]]:null:t[2]===e.STEP_RESULT?[3,this.cases[t[1]][1]]:null:null:t[0]===e.STEP_DEFAULT?[1,this.defaultCase]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.value.setParent(this),this.cases.forEach((function(t){var n=Ue(t,2),r=n[0],o=n[1];r.forEach((function(t){return t.setParent(e)})),o.setParent(e)})),this.defaultCase.setParent(this)},e.prototype.validate=function(t,e,n){this.value.validate(t,e,n),this.cases.forEach((function(r){var o=Ue(r,2),i=o[0],s=o[1];i.forEach((function(r){return r.validate(t,e,n)})),s.validate(t,e,n)})),this.defaultCase.validate(t,e,n)},e.prototype.mutates=function(t,e,n){var r,o,i,s;if(this.value.mutates(t,e,n))return!0;try{for(var a=Je(this.cases),u=a.next();!u.done;u=a.next()){var p=Ue(u.value,2),c=p[0];if(p[1].mutates(t,e,n))return!0;try{for(var l=(i=void 0,Je(c)),f=l.next();!f.done;f=l.next())if(f.value.mutates(t,e,n))return!0}catch(t){i={error:t}}finally{try{f&&!f.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return this.defaultCase.mutates(t,e,n)},e.prototype.val=function(t,e){return this.value=jn.parse(t),this.value.setParent(this),this.op=e?e.id:this.op,this},e.prototype.case=function(t){var e=this.cases.length-1,n=jn.parse(t);return n.setParent(this),e>=0&&this.cases[e][1]===ft.instance?this.cases[e][0].push(n):this.cases.push([[n],ft.instance]),this},e.prototype.than=function(t){var e=jn.parse(t);return this.cases[this.cases.length-1][1]=e,e.setParent(this),this},e.prototype.default=function(t){return this.defaultCase=jn.parse(t),this.defaultCase.setParent(this),this},e.STEP_VALUE="value",e.STEP_CASES="cases",e.STEP_CASE="case",e.STEP_RESULT="result",e.STEP_DEFAULT="default",e.id="switch",e}(F),ze=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xe=function(t){function e(e,n){var r=t.call(this)||this;return r.template=e,r.params=n,r}return ze(e,t),e.decode=function(t,n){return new e(t[1],O(t[2],(function(t){return n.getExpression(t)})))},e.encode=function(t){var e=O(t.params,(function(t){return t.encode()}));return[this.id,t.template,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){var n=0;for(var r in this.params)n=Math.max(n,this.params[r].getComplexity(t,e));return n},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.template,O(this.params,(function(t){return t.clone()})))},e.prototype.getType=function(t,e){return qt.baseType.newInstance()},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return E(e.params,(function(n,r){return t.step(r,n,(function(t){return e.params[r]=t}),(function(){return $.objectRemove(e.params,r)}))}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]in this.params?[1,this.params[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.params,(function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n){var r=this;E(this.params,(function(o){r.validateType(t,e,qt.baseType,o,n)}))},e.prototype.mutates=function(t,e,n){for(var r in this.params)if(this.params[r].mutates(t,e,n))return!0;return!1},e.prototype.param=function(t,e){var n,r=o(t)?((n={})[t]=e,n):t;for(var i in r){var s=jn.parse(r[i]);this.params[i]=s,s.setParent(this)}return this},e.id="tmpl",e}(F),$e=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qe=1e5,Ze=function(t){function e(e,n,r){void 0===r&&(r=Qe);var o=t.call(this)||this;return o.condition=e,o.body=n,o.maxIterations=r,o}return $e(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),n.getExpression(t[2]),parseInt(t[3])||this.MAX_ITERATIONS)},e.encode=function(t){return t.maxIterations!==this.MAX_ITERATIONS?[this.id,t.condition.encode(),t.body.encode(),t.maxIterations]:[this.id,t.condition.encode(),t.body.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return 1+Math.max(this.condition.getComplexity(t,e),this.body.getComplexity(t,e))},e.prototype.isDynamic=function(){return this.body.isDynamic()},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.condition.clone(),this.body.clone(),this.maxIterations)},e.prototype.getType=function(t,e){var n=t.getContextWithScope(e,this.getScope()).context,r=this.body.getType(t,n);return r?Si.optional(r):null},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_CONDITION,n.condition,(function(t){return n.condition=t})),t.step(e.STEP_BODY,n.body,(function(t){return n.body=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_CONDITION?[1,this.condition]:t[0]===e.STEP_BODY?[1,this.body]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.condition.setParent(this),this.body.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,Z.baseType,this.condition,n);var r=t.getContext(e,this.getScope());this.body.validate(t,r,n)},e.prototype.mutates=function(t,e,n){return this.condition.mutates(t,e,n)||this.body.mutates(t,e,n)},e.prototype.isValidFlow=function(e,n,r){return r===this.body&&(n===A.BREAK||n===A.CONTINUE)||t.prototype.isValidFlow.call(this,e,n)},e.prototype.while=function(t){return this.condition=t,this.condition.setParent(this),this},e.prototype.do=function(t){return this.body=t,this.body.setParent(this),this},e.prototype.withMax=function(t){return this.maxIterations=t,this},e.STEP_CONDITION="condition",e.STEP_BODY="body",e.MAX_ITERATIONS=Qe,e.id="while",e}(F),tn=new W(G.Tuple+G.Delimiter),en=new H(G.Tuple+G.Delimiter),nn=tn,rn={create:nn.set("create"),maybe:nn.set("maybe",{},["value"]),cmp:nn.set("cmp",{},["value","test"]),copy:nn.set("copy",{},["value"]),build:nn.set("build",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),get:nn.set("get",{},["value","index"]),set:nn.set("set",{mutates:["value"]},["value","index","element"]),isValid:nn.set("?",{},["value"]),isEqual:nn.set("=",{},["value","test"]),isNotEqual:nn.set("!=",{},["value","test"]),isLess:nn.set("<",{},["value","test"]),isLessOrEqual:nn.set("<=",{},["value","test"]),isGreater:nn.set(">",{},["value","test"]),isGreaterOrEqual:nn.set(">=",{},["value","test"]),asAny:nn.set("~"+G.Any,{},["value"]),asBoolean:nn.set("~"+G.Boolean,{},["value"]),asColor:nn.set("~"+G.Color,{},["value"]),asDate:nn.set("~"+G.Date,{},["value"]),asList:nn.set("~"+G.List,{},["value"]),asMap:nn.set("~"+G.Map,{},["value"]),asNumber:nn.set("~"+G.Number,{},["value"]),asObject:nn.set("~"+G.Object,{},["value"]),asText:nn.set("~"+G.Text,{},["value"]),asTuple:nn.set("~"+G.Tuple,{},["value"]),asSet:nn.set("~"+G.Set,{},["value"])};en.set("copy",rn.copy);var on=new W(G.Number+G.Delimiter),sn=new H(G.Number+G.Delimiter),an=on,un={create:an.set("create"),pi:an.set("pi"),pi2:an.set("2pi"),piHalf:an.set("hpi"),e:an.set("e"),sqrt2:an.set("sqrt2"),sqrt12:an.set("sqrt1/2"),ln2:an.set("ln2"),ln10:an.set("ln10"),log2e:an.set("log2e"),log10e:an.set("log10e"),add:an.set("+",{},["value","addend"]),sub:an.set("-",{},["value","subtrahend"]),mul:an.set("*",{},["value","multiplier"]),div:an.set("/",{},["value","divisor"]),mod:an.set("%",{},["value","divisor"]),min:an.set("min",{},["a","b"]),max:an.set("max",{},["a","b"]),pow:an.set("^^",{},["value","exponent"]),atan2:an.set("atan2",{},["x","y"]),hypot:an.set("hyp",{},["a","b"]),choose:an.set("choose",{complexity:1},["n","k"]),gcd:an.set("gcd",{complexity:1},["a","b"]),bitAnd:an.set("&",{},["a","b"]),bitOr:an.set("|",{},["a","b"]),bitXor:an.set("^",{},["a","b"]),cmp:an.set("cmp",{},["value","test"]),maybe:an.set("maybe",{},["value"]),sqrt:an.set("sqrt",{},["value"]),sq:an.set("^2",{},["value"]),cbrt:an.set("cbrt",{},["value"]),floor:an.set("floor",{},["value"]),ceil:an.set("ceil",{},["value"]),up:an.set("up",{},["value"]),down:an.set("down",{},["value"]),round:an.set("round",{},["value"]),abs:an.set("abs",{},["value"]),neg:an.set("neg",{},["value"]),sign:an.set("sign",{},["value"]),log:an.set("log",{},["value"]),sin:an.set("sin",{},["value"]),cos:an.set("cos",{},["value"]),tan:an.set("tan",{},["value"]),sinh:an.set("sinh",{},["value"]),cosh:an.set("cosh",{},["value"]),asin:an.set("asin",{},["value"]),acos:an.set("acos",{},["value"]),atan:an.set("atan",{},["value"]),factorial:an.set("!",{},["value"]),bitFlip:an.set("~",{},["value"]),clamp:an.set("clamp",{},["value","min","max"]),triangleHeight:an.set("triangleHeight",{},["base","side1","side2"]),lerp:an.set("lerp",{},["delta","start","end"]),rnd:an.set("rnd",{},[],["min","max","whole","includeMax"]),toBaseText:an.set("toBaseText",{},["value"],["base","minDigits"]),toText:an.set("toText",{},["value"],["prefix","suffix","minPlaces","maxPlaces","useExponent","thousandSeparator"]),toPercent:an.set("toPercent",{},["value"],["minPlaces","maxPlaces","thousandSeparator"]),fromPercent:an.set("fromPercent",{},["value"]),isValid:an.set("?",{},["value"]),isZero:an.set("0?",{},["value"],["epsilon"]),isEqual:an.set("=",{},["value","test"],["epsilon"]),isNotEqual:an.set("!=",{},["value","test"],["epsilon"]),isLess:an.set("<",{},["value","test"]),isLessOrEqual:an.set("<=",{},["value","test"]),isGreater:an.set(">",{},["value","test"]),isGreaterOrEqual:an.set(">=",{},["value","test"]),isBetween:an.set("><",{},["value","min","max"],["minInclusive","maxInclusive"]),isWhole:an.set("w?",{},["value"],["epsilon"]),isDecimal:an.set("d?",{},["value"],["epsilon"]),isPositive:an.set("+?",{},["value"]),isNegative:an.set("-?",{},["value"]),isDivisible:an.set("%?",{},["value","by"],["epsilon"]),bitCompare:an.set("bit",{},["value","method","test"]),asAny:an.set("~"+G.Any,{},["value"]),asBoolean:an.set("~"+G.Boolean,{},["value"]),asColor:an.set("~"+G.Color,{},["value"]),asDate:an.set("~"+G.Date,{},["value"]),asList:an.set("~"+G.List,{},["value"]),asMap:an.set("~"+G.Map,{},["value"]),asNumber:an.set("~"+G.Number,{},["value"]),asObject:an.set("~"+G.Object,{},["value"]),asText:an.set("~"+G.Text,{},["value"]),asTuple:an.set("~"+G.Tuple,{},["value"]),asSet:an.set("~"+G.Set,{},["value"])};sn.set("floor",un.floor),sn.set("ceil",un.ceil),sn.set("up",un.up),sn.set("down",un.down),sn.set("round",un.round),sn.set("abs",un.abs),sn.set("negate",un.neg),sn.set("sign",un.sign),sn.set("isZero",un.isZero),sn.set("isWhole",un.isWhole),sn.set("isDecimal",un.isDecimal),sn.set("isPositive",un.isPositive),sn.set("isNegative",un.isNegative),sn.set("toText",un.toText);var pn=new W(G.List+G.Delimiter),cn=new H(G.List+G.Delimiter),ln=pn,fn={create:ln.set("create"),createLike:ln.set("createLike",{},["list"],[],[],[],["list"]),createFor:ln.set("createFor",{},["item"],[],[],[],["item"]),maybe:ln.set("maybe",{},["value"]),build:ln.set("new",{},["count","item"],["sameItem"],["list","index","last","count"],["item"],["item"]),get:ln.set("get",{},["list","index"],[],[],[],["list"]),set:ln.set("set",{},["list","index","value"],[],[],[],["list"]),add:ln.set("+",{mutates:["list"]},["list","item"],[],[],[],["list"]),addFirst:ln.set("+f",{mutates:["list"]},["list","item"],[],[],[],["list"]),addLast:ln.set("+l",{mutates:["list"]},["list","item"],[],[],[],["list"]),insert:ln.set("+@",{mutates:["list"]},["list","item","index"],[],[],[],["list"]),remove:ln.set("-",{mutates:["list"],complexity:1},["list","item","isEqual"],[],["list","value","test"],["isEqual"],["list"],!0),removeFirst:ln.set("-f",{mutates:["list"]},["list"],[],[],[],["list"]),removeLast:ln.set("-l",{mutates:["list"]},["list"],[],[],[],["list"]),removeAt:ln.set("-@",{mutates:["list"]},["list","index"],[],[],[],["list"]),removeWhere:ln.set("-?",{mutates:["list"]},["list","where"],[],["list","item","index"],["where"],["list"]),clear:ln.set("clear",{mutates:["list"]},["list"],[],[],[],["list"]),contains:ln.set("contains",{complexity:1},["list","item","isEqual"],[],["list","value","test"],["isEqual"],[],!0),find:ln.set("find",{complexity:1},["list","where"],["start","reverse"],["list","item","index"],["where"],["list"],!0),copy:ln.set("copy",{complexity:1},["list"],["deepCopy"],["copy"],["deepCopy"],["list"],!0),reverse:ln.set("reverse",{complexity:.5},["list"],[],[],[],["list"]),exclude:ln.set("exclude",{mutates:["list"],complexity:2},["list","exclude","isEqual"],[],["list","value","test"],["isEqual"],["list"],!0),overlap:ln.set("overlap",{complexity:2},["list","overlap","isEqual"],[],["list","value","test"],["isEqual"],["list"],!0),sort:ln.set("sort",{mutates:["list"],complexity:1},["list","compare"],[],["list","value","test"],["compare"],["list"]),shuffle:ln.set("shuffle",{mutates:["list"],complexity:1},["list"],["times"],[],[],["list"],!0),unique:ln.set("unique",{complexity:2},["list","isEqual"],[],["list","value","test"],["isEqual"],["list"],!0),duplicates:ln.set("dupes",{complexity:2},["list","isEqual"],["once"],["list","value","test"],["isEqual"],["list"],!0),take:ln.set("take",{},["list","count"],[],[],[],["list"]),skip:ln.set("skip",{},["list","count"],[],[],[],["list"]),drop:ln.set("drop",{},["list","count"],[],[],[],["list"]),append:ln.set("append",{},["list","append"],[],[],[],["list"]),prepend:ln.set("prepend",{},["list","prepend"],[],[],[],["list"]),indexOf:ln.set("indexOf",{complexity:1},["list","item","isEqual"],["start"],["list","value","test"],["isEqual"],["list"],!0),lastIndexOf:ln.set("lastIndexOf",{complexity:1},["list","item","isEqual"],["start"],["list","value","test"],["isEqual"],["list"],!0),findIndex:ln.set("findIndex",{complexity:1},["list","where"],["reverse","start"],["list","item","index"],["where"],[],!0),last:ln.set("last",{},["list"],[],[],[],["list"]),first:ln.set("first",{},["list"],[],[],[],["list"]),count:ln.set("count",{},["list"]),randomList:ln.set("randomList",{},["list","count"],[],[],[],["list"],!0),random:ln.set("random",{},["list"],[],[],[],["list"]),flatten:ln.set("flatten",{},["list"],[],[],[],["list"],!0),join:ln.set("join",{complexity:1},["list"],["delimiter","toText","prefix","suffix"],["list","item","index"],["toText"],[],!0),each:ln.set("each",{complexity:1},["list","each"],["reverse"],["list","item","index"],["each"],["list"],!0),filter:ln.set("filter",{complexity:1},["list","filter"],[],["list","item","index"],["filter"],["list"],!0),not:ln.set("not",{complexity:1},["list","not"],[],["list","item","index"],["not"],["list"],!0),map:ln.set("map",{complexity:1},["list","transform"],[],["list","item","index"],["transform"],["list"],!0),split:ln.set("split",{complexity:1},["list","pass"],[],["list","item","index"],["pass"],["list"],!0),reduce:ln.set("reduce",{complexity:1},["list","reduce","initial"],[],["list","item","index","reduced"],["reduce"],["reduce"],!0),cmp:ln.set("cmp",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"],[],!0),group:ln.set("group",{complexity:1},["list","by"],["getValue"],["list","item","index"],["by","getValue"],["list","by","getValue"],!0),toListMap:ln.set("toListMap",{complexity:1},["list","getKey"],["getValue"],["list","item","index"],["getKey","getValue"],["list","getKey","getValue"],!0),toMap:ln.set("toMap",{complexity:1},["list","getKey"],["getValue"],["list","item","index"],["getKey","getValue"],["list","getKey","getValue"],!0),joinInner:ln.set("joinInner",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"],!0),joinLeft:ln.set("joinLeft",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"],!0),joinRight:ln.set("joinRight",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"],!0),joinFull:ln.set("joinFull",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"],!0),joinCross:ln.set("joinCross",{complexity:2},["a","b","join"],[],["joinA","joinB"],["join"],["join"],!0),min:ln.set("min",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),max:ln.set("max",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),sum:ln.set("sum",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),avg:ln.set("avg",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),std:ln.set("std",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),variance:ln.set("variance",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),median:ln.set("median",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),bitand:ln.set("band",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),bitor:ln.set("bor",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),bitxor:ln.set("bxor",{complexity:1},["list","value"],[],["list","item","index"],["value"],[],!0),isValid:ln.set("?",{},["value"]),isEmpty:ln.set("0?",{},["list"]),isNotEmpty:ln.set("!0",{},["list"]),isEqual:ln.set("=",{complexity:1},["list","test","isEqual"],[],["list","value","test"],["isEqual"],[],!0),isNotEqual:ln.set("!=",{complexity:1},["list","test","isEqual"],[],["list","value","test"],["isEqual"],[],!0),isLess:ln.set("<",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"],[],!0),isLessOrEqual:ln.set("<=",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"],[],!0),isGreater:ln.set(">",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"],[],!0),isGreaterOrEqual:ln.set(">=",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"],[],!0),asAny:ln.set("~"+G.Any,{},["value"]),asBoolean:ln.set("~"+G.Boolean,{},["value"]),asColor:ln.set("~"+G.Color,{},["value"]),asDate:ln.set("~"+G.Date,{},["value"]),asList:ln.set("~"+G.List,{},["value"]),asMap:ln.set("~"+G.Map,{},["value"]),asNumber:ln.set("~"+G.Number,{},["value"]),asObject:ln.set("~"+G.Object,{},["value"]),asText:ln.set("~"+G.Text,{},["value"]),asTuple:ln.set("~"+G.Tuple,{},["value"]),asSet:ln.set("~"+G.Set,{},["value"])};cn.set("copy",fn.copy),cn.set("reversed",fn.reverse),cn.set("shuffled",fn.shuffle),cn.set("first",fn.first),cn.set("last",fn.last),cn.set("random",fn.random),cn.set("isEmpty",fn.isEmpty),cn.set("isNotEmpty",fn.isNotEmpty);var yn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hn=function(){return(hn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},dn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},mn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return yn(e,t),e.decode=function(t,n){var r=n.getType(t[1]),o=t[2]||{};return new e(hn({item:r},o))},e.encode=function(t){var e=hn({},t.options),n=e.item;return delete e.item,d(e)?[this.id,n.encode()]:[this.id,n.encode(),e]},e.describe=function(t,n,r){if(!i(t))return null;var o=new e({item:ht.baseType,min:t.length,max:t.length});r.set(t,o);for(var s=n.describe(t[0]),a=1;a<t.length;a++)s=n.merge(s,t[a]);return o.options.item=s,o},e.register=function(){var t="object";$.addJson({priority:8,toJson:function(t,e){if(i(t))return t.map(e)},fromJson:function(t,e){if(i(t))return t.map(e)}}),$.addCompare({priority:8,type:t,compare:function(t,e,n){var r=i(t),o=i(e);if(r!==o)return(r?1:0)-(o?1:0);if(r){var s=t.length-e.length;if(0===s){for(var a=0,u=0,p=0;p<t.length;p++){var c=n(t[p],e[p]);c<0&&a++,c>0&&u++}s=$.getCompare(a,u)}return s}}}),$.addEquals({priority:8,type:t,equals:function(t,e,n){var r=i(t);if(r!==i(e))return!1;if(r){if(t.length!==e.length)return!1;for(var o=0;o<t.length;o++)if(!n(t[o],e[o]))return!1;return!0}}}),$.addCopier({priority:8,copy:function(t,e,n){var r,o;if(i(t)){var s=[];n(t,s);try{for(var a=dn(t),u=a.next();!u.done;u=a.next()){var p=u.value;s.push(e(p))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return s}}}),$.addAccessor({priority:8,isValid:function(t){return i(t)},get:function(t,e){return t[e]},set:function(t,e,n){return $.arraySet(t,e,n)},remove:function(t,e){return $.arrayRemove(t,e)},has:function(t,e){return void 0!==t[e]}})},e.forItem=function(t){return new e({item:Si.parse(t)})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.item=Si.merge(e.item,n.item),e.min=Math.min(e.min,n.min),e.max=Math.max(e.max,n.max)},e.prototype.getSubType=function(t,e,n){var o=this;if(Kt.is(t)){if("length"===t.value)return Si.LENGTH;if(r(t.value))return r(this.options.min)&&t.value<this.options.min?this.options.item:Si.optional(this.options.item)}var i=t.getType(e,n);if(i){if((i=i.getRequired())instanceof An)return Si.optional(this.options.item);if(i instanceof Ut){var s=Array.from(i.options.constants.values());if(i.options.value instanceof An)return r(this.options.min)&&!s.some((function(t){return t>=o.options.min}))?this.options.item:Si.optional(this.options.item);if(i.options.value instanceof qt&&1===s.length&&"length"===s[0])return Si.LENGTH}}return null},e.prototype.getSubTypes=function(t){for(var e=this.options,n=e.min,o=e.item,i=r(n)&&n>0&&n<=10?n:0,s=[],a=0;a<i;a++)s.push({key:a,value:o});return function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(vn(arguments[e]));return t}(s,[{key:"length",value:Si.LENGTH},{key:Si.INDEX,value:Si.optional(o)}])},e.prototype.getChildType=function(t){switch(t){case e.CHILD_ITEM:return this.options.item}return null},e.prototype.getChildTypes=function(){return[e.CHILD_ITEM]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){var r=this.options,o=r.item,i=r.min,s=r.max;if(!n.strict&&!n.exact&&t instanceof xn&&!t.options.some((function(t){return!o.isCompatible(t,n)})))return!0;if(!(t instanceof e))return!1;if(!o.isCompatible(t.options.item,n))return!1;if(n.value){var a=t.options.min;if(i&&(!a||a<i))return!1;var u=t.options.max;if(s&&(!u||u<s))return!1}return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){return t.step(e.STEP_ITEM,n.options.item,(function(t){return n.options.item=t}))}))},e.prototype.getTypeFromStep=function(t){return t===e.STEP_ITEM?this.options.item:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.item.setParent(this)},e.prototype.removeDescribedRestrictions=function(){var t=this.options.item;t.removeDescribedRestrictions(),this.options={item:t}},e.prototype.getCreateExpression=function(){return jn.op(fn.create,{})},e.prototype.getValidateExpression=function(){return jn.and(jn.op(fn.isValid,{value:jn.get("value")}),jn.not(jn.op(fn.contains,{list:jn.get("value"),item:jn.null(),isEqual:jn.not(this.options.item.getValidateExpression())},{value:"ignore",test:"value"})))},e.prototype.getCompareExpression=function(){return jn.op(fn.cmp,{value:jn.get("value"),test:jn.get("test"),compare:this.options.item.getCompareExpression()})},e.prototype.getValueChangeExpression=function(t,e,n){return jn.op(fn.map,{list:jn.get("value"),transform:t},{item:"value"})},e.prototype.isValid=function(t){var e,n;if(!Array.isArray(t))return!1;var o=this.options,i=o.item,s=o.min,a=o.max;if(r(s)&&t.length<s)return!1;if(r(a)&&t.length>a)return!1;try{for(var u=dn(t),p=u.next();!p.done;p=u.next()){var c=p.value;if(!i.isValid(c))return!1}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return!0},e.prototype.normalize=function(t){if(i(t))for(var e=this.options.item,n=0;n<t.length;n++)t[n]=e.normalize(t[n]);return t},e.prototype.newInstance=function(){return new e({item:this.options.item.newInstance()})},e.prototype.clone=function(){var t=this.options,n=t.item,r=t.min,o=t.max;return new e({item:n.clone(),min:r,max:o})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return[]},e.prototype.random=function(t){for(var e=this.options,n=e.min,r=e.max,o=I(n,2),i=I(r,5),s=t(Math.min(o,i),Math.max(o,i)+1,!0),a=[],u=0;u<s;u++)a.push(this.options.item.random(t));return a},e.prototype.fromJson=function(t){var e=this;return t?t.map((function(t){return e.options.item.fromJson(t)})):null},e.prototype.toJson=function(t){var e=this;return t?t.map((function(t){return e.options.item.toJson(t)})):null},e.STEP_ITEM="item",e.CHILD_ITEM="item",e.id=G.List,e.operations=pn,e.computeds=cn,e.baseType=new e({item:ht.baseType}),e.describePriority=6,e.registered=!1,e}(q),gn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},bn=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Tn(arguments[e]));return t},xn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gn(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){return n.getType(t)})))},e.encode=function(t){var e=t.options.map((function(t){return t.encode()}));return[this.id,e]},e.describe=function(t,e,n){return null},e.register=function(){},e.forItem=function(t){return new e(t.map((function(t){return Si.parse(t)})))},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){var o=this;if(Kt.is(t)){if("length"===t.value)return Si.LENGTH;if(r(t.value))return this.options[t.value]}var i=t.getType(e,n);if(i){if((i=i.getRequired())instanceof An)return Si.mergeMany(this.options,ct.baseType);if(i instanceof Ut){if(i.options.value instanceof An){var s=(a=Array.from(i.options.constants.values())).map((function(t){return o.options[t]})).filter((function(t){return!!t}));return Si.mergeMany(s,ct.baseType)}var a;if(i.options.value instanceof qt&&1===(a=Array.from(i.options.constants.values())).length&&"length"===a[0])return Si.LENGTH}}},e.prototype.getSubTypes=function(t){return bn(this.options.map((function(t,e){return{key:e,value:t}})),[{key:"length",value:Si.LENGTH},{key:new Ut({key:An.baseType,value:An.baseType,constants:new Map(this.options.map((function(t,e){return[e,e]})))}),value:Si.mergeMany(this.options,ct.baseType)},{key:Si.INDEX,value:Si.optional(Si.mergeMany(this.options,ct.baseType))}])},e.prototype.getChildType=function(t){return this.options[t]||null},e.prototype.getChildTypes=function(){return this.options.map((function(t,e){return e}))},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.getCreateExpression=function(){return jn.tuple.apply(jn,bn(this.options.map((function(t){return t.getCreateExpression()}))))},e.prototype.getValidateExpression=function(){return jn.op(rn.isValid,{value:jn.get("value")}).and(this.options.map((function(t,e){return jn.define({value:jn.get("value",e)}).run(t.getValidateExpression())})))},e.prototype.getCompareExpression=function(){return jn.or.apply(jn,bn([jn.op(un.cmp,{value:jn.get("value","length"),test:jn.get("test","length")})],this.options.map((function(t,e){return jn.define({value:jn.get("value",e),test:jn.get("test",e)}).run(t.getCompareExpression())}))))},e.prototype.getValueChangeExpression=function(t,e,n){var o=r(e),i=r(n);return!o&&i?jn.define({parent:jn.get("value")},jn.op(fn.insert,{list:jn.get("value"),index:n,item:t})):o&&!i?jn.body(jn.op(fn.removeAt,{list:jn.get("value"),index:e}),jn.get("value")):e===n&&o?jn.body(jn.set("value",e).to(t,"value"),jn.get("value")):t},e.prototype.isDeepCompatible=function(t,n){if(!n.exact&&!n.strict&&t instanceof mn&&!this.options.some((function(e){return!e.isCompatible(t.options.item,n)}))&&r(t.options.min)&&t.options.min>=this.options.length)return!0;if(!(t instanceof e))return!1;var o=this.options,i=t.options;if(i.length<o.length||n.exact&&o.length!==i.length)return!1;for(var s=0;s<o.length;s++)if(!o[s].isCompatible(i[s],n))return!1;return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return e.options.map((function(n,r){return t.step(r,n,(function(t){return e.options.splice(r,1,t)}),(function(){return e.options.splice(r,1)}))}))}))},e.prototype.getTypeFromStep=function(t){return this.options[t]||null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.options.forEach((function(t){return t.setParent(e)}))},e.prototype.removeDescribedRestrictions=function(){this.options.forEach((function(t){return t.removeDescribedRestrictions()}))},e.prototype.isValid=function(t){if(!i(t))return!1;for(var e=this.options,n=0;n<e.length;n++)if(!e[n].isValid(t[n]))return!1;return!0},e.prototype.normalize=function(t){if(!i(t))return t;for(var e=this.options,n=0;n<e.length;n++)t[n]=e[n].normalize(t[n]);return t},e.prototype.newInstance=function(){return new e([])},e.prototype.clone=function(){return new e(this.options.map((function(t){return t.clone()})))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.options.map((function(t){return t.create()}))},e.prototype.random=function(t){return this.options.map((function(e){return e.random(t)}))},e.prototype.fromJson=function(t){return this.options.map((function(e,n){return e.fromJson(t[n])}))},e.prototype.toJson=function(t){return this.options.map((function(e,n){return e.toJson(t[n])}))},e.id=G.Tuple,e.operations=tn,e.computeds=en,e.baseType=new e([]),e.describePriority=-1,e.registered=!1,e}(q),On=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),En=function(t){function e(e){var n=t.call(this)||this;return n.expressions=e,n}return On(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){return n.getExpression(t)})))},e.encode=function(t){var e=t.expressions.map((function(t){return t.encode()}));return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.expressions.reduce((function(n,r){return Math.max(n,r.getComplexity(t,e))}),0)},e.prototype.isDynamic=function(){return this.expressions.some((function(t){return t.isDynamic()}))},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.expressions.map((function(t){return t.clone()})))},e.prototype.getType=function(t,e){return new xn(this.expressions.map((function(n){return Si.simplify(n.getType(t,e))})))},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return e.expressions.forEach((function(n,r){return t.step(r,n,(function(t){return e.expressions.splice(r,1,t)}),(function(){return e.expressions.splice(r,1)}))}))}))},e.prototype.getExpressionFromStep=function(t){return r(t[0])&&t[0]<this.expressions.length?[1,this.expressions[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.expressions.forEach((function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n){this.expressions.forEach((function(r){r.validate(t,e,n)}))},e.prototype.mutates=function(t,e,n){var r,o;try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.expressions),s=i.next();!s.done;s=i.next())if(s.value.mutates(t,e,n))return!0}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},e.id="tuple",e}(F),wn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sn=function(t){function e(e){var n=t.call(this)||this;return n.props=e,n}return wn(e,t),e.decode=function(t,n){return new e(O(t[1],(function(t){return n.getExpression(t)})))},e.encode=function(t){var e=O(t.props,(function(t){return t.encode()}));return[this.id,e]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return S(this.props,(function(n,r,o){return Math.max(o,n.getComplexity(t,e))}),0)},e.prototype.isDynamic=function(){for(var t in this.props){var e=this.props[t];if(e&&e.isDynamic())return!0}return!1},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(O(this.props,(function(t){return t.clone()})))},e.prototype.getType=function(t,e){return new be({props:O(this.props,(function(n){return Si.simplify(n.getType(t,e))}))})},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return E(e.props,(function(n,r){return t.step(r,n,(function(t){return e.props[r]=t}),(function(){return $.objectRemove(e.props,r)}))}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]in this.props?[1,this.props[t[0]]]:null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,E(this.props,(function(t){return t.setParent(e)}))},e.prototype.validate=function(t,e,n){E(this.props,(function(r){return r.validate(t,e,n)}))},e.prototype.mutates=function(t,e,n){for(var r in this.props)if(this.props[r].mutates(t,e,n))return!0;return!1},e.id="obj",e}(F),Pn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_n=function(t){function e(e,n){void 0===n&&(n=ft.instance);var r=t.call(this)||this;return r.condition=e,r.message=n,r}return Pn(e,t),e.decode=function(t,n){return new e(n.getExpression(t[1]),n.getExpression(t[2])||ft.instance)},e.encode=function(t){return t.message===ft.instance?[this.id,t.condition.encode()]:[this.id,t.condition.encode(),t.message.encode()]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.condition.getComplexity(t,e)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.condition.clone(),this.message.clone())},e.prototype.getType=function(t,e){return ct.baseType},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_CONDITION,n.condition,(function(t){return n.condition=t})),t.step(e.STEP_MESSAGE,n.message,(function(t){return n.message=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_CONDITION?[1,this.condition]:t[0]===e.STEP_MESSAGE?[1,this.message]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.condition.setParent(this),this.message.setParent(this)},e.prototype.validate=function(t,e,n){this.validateType(t,e,Z.baseType,this.condition,n),this.message!==ft.instance&&this.validateType(t,e,qt.baseType,this.message,n)},e.prototype.mutates=function(t,e,n){return this.condition.mutates(t,e,n)||this.message.mutates(t,e,n)},e.STEP_CONDITION="condition",e.STEP_MESSAGE="message",e.id="assert",e}(F),In=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mn=function(t){function e(e,n,r){var o=t.call(this)||this;return o.type=e,o.body=n,o.aliases=r,o}return In(e,t),e.decode=function(t,n){return new e(n.getType(t[1]),n.getExpression(t[2]),t[3])},e.encode=function(t){var e=t.type.encode(),n=t.body.encode();return d(t.aliases)?[this.id,e,n]:[this.id,e,n,$.copy(t.aliases)]},e.prototype.getId=function(){return e.id},e.prototype.getComplexity=function(t,e){return this.body.getComplexity(t,e)},e.prototype.getScope=function(){return null},e.prototype.encode=function(){return e.encode(this)},e.prototype.clone=function(){return new e(this.type.clone(),this.body.clone(),$.copy(this.aliases))},e.prototype.getArgumentsAliased=function(){var t=this.type.getParamTypes();if(this.aliases)for(var e in this.aliases)t[this.aliases[e]]=t[e],delete t[e];return t},e.prototype.getBodyContext=function(t,e){return t.getContext(e,this.getArgumentsAliased())},e.prototype.getCaptured=function(t){var e=this.getArgumentsAliased(),n={};return this.body.traverse(new L((function(r){if(r instanceof ee){var o=r.expressions,i=o[0],s=o[1];i instanceof Ct&&s instanceof Kt&&!(s.value in e)&&t.getChildType(s.value)&&(n[s.value]=t.getChildType(s.value))}}))),n},e.prototype.getType=function(t,e,n){return n?this.type:this.body.getType(t,e)},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_BODY,n.body,(function(t){return n.body=t}))}))},e.prototype.getExpressionFromStep=function(t){return t[0]===e.STEP_BODY?[1,this.body]:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.body.setParent(this)},e.prototype.validate=function(t,e,n){var r=this.type.getParamTypes(),o=this.type.getOverloaded(r);if(o.getReturnType()){var i=this.getBodyContext(t,e);this.validateType(t,i,o.getReturnType(),this.body,n)}this.body.validate(t,e,n)},e.prototype.mutates=function(t,e,n){var r=this.body,o=this.type.getParamTypes();for(var i in o)if(r.mutates(t,i,!1))return!0;return!1},e.prototype.getInnerExpression=function(t){return this.body},e.STEP_BODY="body",e.id="func",e}(F),Cn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Dn=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Cn(arguments[e]));return t},jn=function(){function t(){}return t.setParent=function(t,e){return void 0===e&&(e=!1),(this.autoSetParent||e)&&t.setParent(),t},t.parse=function(t){var e=this;return i(t)?t.map((function(t){return e.parse(t)})):t instanceof F?t:l(t)?O(t,(function(t){return e.parse(t)})):new Kt(t)},t.cast=function(t,e,n){void 0===n&&(n=!0);var r=t.getId()+":~"+e.getId(),o=t.getOperations()[r];return o?this.op(o,{value:this.get("value")}):n?this.setParent(e.getCreateExpression()):null},t.and=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new rt(t))},t.body=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new St(t))},t.const=function(t){return new Kt(t)},t.define=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=ft.instance),this.setParent(new Tt([],e).with(t))},t.do=function(t,e,n){return void 0===e&&(e=ft.instance),this.setParent(new Ot(e,t,n))},t.for=function(t,e,n,r,o,i){return void 0===e&&(e=new Kt(0)),void 0===n&&(n=new Kt(0)),void 0===r&&(r=ft.instance),void 0===o&&(o=new Kt(1)),this.setParent(new se(t,this.parse(e),this.parse(n),r,this.parse(o),i))},t.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?new Ct:this.setParent(new ee(Dn([new Ct],this.parse(t))))},t.sub=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this.setParent(new ee(Dn([this.parse(t)],this.parse(e))))},t.computed=function(t){return this.setParent(new re(t))},t.if=function(t,e,n){return void 0===e&&(e=ft.instance),void 0===n&&(n=ft.instance),this.setParent(new Me([[t,e]],n))},t.func=function(t,e,n){return this.setParent(new Mn(t,e,n))},t.invoke=function(t,e){return void 0===e&&(e={}),this.setParent(new Ne(t,this.parse(e)))},t.method=function(t,e,n){return void 0===n&&(n={}),this.setParent(new Le(t,e,this.parse(n)))},t.noop=function(){return ft.instance},t.not=function(t){return this.setParent(new et(t))},t.object=function(t){return this.setParent(new Sn(this.parse(t)))},t.op=function(t,e,n){return void 0===n&&(n=Object.create(null)),this.setParent(new We(t.id,this.parse(e),n))},t.or=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new Fe(t))},t.path=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(1===t.length&&t[0]instanceof ee?t[0]:new ee(this.parse(t)))},t.return=function(t){return void 0===t&&(t=ft.instance),this.setParent(new Ge(A.RETURN,this.parse(t)))},t.break=function(){return this.setParent(new Ge(A.BREAK,ft.instance))},t.continue=function(){return this.setParent(new Ge(A.CONTINUE,ft.instance))},t.exit=function(t){return void 0===t&&(t=ft.instance),this.setParent(new Ge(A.EXIT,this.parse(t)))},t.set=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new Xt(this.path.apply(this,Dn(t)),ft.instance))},t.switch=function(t,e){return this.setParent(new Ke(t,e.id,[],ft.instance))},t.template=function(t,e){return void 0===e&&(e={}),this.setParent(new Xe(t,this.parse(e)))},t.tuple=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.setParent(new En(this.parse(t)))},t.while=function(t,e,n){return void 0===e&&(e=ft.instance),this.setParent(new Ze(t,e,n))},t.assert=function(t,e){return void 0===e&&(e=ft.instance),this.setParent(new _n(t,this.parse(e)))},t.undefined=function(){return this.const(void 0)},t.null=function(){return this.const(null)},t.true=function(){return this.const(!0)},t.false=function(){return this.const(!1)},t.zero=function(){return this.const(0)},t.one=function(){return this.const(1)},t.compareEqual=function(){return this.const(1)},t.compareLess=function(){return this.const(-1)},t.compareGreater=function(){return this.const(1)},t.string=function(){return this.const("")},t.comment=function(t){return new _t(t)},t.entity=function(t){return new we(t)},t.relation=function(t){return new Pe(t)},t.data=function(t){return new ue(t)},t.autoSetParent=!0,t}(),Rn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),An=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Rn(e,t),e.decode=function(t){return new e(t[1]||{})},e.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},e.describe=function(t,n,o){return r(t)?new e({min:t,max:t,whole:Math.abs(Math.floor(t)-t)<=e.WHOLE_EPSILON}):null},e.register=function(){var t=this,e="number";$.addCompare({priority:0,type:e,compare:function(e,n){return e<n?n-e<t.COMPARES_EPSILON?0:-1:e-n<t.COMPARES_EPSILON?0:1}}),$.addEquals({priority:0,type:e,equals:function(e,n){return Math.abs(e-n)<t.EQUALS_EPSILON}}),$.addCompare({priority:0,type:"bigint",compare:function(t,e){return t-e}}),$.addEquals({priority:0,type:"bigint",equals:function(t,e){return t===e}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.max=Math.max(e.max,n.max),e.min=Math.min(e.min,n.min),e.whole=e.whole&&n.whole},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){if(!(t instanceof e))return!1;if(n.value){var o=this.options.min,i=t.options.min;if(r(o)&&(!r(i)||i<o))return!1;var s=this.options.max,a=t.options.max;if(r(s)&&(!r(a)||a<s))return!1}return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){this.options={}},e.prototype.getCreateExpression=function(){return jn.op(un.create,{})},e.prototype.getValidateExpression=function(){return jn.op(un.isValid,{value:jn.get("value")})},e.prototype.getCompareExpression=function(){return jn.op(un.cmp,{value:jn.get("value"),test:jn.get("test")})},e.prototype.isValid=function(t){if(!r(t))return!1;var e=this.options,n=e.min,o=e.max,i=e.whole;return!(r(n)&&t<n||r(o)&&t>o||i&&!h(t))},e.prototype.normalize=function(t){return t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e($.copy(this.options))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return 0},e.prototype.random=function(t){var e=this.options,n=e.min,r=e.max,o=e.whole;return t(I(n,0),I(r,10),o)},e.prototype.fromJson=function(t){return t},e.prototype.toJson=function(t){return t},e.WHOLE_EPSILON=1e-6,e.id=G.Number,e.operations=on,e.computeds=sn,e.baseType=new e({}),e.describePriority=4,e.registered=!1,e.EQUALS_EPSILON=1e-6,e.COMPARES_EPSILON=1e-6,e}(q),Nn=["th","st","nd","rd","th","th","th","th","th","th"],kn={weekStartsOn:0,firstWeekContainsDate:4,am:"am",pm:"pm",formatLT:"h:mm A",formatLTS:"h:mm:ss A",formatL:"MM/DD/Y",formatl:"M/D/Y",formatLL:"MMMM D, Y",formatll:"MMM D, Y",formatLLL:"MMMM D, Y h:mm A",formatlll:"MMM D, Y h:mm A",formatLLLL:"dddd, MMMM D, Y h:mm A",formatllll:"ddd, MMM D, Y h:mm A",suffix:function(t){return t+(t>=11&&t<=13?"th":Nn[t%Nn.length])},list:function(t){for(var e=t.length-1,n=t[0],r=1;r<e;r++)n+=", "+t[r];return e>0&&(n+=" and "+t[e]),n},months:[["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["Ja","F","Mr","Ap","My","Je","Jl","Ag","S","O","N","D"]],weekdays:[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Su","M","Tu","W","Th","F","Sa"]]},Ln=1e3,qn=60,Fn=24,Vn=7,Yn=Ln*qn,Wn=Yn*qn,Hn=Wn*Fn,Gn=3,Bn=12,Un=1,Jn=31,Kn=23,zn=59,Xn=59,$n=999,Qn=6,Zn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},tr=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Zn(arguments[e]));return t},er={none:function(t){return t},floor:function(t){return Math.floor(t)},ceil:function(t){return Math.ceil(t)},round:function(t){return Math.round(t)},truncate:function(t){return t<0?Math.ceil(t):Math.floor(t)},down:function(t){return t<0?Math.ceil(t):Math.floor(t)},up:function(t){return t<0?Math.floor(t):Math.ceil(t)}},nr={timestamp:function(t){return t.valueOf()},timestampSeconds:function(t){return Math.floor(t.valueOf()/Ln)},millis:function(t){return t.getMilliseconds()},second:function(t){return t.getSeconds()},minute:function(t){return t.getMinutes()},hour:function(t){return t.getHours()},day:function(t){return t.getDay()},dayOfMonth:function(t){return t.getDate()},lastDayOfMonth:mr,dayOfYear:Nr,dayOfWeek:Ar,week:br,weekOfMonth:Mr,weekspanOfMonth:Sr,fullWeekOfMonth:_r,lastWeekspanOfMonth:Pr,lastFullWeekOfMonth:Ir,weekOfYear:Tr,weekspanOfYear:xr,fullWeekOfYear:Or,lastWeekspanOfYear:gr,lastFullWeekOfYear:wr,month:function(t){return t.getMonth()},quarter:Gr,year:function(t){return t.getFullYear()},timeIdentifier:fr,dayIdentifier:yr,weekIdentifier:hr,monthIdentifier:dr,quarterIdentifier:vr},rr={timestamp:function(t,e){return ur(t,(function(t){return t.setTime(e)}))},timestampSeconds:function(t,e){return ur(t,(function(t){return t.setTime(1e3*e)}))},millis:function(t,e){return ur(t,(function(t){return t.setMilliseconds(e)}))},second:function(t,e){return ur(t,(function(t){return t.setSeconds(e)}))},minute:function(t,e){return ur(t,(function(t){return t.setMinutes(e)}))},hour:function(t,e){return ur(t,(function(t){return t.setHours(e)}))},day:function(t,e){return ur(t,(function(t){return sr.day(t,e-t.getDay())}))},dayOfMonth:function(t,e){return ur(t,(function(t){return t.setDate(e)}))},lastDayOfMonth:function(t,e){return ur(t,(function(t){return sr.day(t,e-mr(t))}))},dayOfYear:function(t,e){return ur(t,(function(t){return sr.day(t,e-Nr(t))}))},dayOfWeek:function(t,e){return ur(t,(function(t){return sr.day(t,e-Ar(t))}))},week:function(t,e){return ur(t,(function(t){return sr.week(t,e-br(t))}))},weekOfMonth:function(t,e){return ur(t,(function(t){return sr.week(t,e-Mr(t))}))},weekspanOfMonth:function(t,e){return ur(t,(function(t){return sr.week(t,e-Sr(t))}))},fullWeekOfMonth:function(t,e){return ur(t,(function(t){return sr.week(t,e-_r(t))}))},lastWeekspanOfMonth:function(t,e){return ur(t,(function(t){return sr.week(t,e-Pr(t))}))},lastFullWeekOfMonth:function(t,e){return ur(t,(function(t){return sr.week(t,e-Ir(t))}))},weekOfYear:function(t,e){return ur(t,(function(t){return sr.week(t,e-Tr(t))}))},weekspanOfYear:function(t,e){return ur(t,(function(t){return sr.week(t,e-xr(t))}))},fullWeekOfYear:function(t,e){return ur(t,(function(t){return sr.week(t,e-Or(t))}))},lastWeekspanOfYear:function(t,e){return ur(t,(function(t){return sr.week(t,e-gr(t))}))},lastFullWeekOfYear:function(t,e){return ur(t,(function(t){return sr.week(t,e-wr(t))}))},month:function(t,e){return ur(t,(function(t){return t.setMonth(e)}))},quarter:function(t,e){return ur(t,(function(t){return sr.quarter(t,e-Gr(t))}))},year:function(t,e){return ur(t,(function(t){return t.setFullYear(e)}))}},or={millis:function(t){return t},second:Br,minute:Ur,hour:Jr,day:Kr,week:zr,month:Xr,quarter:$r,year:Qr},ir={millis:function(t){return t},second:Zr,minute:to,hour:eo,day:no,week:ro,month:oo,quarter:io,year:so},sr={millis:ao,second:uo,minute:po,hour:co,day:lo,week:fo,month:yo,quarter:ho,year:vo},ar={millis:mo,second:go,minute:To,hour:bo,day:xo,week:Oo,month:Eo,quarter:wo,year:So};function ur(t,e,n){var r=new Date(t.getTime());return e(r,n),r}function pr(t,e,n,r){void 0===n&&(n="millis"),void 0===r&&(r=kn);var o=or[n],i=ur(t,o,r),s=ur(e,o,r);return i.getTime()-s.getTime()}var cr=[{pattern:/^(\d{4})[-/](\d{1,22})[-/](\d{1,2})(|[T ](\d{1,2})((|:(\d{1,2})(|:(\d{1,2})(|\.(\d+)Z?)))))$/,groups:[1,2,3,5,8,10,12]},{pattern:/^(\d{1,2})[-/](\d{1,2})[-/](\d{4})(|[T ](\d{1,2})((|:(\d{1,2})(|:(\d{1,2})(|\.(\d+)Z?)))))$/,groups:[3,1,2,5,8,10,12]}];function lr(t,e){var n,i;if(void 0===e&&(e=!1),s(t))return t;if(r(t)&&t>0)return new Date(t);if(o(t)){try{for(var a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(cr),u=a.next();!u.done;u=a.next()){var p=u.value,c=p.pattern,l=p.groups,f=c.exec(t);if(f){for(var y=[0,0,1,0,0,0,0],h=0;h<y.length;h++){var d=parseInt(f[l[h]]);isFinite(d)&&(y[h]=1===h?d-1:d)}return e?new Date(Date.UTC.apply(Date,tr(y))):new(Date.bind.apply(Date,tr([void 0],y)))}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}if(e){var v=t+" UTC",m=Date.parse(v);if(isFinite(m))return new Date(m)}var g=Date.parse(t);if(isFinite(g))return new Date(g)}return null}function fr(t){return 1e8*t.getFullYear()+1e6*(t.getMonth()+1)+1e4*t.getDate()+100*t.getHours()+t.getMinutes()}function yr(t){return 1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate()}function hr(t){return 1e3*t.getFullYear()+br(t)}function dr(t){return 100*t.getFullYear()+(t.getMonth()+1)}function vr(t){return 10*t.getFullYear()+Gr(t)}function mr(t){return Yr(t)-t.getDate()+1}function gr(t){var e=Fr(t)-Nr(t);return Math.floor(e/Vn)}function Tr(t,e){return void 0===e&&(e=kn),Dr(ur(t,Qr),Nr(t),e)}function br(t,e){return void 0===e&&(e=kn),jr(ur(t,Qr),Nr(t),e)}function xr(t){return Math.floor((Nr(t)-1)/Vn)}function Or(t,e){return void 0===e&&(e=kn),Rr(ur(t,Qr),Fr(t),e)}function Er(t,e){return void 0===e&&(e=kn),Tr(ur(t,so),e)+1}function wr(t,e){void 0===e&&(e=kn);var n=ur(t,so),r=Tr(t,e),o=Tr(n,e)-r;return Ar(n,e)===Qn?o+1:o}function Sr(t){return Math.floor((t.getDate()-1)/Vn)}function Pr(t){var e=Yr(t)-t.getDate();return Math.floor(e/Vn)}function _r(t,e){return void 0===e&&(e=kn),Rr(ur(t,Xr),t.getDate(),e)}function Ir(t,e){void 0===e&&(e=kn);var n=Yr(t)-t.getDate(),r=Qn-Ar(t,e);return Math.floor((n-r+Vn)/Vn)}function Mr(t,e){return void 0===e&&(e=kn),Dr(ur(t,Xr),t.getDate(),e)}function Cr(t,e){return void 0===e&&(e=kn),jr(ur(t,Xr),t.getDate(),e)}function Dr(t,e,n){void 0===n&&(n=kn);var r=n.firstWeekContainsDate,o=Ar(t,n),i=Vn-o<r?o-1:o-1+Vn;return Math.floor((e+i)/Vn)}function jr(t,e,n){var r=Ar(t,n)-1+Vn;return Math.floor((e+r)/Vn)}function Rr(t,e,n){void 0===n&&(n=kn);var r=Ar(t,n),o=0!==r?r-1:r-1+Vn;return Math.floor((e+o)/Vn)}function Ar(t,e){void 0===e&&(e=kn);var n=e.weekStartsOn,r=t.getDay();return r<n?r-n+Vn:r-n}function Nr(t){return Math.round(xo(t,ur(t,Qr)))+1}function kr(t){return 15*-Math.round(t.getTimezoneOffset()/15)}function Lr(t){var e=kr(t);return e>kr(ur(t,(function(t){return t.setMonth(0)})))||e>kr(ur(t,(function(t){return t.setMonth(5)})))}function qr(t){var e=t.getFullYear();return e%400==0||e%4==0&&e%100!=0}function Fr(t){return qr(t)?366:365}var Vr=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]];function Yr(t){return Vr[qr(t)?1:0][t.getMonth()]}function Wr(t){return t.getTime()-Hr(t)}function Hr(t){var e=new Date(t.getTime()),n=e.getTimezoneOffset();e.setSeconds(0,0);var r=e.getTime()%Yn;return n*Yn+r}function Gr(t){return Math.floor(t.getMonth()/Gn)}function Br(t){t.setMilliseconds(0)}function Ur(t){t.setSeconds(0,0)}function Jr(t){t.setMinutes(0,0,0)}function Kr(t){t.setHours(0,0,0,0)}function zr(t,e){void 0===e&&(e=kn);var n=Ar(t,e);t.setDate(t.getDate()-n),t.setHours(0,0,0,0)}function Xr(t){t.setDate(Un),t.setHours(0,0,0,0)}function $r(t){var e=t.getMonth();t.setMonth(e-e%Gn,Un),t.setHours(0,0,0,0)}function Qr(t){var e=t.getFullYear();t.setTime(0),t.setFullYear(e,0,1),t.setHours(0,0,0,0)}function Zr(t){t.setMilliseconds($n)}function to(t){t.setSeconds(Xn,$n)}function eo(t){t.setMinutes(zn,Xn,$n)}function no(t){t.setHours(Kn,zn,Xn,$n)}function ro(t,e){void 0===e&&(e=kn);var n=Ar(t,e);t.setDate(t.getDate()+(Qn-n)),no(t)}function oo(t){t.setFullYear(t.getFullYear(),t.getMonth()+1,0),no(t)}function io(t){var e=t.getMonth();t.setMonth(e-e%Gn+Gn,Un),no(t)}function so(t){t.setFullYear(t.getFullYear()+1,0,0),no(t)}function ao(t,e){t.setTime(t.getTime()+e)}function uo(t,e){ao(t,e*Ln)}function po(t,e){ao(t,e*Yn)}function co(t,e){ao(t,e*Wn)}function lo(t,e){t.setDate(t.getDate()+e)}function fo(t,e){lo(t,e*Vn)}function yo(t,e){var n=t.getMonth()+e,r=new Date(0);r.setFullYear(r.getFullYear(),n,1),r.setHours(0,0,0,0);var o=Yr(r);t.setMonth(n,Math.min(o,t.getDate()))}function ho(t,e){yo(t,e*Gn)}function vo(t,e){yo(t,e*Bn)}function mo(t,e){return t.getTime()-e.getTime()}function go(t,e){return mo(t,e)/Ln}function To(t,e){return mo(t,e)/Yn}function bo(t,e){return mo(t,e)/Wn}function xo(t,e){return(Wr(t)-Wr(e))/Hn}function Oo(t,e){return xo(t,e)/Vn}function Eo(t,e){var n=t.getFullYear()-e.getFullYear(),r=t.getMonth()-e.getMonth(),o=(t.getDate()-e.getDate())/Jn;return n*Bn+r+o}function wo(t,e){return Eo(t,e)/Gn}function So(t,e){return Eo(t,e)/Bn}var Po=new W(G.Date+G.Delimiter),_o=new H(G.Date+G.Delimiter),Io=Po,Mo={create:Io.set("create"),now:Io.set("now"),today:Io.set("today"),tomorrow:Io.set("today+"),yesterday:Io.set("today-"),maybe:Io.set("maybe",{},["value"]),parse:Io.set("parse",{},["value"],["parseAsUTC"]),fromText:Io.set(">txt",{},["value"],["parseAsUTC"]),fromTimestamp:Io.set(">tms",{},["value"]),fromTimestampSeconds:Io.set(">tmss",{},["value"]),min:Io.set("min",{},["value","test"]),max:Io.set("max",{},["value","test"]),get:Io.set("get",{},["value","property"]),set:Io.set("set",{},["value","property","set"]),add:Io.set("+",{},["value","unit"],["amount"]),sub:Io.set("-",{},["value","unit"],["amount"]),startOf:Io.set("startOf",{},["value","unit"]),endOf:Io.set("endOf",{},["value","unit"],["inclusive"]),daysInMonth:Io.set("dim",{},["value"]),daysInYear:Io.set("diy",{},["value"]),weeksInYear:Io.set("wiy",{},["value"]),copy:Io.set("copy",{},["value"]),cmp:Io.set("cmp",{},["value","test"],["unit"]),diff:Io.set("diff",{},["value","test"],["unit","absolute","adjust"]),timezoneOffset:Io.set("offset",{},["value"]),toText:Io.set("toText",{},["value","format"]),toISOText:Io.set("toISOText",{},["value"]),isValid:Io.set("?",{},["value"]),isEqual:Io.set("=",{},["value","test"],["unit"]),isBefore:Io.set("<",{},["value","test"],["unit"]),isBeforeOrEqual:Io.set("<=",{},["value","test"],["unit"]),isAfter:Io.set(">",{},["value","test"],["unit"]),isAfterOrEqual:Io.set(">=",{},["value","test"],["unit"]),isBetween:Io.set("between",{},["value","start","end"],["unit","startInclusive","endInclusive"]),isStartOf:Io.set("startOf?",{},["value","unit"]),isEndOf:Io.set("endOf?",{},["value","unit"],["inclusive"]),isDST:Io.set("dst?",{},["value"]),isLeapYear:Io.set("leap?",{},["value"]),asAny:Io.set("~"+G.Any,{},["value"]),asBoolean:Io.set("~"+G.Boolean,{},["value"]),asColor:Io.set("~"+G.Color,{},["value"]),asDate:Io.set("~"+G.Date,{},["value"]),asList:Io.set("~"+G.List,{},["value"]),asMap:Io.set("~"+G.Map,{},["value"]),asNumber:Io.set("~"+G.Number,{},["value"]),asObject:Io.set("~"+G.Object,{},["value"]),asText:Io.set("~"+G.Text,{},["value"]),asTuple:Io.set("~"+G.Tuple,{},["value"]),asSet:Io.set("~"+G.Set,{},["value"])};_o.set("timestamp",Mo.get,"value",{property:"timestamp"}),_o.setWritable("timestamp",Mo.set,"value","set",{property:"timestamp"}),_o.set("timestampSeconds",Mo.get,"value",{property:"timestampSeconds"}),_o.setWritable("timestampSeconds",Mo.set,"value","set",{property:"timestampSeconds"}),_o.set("millis",Mo.get,"value",{property:"millis"}),_o.setWritable("millis",Mo.set,"value","set",{property:"millis"}),_o.set("second",Mo.get,"value",{property:"second"}),_o.setWritable("second",Mo.set,"value","set",{property:"second"}),_o.set("minute",Mo.get,"value",{property:"minute"}),_o.setWritable("minute",Mo.set,"value","set",{property:"minute"}),_o.set("hour",Mo.get,"value",{property:"hour"}),_o.setWritable("hour",Mo.set,"value","set",{property:"hour"}),_o.set("day",Mo.get,"value",{property:"day"}),_o.setWritable("day",Mo.set,"value","set",{property:"day"}),_o.set("dayOfMonth",Mo.get,"value",{property:"dayOfMonth"}),_o.setWritable("dayOfMonth",Mo.set,"value","set",{property:"dayOfMonth"}),_o.set("lastDayOfMonth",Mo.get,"value",{property:"lastDayOfMonth"}),_o.setWritable("lastDayOfMonth",Mo.set,"value","set",{property:"lastDayOfMonth"}),_o.set("dayOfYear",Mo.get,"value",{property:"dayOfYear"}),_o.setWritable("dayOfYear",Mo.set,"value","set",{property:"dayOfYear"}),_o.set("dayOfWeek",Mo.get,"value",{property:"dayOfWeek"}),_o.setWritable("dayOfWeek",Mo.set,"value","set",{property:"dayOfWeek"}),_o.set("week",Mo.get,"value",{property:"week"}),_o.setWritable("week",Mo.set,"value","set",{property:"week"}),_o.set("weekOfMonth",Mo.get,"value",{property:"weekOfMonth"}),_o.setWritable("weekOfMonth",Mo.set,"value","set",{property:"weekOfMonth"}),_o.set("weekspanOfMonth",Mo.get,"value",{property:"weekspanOfMonth"}),_o.setWritable("weekspanOfMonth",Mo.set,"value","set",{property:"weekspanOfMonth"}),_o.set("fullWeekOfMonth",Mo.get,"value",{property:"fullWeekOfMonth"}),_o.setWritable("fullWeekOfMonth",Mo.set,"value","set",{property:"fullWeekOfMonth"}),_o.set("lastWeekspanOfMonth",Mo.get,"value",{property:"lastWeekspanOfMonth"}),_o.setWritable("lastWeekspanOfMonth",Mo.set,"value","set",{property:"lastWeekspanOfMonth"}),_o.set("lastFullWeekOfMonth",Mo.get,"value",{property:"lastFullWeekOfMonth"}),_o.setWritable("lastFullWeekOfMonth",Mo.set,"value","set",{property:"lastFullWeekOfMonth"}),_o.set("weekOfYear",Mo.get,"value",{property:"weekOfYear"}),_o.setWritable("weekOfYear",Mo.set,"value","set",{property:"weekOfYear"}),_o.set("weekspanOfYear",Mo.get,"value",{property:"weekspanOfYear"}),_o.setWritable("weekspanOfYear",Mo.set,"value","set",{property:"weekspanOfYear"}),_o.set("fullWeekOfYear",Mo.get,"value",{property:"fullWeekOfYear"}),_o.setWritable("fullWeekOfYear",Mo.set,"value","set",{property:"fullWeekOfYear"}),_o.set("lastWeekspanOfYear",Mo.get,"value",{property:"lastWeekspanOfYear"}),_o.setWritable("lastWeekspanOfYear",Mo.set,"value","set",{property:"lastWeekspanOfYear"}),_o.set("lastFullWeekOfYear",Mo.get,"value",{property:"lastFullWeekOfYear"}),_o.setWritable("lastFullWeekOfYear",Mo.set,"value","set",{property:"lastFullWeekOfYear"}),_o.set("month",Mo.get,"value",{property:"month"}),_o.setWritable("month",Mo.set,"value","set",{property:"month"}),_o.set("quarter",Mo.get,"value",{property:"quarter"}),_o.setWritable("quarter",Mo.set,"value","set",{property:"quarter"}),_o.set("year",Mo.get,"value",{property:"year"}),_o.setWritable("year",Mo.set,"value","set",{property:"year"}),_o.set("timeIdentifier",Mo.get,"value",{property:"timeIdentifier"}),_o.setWritable("timeIdentifier",Mo.set,"value","set",{property:"timeIdentifier"}),_o.set("dayIdentifier",Mo.get,"value",{property:"dayIdentifier"}),_o.setWritable("dayIdentifier",Mo.set,"value","set",{property:"dayIdentifier"}),_o.set("weekIdentifier",Mo.get,"value",{property:"weekIdentifier"}),_o.setWritable("weekIdentifier",Mo.set,"value","set",{property:"weekIdentifier"}),_o.set("monthIdentifier",Mo.get,"value",{property:"monthIdentifier"}),_o.setWritable("monthIdentifier",Mo.set,"value","set",{property:"monthIdentifier"}),_o.set("quarterIdentifier",Mo.get,"value",{property:"quarterIdentifier"}),_o.setWritable("quarterIdentifier",Mo.set,"value","set",{property:"quarterIdentifier"}),_o.set("startOfSecond",Mo.startOf,"value",{unit:"second"}),_o.set("startOfMinute",Mo.startOf,"value",{unit:"minute"}),_o.set("startOfHour",Mo.startOf,"value",{unit:"hour"}),_o.set("startOfDay",Mo.startOf,"value",{unit:"day"}),_o.set("startOfWeek",Mo.startOf,"value",{unit:"week"}),_o.set("startOfMonth",Mo.startOf,"value",{unit:"month"}),_o.set("startOfQuarter",Mo.startOf,"value",{unit:"quarter"}),_o.set("startOfYear",Mo.startOf,"value",{unit:"year"}),_o.set("endOfSecond",Mo.endOf,"value",{unit:"second"}),_o.set("endOfMinute",Mo.endOf,"value",{unit:"minute"}),_o.set("endOfHour",Mo.endOf,"value",{unit:"hour"}),_o.set("endOfDay",Mo.endOf,"value",{unit:"day"}),_o.set("endOfWeek",Mo.endOf,"value",{unit:"week"}),_o.set("endOfMonth",Mo.endOf,"value",{unit:"month"}),_o.set("endOfQuarter",Mo.endOf,"value",{unit:"quarter"}),_o.set("endOfYear",Mo.endOf,"value",{unit:"year"}),_o.set("daysInMonth",Mo.daysInMonth),_o.set("daysInYear",Mo.daysInYear),_o.set("weeksInYear",Mo.weeksInYear),_o.set("timezoneOffset",Mo.timezoneOffset),_o.set("toISOText",Mo.toISOText),_o.set("isDST",Mo.isDST),_o.set("isLeapYear",Mo.isLeapYear);var Co=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Do=function(){return(Do=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},jo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Co(e,t),e.decode=function(t,n){return new e(this.decodeOptions(t[1]||{}))},e.encode=function(t){return d(t.options)?this.id:[this.id,this.encodeOptions(t.options)]},e.decodeOptions=function(t){return t.validateMin&&(t.validateMin=new Date(t.validateMin)),t.validateMax&&(t.validateMax=new Date(t.validateMax)),t.forceMin&&(t.forceMin=new Date(t.forceMin)),t.forceMax&&(t.forceMax=new Date(t.forceMax)),t},e.encodeOptions=function(t){var e=Do({},t);return e.validateMin&&(e.validateMin=e.validateMin.toISOString()),e.validateMax&&(e.validateMax=e.validateMax.toISOString()),e.forceMin&&(e.forceMin=e.forceMin.toISOString()),e.forceMax&&(e.forceMax=e.forceMax.toISOString()),e},e.describe=function(t,n,r){return s(t)?new e({validateMin:new Date(t.getTime()),validateMax:new Date(t.getTime())}):null},e.register=function(){var t="object";$.addCompare({priority:9,type:t,compare:function(t,e){var n=s(t),r=s(e);return n!==r?(n?1:0)-(r?1:0):n?t.getTime()-e.getTime():void 0}}),$.addEquals({priority:9,type:t,equals:function(t,e){var n=s(t);return n===s(e)&&(n?t.getTime()===e.getTime():void 0)}}),$.addJson({priority:9,fromJson:function(t){if(l(t)&&o(t.$any)&&"date"===t.$any)return new Date(t.value)},toJson:function(t){if(s(t))return{$any:"date",value:t.toISOString()}}}),$.addCopier({priority:9,copy:function(t,e,n){if(s(t)){var r=new Date(t.getTime());return n(t,r),r}}})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.parseAsUTC=e.parseAsUTC&&n.parseAsUTC,e.validateMin&&n.validateMin&&e.validateMin.setTime(Math.min(e.validateMin.getTime(),n.validateMin.getTime())),e.validateMax&&n.validateMax&&e.validateMax.setTime(Math.max(e.validateMax.getTime(),n.validateMax.getTime()))},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){if(void 0===n&&(n={}),!(t instanceof e))return!1;if(n.value){if(t.options.withTime&&!this.options.withTime)return!1;var r=this.getMin(),o=t.getMin();if(r&&(!o||o.getTime()<r.getTime()))return!1;var i=this.getMax(),s=t.getMax();if(i&&(!s||s.getTime()>i.getTime()))return!1;var a=this.options,u=a.forceStartOf,p=a.forceEndOf;if(u&&u!==t.options.forceStartOf)return!1;if(p&&p!==t.options.forceEndOf)return!1}return!0},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.traverse=function(t){return t.enter(this)},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){var t=this.options,e=t.parseAsUTC,n=t.withTime;this.options={parseAsUTC:e,withTime:n}},e.prototype.getCreateExpression=function(){return jn.op(Mo.create,{})},e.prototype.getValidateExpression=function(){return jn.op(Mo.isValid,{value:jn.get("value")})},e.prototype.getCompareExpression=function(){return jn.op(Mo.cmp,{value:jn.get("value"),test:jn.get("test")})},e.prototype.isValid=function(t){var e=this.options,n=e.parseAsUTC,r=e.validateMin,o=e.validateMax,i=lr(t,n);return!(!i||r&&i.getTime()<r.getTime()||o&&i.getTime()>o.getTime())},e.prototype.normalize=function(t){var e=this.options,n=e.parseAsUTC,r=e.forceMin,o=e.forceMax,i=e.forceStartOf,s=e.forceEndOf,a=lr(t,n);return a?(r&&a.getTime()<r.getTime()&&a.setTime(r.getTime()),o&&a.getTime()>o.getTime()&&a.setTime(o.getTime()),i&&or[i](a),s&&ir[s](a),a):t},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e($.copy(this.options))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return new Date},e.prototype.random=function(t){var e=new Date,n=this.getMin(),r=this.getMax(),o=n?n.getTime():e.getTime(),i=r?r.getTime():e.getTime();return new Date(t(o,i,!0))},e.prototype.getMin=function(){return this.options.validateMin||this.options.forceMin},e.prototype.getMax=function(){return this.options.validateMax||this.options.forceMax},e.prototype.fromJson=function(t){return new Date(t)},e.prototype.toJson=function(t){return t?t.toISOString():null},e.id=G.Date,e.operations=Po,e.computeds=_o,e.baseType=new e({}),e.describePriority=6,e.registered=!1,e}(q),Ro=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ao=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},No=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ko=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ro(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){return n.getType(t)})))},e.encode=function(t){var e=t.options.map((function(t){return t.encode()}));return[this.id,e]},e.describe=function(t,e,n){return null},e.register=function(){},e.prototype.getOperations=function(){var t=this;return this.operations||(this.operations={},this.options.forEach((function(e){var n=e.getOperations();for(var r in n)t.operations[r]=n[r]}))),this.operations},e.prototype.forMany=function(t,e){var n,r,o=this.options;try{for(var i=Ao(o),s=i.next();!s.done;s=i.next()){var a=e(s.value);if(void 0!==a)return a}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){var r,o;try{for(var i=Ao(this.options),s=i.next();!s.done;s=i.next()){var a=s.value.getSubType(t,e,n);if(a)return a}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return null},e.prototype.getSubTypes=function(t){var e=[];return this.options.forEach((function(n){n.getSubTypes(t).forEach((function(t){e.find((function(e){return e.key===t.key||e.key instanceof q&&t.key instanceof q&&y(e.key,t.key)}))||e.push(t)}))})),e.sort((function(t,e){return(t.key instanceof q?1:0)-(e.key instanceof q?1:0)})),e},e.prototype.getChildType=function(t){return this.options[t]||null},e.prototype.getChildTypes=function(){return this.options.map((function(t,e){return e}))},e.prototype.getExactType=function(t){return this.forMany(this,(function(e){return e.isValid(t)?e:void 0}))},e.prototype.getSimplifiedType=function(){return 1===this.options.length?this.options[0]:this},e.prototype.getRequired=function(){return this.isOptional()?new e(this.options.map((function(t){return t.getRequired()}))):this},e.prototype.isDeepCompatible=function(t,e){return this.forMany(!1,(function(n){return!!n.isCompatible(t,e)||void 0}))},e.prototype.isOptional=function(){return this.forMany(!0,(function(t){return!!t.isOptional()&&void 0}))},e.prototype.isSimple=function(){return this.forMany(!0,(function(t){return!!t.isSimple()&&void 0}))},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return e.options.map((function(n,r){return t.step(r,n,(function(t){return e.options.splice(r,1,t)}),(function(){return e.options.splice(r,1)}))}))}))},e.prototype.getTypeFromStep=function(t){return this.options[t]||null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.options.forEach((function(t){return t.setParent(e)}))},e.prototype.removeDescribedRestrictions=function(){this.options.forEach((function(t){return t.removeDescribedRestrictions()}))},e.prototype.getCreateExpression=function(){return this.options[0].getCreateExpression()},e.prototype.getValidateExpression=function(){return jn.or.apply(jn,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(No(arguments[e]));return t}(this.options.map((function(t){return t.getValidateExpression()}))))},e.prototype.getCompareExpression=function(){return jn.op(ut.cmp,{value:jn.get("value"),test:jn.get("test")})},e.prototype.getValueChangeExpression=function(t,e,n){var o=r(e),i=r(n);if(o&&!i){var s=0===e?this.options[1]:this.options[0],a=this.options[e],u=jn.cast(a,s);return jn.if(s.getValidateExpression()).than(jn.get("value")).else(u)}return!o&&i?t:n===e&&o?jn.if(jn.not(this.getValidateExpression())).than(t).else(jn.get("value")):t},e.prototype.isValid=function(t){return this.forMany(!1,(function(e){return!!e.isValid(t)||void 0}))},e.prototype.normalize=function(t){return this.forMany(t,(function(e){return e.isValid(t)?e.normalize(t):void 0}))},e.prototype.newInstance=function(){return new e([])},e.prototype.clone=function(){return new e(this.options.map((function(t){return t.clone()})))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.options.length>0?this.options[0].create():null},e.prototype.random=function(t){var e=this.options;return e[t(0,e.length,!0)].random(t)},e.prototype.fromJson=function(t){var e,n,r=this.options;try{for(var o=Ao(r),i=o.next();!i.done;i=o.next()){var s=i.value.normalize(t);if(null!=s)return s}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return t},e.prototype.toJson=function(t){var e,n,r=this.options;try{for(var o=Ao(r),i=o.next();!i.done;i=o.next()){var s=i.value;if(s.isValid(t))return s.toJson(t)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return t},e.id=G.Many,e.operations=new W(G.Many+G.Delimiter),e.computeds=new H(G.Many+G.Delimiter),e.baseType=new e([ht.baseType]),e.describePriority=-1,e.registered=!1,e}(q),Lo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qo=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Fo=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Vo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Lo(e,t),e.decode=function(t,n){var r=n.getType(t[1]);return new e({key:n.getType(t[2],qt.baseType),value:r})},e.encode=function(t){var e=t.options,n=e.key,r=e.value;return n!==qt.baseType?[this.id,r.encode()]:[this.id,r.encode(),n.encode()]},e.describe=function(t,n,r){var o,i;if(!a(t))return null;var s=new ht({}),u=new ht({}),p=new e({key:s,value:u});r.set(t,p);try{for(var c=qo(t.entries()),l=c.next();!l.done;l=c.next()){var f=Fo(l.value,2),y=f[0],h=f[1];s=n.merge(s,y),u=n.merge(u,h)}}catch(t){o={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}return p.options.key=s,p.options.value=u,p},e.register=function(){var t="object";$.addJson({priority:10,fromJson:function(t,e){if(l(t)&&o(t.$any)&&"map"===t.$any)return new Map(t.value.map((function(t){var n=Fo(t,2),r=n[0],o=n[1];return[e(r),e(o)]})))},toJson:function(t,e){if(a(t))return{$any:"map",value:Array.from(t.entries()).map((function(t){var n=Fo(t,2),r=n[0],o=n[1];return[e(r),e(o)]}))}}}),$.addCopier({priority:10,copy:function(t,e,n){var r,o;if(a(t)){var i=new Map;n(t,i);try{for(var s=qo(t.entries()),u=s.next();!u.done;u=s.next()){var p=Fo(u.value,2),c=p[0],l=p[1];i.set(e(c),e(l))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}}}),$.addCompare({priority:10,type:t,compare:function(t,e,n){var r,o,i,s,u=a(t),p=a(e);if(u!==p)return(u?1:0)-(p?1:0);if(a(t)&&a(e)){var c=0,l=0;try{for(var f=qo(t.keys()),y=f.next();!y.done;y=f.next()){var h=y.value;e.has(h)||c++}}catch(t){r={error:t}}finally{try{y&&!y.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}try{for(var d=qo(e.keys()),v=d.next();!v.done;v=d.next())if(h=v.value,t.has(h)){var m=n(t.get(h),e.get(h));m<0&&c++,m>0&&l++}else l++}catch(t){i={error:t}}finally{try{v&&!v.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}return $.getCompare(c,l)}}}),$.addEquals({priority:10,type:t,equals:function(t,e,n){var r,o;if(a(t)!==a(e))return!1;if(a(t)&&a(e)){if(t.size!==e.size)return!1;try{for(var i=qo(t.entries()),s=i.next();!s.done;s=i.next()){var u=Fo(s.value,2),p=u[0],c=u[1];if(!e.has(p))return!1;if(!n(c,e.get(p)))return!1}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!0}}}),$.addAccessor({priority:10,isValid:function(t){return a(t)},get:function(t,e){return t.get(e)},set:function(t,e,n){return t.set(e,n)},remove:function(t,e){return t.delete(e)},has:function(t,e){return t.has(e)}})},e.forItem=function(t,n){void 0===n&&(n=qt);var r=Si.parse(t);return new e({key:Si.parse(n),value:r})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.key=Si.merge(e.key,n.key),e.value=Si.merge(e.value,n.value)},e.prototype.getSubType=function(t,e,n){if(Kt.is(t)&&this.options.key.isValid(t.value))return this.options.value;var r=t.getType(e,n);return r&&y(r=r.getRequired(),this.options.key)?this.options.value:null},e.prototype.getSubTypes=function(t){return[{key:this.options.key,value:this.options.value}]},e.prototype.getChildType=function(t){switch(t){case e.CHILD_KEY:return this.options.key;case e.CHILD_VALUE:return this.options.value}return null},e.prototype.getChildTypes=function(){return[e.CHILD_KEY,e.CHILD_VALUE]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){return t instanceof e&&this.options.key.isCompatible(t.options.key,n)&&this.options.value.isCompatible(t.options.value,n)},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_KEY,n.options.key,(function(t){return n.options.key=t})),t.step(e.STEP_VALUE,n.options.value,(function(t){return n.options.value=t}))}))},e.prototype.getTypeFromStep=function(t){return t===e.STEP_KEY?this.options.key:t===e.STEP_VALUE?this.options.value:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.key.setParent(this),this.options.value.setParent(this)},e.prototype.removeDescribedRestrictions=function(){this.options.key.removeDescribedRestrictions(),this.options.value.removeDescribedRestrictions()},e.prototype.getCreateExpression=function(){return jn.op(Wt.create,{})},e.prototype.getValidateExpression=function(){return jn.and(jn.op(Wt.isValid,{value:jn.get("value")}),jn.not(jn.op(fn.contains,{list:jn.op(Wt.values,{map:jn.get("value")}),item:jn.null(),isEqual:jn.not(this.options.value.getValidateExpression())},{value:"ignore",test:"value"})),jn.not(jn.op(fn.contains,{list:jn.op(Wt.keys,{map:jn.get("value")}),item:jn.null(),isEqual:jn.not(this.options.key.getValidateExpression())},{value:"ignore",test:"value"})))},e.prototype.getCompareExpression=function(){return jn.op(Wt.cmp,{value:jn.get("value"),test:jn.get("test"),compare:this.options.value.getValidateExpression()})},e.prototype.getValueChangeExpression=function(t,n,r){return n===e.STEP_KEY?jn.op(Wt.map,{map:jn.get("value"),transformKey:t},{key:"value",value:"actualValue"}):jn.op(Wt.map,{map:jn.get("value"),transform:t})},e.prototype.isValid=function(t){if(t instanceof Map||l(t)){var e=this.options,n=e.key,r=e.value;return this.iterate(t,!0,(function(t,e){if(!n.isValid(t)||!r.isValid(e))return!1}))}return!1},e.prototype.normalize=function(t){var e=this.options,n=e.key,r=e.value,o=[];return this.iterate(t,void 0,(function(t,e){o.push([n.normalize(t),r.normalize(e)])})),new Map(o)},e.prototype.iterate=function(t,e,n){var r,o;if(t instanceof Map)try{for(var i=qo(t.entries()),s=i.next();!s.done;s=i.next()){var a=Fo(s.value,2);if(void 0!==(p=n(a[0],a[1])))return p}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}else if(l(t))for(var u in t){var p;if(void 0!==(p=n(u,t[u])))return p}return e},e.prototype.newInstance=function(){var t=this.options,n=t.key,r=t.value;return new e({key:n.newInstance(),value:r.newInstance()})},e.prototype.clone=function(){var t=this.options,n=t.key,r=t.value;return new e({key:n.clone(),value:r.clone()})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return new Map},e.prototype.random=function(t){for(var e=this.options,n=e.key,r=e.value,o=t(2,6,!0),i=new Map,s=0;s<o;s++){var a=n.random(t),u=r.random(t);i.set(a,u)}return i},e.prototype.fromJson=function(t){var e=this.options,n=e.key,r=e.value;return new Map(t.map((function(t){var e=Fo(t,2),o=e[0],i=e[1];return[n.fromJson(o),r.fromJson(i)]})))},e.prototype.toJson=function(t){var e=this.options,n=e.key,r=e.value;return Array.from(t.entries()).map((function(t){var e=Fo(t,2),o=e[0],i=e[1];return[n.toJson(o),r.toJson(i)]}))},e.STEP_KEY="key",e.STEP_VALUE="value",e.CHILD_KEY="key",e.CHILD_VALUE="value",e.id=G.Map,e.operations=Ft,e.computeds=Vt,e.baseType=new e({key:qt.baseType,value:ht.baseType}),e.describePriority=7,e.registered=!1,e}(q),Yo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yo(e,t),e.decode=function(t,n){return new e(n.getType(t[1]))},e.encode=function(t){return[this.id,t.options.encode()]},e.describe=function(t,e,n){return null},e.register=function(){},e.for=function(t){return new e(Si.parse(t))},e.prototype.getOperations=function(){return this.options.getOperations()},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return this.options.getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.options.getSubTypes(t)},e.prototype.getChildType=function(t){return t===e.CHILD_OPTIONAL?this.options:null},e.prototype.getChildTypes=function(){return[e.CHILD_OPTIONAL]},e.prototype.getExactType=function(t){return this.options.getExactType(t)},e.prototype.getSimplifiedType=function(){return this},e.prototype.getRequired=function(){return this.options},e.prototype.isDeepCompatible=function(t,n){return t instanceof e?this.options.isCompatible(t.options,n):this.options.isCompatible(t,n)},e.prototype.isOptional=function(){return!0},e.prototype.isSimple=function(){return this.options.isSimple()},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){return t.step(e.STEP_OPTIONAL,n.options,(function(t){return n.options=t}))}))},e.prototype.getTypeFromStep=function(t){return t===e.STEP_OPTIONAL?this.options:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.setParent(this)},e.prototype.removeDescribedRestrictions=function(){this.options.removeDescribedRestrictions()},e.prototype.getCreateExpression=function(){return this.options.getCreateExpression()},e.prototype.getValidateExpression=function(){return jn.or(jn.op(ut.isEqual,{value:jn.get("value"),test:jn.undefined()}),this.options.getValidateExpression())},e.prototype.getCompareExpression=function(){return jn.define({valueMissing:jn.op(ut.isEqual,{value:jn.get("value"),test:jn.undefined()}),testMissing:jn.op(ut.isEqual,{value:jn.get("test"),test:jn.undefined()})},jn.if(jn.and(jn.get("valueMissing"),jn.get("testMissing"))).than(jn.compareEqual()).if(jn.get("valueMissing")).than(jn.compareLess()).if(jn.get("testMissing")).than(jn.compareGreater()).else(this.options.getCompareExpression()))},e.prototype.getValueChangeExpression=function(t,e,n){return jn.if(this.options.getValidateExpression()).than(t).else(jn.get("value"))},e.prototype.isValid=function(t){return null==t||this.options.isValid(t)},e.prototype.normalize=function(t){return null==t?t:this.options.normalize(t)},e.prototype.newInstance=function(){return new e(this.options.newInstance())},e.prototype.clone=function(){return new e(this.options.clone())},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.options?this.options.create():void 0},e.prototype.random=function(t){return this.options&&t(0,1,!1)>.3?this.options.random(t):void 0},e.prototype.fromJson=function(t){return null==t?void 0:this.options.fromJson(t)},e.prototype.toJson=function(t){return null==t?void 0:this.options.toJson(t)},e.STEP_OPTIONAL="optional",e.CHILD_OPTIONAL="optional",e.id=G.Optional,e.operations=new W(G.Optional+G.Delimiter),e.computeds=new H(G.Optional+G.Delimiter),e.baseType=new e(ht.baseType),e.describePriority=-1,e.registered=!1,e}(q),Ho=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Go=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ho(e,t),e.decode=function(t,n){return new e(t[1].map((function(t){return n.getType(t)})))},e.encode=function(t){var e=t.options.map((function(t){return t.encode()}));return[this.id,e]},e.describe=function(t,e,n){return null},e.register=function(){},e.prototype.getOperations=function(){return{}},e.prototype.forNot=function(t,e){var n,r,o=this.options;try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),s=i.next();!s.done;s=i.next()){var a=e(s.value);if(void 0!==a)return a}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getChildType=function(t){return this.options[t]||null},e.prototype.getChildTypes=function(){return this.options.map((function(t,e){return e}))},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,e){return this.forNot(!0,(function(n){return!n.isCompatible(t,e)&&void 0}))},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.isOptional=function(){return!0},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var e=this;return t.enter(this,(function(){return e.options.map((function(n,r){return t.step(r,n,(function(t){return e.options.splice(r,1,t)}),(function(){return e.options.splice(r,1)}))}))}))},e.prototype.getTypeFromStep=function(t){return this.options[t]||null},e.prototype.setParent=function(t){var e=this;void 0===t&&(t=null),this.parent=t,this.options.forEach((function(t){return t.setParent(e)}))},e.prototype.removeDescribedRestrictions=function(){this.options.forEach((function(t){return t.removeDescribedRestrictions()}))},e.prototype.getCreateExpression=function(){return ft.instance},e.prototype.getValidateExpression=function(){return ft.instance},e.prototype.getCompareExpression=function(){return ft.instance},e.prototype.isValid=function(t){return this.forNot(!0,(function(e){return!e.isValid(t)&&void 0}))},e.prototype.normalize=function(t){return this.forNot(t,(function(e){return e.isValid(t)?null:void 0}))},e.prototype.newInstance=function(){return new e([])},e.prototype.clone=function(){return new e(this.options.map((function(t){return t.clone()})))},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return null},e.prototype.random=function(t){return null},e.prototype.fromJson=function(t){return ht.baseType.fromJson(t)},e.prototype.toJson=function(t){return ht.baseType.toJson(t)},e.id=G.Not,e.operations=new W(G.Not+G.Delimiter),e.computeds=new H(G.Not+G.Delimiter),e.baseType=new e([ht.baseType]),e.describePriority=-1,e.registered=!1,e}(q),Bo=new W(G.Color+G.Delimiter),Uo=new H(G.Color+G.Delimiter),Jo=Bo,Ko={create:Jo.set("create",{}),maybe:Jo.set("maybe",{},["value"]),cmp:Jo.set("cmp",{},["value","test"]),copy:Jo.set("copy",{},["value"]),build:Jo.set("build",{},["r","g","b"],["a"]),map:Jo.set("map",{},["value","r","g","b"],["a"],["value","component"],["r","g","b","a"]),op:Jo.set("op",{},["value","test","r","g","b"],["a"],["value","test","component"],["r","g","b","a"]),clamp:Jo.set("clamp",{},["value"]),add:Jo.set("+",{},["value","addend"],["alpha"]),adds:Jo.set("+*",{},["value","addend","addendScale"],["alpha"]),sub:Jo.set("-",{},["value","subtrahend"],["alpha"]),mul:Jo.set("*",{},["value","multiplier"],["alpha"]),div:Jo.set("/",{},["value","divisor"],["alpha"]),mod:Jo.set("%",{},["value","divisor"],["alpha"]),format:Jo.set("format",{},["value","format"]),parse:Jo.set("parse",{},["value"]),lerp:Jo.set("lerp",{},["start","end","delta"]),lighten:Jo.set("lighten",{},["value","amount"]),darken:Jo.set("darken",{},["value","amount"]),toHSL:Jo.set("->hsl",{},["value"]),fromHSL:Jo.set("<-hsl",{},["value"]),luminance:Jo.set("luminance",{},["value"]),contrast:Jo.set("contrast",{},["value","test"]),invert:Jo.set("invert",{},["value"],["alpha"]),opaque:Jo.set("opaque",{},["value"]),alpha:Jo.set("alpha",{},["value","alpha"]),distance:Jo.set("distance",{},["value","test"]),named:Jo.set("named",{},["name"]),getName:Jo.set("getName",{},["value"]),blend:Jo.set("blend",{},["top","bottom","mode"]),isValid:Jo.set("?",{},["value"]),isEqual:Jo.set("=",{},["value","test"],["epsilon"]),isNotEqual:Jo.set("!=",{},["value","test"],["epsilon"]),isLess:Jo.set("<",{},["value","test"]),isLessOrEqual:Jo.set("<=",{},["value","test"]),isGreater:Jo.set(">",{},["value","test"]),isGreaterOrEqual:Jo.set(">=",{},["value","test"]),asAny:Jo.set("~"+G.Any,{},["value"]),asBoolean:Jo.set("~"+G.Boolean,{},["value"]),asColor:Jo.set("~"+G.Color,{},["value"]),asDate:Jo.set("~"+G.Date,{},["value"]),asList:Jo.set("~"+G.List,{},["value"]),asMap:Jo.set("~"+G.Map,{},["value"]),asNumber:Jo.set("~"+G.Number,{},["value"]),asObject:Jo.set("~"+G.Object,{},["value"]),asText:Jo.set("~"+G.Text,{},["value"]),asTuple:Jo.set("~"+G.Tuple,{},["value"]),asSet:Jo.set("~"+G.Set,{},["value"])};Uo.set("toHSL",Ko.toHSL),Uo.set("luminance",Ko.luminance),Uo.set("inverted",Ko.invert),Uo.set("opaque",Ko.opaque),Uo.set("name",Ko.getName);var zo=0,Xo=255;function $o(t){return l(t)&&r(t.r)&&r(t.g)&&r(t.b)}function Qo(t){return m(Math.round(t),zo,Xo)}var Zo=function(){function t(t,e){this.code=t,this.name=e,this.formatMap={},this.formats=[]}return t.prototype.setType=function(t){return this.type=t,this},t.prototype.setToColor=function(t){return this.toColor=t,this},t.prototype.setFromColor=function(t){return this.fromColor=t,this},t.prototype.addFormat=function(t){return this.formatMap[t.code]=t,this.formats.push(t),this},t}(),ti=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ei=new Zo("rgb","RGB").setToColor((function(t){return t})).setFromColor((function(t){return t})).addFormat({code:"default",name:"Default",parser:function(t){return $o(t)?t:null},formatter:function(t){return t}}).addFormat({code:"bestfit",name:"Best Fit",parser:function(t){return null},formatter:function(t){return t.a===Xo?"#"+ri(t.r)+ri(t.g)+ri(t.b):"rgba("+Qo(t.r)+","+Qo(t.g)+","+Qo(t.b)+","+Qo(t.a)/Xo+")"}}).addFormat({code:"hexShort",name:"Hex (#rgb)",parser:function(t){if(!o(t))return null;var e=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t);if(!e)return null;var n=ti(e,4),r=n[1],i=n[2],s=n[3];return{r:parseInt(r+r,16),g:parseInt(i+i,16),b:parseInt(s+s,16),a:Xo}},formatter:function(t){return"#"+ri(t.r).substring(0,1)+ri(t.g).substring(0,1)+ri(t.b).substring(0,1)}}).addFormat({code:"hex",name:"Hex (#rrggbb)",parser:function(t){if(!o(t))return null;var e=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t);if(!e)return null;var n=ti(e,4),r=n[1],i=n[2],s=n[3];return{r:parseInt(r,16),g:parseInt(i,16),b:parseInt(s,16),a:Xo}},formatter:function(t){return"#"+ri(t.r)+ri(t.g)+ri(t.b)}}).addFormat({code:"hexLong",name:"Hex (#rrggbbaa)",parser:function(t){if(!o(t))return null;var e=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t);if(!e)return null;var n=ti(e,5),r=n[1],i=n[2],s=n[3],a=n[4];return{r:parseInt(r,16),g:parseInt(i,16),b:parseInt(s,16),a:parseInt(a,16)}},formatter:function(t){return"#"+ri(t.r)+ri(t.g)+ri(t.b)+ri(t.a)}}).addFormat({code:"rgb",name:"rgb(r, g, b)",parser:function(t){if(!o(t))return null;var e=/^rgb\(\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*\)$/i.exec(t);if(!e)return null;var n=ti(e,4),r=n[1],i=n[2],s=n[3];return{r:ni(r),g:ni(i),b:ni(s),a:Xo}},formatter:function(t){return"rgb("+Qo(t.r)+","+Qo(t.g)+","+Qo(t.b)+")"}}).addFormat({code:"rgba",name:"rgba(r, g, b, a)",parser:function(t){if(!o(t))return null;var e=/^rgb\(\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*([01]?\.?[0-9]*)\s*\)$/i.exec(t);if(!e)return null;var n=ti(e,5),r=n[1],i=n[2],s=n[3],a=n[4];return{r:ni(r),g:ni(i),b:ni(s),a:Qo(Math.floor(parseFloat(a)*Xo))}},formatter:function(t){return"rgba("+Qo(t.r)+","+Qo(t.g)+","+Qo(t.b)+","+Qo(t.a)/Xo+")"}});function ni(t){return-1===t.indexOf("%")?Qo(parseInt(t,10)):Qo(2.55*parseInt(t.substring(0,t.length-1),10))}function ri(t){return C(Qo(t).toString(16),2,"0",!0)}var oi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function ii(t){return l(t)&&r(t.h)&&r(t.s)&&r(t.l)}var si=new Zo("hsl","HSL").setType(new be({props:{h:new An({min:0,max:360,whole:!0}),s:new An({min:0,max:100,whole:!0}),l:new An({min:0,max:100,whole:!0}),a:new An({min:0,max:255,whole:!0})}})).setToColor((function(t){var e=ai(t.h),n=ui(t.l)/100,r=ui(t.s)/100,o=(1-Math.abs(2*n-1))*r,i=o*(1-Math.abs(e/60%2-1)),s=n-o/2,a=e>=240?0:e>=60&&e<180?o:i,u=e<=120?0:e>=180&&e<300?o:i;return{r:Qo(((e<60||e>=300?o:e>=120&&e<240?0:i)+s)*Xo),g:Qo((a+s)*Xo),b:Qo((u+s)*Xo),a:t.a}})).setFromColor((function(t){var e=Qo(t.r),n=Qo(t.g),r=Qo(t.b),o=e/Xo,i=n/Xo,s=r/Xo,a=Math.max(o,i,s),u=Math.min(o,i,s),p=a-u,c=(a+u)/2,l=0===p?0:a===o?(i-s)/p%6:a===i?(s-o)/p+2:(o-i)/p+4,f=0===p?0:p/(1-Math.abs(2*c-1));return{h:ai(Math.round(60*l)),s:ui(Math.round(100*f)),l:ui(Math.round(100*c)),a:t.a}})).addFormat({code:"hsl",name:"HSL",parser:function(t){if(!o(t))return null;var e=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*\)$/i.exec(t);if(!e)return null;var n=oi(e,4),r=n[1],i=n[2],s=n[3];return{h:ai(parseInt(r,10)),s:ui(parseInt(i,10)),l:ui(parseInt(s,10)),a:Xo}},formatter:function(t){return"hsl("+ai(Math.round(t.h))+","+ui(Math.round(t.s))+"%,"+ui(Math.round(t.l))+"%)"}}).addFormat({code:"hsla",name:"HSLA",parser:function(t){if(!o(t))return null;var e=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*,\s*([01]?\.?[0-9]*)\s*\)$/i.exec(t);if(!e)return null;var n=oi(e,5),r=n[1],i=n[2],s=n[3],a=n[4];return{h:ai(parseInt(r,10)),s:ui(parseInt(i,10)),l:ui(parseInt(s,10)),a:Qo(Math.floor(parseFloat(a)*Xo))}},formatter:function(t){return"hsla("+ai(Math.round(t.h))+","+ui(Math.round(t.s))+"%,"+ui(Math.round(t.l))+"%,"+Qo(t.a)/Xo+")"}});function ai(t){return t<0?360-Math.abs(t%360):t%360}function ui(t){return m(t,0,100)}var pi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ci=function(){return(ci=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},li=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fi=function(t){function e(n){return void 0===n&&(n={}),t.call(this,ci(ci({},n),{props:e.componentProps}))||this}return pi(e,t),e.decode=function(t){return new e(t[1]||{})},e.encode=function(t){return t.options.hasAlpha?[this.id,{hasAlpha:!0}]:this.id},e.describe=function(t,n,r){var o=e.baseType.normalize(t);return o?new e({hasAlpha:o.a!==Xo}):null},e.register=function(){},e.getFormat=function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(t.split(":"),2),n=e[0],r=e[1],o=this.spaces.find((function(t){return t.code===n}));return o?o.formatMap[r]:void 0},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.hasAlpha=e.hasAlpha||n.hasAlpha},e.prototype.isDeepCompatible=function(t,n){return t instanceof e||!(n.strict||n.exact||!(t instanceof be)||!t.isCompatible(this))},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!0},e.prototype.removeDescribedRestrictions=function(){t.prototype.removeDescribedRestrictions.call(this),delete this.options.hasAlpha},e.prototype.getCreateExpression=function(){return jn.op(Ko.create,{})},e.prototype.getValidateExpression=function(){return jn.op(Ko.isValid,{value:jn.get("value")})},e.prototype.getCompareExpression=function(){return jn.op(Ko.cmp,{value:jn.get("value"),test:jn.get("test")})},e.prototype.isValid=function(t){return void 0!==this.normalize(t)},e.prototype.normalize=function(t){var n,r,o,i;try{for(var s=li(e.spaces),a=s.next();!a.done;a=s.next()){var u=a.value;try{for(var p=(o=void 0,li(u.formats)),c=p.next();!c.done;c=p.next()){var l=c.value.parser(t);if(null!==l)return u.toColor(l)}}catch(t){o={error:t}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.newInstance=function(){return new e({})},e.prototype.clone=function(){return new e({hasAlpha:this.options.hasAlpha})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return{r:0,g:0,b:0,a:0}},e.prototype.random=function(t){return{r:t(zo,Xo,!0),g:t(zo,Xo,!0),b:t(zo,Xo,!0),a:Xo}},e.prototype.fromJson=function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}},e.prototype.toJson=function(t){return t?{r:t.r,g:t.g,b:t.b,a:t.a}:null},e.componentType=new An({min:zo,max:Xo,whole:!0}),e.componentProps={r:e.componentType,g:e.componentType,b:e.componentType,a:e.componentType},e.spaces=[ei,si],e.id=G.Color,e.operations=Bo,e.computeds=Uo,e.baseType=new e({hasAlpha:!0}),e.describePriority=7,e.registered=!1,e}(be);ei.setType(fi.baseType);var yi=new W(G.Set+G.Delimiter),hi=new H(G.Set+G.Delimiter),di=yi,vi={create:di.set("create"),createLike:di.set("createLike",{},["set"],[],[],[],["set"]),createFor:di.set("createFor",{},["value"],[],[],[],["value"]),maybe:di.set("maybe",{},["value"]),add:di.set("add",{mutates:["set"]},["set","value"],[],[],[],["set"]),has:di.set("has",{},["set","value"]),delete:di.set("delete",{mutates:["set"]},["set","value"]),values:di.set("values",{complexity:1},["set"],[],[],[],["set"],!0),clear:di.set("clear",{mutates:["set"]},["set"],[],[],[],["set"]),count:di.set("count",{},["set"]),cmp:di.set("cmp",{complexity:1},["value","test"],[],[],[],[],!0),copy:di.set("copy",{complexity:1},["set"],["deepCopy"],["set","value"],["deepCopy"],["set"],!0),map:di.set("map",{complexity:1},["set"],["transform"],["set","value"],["transform"],["set"],!0),isValid:di.set("?",{},["value"]),isEqual:di.set("=",{complexity:1},["value","test"],[],[],[],[],!0),isNotEqual:di.set("!=",{complexity:1},["value","test"],[],[],[],[],!0),isLess:di.set("<",{complexity:1},["value","test"],[],[],[],[],!0),isLessOrEqual:di.set("<=",{complexity:1},["value","test"],[],[],[],[],!0),isGreater:di.set(">",{complexity:1},["value","test"],[],[],[],[],!0),isGreaterOrEqual:di.set(">=",{complexity:1},["value","test"],[],[],[],[],!0),asAny:di.set("~"+G.Any,{},["value"]),asBoolean:di.set("~"+G.Boolean,{},["value"]),asColor:di.set("~"+G.Color,{},["value"]),asDate:di.set("~"+G.Date,{},["value"]),asList:di.set("~"+G.List,{},["value"]),asMap:di.set("~"+G.Map,{},["value"]),asNumber:di.set("~"+G.Number,{},["value"]),asObject:di.set("~"+G.Object,{},["value"]),asText:di.set("~"+G.Text,{},["value"]),asTuple:di.set("~"+G.Tuple,{},["value"]),asSet:di.set("~"+G.Set,{},["value"])};hi.set("copy",vi.copy),hi.set("values",vi.values),hi.set("count",vi.count);var mi,gi,Ti,bi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xi=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Oi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return bi(e,t),e.decode=function(t,n){return new e({value:n.getType(t[1])})},e.encode=function(t){var e=t.options.value;return[this.id,e.encode()]},e.describe=function(t,n,r){var o,i;if(!u(t))return null;var s=new ht({}),a=new e({value:s});r.set(t,a);try{for(var p=xi(t.entries()),c=p.next();!c.done;c=p.next()){var l=Oi(c.value,1)[0];s=n.merge(s,l)}}catch(t){o={error:t}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return a.options.value=s,a},e.register=function(){var t="object";$.addJson({priority:11,fromJson:function(t,e){if(l(t)&&o(t.$any)&&"set"===t.$any)return new Set(t.value.map(e))},toJson:function(t,e){if(u(t))return{$any:"set",value:Array.from(t.entries()).map(e)}}}),$.addCopier({priority:11,copy:function(t,e,n){var r,o;if(u(t)){var i=new Set;n(t,i);try{for(var s=xi(t.entries()),a=s.next();!a.done;a=s.next()){var p=Oi(a.value,1)[0];i.add(e(p))}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}}}),$.addCompare({priority:11,type:t,compare:function(t,e,n){var r=u(t),o=u(e);if(r!==o)return(r?1:0)-(o?1:0);if(u(t)&&u(e)){var i=t.size-e.size;if(0===i){for(var s=0,a=0,p=Array.from(t),c=Array.from(e),l=0;l<p.length;l++){var f=n(p[l],c[l]);f<0&&s++,f>0&&a++}i=$.getCompare(s,a)}return i}}}),$.addEquals({priority:11,type:t,equals:function(t,e,n){var r,o;if(u(t)!==u(e))return!1;if(u(t)&&u(e)){if(t.size!==e.size)return!1;try{for(var i=xi(t),s=i.next();!s.done;s=i.next()){var a=s.value;if(!e.has(a))return!1}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!0}}})},e.forItem=function(t){return new e({value:Si.parse(t)})},e.prototype.getId=function(){return e.id},e.prototype.getOperations=function(){return e.operations.map},e.prototype.merge=function(t){var e=this.options,n=t.options;e.value=Si.merge(e.value,n.value)},e.prototype.getSubType=function(t,e,n){return null},e.prototype.getSubTypes=function(t){return[]},e.prototype.getChildType=function(t){return t===e.CHILD_VALUE?this.options.value:null},e.prototype.getChildTypes=function(){return[e.CHILD_VALUE]},e.prototype.getExactType=function(t){return this},e.prototype.getSimplifiedType=function(){return this},e.prototype.isDeepCompatible=function(t,n){return t instanceof e&&this.options.value.isCompatible(t.options.value,n)},e.prototype.isOptional=function(){return!1},e.prototype.isSimple=function(){return!1},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){t.step(e.STEP_VALUE,n.options.value,(function(t){return n.options.value=t}))}))},e.prototype.getTypeFromStep=function(t){return t===e.STEP_VALUE?this.options.value:null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t,this.options.value.setParent(this)},e.prototype.removeDescribedRestrictions=function(){this.options.value.removeDescribedRestrictions()},e.prototype.getCreateExpression=function(){return jn.op(vi.create,{})},e.prototype.getValidateExpression=function(){return jn.and(jn.op(vi.isValid,{value:jn.get("value")}),jn.not(jn.op(fn.contains,{list:jn.op(vi.values,{set:jn.get("value")}),item:jn.null(),isEqual:jn.not(this.options.value.getValidateExpression())},{value:"ignore",test:"value"})))},e.prototype.getCompareExpression=function(){return jn.op(vi.cmp,{value:jn.get("value"),test:jn.get("test")})},e.prototype.getValueChangeExpression=function(t,e,n){return jn.op(vi.map,{set:jn.get("value"),transform:t},{value:"value"})},e.prototype.isValid=function(t){if(t instanceof Set||i(t)){var e=this.options.value;return!Array.from(t).some((function(t){return!e.isValid(t)}))}return!1},e.prototype.normalize=function(t){var e=this.options.value;return new Set(Array.from(t).map((function(t){return e.normalize(t)})))},e.prototype.newInstance=function(){return new e({value:this.options.value.newInstance()})},e.prototype.clone=function(){return new e({value:this.options.value.clone()})},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return new Set},e.prototype.random=function(t){for(var e=this.options.value,n=t(2,6,!0),r=new Set,o=0;o<n;o++){var i=e.random(t);r.add(i)}return r},e.prototype.fromJson=function(t){var e=this.options.value;return new Set(t.map((function(t){return e.fromJson(t)})))},e.prototype.toJson=function(t){var e=this.options.value;return Array.from(t.values()).map((function(t){return e.toJson(t)}))},e.STEP_VALUE="value",e.CHILD_VALUE="value",e.id=G.Set,e.operations=yi,e.computeds=hi,e.baseType=new e({value:ht.baseType}),e.describePriority=7,e.registered=!1,e}(q),wi=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Si=function(){function t(){}return t.setParent=function(t,e){return void 0===e&&(e=!1),(this.autoSetParent||e)&&t.setParent(),t},t.any=function(){return new ht({})},t.bool=function(t,e){return new Z({true:t,false:e})},t.date=function(t){return void 0===t&&(t={}),new jo(t)},t.entity=function(t,e){return new Oe(t,e)},t.enum=function(t,e,n){return void 0===e&&(e=qt),void 0===n&&(n=new Map([])),this.setParent(new Ut({value:this.parse(t),key:this.parse(e),constants:g(n)}))},t.enumForText=function(t){return this.setParent(new Ut({value:this.text(),key:this.text(),constants:a(t)?t:i(t[0])?new Map(t):new Map(t.map((function(t){return[t,t]})))}))},t.list=function(t,e,n){return this.setParent(new mn({item:this.parse(t),min:e,max:n}))},t.many=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.setParent(new ko(i(e[0])?e[0].map((function(e){return t.parse(e)})):e.map((function(e){return t.parse(e)}))))},t.not=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.setParent(new Go(i(e[0])?e[0].map((function(e){return t.parse(e)})):e.map((function(e){return t.parse(e)}))))},t.map=function(t,e){return void 0===e&&(e=qt),this.setParent(new Vo({key:this.parse(e),value:this.parse(t)}))},t.null=function(){return ct.baseType},t.number=function(t,e,n){return new An({min:t,max:e,whole:n})},t.int=function(t,e){return new An({min:t,max:e,whole:!0})},t.index=function(t){return new An({min:0,max:t,whole:!0})},t.char=function(){return new qt({min:1,max:1})},t.object=function(t){var e=this;return void 0===t&&(t=Object.create(null)),this.setParent(new be({props:O(t,(function(t){return e.parse(t)}))}))},t.optional=function(t){var e=this.parse(t);return this.setParent(e.isOptional()?e:new Wo(e))},t.color=function(t){return void 0===t&&(t={}),this.setParent(new fi(t))},t.set=function(t){return this.setParent(new Ei({value:this.parse(t)}))},t.text=function(t){return void 0===t&&(t={}),new qt(t)},t.tuple=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.setParent(new xn(i(e[0])?e[0].map((function(e){return t.parse(e)})):e.map((function(e){return t.parse(e)}))))},t.generic=function(t,e){return this.setParent(new De({path:t,base:e}))},t.func=function(t,e,n){var r=this;return this.setParent(new Re({params:O(e,(function(t){return r.parse(t)})),returns:n?this.parse(n):void 0},t))},t.parse=function(t){return t instanceof q?t:t.baseType.newInstance()},t.simplify=function(t){return t?t.getSimplifiedType():null},t.resolve=function(t){var e,n=this;return t&&(t instanceof q?e=t:t.baseType instanceof q?e=t.baseType.newInstance():i(t)?e=t.map((function(t){return n.resolve(t)})):l(t)&&(e=O(t,(function(t){return n.resolve(t)})))),e},t.reduce=function(t){return 1===t.length?t[0]:new ko(t)},t.explode=function(t){return t instanceof ko?t.options:[t]},t.maybe=function(t,e){if(t instanceof e)return t;if(t instanceof Wo&&t.options instanceof e)return t;if(t instanceof ko){var n=t.options.find((function(t){return t instanceof e}));if(n)return this.optional(n);var r=t.options.find((function(t){return t instanceof Wo&&t.options instanceof e}));if(r)return r}return this.optional(e)},t.mergeMany=function(t,e){var n=this;return void 0===e&&(e=null),0===t.length?e:t.find((function(t){return t instanceof ht}))?ht.baseType:t.map((function(t){return t?t.clone():null})).reduce((function(t,e){return t&&e?n.merge(t,e):t||e}))},t.merge=function(t,e){var n,r;if(t instanceof ht)return e;var o=t instanceof Wo||e instanceof Wo,i=t.getRequired(),s=e.getRequired();if(y(i,s))return i.merge(s),o?this.optional(i):i;if(i instanceof ko||s instanceof ko){var a=this.explode(i),u=this.explode(s),p=a.length;try{for(var c=wi(u),l=c.next();!l.done;l=c.next()){for(var f=l.value,h=!1,d=f instanceof Wo,v=d?f.options:f,m=0;m<p;m++){var g=a[m],T=g instanceof Wo,b=T?g.options:g;y(b,v)&&(h=!0,b.merge(v),d&&!T&&(a[m]=this.optional(b)))}h||a.push(f)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return o?this.optional(this.reduce(a)):this.reduce(a)}return this.many(t,e)},t.coalesce=function(e,n){var r,o;void 0===n&&(n=ct.baseType);var i=!0,s=[],a=function(t){if(!i)return"break";if(t){var e=t instanceof Wo,n=e?t.options:t;n instanceof ko&&n.options.forEach((function(t){var n=t instanceof Wo,r=n?t.options:t;e=e||n,s.some((function(t){return t.exactType(r)}))||s.push(r)})),i=i&&e,s.some((function(t){return t.exactType(n)}))||s.push(n)}};try{for(var u=wi(e),p=u.next();!p.done&&"break"!==a(p.value);p=u.next());}catch(t){r={error:t}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}return s.length>1?i?t.optional(new ko(s)):new ko(s):1===s.length?i?t.optional(s[0]):s[0]:n},t.INDEX=t.index(),t.LENGTH=t.index(),t.CHAR=t.char(),t.autoSetParent=!0,t}(),Pi=function(){function t(t){this.value=t,this.next=this.prev=this}return t.prototype.isEmpty=function(){return this.next===this},t.prototype.clear=function(){this.next=this.prev=this},t.prototype.addLast=function(e){var n=new t(e);return n.linkAfter(this.prev),n},t.prototype.addFirst=function(e){var n=new t(e);return n.linkAfter(this),n},t.prototype.each=function(t){for(var e=this.next,n=0;e!==this;){var r=e.next;t(e.value,n,e),e=r,n++}return n},t.prototype.isRemoved=function(){return this.next===this},t.prototype.remove=function(){this.isRemoved()||(this.next.prev=this.prev,this.prev.next=this.next,this.next=this.prev=this)},t.prototype.linkAfter=function(t){this.remove(),this.next=t.next,this.prev=t,t.next.prev=this,t.next=this},t}(),_i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ii=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(_i(arguments[e]));return t},Mi=function(){function t(){this.listeners=Object.create(null)}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.getListeners(t,!1),o=[];return r&&r.each((function(n){return o.push(n.apply(void 0,Ii([t],e)))})),o},t.prototype.hasListeners=function(t){return null!==this.getListeners(t)},t.prototype.getListeners=function(t,e){void 0===e&&(e=!0);var n=this.listeners[t];return!n&&e&&(n=this.listeners[t]=new Pi((function(){}))),n||null},t.prototype.on=function(t,e){var n=this,r=(i(t)?t:[t]).map((function(t){return n.getListeners(t,!0).addLast(e)}));return function(){return r.forEach((function(t){return t.remove()}))}},t.prototype.once=function(t,e){var n=this.on(t,(function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return n(),e.apply(void 0,Ii([t],r))}));return n},t.prototype.off=function(t,e){var n=this;if(t)if(Array.isArray(t))t.forEach((function(t){return n.off(t,e)}));else{var r=this.listeners[t];r&&(e?r.each((function(t,n,r){t===e&&r.remove()})):r.clear())}else this.listeners=Object.create(null);return this},t}(),Ci=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Di=function(){return(Di=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ji=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e.name,r.created=e.created||v(),r.updated=e.updated||v(),r.description=e.description,r.meta=e.meta,r.type=n.getTypeKind(e.type,Re),r.expression=r.parseExpression(n,e.expression),r.defaults=r.type.fromJsonArguments(e.defaults),r.tests=e.tests.map((function(t){return Di(Di({},t),{args:r.type.fromJsonArguments(t.args)})})),r}return Ci(e,t),e.create=function(t,n){return void 0===n&&(n={}),new e(Di({name:"",created:v(),updated:v(),description:"",meta:null,type:Si.func(t,{},Si.null()),expression:jn.noop(),defaults:{},tests:[]},n),t)},e.prototype.parseExpression=function(t,e){var n=t.getExpression(e);return n.traverse(L.some((function(t){return t instanceof Ge&&t.type===A.RETURN})))||(n=new Ge(A.RETURN,n)),n instanceof Mn?n:new Mn(this.type,n)},e.prototype.sync=function(t,n){var r=this;this.hasChanges(t)&&(this.name=t.name,this.created=t.created||v(),this.updated=t.updated||v(),this.description=t.description,this.meta=t.meta,this.type=t instanceof e?t.type:n.getTypeKind(t.type,Re),this.expression=t instanceof e?t.expression:this.parseExpression(n,t.expression),this.defaults=t instanceof e?t.defaults:this.type.fromJsonArguments(t.defaults),b(this.tests,t instanceof e?t.tests:t.tests.map((function(t){return Di(Di({},t),{args:r.type.fromJsonArguments(t.args)})})),(function(t,e){return t.name===e.name||$.equals(t.args,e.args)}),(function(t,e){return r.addTest(e,!0)}),(function(t,e){return r.removeTest(e,!0)}),(function(t,e,n,o){return r.updateTest(n,o,!0)})),this.trigger("sync",this,t,n),this.changed())},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.updated=v(),this.trigger("changed",this)},e.prototype.encode=function(){var t=this,e=t.name,n=t.created,r=t.updated,o=t.description,i=t.meta,s=t.type,a=t.expression,u=t.defaults,p=t.tests;return{name:e,created:n,updated:r,description:o,meta:i,type:s.encode(),expression:a.encode(),defaults:s.toJsonArguments(u),tests:p.map((function(t){return Di(Di({},t),{args:s.toJsonArguments(t.args)})}))}},e.prototype.renameParameter=function(t,e){var n=this.type.options.params,r=n[t];return r&&($.objectSet(n,e,r),$.objectRemove(n,t),t in this.defaults&&($.objectSet(this.defaults,e,this.defaults[t]),$.objectRemove(this.defaults,t)),this.trigger("renameParameter",this,e,t),this.changed()),!!r},e.prototype.removeParameter=function(t){var e=this.type.options.params,n=t in e;return n&&($.objectRemove(e,t),$.objectRemove(this.defaults,t),this.trigger("removeParameter",this,t),this.changed()),n},e.prototype.addTest=function(t,e){void 0===e&&(e=!1),this.tests.push(t),this.trigger("addTest",this,t),e||this.changed()},e.prototype.updateTest=function(t,e,n){void 0===n&&(n=!1);var o=r(t)?this.tests[t]:t,i=!!o;return i&&(Object.assign(o,e),this.trigger("updateTest",this,o),n||this.changed()),i},e.prototype.removeTest=function(t,e){void 0===e&&(e=!1);var n=r(t)?t:this.tests.indexOf(t),o=n>=0&&n<this.tests.length;if(o){var i=this.tests[n];this.trigger("removeTest",this,i),e||this.changed()}return o},e.prototype.getReturnType=function(t,e,n){return void 0===n&&(n={}),this.type.getOverloaded(n).getReturnType()||this.expression.getType(t,e)},e.prototype.getParamTypes=function(){return this.type.getParamTypes()},e.prototype.getParamType=function(t){var e=this.type.getParamType(t);return e?e.isOptional()&&t in this.defaults&&e.isValid(this.defaults[t])?e.getRequired():e:null},e.prototype.getArguments=function(t,e){void 0===e&&(e=!0);var n=e?Di({},t):t;for(var r in this.defaults){var o=this.type.getParamType(r);o&&!o.getRequired().isValid(n[r])&&$.objectSet(n,r,$.copy(this.defaults[r]))}return n},e.prototype.refactor=function(t,e){var n=e.getCommand(t);this.tests.forEach((function(t){t.args=n({value:t.args})})),this.changed()},e.prototype.mutates=function(t,e){return e in this.type.options.params&&this.expression.mutates(t,e,!1)},e}(Mi),Ri=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ai=function(){return(Ai=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};!function(t){t[t.PRIMARY=0]="PRIMARY",t[t.FOREIGN=1]="FOREIGN",t[t.NONE=2]="NONE"}(gi||(gi={})),function(t){t[t.GIVEN=0]="GIVEN",t[t.AUTO_INCREMENT=1]="AUTO_INCREMENT",t[t.UUID=2]="UUID"}(Ti||(Ti={}));var Ni,ki,Li=function(t){function e(e,n){var o=t.call(this)||this;return o.name=e.name,o.created=e.created||v(),o.updated=e.updated||v(),o.description=e.description,o.meta=e.meta,o.type=n.getTypeKind(e.type,be,Si.object()),o.instances=e.instances&&e.instances.length?e.instances.map((function(t){return o.type.fromJson(t)})):[],o.methods=o.decodeMethods(n,e.methods),o.transcoders=o.decodeTranscoders(n,e.transcoders),o.indexes=o.decodeIndexes(e.indexes),o.primaryType=r(e.primaryType)?e.primaryType:Ti.AUTO_INCREMENT,o.key=e.key?n.getExpression(e.key):o.getPrimaryKeyExpression(),o.keyType=o.key.getType(n,o.getKeyContext()),o.describe=e.describe?n.getExpression(e.describe):jn.noop(),o}return Ri(e,t),e.create=function(t,n){return void 0===n&&(n={}),new e(Ai({name:"",created:v(),updated:v(),description:"",meta:null,type:Si.object(),instances:[],methods:Object.create(null)},n),t)},e.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},e.prototype.sync=function(t,n){var o=this;this.hasChanges(t)&&(this.name=t.name,this.created=t.created||v(),this.updated=t.updated||v(),this.description=t.description,this.meta=t.meta,this.type=n.getTypeKind(t.type,be,Si.object()),this.instances=t instanceof e?t.instances:t.instances&&t.instances.length?t.instances.map((function(t){return o.type.fromJson(t)})):[],x(this.methods,this.decodeMethods(n,t.methods),(function(t,e,n){return o.addMethod(n,!0)}),(function(t,e){return o.removeMethod(e,!0)}),(function(t,e,r,o){return r.sync(o,n)})),x(this.transcoders,this.decodeTranscoders(n,t.transcoders),(function(t,e,r){return o.addTranscoder(n,e,r,!0)}),(function(t,e){return o.removeTranscoder(e,!0)}),(function(t,e,r,i){return o.addTranscoder(n,e,i,!0)})),x(this.indexes,this.decodeIndexes(t.indexes),(function(t,e,n){return o.addIndex(e,n,!0)}),(function(t,e){return o.removeIndex(e,!0)}),(function(t,e,n,r){return o.addIndex(e,r,!0)})),this.primaryType=r(t.primaryType)?t.primaryType:Ti.AUTO_INCREMENT,this.key=t.key?n.getExpression(t.key):this.getPrimaryKeyExpression(),this.keyType=this.key.getType(n,this.getKeyContext()),this.describe=t.describe?n.getExpression(t.describe):jn.noop(),this.trigger("sync",this,t,n),this.trigger("change",this))},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.updated=v(),this.trigger("change",this)},e.prototype.decodeMethods=function(t,e){var n=this;return e?O(e,(function(e){return n.decodeMethod(t,e)})):{}},e.prototype.decodeMethod=function(t,e){return e instanceof ji?e:ji.create(t,e)},e.prototype.decodeTranscoders=function(t,e){var n=this;return e?O(e,(function(e){return n.decodeTranscoder(t,e)})):{}},e.prototype.decodeTranscoder=function(t,e){return e.encode instanceof F?e:{encode:t.getExpression(e.encode),decode:t.getExpression(e.decode),encodedType:t.getType(e.encodedType)}},e.prototype.decodeIndexes=function(t){return t?O(t,(function(t,e){var n=t.unique,r=t.primary;return{name:e,props:t.props,unique:n,primary:r}})):{}},e.prototype.encode=function(){var t=this,e=t.name,n=t.created,r=t.updated,o=t.description,i=t.meta,s=t.type,a=t.instances,u=t.methods,p=t.key,c=t.describe,l=t.transcoders,f=t.indexes;return{name:e,created:n,updated:r,description:o,meta:i,type:s.encode(),instances:a.map((function(t){return s.toJson(t)})),methods:O(u,(function(t){return t.encode()})),key:p.encode(),describe:c.encode(),transcoders:O(l,(function(t){var e=t.encode,n=t.decode,r=t.encodedType;return{encode:e.encode(),decode:n.encode(),encodedType:r.encode()}})),indexes:O(f,(function(t){return{props:t.props,unique:t.unique,primary:t.primary}}))}},e.prototype.canStore=function(t){if(!(this.primaryType!==Ti.GIVEN||this.keyType&&t.keyExpectedType.acceptsType(this.keyType)))return!1;var e=this.describe.getType(t,this.getDescribeContext());return!(!e||!t.describeExpectedType.acceptsType(e))},e.prototype.updateKeyType=function(t){var e=this.key.getType(t,this.getKeyContext());e&&(this.keyType=e)},e.prototype.renameProp=function(t,e){var n=this,r=!1,o=this.transcoders[t];o&&($.objectRemove(this.transcoders,t),$.objectSet(this.transcoders,e,o),r=!0),E(this.indexes,(function(o){var i=o.props.indexOf(t);-1!==i&&(o.props[i]=e,n.updateIndex(o.name,!0),r=!0)})),this.trigger("renameProp",this,e,t),r&&this.changed()},e.prototype.removeProp=function(t){var e=this,n=!1;t in this.transcoders&&(this.removeTranscoder(t,!0),n=!0),E(this.indexes,(function(r,o){var i=r.props.indexOf(t);-1!==i&&(r.props.splice(i,1),n=!0,0===r.props.length?e.removeIndex(o,!0):e.updateIndex(o,!0))})),this.trigger("removeProp",this,t),n&&this.changed()},e.prototype.getEntityProps=function(){var t=this,e=this.getPrimary(),n=e.props.map((function(n,r){return[n,e.types&&e.types[r]?e.types[r]:t.type.options.props[n]]}));return{type:gi.PRIMARY,props:n}},e.prototype.getKey=function(t,e){var n=this.type,r=this.key;return t.run(r,{instance:e,type:n})},e.prototype.setKey=function(t){if(this.primaryType!==Ti.GIVEN){var n=this.getDynamicPrimaryKey();if(!t[n])switch(this.primaryType){case Ti.AUTO_INCREMENT:$.objectSet(t,n,this.instances.reduce((function(t,e){return r(e[n])?Math.max(t,e[n]):t}),0)+1);break;case Ti.UUID:$.objectSet(t,n,e.uuid())}}},e.prototype.takeKey=function(t,e){return this.setKey(e),this.getKey(t,e)},e.prototype.getDescribe=function(t,e){var n=this.type,r=this.describe;return t.run(r,{instance:e,type:n})},e.prototype.getDecodedPropertyTypes=function(){return this.type.options.props},e.prototype.getPropertyTypeFor=function(t){return t?Si.enumForText([t]):this.getPropertyType()},e.prototype.getEncodedPropertyTypes=function(){var t=this;return O(this.type.options.props,(function(e,n){return n in t.transcoders?t.transcoders[n].encodedType:e}))},e.prototype.getEncodedType=function(){return Si.object(this.getEncodedPropertyTypes())},e.prototype.getDecodedType=function(){return this.type},e.prototype.getProperties=function(){return Object.keys(this.getDecodedPropertyTypes())},e.prototype.getPropertyType=function(){return Si.enumForText(this.getProperties())},e.prototype.getKeyReturnType=function(){return this.keyType},e.prototype.getKeyContext=function(){return Si.object({instance:this.type,type:Si.text()})},e.prototype.getDescribeContext=function(){return Si.object({instance:this.type,type:Si.text()})},e.prototype.getEncoded=function(t,e){var n={};for(var r in this.getDecodedPropertyTypes())n[r]=this.getEncodedValue(t,e,r);return n},e.prototype.getEncodedValue=function(t,e,n){var r=this.name,o=this.transcoders,i=n in o?o[n].encode:null,s=e[n];return i?t.run(i,{name:r,instance:e,property:n,value:s}):s},e.prototype.getEncodeContext=function(t){var e=Si.enumForText([this.name]),n=this.getDecodedType(),r=this.getPropertyTypeFor(t),o=this.getDecodeExpected(t);return Si.object({name:e,instance:n,property:r,value:o})},e.prototype.getEncodeExpected=function(t,e){return void 0===e&&(e=Si.any()),t&&t in this.transcoders?this.transcoders[t].encodedType:e},e.prototype.getDecoded=function(t,e){var n={};for(var r in this.getDecodedPropertyTypes())n[r]=this.getDecodedValue(t,e,r);return n},e.prototype.getDecodedValue=function(t,e,n){var r=this.name,o=this.transcoders,i=n in o?o[n].decode:null,s=e[n];return i?t.run(i,{name:r,instance:e,property:n,value:s}):s},e.prototype.getDecodeContext=function(t,e){var n=Si.enumForText([this.name]),r=this.getEncodedType(),o=this.getPropertyTypeFor(t),i=this.getEncodeExpected(t,e);return Si.object({name:n,instance:r,property:o,value:i})},e.prototype.getDecodeExpected=function(t){return t&&this.type.options.props[t]||Si.any()},e.prototype.getIndexExpectedType=function(){return Si.set(this.getPropertyType())},e.prototype.getDynamicPrimaryKey=function(){var t=this.type.options.props;return"id"in t?"_id"in t?"__id":"_id":"id"},e.prototype.getPrimaryKeyExpression=function(t,e){void 0===t&&(t="/"),void 0===e&&(e="primary");var n=this.getPrimary(e);return n.props.length>1?jn.op(fn.join,{list:n.props.map((function(t){return jn.get("instance",t)})),delimiter:jn.const(t),toText:jn.op(ut.asText,{value:jn.get("item")})}):jn.get("instance",n.props[0])},e.prototype.getPrimary=function(t,n){return void 0===t&&(t="primary"),void 0===n&&(n=!0),(t in this.indexes?this.indexes[t]:S(this.indexes,(function(t,e,n){return n||(t.primary?t:n)}),null))||(n?{name:t,props:[this.getDynamicPrimaryKey()],types:[e.PRIMARY_TYPES[this.primaryType]],unique:!0,primary:!0}:null)},e.prototype.getUniqueIndexes=function(){return S(this.indexes,(function(t,e,n){return t.unique&&n.push(t),n}),[])},e.prototype.addPrimary=function(t){return this.addIndex("primary",{props:i(t)?t:[t],unique:!0,primary:!0}),this.primaryType=Ti.GIVEN,this},e.prototype.addIndex=function(t,e,n){void 0===n&&(n=!1);var r=this.indexes[t],o=Ai(Ai({},e),{name:t});return $.objectSet(this.indexes,t,o),r?this.trigger("updateIndex",this,o,r):this.trigger("addIndex",this,o),n||this.changed(),this},e.prototype.updateIndex=function(t,e){void 0===e&&(e=!1);var n=this.indexes[t];return this.trigger("updateIndex",this,n,n),e||this.changed(),this},e.prototype.removeIndex=function(t,e){void 0===e&&(e=!1);var n=this.indexes[t];return $.objectRemove(this.indexes,t),this.trigger("removeIndex",this,n),e||this.changed(),this},e.prototype.renameIndex=function(t,e){var n=this.indexes[t];if(n&&t!==e){var r=Ai(Ai({},n),{props:n.props.slice()});n.name=e,$.objectRemove(this.indexes,t),$.objectSet(this.indexes,e,n),this.trigger("updateIndex",this,n,r),this.changed()}return this},e.prototype.addTranscoder=function(t,e,n,r){void 0===r&&(r=!1);var o=this.transcoders[e],i=this.decodeTranscoder(t,n);return $.objectSet(this.transcoders,e,i),o?this.trigger("updateTranscoder",this,name,i,o):this.trigger("addTranscoder",this,name,i),r||this.changed(),this},e.prototype.removeTranscoder=function(t,e){void 0===e&&(e=!1);var n=this.transcoders[t];return n&&($.objectRemove(this.transcoders,t),this.trigger("removeTranscoder",this,t,n),e||this.changed()),this},e.prototype.updateTranscoder=function(t,e){void 0===e&&(e=!1);var n=this.transcoders[t];return n&&(this.trigger("updateTranscoder",this,t,n,n),e||this.changed()),this},e.prototype.addMethod=function(t,e){void 0===e&&(e=!1);var n=this.methods[t.name];return $.objectSet(this.methods,t.name,t),n?this.trigger("updateMethod",this,t,n):this.trigger("addMethod",this,t),e||this.changed(),this},e.prototype.renameMethod=function(t,e,n){void 0===n&&(n=!1);var r=this.methods[t];return r&&t!==e&&(r.name=e,$.objectRemove(this.methods,t),$.objectSet(this.methods,e,r),this.trigger("updateMethod",this,r,r),n||this.changed()),this},e.prototype.removeMethod=function(t,e){void 0===e&&(e=!1);var n=this.methods[t];return n&&($.objectRemove(this.methods,t),this.trigger("removeMethod",this,n),e||this.changed()),this},e.PRIMARY_TYPES=((mi={})[Ti.GIVEN]=null,mi[Ti.AUTO_INCREMENT]=Si.int(1),mi[Ti.UUID]=Si.text({min:36,max:36,forceLower:!0,matches:/^[\da-f]{8}\-[\da-f]{4}\-[\da-f]{4}\-[\da-f]{4}\-[\da-f]{12}$/i}),mi),e}(Mi),qi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.HAS_MANY=0]="HAS_MANY",t[t.BELONGS_TO=1]="BELONGS_TO",t[t.HAS_ONE=2]="HAS_ONE",t[t.ONE=3]="ONE",t[t.HAS_ONE_POLYMORPHIC=4]="HAS_ONE_POLYMORPHIC",t[t.ONE_POLYMORPHIC=5]="ONE_POLYMORPHIC"}(Ni||(Ni={})),function(t){t[t.NONE=0]="NONE",t[t.CASCADE=1]="CASCADE",t[t.SET_NULL=2]="SET_NULL",t[t.RESTRICT=3]="RESTRICT"}(ki||(ki={}));var Fi=function(t){function e(e,n){var r=t.call(this)||this;return r.defs=e,r.name=n.name,r.updated=n.updated||v(),r.created=n.created||v(),r.kind=n.kind,r.subject=n.subject,r.subjectRelationName=n.subjectRelationName||n.related[0].name,r.morphs=n.morphs?r.decodeTypePair(n.morphs):null,r.morphsToRelated=g(n.morphsToRelated),r.related=n.related,r.relatedRelationName=n.relatedRelationName||n.subject.name,r.relatedToMorphs=T(r.morphsToRelated),r.multiple=!!n.multiple,r.required=!!n.required,r.owns=!!n.owns,r.extension=!!n.extension,r}return qi(e,t),e.prototype.sync=function(t,e){this.hasChanges(t)&&(this.name=t.name,this.updated=t.updated||v(),this.created=t.created||v(),this.kind=t.kind,this.subject=t.subject,this.subjectRelationName=t.subjectRelationName||t.related[0].name,this.morphs=t.morphs?this.decodeTypePair(t.morphs):null,this.morphsToRelated=g(t.morphsToRelated),this.related=t.related,this.relatedRelationName=t.relatedRelationName||t.subject.name,this.relatedToMorphs=T(this.morphsToRelated),this.multiple=!!t.multiple,this.required=!!t.required,this.owns=!!t.owns,this.extension=!!t.extension,this.trigger("sync",this,t,e),this.changed())},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.updated=v(),this.trigger("changed",this)},e.prototype.decodeTypePair=function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(t,2),n=e[0],r=e[1];return[n,this.defs.getType(r)]},e.prototype.encodeTypePair=function(t){return t?[t[0],t[1].encode()]:null},e.prototype.encode=function(){var t=this,e=t.name,n=t.created,r=t.updated,o=t.kind,i=t.subject,s=t.subjectRelationName,a=t.morphs,u=t.morphsToRelated,p=t.related,c=t.relatedRelationName,l=t.multiple,f=t.required,y=t.owns,h=t.extension;return{name:e,updated:r,created:n,kind:o,subject:i,subjectRelationName:s,morphs:this.encodeTypePair(a),morphsToRelated:Array.from(u.entries()),related:p,relatedRelationName:c,multiple:l,required:f,owns:y,extension:h}},e.prototype.getRelatedWithName=function(t,e){return e.find((function(e){return e.name===t}))},e.prototype.rename=function(t,e){this.renameReference(t,e,[this.subject]),this.renameReference(t,e,this.related),this.changed()},e.prototype.renameReference=function(t,e,n){var r=this.getRelatedWithName(t,n);r&&(r.name=e)},e.prototype.remove=function(t){this.removeReference(t,[this.subject]),this.removeReference(t,this.related),this.changed()},e.prototype.removeReference=function(t,e){var n=e.findIndex((function(e){return e.name===t}));-1!==n&&(e.splice(n,1),e[n].props=[])},e.prototype.renameProp=function(t,e,n){this.renamePropReference(t,e,n,[this.subject]),this.renamePropReference(t,e,n,this.related),this.changed()},e.prototype.renamePropReference=function(t,e,n,r){var o=this.getRelatedWithName(t,r);if(o){var i=o.props.indexOf(e);-1!==i&&(o.props[i]=n)}},e.prototype.removeProp=function(t,e){this.removePropReference(t,e,[this.subject]),this.removePropReference(t,e,this.related),this.changed()},e.prototype.removePropReference=function(t,e,n){var r=n.findIndex((function(e){return e.name===t}));if(-1!==r){var o=n[r],i=o.props.indexOf(e);if(-1!==i&&(o.props.splice(i,1),0===o.props.length))return n.splice(r,1),!0}return!1},e.prototype.getPropTypes=function(t){var e=this,n=[];return t.forEach((function(t){var r=t.name,o=t.props,i=e.defs.getEntity(r).getEntityProps();o.forEach((function(t,e){var r=i.props[e][1];n[e]=n[e]?Si.merge(n[e],r):r.clone()}))})),n},e.prototype.isEmpty=function(){return 0===this.subject.props.length||0===this.related.length},e.prototype.getItemType=function(t){var e=this,n=t.map((function(t){return e.defs.getType(t.name)}));return n.length>1?Si.many(n):n[0]},e.prototype.getSubjectRelation=function(t){if(this.subject.name!==t)return null;var e=this.subjectRelationName,n=this.subject.props,r=this.related,o=this.getItemType(r),i=this.owns&&this.multiple?ki.CASCADE:this.required?ki.RESTRICT:ki.SET_NULL,s=this.required?o:Si.optional(o),a={relation:this,name:e,kind:this.kind===Ni.HAS_MANY?Ni.BELONGS_TO:this.kind,local:n,cascade:i,related:r,itemType:o,relationType:s};return this.morphs&&(a.morphs=this.morphs,a.morphsToRelated=this.morphsToRelated,a.relatedToMorphs=this.relatedToMorphs),a},e.prototype.getRelatedRelation=function(t){var e=this.getRelatedWithName(t,this.related);if(!e)return null;var n=this.relatedRelationName,r=e.props,o=[this.subject],i=this.getItemType(o),s=ki.NONE,a=this.multiple?Si.list(i):this.required?i:Si.optional(i),u={relation:this,name:n,kind:this.kind===Ni.HAS_MANY?Ni.HAS_MANY:this.morphs?Ni.ONE_POLYMORPHIC:Ni.ONE,local:r,cascade:s,related:o,itemType:i,relationType:a};return this.morphs&&(u.where=[this.morphs[0],this.relatedToMorphs.get(t)]),u},e.prototype.getTypeProps=function(t){var e=[];if(this.subject.name===t){var n=this.getPropTypes(this.related),r=this.subject.props.map((function(t,e){return[t,n[e]]}));e.push({type:gi.FOREIGN,props:r,relation:this}),this.morphs&&e.push({type:gi.NONE,props:[this.morphs],relation:this})}return e},e.hasMany=function(t,n){var r=n.oneRelationName||n.many,o=n.manyRelationName||n.one,i=n.foreignKeyPrefix||o+"_",s=n.name||o+"_hasMany_"+r,a=t.getEntity(n.one).getPrimary().props,u=a.map((function(t){return i+t}));return new e(t,{name:s,created:n.created||v(),updated:n.updated||v(),kind:Ni.HAS_MANY,subject:{name:n.many,props:u},subjectRelationName:o,related:[{name:n.one,props:a}],relatedRelationName:r,multiple:!0,owns:!1!==n.owns,required:!1!==n.owns})},e.belongsTo=function(t,e){return this.hasMany(t,{name:e.name,one:e.belongsTo,many:e.oneOfMany,oneRelationName:e.belongsToRelationName,manyRelationName:e.oneOfManyRelationName,foreignKeyPrefix:e.foreignKeyPrefix,owns:e.owns})},e.hasOne=function(t,n){var r=n.oneRelationName||n.hasOne,o=n.hasOneRelationName||n.one,i=n.foreignKeyPrefix||o+"_",s=n.name||o+"_hasOne_"+r,a=t.getEntity(n.one).getPrimary().props,u=a.map((function(t){return i+t}));return new e(t,{name:s,created:n.created||v(),updated:n.updated||v(),kind:Ni.HAS_ONE,subject:{name:n.hasOne,props:u},subjectRelationName:o,related:[{name:n.one,props:a}],relatedRelationName:r,required:n.required,owns:n.owns})},e.belongsToOne=function(t,e){return this.hasOne(t,{name:e.name,hasOne:e.belongsTo,one:e.one,required:e.required,owns:e.owns,hasOneRelationName:e.belongsToRelationName,oneRelationName:e.oneRelationName,foreignKeyPrefix:e.foreignKeyPrefix})},e.hasOnePolymorphic=function(t,n){var r=n.hasOneRelationName,o=n.polyRelationName||n.hasOne,i=n.name||r+"_hasOnePolymorphic_"+o,s=n.foreignKeyPrefix||r+"_",a=n.poly.map((function(e){return{name:e,props:t.getEntity(e).getPrimary().props}})),u=a[0].props.map((function(t){return s+t}));return new e(t,{name:i,created:n.created||v(),updated:n.updated||v(),kind:Ni.HAS_ONE_POLYMORPHIC,subject:{name:n.hasOne,props:u},subjectRelationName:r,related:a,relatedRelationName:o,morphs:n.morphs,morphsToRelated:n.morphsToRelated,required:n.required,owns:n.owns})},e}(Mi),Vi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yi=function(){return(Yi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Wi=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e.name,r.author=e.author,r.description=e.description,r.meta=e.meta,r.created=e.created,r.updated=e.updated,r.dataType=n.getType(e.dataType),r.expression=n.getExpression(e.expression),r.datasets=e.datasets.map((function(t){return Yi(Yi({},t),{data:r.dataType.fromJson(t.data)})})),r}return Vi(e,t),e.create=function(t,n){return void 0===n&&(n={}),new e(Yi({name,author:"",description:"",meta:null,created:v(),updated:v(),dataType:Si.object(),datasets:[{name:"Data Set #1",data:Object.create(null),created:v(),updated:v(),meta:null}],expression:ft.instance},n),t)},e.prototype.sync=function(t,n){var r=this;this.hasChanges(t)&&(this.name=t.name,this.created=t.created||v(),this.updated=t.updated||v(),this.author=t.author,this.description=t.description,this.meta=t.meta,this.created=t.created,this.updated=t.updated,this.dataType=t instanceof e?t.dataType:n.getType(t.dataType),this.expression=t instanceof e?t.expression:n.getExpression(t.expression),b(this.datasets,t instanceof e?t.datasets:t.datasets.map((function(t){return Yi(Yi({},t),{data:r.dataType.fromJson(t.data)})})),(function(t,e){return t.name===e.name||t.created===e.created}),(function(t,e){return r.addDataset(e,!0)}),(function(t,e,n){return r.removeDataset(e,!0)}),(function(t,e,n,o){return r.updateDataset(n,o,!0)})),this.trigger("sync",this,t,n),this.changed())},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.updated=v(),this.trigger("changed",this)},e.prototype.encode=function(){var t=this,e=t.name,n=t.author,r=t.description,o=t.meta,i=t.created,s=t.updated,a=t.dataType,u=t.datasets,p=t.expression;return{name:e,author:n,description:r,meta:o,created:i,updated:s,dataType:a.encode(),datasets:u.map((function(t){return Yi(Yi({},t),{data:a.toJson(t.data)})})),expression:p.encode()}},e.prototype.addDataset=function(t,e){void 0===e&&(e=!1),this.datasets.push(t),this.trigger("addDataset",this,t),e||this.changed()},e.prototype.moveDataset=function(t,e,n){void 0===n&&(n=!1);var o=r(t)?t:this.datasets.indexOf(t),i=o>=0&&o<this.datasets.length,s=e>=0&&e<this.datasets.length,a=i&&s;if(a){var u=this.datasets[o];this.datasets.splice(o,1),this.datasets.splice(e,0,u),this.trigger("moveDataset",this,u,o,e),n||this.changed()}return a},e.prototype.updateDataset=function(t,e,n){void 0===n&&(n=!1);var o=r(t)?this.datasets[t]:t,i=!!o;return i&&(Object.assign(o,e),this.trigger("updateDataset",this,o),n||this.changed()),i},e.prototype.removeDataset=function(t,e){void 0===e&&(e=!1);var n=r(t)?t:this.datasets.indexOf(t),o=n>=0&&n<this.datasets.length;if(o){var i=this.datasets[n];$.arrayRemove(this.datasets,n),this.trigger("removeDataset",this,i),e||this.changed()}return o},e.prototype.refactor=function(t,e){var n=e.getCommand(t);this.datasets.forEach((function(t){t.data=n({value:t.data})})),this.changed()},e}(Mi),Hi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gi=function(){return(Gi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Bi=function(t){function e(e,n){var r=t.call(this)||this;return r.name=e.name,r.created=e.created||v(),r.updated=e.updated||v(),r.meta=e.meta,r.dataType=n.getType(e.dataType),r.data=r.dataType.fromJson(e.data),r}return Hi(e,t),e.create=function(t,n){return void 0===n&&(n={}),new e(Gi({name:"",created:v(),updated:v(),dataType:Si.object(),data:Object.create(null),meta:null},n),t)},e.prototype.sync=function(t,n){this.hasChanges(t)&&(this.name=t.name,this.created=t.created||v(),this.updated=t.updated||v(),this.meta=t.meta,this.dataType=t instanceof e?t.dataType:n.getType(t.dataType),this.data=t instanceof e?t.data:this.dataType.fromJson(t.data),this.trigger("sync",this,t,n),this.changed())},e.prototype.hasChanges=function(t){return!$.equals(t instanceof e?t.encode():t,this.encode())},e.prototype.changed=function(){this.updated=v(),this.trigger("changed",this)},e.prototype.encode=function(){var t=this,e=t.name,n=t.created,r=t.updated,o=t.meta,i=t.dataType,s=t.data;return{name:e,created:n,updated:r,meta:o,dataType:i.encode(),data:i.toJson(s)}},e.prototype.refactor=function(t,e){this.data=e.run(t,{value:this.data}),this.changed()},e}(Mi),Ui=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ji=function(t){function e(e,n){var r=t.call(this,e)||this;return r.provider=n,r}return Ui(e,t),e.decode=function(t,n){return new e(t[1],n)},e.encode=function(t){return[this.id,t.options]},e.describe=function(t,e,n){return null},e.register=function(){},e.prototype.getType=function(){if(!this.provider)return ct.baseType;var t=this.provider.getData(this.options);return t?t.dataType:ct.baseType},e.prototype.getOperations=function(){return this.getType().getOperations()},e.prototype.getId=function(){return e.id},e.prototype.merge=function(t){},e.prototype.getSubType=function(t,e,n){return this.getType().getSubType(t,e,n)},e.prototype.getSubTypes=function(t){return this.getType().getSubTypes(t)},e.prototype.getChildType=function(t){return t===e.CHILD_REFERENCED?this.getType():null},e.prototype.getChildTypes=function(){return[e.CHILD_REFERENCED]},e.prototype.getExactType=function(t){return this.getType().getExactType(t)},e.prototype.getSimplifiedType=function(){return this.getType().getSimplifiedType()},e.prototype.isDeepCompatible=function(t,n){return t instanceof e?this.getType().isCompatible(t.getType(),n):this.getType().isCompatible(t,n)},e.prototype.isOptional=function(){return this.getType().isOptional()},e.prototype.isSimple=function(){return this.getType().isSimple()},e.prototype.acceptsOtherTypes=function(){return!0},e.prototype.traverse=function(t){var n=this;return t.enter(this,(function(){return t.step(e.STEP_REFERENCED,n.getType(),(function(t){return t instanceof e?n.options=t.options:0}))}))},e.prototype.getTypeFromStep=function(t){return t===e.STEP_REFERENCED?this.getType():null},e.prototype.setParent=function(t){void 0===t&&(t=null),this.parent=t},e.prototype.removeDescribedRestrictions=function(){},e.prototype.getCreateExpression=function(){return this.getType().getCreateExpression()},e.prototype.getValidateExpression=function(){return this.getType().getValidateExpression()},e.prototype.getCompareExpression=function(){return this.getType().getCompareExpression()},e.prototype.getValueChangeExpression=function(t,e,n){return t},e.prototype.isValid=function(t){return this.getType().isValid(t)},e.prototype.normalize=function(t){return this.getType().normalize(t)},e.prototype.newInstance=function(){return new e(this.options,this.provider)},e.prototype.clone=function(){return new e(this.options,this.provider)},e.prototype.encode=function(){return e.encode(this)},e.prototype.create=function(){return this.getType().create()},e.prototype.random=function(t){return this.getType().random(t)},e.prototype.fromJson=function(t){return this.getType().fromJson(t)},e.prototype.toJson=function(t){return this.getType().toJson(t)},e.STEP_REFERENCED="referenced",e.CHILD_REFERENCED="referenced",e.id=G.Reference,e.operations=new W(G.Reference+G.Delimiter),e.computeds=new H(G.Reference+G.Delimiter),e.baseType=new e("",null),e.describePriority=-1,e.registered=!1,e}(q),Ki=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Xi=function(){function t(t){this.clear(),t&&this.merge(t)}return t.prototype.reset=function(t){this.clear(),this.merge(t)},t.prototype.merge=function(e){var n,r,o,s;if(e instanceof Map)try{for(var a=Ki(e.entries()),u=a.next();!u.done;u=a.next()){var p=zi(u.value,2),c=p[0],f=p[1];this.set(c,f)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}else if(e instanceof t)for(var y=0;y<e.length();y++)this.set(e.keyAt(y),e.valueAt(y));else if(i(e))try{for(var h=Ki(e),d=h.next();!d.done;d=h.next()){var v=zi(d.value,2);c=v[0],f=v[1],this.set(c,f)}}catch(t){o={error:t}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}else if(l(e))for(var c in e)this.set(c,e[c])},t.prototype.sync=function(e,n){var r=this,o=new t(e);this.filter((function(t,e){return o.has(e)})),o.forEach((function(t,e){r.has(e)&&n?n(r.get(e),t):r.set(e,t)}))},t.prototype.clear=function(){this.indexes=Object.create(null),this.keys=[],this.values=[]},t.prototype.length=function(){return this.keys.length},t.prototype.valueAt=function(t){return this.values[t]},t.prototype.keyAt=function(t){return this.keys[t]},t.prototype.pairAt=function(t){return[this.keys[t],this.values[t]]},t.prototype.has=function(t){return o(t)?t in this.indexes:this.values.includes(t)},t.prototype.set=function(t,e){var n=this.indexes[t];r(n)?this.values.splice(n,1,e):(this.indexes[t]=this.values.length,this.values.push(e),this.keys.push(t))},t.prototype.rekey=function(t,e){var n=this.indexOf(t),r=-1!==n;return r&&(delete this.indexes[this.keys[n]],this.indexes[e]=n,this.keys.splice(n,1,e)),r},t.prototype.sort=function(t){this.reset(this.toPairs().sort((function(e,n){var r=zi(e,2),o=(r[0],r[1]),i=zi(n,2),s=(i[0],i[1]);return t(o,s)})))},t.prototype.sortByKey=function(t){void 0===t&&(t=function(t,e){return t.localeCompare(e)}),this.reset(this.toPairs().sort((function(e,n){var r=zi(e,2),o=r[0],i=(r[1],zi(n,2)),s=i[0];return i[1],t(o,s)})))},t.prototype.reindex=function(){for(var t=this.keys,e=Object.create(null),n=0;n<t.length;n++)e[t[n]]=n;this.indexes=e},t.prototype.swap=function(t,e){if(t===e||t<0||e<0||t>=this.keys.length||e>=this.keys.length)return!1;var n=this.keys[t],r=this.values[t],o=this.keys[e],i=this.values[e];return this.indexes[n]=e,this.indexes[o]=t,this.keys.splice(t,1,o),this.keys.splice(e,1,n),this.values.splice(t,1,i),this.values.splice(e,1,r),!0},t.prototype.get=function(t,e){return o(t)?this.values[this.indexes[t]]||e:t},t.prototype.remove=function(t,e){void 0===e&&(e=!1);var n=this.indexOf(t);if(-1!==n){var r=this.keys,o=this.values,i=o[n];if(e)this.removeAt(n);else{delete this.indexes[r[n]];var s=r.pop(),a=o.pop();n!==r.length&&(r.splice(n,1,s),o.splice(n,1,a),this.indexes[s]=n)}return i}},t.prototype.removeAt=function(t){var e=this.keys,n=this.values;if(t<0||t>=e.length)return!1;for(delete this.indexes[e[t]],e.splice(t,1),n.splice(t,1);++t<e.length;)this.indexes[e[t]]--;return!0},t.prototype.move=function(t,e){var n=this.keys,r=this.values;if(t<0||e<0||t>=n.length||e>=n.length)return!1;if(t!==e){var o=r[t],i=n[t];r.splice(t,1),n.splice(t,1),r.splice(e,0,o),n.splice(e,0,i),this.reindex()}return!0},t.prototype.moveToFront=function(t){var e=this.indexOf(t);return-1!==e&&this.move(e,0)},t.prototype.moveToBack=function(t){var e=this.indexOf(t);return-1!==e&&this.move(e,this.keys.length-1)},t.prototype.indexOf=function(t){return o(t)?t in this.indexes?this.indexes[t]:-1:this.values.indexOf(t)},t.prototype.keyOf=function(t){var e=this.values.indexOf(t);return-1===e?void 0:this.keys[e]},t.prototype.toPairs=function(){var t=this;return this.values.map((function(e,n){return[t.keys[n],e]}))},t.prototype.toMap=function(){return new Map(this.toPairs())},t.prototype.toObject=function(){for(var t=Object.create(null),e=0;e<this.keys.length;e++)t[this.keys[e]]=this.values[e];return t},t.prototype.clone=function(){return new t(this)},t.prototype.forEach=function(t){for(var e=this.keys,n=this.values,r=0;r<e.length;){var o=e[r];t(n[r],o),e[r]===o&&r++}},t.prototype.filter=function(t){for(var e=this,n=e.values,r=e.keys,o=e.indexes,i=0,s=0;s<n.length;s++){var a=n[s],u=r[s];t(a,u)?(n[i]=a,r[i]=u,o[u]=i,i++):delete o[u]}i<n.length&&(n.splice(i,n.length-i),r.splice(i,r.length-i))},t}(),$i=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qi=function(t){function e(e){var n=t.call(this)||this;return e&&n.merge(e),n}return $i(e,t),e.isNamedArray=function(t){return i(t)&&t.length>0&&o(t[0].name)},e.prototype.reset=function(t){this.clear(),this.merge(t)},e.prototype.merge=function(n){var r,o;if(e.isNamedArray(n))try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),s=i.next();!s.done;s=i.next()){var a=s.value;this.add(a)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}else t.prototype.merge.call(this,n)},e.prototype.sync=function(n,r){t.prototype.sync.call(this,new e(n),r)},e.prototype.syncManual=function(t,n,r,o,i){var s=this,a=new e(t);return i?b(this.values,a.values,i,(function(t,e){return n(s,e,e.name)}),(function(t,e,n){return r(s,n,n.name)}),(function(t,e,n,r){return o(s,n,r,n.name)})):(this.forEach((function(t,e){var n=a.get(e);void 0===n?r(s,t,e):o(s,t,n,e)})),a.forEach((function(t,e){s.has(e)||n(s,t,e)}))),this},e.prototype.rename=function(t,e){var n=this.get(t),r=!!n&&n.name!==e;return r&&(this.rekey(n,e),n.name=e),r},e.prototype.has=function(t){return this.nameOf(t)in this.indexes},e.prototype.add=function(t){this.set(t.name,t)},e.prototype.nameOf=function(t){return o(t)?t:t.name},e.prototype.valueOf=function(t){return o(t)?this.get(t):t},e.prototype.indexOf=function(t){var e=this.indexes[this.nameOf(t)];return r(e)?e:-1},e.prototype.keyOf=function(t){return t.name},e.prototype.clone=function(){return new e(this)},e}(Xi),Zi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ts=function(){return(ts=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},es=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ns=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},rs=function(t){function e(e){var n=t.call(this)||this;return n.legacy=!1,n.types=Object.create(null),n.typeList=[],n.describers=[],n.expressions=Object.create(null),n.expressionParsers=Object.create(null),n.operations=new W(""),n.computeds=new H(""),n.parsers=Object.create(null),n.entities=new Qi,n.functions=new Qi,n.relations=new Qi,n.programs=new Qi,n.data=new Qi,n.keyExpectedType=Si.many(Si.text(),Si.number()),n.describeExpectedType=Si.text(),e&&n.add(e),n}return Zi(e,t),e.prototype.isLegacy=function(){return this.legacy},e.prototype.setLegacy=function(){this.legacy=!0},e.prototype.encodeMap=function(t,e){return void 0===e&&(e=!0),O(t.toObject(),(function(t){return e?t.encode():t}))},e.prototype.extend=function(t,n){void 0===t&&(t=!1);var r=new e({types:w(this.types),expressions:w(this.expressions),entities:this.encodeMap(this.entities,t),functions:this.encodeMap(this.functions,t),relations:this.encodeMap(this.relations,t),programs:this.encodeMap(this.programs,t),data:this.encodeMap(this.data,t)});return n&&r.add(n),r},e.prototype.changed=function(){this.trigger("changed",this)},e.prototype.add=function(t){var e=this;t.types&&t.types.forEach((function(t){return e.addType(t,!0)})),this.sortDescribers(),t.expressions&&t.expressions.forEach((function(t){return e.addExpression(t)})),this.import(t)},e.prototype.describe=function(t){var e=this,n=new Map,r={describe:function(t){var o,i,s=n.get(t);if(void 0!==s)return s;try{for(var a=es(e.describers),u=a.next();!u.done;u=a.next())if(s=u.value.describe(t,r,n))return s}catch(t){o={error:t}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return ht.baseType},merge:function(t,n){return e.merge(t,n)}};return r.describe(t)},e.prototype.merge=function(t,e){return Si.merge(t,this.describe(e))},e.prototype.sortDescribers=function(){this.describers.sort((function(t,e){return e.describePriority-t.describePriority}))},e.prototype.addType=function(t,e){void 0===e&&(e=!1),this.types[t.id]=t,this.typeList.push(t),this.parsers[t.id]=function(e,n){return t.decode(e,n)},this.describers.push(t),e||this.sortDescribers(),t.registered||(t.registered=!0,t.register())},e.prototype.findEntity=function(t,e){void 0===e&&(e={strict:!0,value:!1,exact:!1});var n=this.entities.values.find((function(n){return n.type.isCompatible(t,e)}));return!!n&&n.name},e.prototype.addData=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Bi?t:Bi.create(this,t),o=this.data.get(r.name);return o?(e?o.sync(r,this):this.data.add(r),this.trigger("updateData",this,r)):(this.data.add(r),this.trigger("addData",this,r)),this.trigger("changedData",this),n||this.changed(),this},e.prototype.getData=function(t){return this.data.get(t,null)},e.prototype.getDatas=function(){return this.data},e.prototype.removeData=function(t,e,n,r){void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.data.valueOf(t);return!o||!(e&&this.getDataReferences(o).length>0)&&(this.data.remove(o,n),this.trigger("removeData",this,o),this.trigger("changedData",this),r||this.changed(),!0)},e.prototype.clearData=function(t){void 0===t&&(t=!1);var e=this.data.values.slice();this.data.clear(),this.trigger("clearData",this,e),this.trigger("changedData",this),t||this.changed()},e.prototype.renameData=function(t,e,n){void 0===n&&(n=!1);var r=this.data.valueOf(t),o=r.name;if(!this.data.rename(r,e))return!1;var i=this.getDataReferences(r);return i.forEach((function(t){t.value instanceof Ji?t.value.options=e:t.value.name=e})),r.trigger("renamed",r,o),r.changed(),this.trigger("renameData",this,r,o),this.trigger("changedData",this),n||this.changed(),i},e.prototype.addFunction=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof ji?t:ji.create(this,t),o=this.functions.get(r.name);return o?(e?o.sync(r,this):this.functions.add(r),this.trigger("updateFunction",this,r)):(this.functions.add(r),this.trigger("addFunction",this,r)),this.trigger("changedFunctions",this),n||this.changed(),this},e.prototype.getFunction=function(t){return this.functions.get(t,null)},e.prototype.getFunctions=function(){return this.functions},e.prototype.addProgram=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Wi?t:Wi.create(this,t),o=this.programs.get(r.name);return o?(e?o.sync(r,this):this.programs.add(r),this.trigger("updateProgram",this,r)):(this.programs.add(r),this.trigger("addProgram",this,r)),this.trigger("changedPrograms",this),n||this.changed(),this},e.prototype.getProgram=function(t){return this.programs.get(t,null)},e.prototype.getPrograms=function(){return this.programs},e.prototype.removeProgram=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r=this.programs.valueOf(t);return!r||(this.programs.remove(r,e),this.trigger("removeProgram",this,r),this.trigger("changedPrograms",this),n||this.changed(),!0)},e.prototype.clearPrograms=function(t){void 0===t&&(t=!1);var e=this.programs.values.slice();this.programs.clear(),this.trigger("clearPrograms",this,e),this.trigger("changedPrograms",this),t||this.changed()},e.prototype.addEntity=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Li?t:Li.create(this,t),o=this.entities.get(r.name);return o?(e?o.sync(r,this):this.entities.add(r),this.trigger("updateEntity",this,r)):(this.entities.add(r),this.trigger("addEntity",this,r)),this.trigger("changedEntities",this),n||this.changed(),this},e.prototype.getEntity=function(t){return this.entities.get(t,null)},e.prototype.getEntities=function(){return this.entities},e.prototype.addRelation=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var r=t instanceof Fi?t:new Fi(this,t),o=this.relations.get(r.name);return o?(e?o.sync(r,this):this.relations.add(r),this.trigger("updateRelation",this,r)):(this.relations.add(r),this.trigger("addRelation",this,r)),this.trigger("changedRelations",this),n||this.changed(),this},e.prototype.getRelation=function(t){return this.relations.get(t,null)},e.prototype.getRelations=function(t){var e=[];return this.relations.forEach((function(n){var r=n.getSubjectRelation(t);r&&e.push(r);var o=n.getRelatedRelation(t);o&&e.push(o)})),e},e.prototype.getEntityProps=function(t){var e=[],n=this.entities.get(t);return n&&(e.push(n.getEntityProps()),this.relations.forEach((function(n){e.push.apply(e,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ns(arguments[e]));return t}(n.getTypeProps(t)))}))),e},e.prototype.removeRelation=function(t,e,n,r){void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.relations.valueOf(t);return!o||!(e&&this.getRelationReferences(o).length>0)&&(this.relations.remove(o,n),this.trigger("removeRelation",this,o),this.trigger("changedRelations",this),r||this.changed(),!0)},e.prototype.clearRelations=function(t){void 0===t&&(t=!1);var e=this.relations.values.slice();this.relations.clear(),this.trigger("clearRelations",this,e),this.trigger("changedRelations",this),t||this.changed()},e.prototype.renameProgram=function(t,e,n){void 0===n&&(n=!1);var r=this.programs.valueOf(t),o=r.name;return!!this.programs.rename(r,e)&&(r.trigger("renamed",r,o),r.changed(),this.trigger("renameProgram",this,r,o),this.trigger("changedPrograms",this),n||this.changed(),!0)},e.prototype.renameEntity=function(t,e,n){void 0===n&&(n=!1);var r=this.entities.valueOf(t),o=r.name;if(!this.entities.rename(r,e))return!1;this.relations.forEach((function(t){t.rename(name,e)}));var i=this.getEntityReferences(name);return i.forEach((function(t){t.value instanceof Oe?t.value.options=e:t.value.name=e})),this.getMethodReferences(name).forEach((function(t){t.value.name=e})),r.trigger("renamed",r,o),r.changed(),this.trigger("renameEntity",this,r,o),this.trigger("changedEntities",this),n||this.changed(),i},e.prototype.renameEntityProp=function(t,e,n){var r=this.entities.get(t);r&&(r.renameProp(e,n),this.relations.forEach((function(t){t.renameProp(r.name,e,n)})))},e.prototype.removeEntityProp=function(t,e){var n=this,r=this.entities.get(t);r&&(r.removeProp(e),this.relations.forEach((function(t){t.removeProp(r.name,e),t.isEmpty()&&n.relations.remove(t)})))},e.prototype.removeEntity=function(t,e,n,r){var o=this;void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.entities.valueOf(t);return!i||!(e&&this.getEntityReferences(i).length>0)&&(this.entities.remove(i,n),this.relations.forEach((function(t){t.remove(name),t.isEmpty()&&o.relations.remove(t,n)})),this.trigger("removeEntity",this,i),this.trigger("changedEntities",this),r||this.changed(),!0)},e.prototype.clearEntities=function(t){void 0===t&&(t=!1);var e=this.entities.values.slice();this.entities.clear(),this.trigger("clearEntities",this,e),this.trigger("changedEntities",this),t||this.changed()},e.prototype.refactorEntity=function(t,e,n){var r=this.getEntityDataReferences(t);return r.forEach((function(t){t.root.setParent();var r=t.type.getValueChangeAt(e);t.data=n.run(r,{value:t.data})})),r},e.prototype.renameRelation=function(t,e,n){void 0===n&&(n=!1);var r=this.relations.valueOf(t),o=r.name;if(!this.relations.rename(r,e))return!1;var i=this.getRelationReferences(r);return i.forEach((function(t){t.value.name=e})),r.trigger("renamed",r,o),r.changed(),this.trigger("renameRelation",this,r,o),this.trigger("changedRelations",this),n||this.changed(),i},e.prototype.renameFunction=function(t,e,n){void 0===n&&(n=!1);var r=this.functions.valueOf(t),o=r.name;if(!this.functions.rename(r,e))return!1;var i=this.getFunctionReferences(r);return i.forEach((function(t){t.value.name=e})),r.trigger("renamed",r,o),r.changed(),this.trigger("renameFunction",this,r,o),this.trigger("changedFunctions",this),n||this.changed(),i},e.prototype.renameFunctionParameter=function(t,e,n){var r=this.functions.get(t);if(!r)return!1;if(!r.renameParameter(e,n))return!1;var o=this.getFunctionReferences(t,e);return o.forEach((function(t){$.objectSet(t.value.args,n,t.value.args[e]),$.objectRemove(t.value.args,e)})),o},e.prototype.removeFunctionParameter=function(t,e){var n=this.functions.get(t);if(!n)return!1;if(!n.removeParameter(e))return!1;var r=this.getFunctionReferences(t,e);return r.forEach((function(t){$.objectRemove(t.value.args,e)})),r},e.prototype.removeFunction=function(t,e,n,r){void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.functions.valueOf(t);return!o||!(e&&this.getFunctionReferences(o).length>0)&&(this.functions.remove(o,n),this.trigger("removeFunction",this,o),this.trigger("changedFunctions",this),r||this.changed(),!0)},e.prototype.clearFunctions=function(t){void 0===t&&(t=!1);var e=this.functions.values.slice();this.functions.clear(),this.trigger("clearFunctions",this,e),this.trigger("changedFunctions",this),t||this.changed()},e.prototype.addMethod=function(t,e,n,r){void 0===n&&(n=!0),void 0===r&&(r=!1);var o=this.entities.valueOf(t);if(!o)return!1;var i=e instanceof ji?e:ji.create(this,e),s=o.methods[i.name];return s?(n?s.sync(i,this):o.addMethod(i),this.trigger("updateMethod",this,i,o)):(o.addMethod(i),this.trigger("addMethod",this,i,o)),this.trigger("changedMethods",this),r||this.changed(),!0},e.prototype.renameMethod=function(t,e,n,r){void 0===r&&(r=!1);var o=this.entities.valueOf(t);if(!o)return!1;var i=o.methods[this.functions.nameOf(e)];if(!i)return!1;var s=i.name;o.renameMethod(s,n);var a=this.getMethodReferences(o,i);return a.forEach((function(t){t.value.name=n})),i.trigger("renamed",i,s),i.changed(),this.trigger("renameMethod",this,i,o,s),this.trigger("changedMethods",this),r||this.changed(),a},e.prototype.renameMethodParameter=function(t,e,n,r){var o=this.entities.valueOf(t);if(!o)return!1;var i=o.methods[this.functions.nameOf(e)];if(!i)return!1;if(!i.renameParameter(n,r))return!1;var s=this.getMethodReferences(t,e,n);return s.forEach((function(t){$.objectSet(t.value.args,r,t.value.args[n]),$.objectRemove(t.value.args,n)})),s},e.prototype.removeMethodParameter=function(t,e,n){var r=this.entities.valueOf(t);if(!r)return!1;var o=r.methods[this.functions.nameOf(e)];if(!o)return!1;if(!o.removeParameter(n))return!1;var i=this.getMethodReferences(t,e,n);return i.forEach((function(t){$.objectRemove(t.value.args,n)})),i},e.prototype.removeMethod=function(t,e,n,r,o){void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===o&&(o=!1);var i=this.entities.valueOf(t);if(!i)return!1;var s=i.methods[this.functions.nameOf(e)];return!(!s||n&&this.getMethodReferences(t,e).length>0||(i.removeMethod(s.name),this.trigger("removeMethod",this,s,i),this.trigger("changedMethods",this),o||this.changed(),0))},e.prototype.getTypeKind=function(t,e,n){void 0===n&&(n=null);var r=this.getType(t);return r instanceof e?r:n},e.prototype.getType=function(t,e){if(t instanceof q)return t;var n=i(t)?t[0]:t,r=i(t)?t:[],o=this.parsers[n];if(!o){if(this.entities.has(n))return this.entities.get(n).type;if(e)return e;throw new Error("No parser found for "+n+" with payload "+JSON.stringify(r))}return o(r,this)},e.prototype.getBaseTypes=function(){return this.typeList.map((function(t){return t.baseType}))},e.prototype.getSimpleTypes=function(){return this.getBaseTypes().filter((function(t){return t.isSimple()}))},e.prototype.getComplexTypes=function(){return this.getBaseTypes().filter((function(t){return!t.isSimple()}))},e.prototype.getSimpleTypeClasses=function(){return this.typeList.filter((function(t){return t.baseType.isSimple()}))},e.prototype.getComplexTypeClasses=function(){return this.typeList.filter((function(t){return!t.baseType.isSimple()}))},e.prototype.getComputed=function(t){var e=this.computeds.get(t);if(e)return e;var n=ns(t.split(G.Delimiter),1)[0],r=this.types[n];return r?r.computeds.get(t):null},e.prototype.getComputedReturnType=function(t,e){var n;void 0===e&&(e=null);var r=this.getComputed(t);if(!r)return null;var o=this.getOperation(r.op),i=this.getOperationTypes(r.op);return o&&i?this.getOperationInputType(i.returnType,((n={})[r.value]=e,n)):null},e.prototype.getComputedsFor=function(t){var e=this.types[t.getId()];return e?e.computeds.list:[]},e.prototype.hasComputed=function(t,e){var n=this.types[t.getId()];return!!n&&!!n.computeds.get(e)},e.prototype.getOperation=function(t){var e=this.operations.get(t);if(e)return e;var n=ns(t.split(G.Delimiter),1)[0],r=this.types[n];return r?r.operations.get(t):null},e.prototype.getOperationTypes=function(t){var e=this.operations.getTypes(t);if(e)return e;var n=ns(t.split(G.Delimiter),1)[0],r=this.types[n];return r?r.operations.getTypes(t):null},e.prototype.getOperationReturnType=function(t,e,n,r){var o=this.getOperation(t),i=this.getOperationTypes(t);if(!o||!i)return null;var s=i.returnType;if(s instanceof q)return s;if(!V(s))return s.baseType.newInstance();var a=o.resultDependency.length>0?this.getOperationParamTypes(t,e,n,r,i.rawTypes):{};return this.getOperationInputType(i.returnType,a)},e.prototype.getOperationExpectedTypes=function(t,e,n,r,o){var i=this;void 0===o&&(o=!1);var s=this.getOperationTypes(t);if(!s)return{};var a=this.getOperationParamTypes(t,e,n,r,o);return O(a,(function(t,e){return i.getOperationInputType(s.params[e]||s.optional[e]||t,a)}))},e.prototype.getOperationParamTypes=function(t,e,n,r,o){var i,s,a,u,p,c;void 0===o&&(o=!1);var l={},f=this.getOperation(t),y=this.getOperationTypes(t);if(!f||!y)return l;for(var h in e)-1===f.hasScope.indexOf(h)&&(O=e[h].getType(this,r))&&(l[h]=o?O:O.getSimplifiedType());var d=this.getContextWithScope(r),v=d.context,m=d.scope;try{for(var g=es(f.scope),T=g.next();!T.done;T=g.next()){var b=T.value,x=this.getOperationInputType(y.scope[b],l);x&&(m[n[b]||b]=o?x:x.getSimplifiedType())}}catch(t){i={error:t}}finally{try{T&&!T.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}for(var h in e){var O;-1!==f.hasScope.indexOf(h)&&(O=e[h].getType(this,v))&&(l[h]=o?O:O.getSimplifiedType())}try{for(var E=es(f.params),w=E.next();!w.done;w=E.next())l[h=w.value]||(l[h]=this.getOperationInputType(y.params[h],l))}catch(t){a={error:t}}finally{try{w&&!w.done&&(u=E.return)&&u.call(E)}finally{if(a)throw a.error}}try{for(var S=es(f.optional),P=S.next();!P.done;P=S.next())l[h=P.value]||(l[h]=this.getOperationInputType(y.optional[h],l))}catch(t){p={error:t}}finally{try{P&&!P.done&&(c=S.return)&&c.call(S)}finally{if(p)throw p.error}}return l},e.prototype.getOperationScopeContext=function(t,e,n,r){var o,i,s=this.getOperation(t),a=this.getOperationTypes(t),u=this.getContextWithScope(r),p=u.context,c=u.scope;try{for(var l=es(s.scope),f=l.next();!f.done;f=l.next()){var y=f.value,h=this.getOperationInputType(a.scope[y],e);h&&(c[n[y]||y]=h.getSimplifiedType())}}catch(t){o={error:t}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return p},e.prototype.getContextWithScope=function(t,e){return void 0===e&&(e={}),{context:t instanceof be?new be({props:e=ts(ts({},t.options.props),e)}):new ko([new be({props:e}),t]),scope:e}},e.prototype.getContext=function(t,e){return this.getContextWithScope(t,e).context},e.prototype.getOperationMapping=function(t,e,n){var r,o,i,s,a=this,u=this.getOperation(t),p=this.getOperationTypes(n),c=u.params.concat(u.optional),l=this.getOperation(n),f=this.getOperationTypes(n),y=Object.create(null),h=Object.create(null),d=w(e,(function(t,e){return[e,t,c.indexOf(e)]})).filter((function(t){return ns(t,3)[2]>=0})).sort((function(t,e){return ns(t,3)[2]-ns(e,3)[2]})),v=function(t,e){if(0===d.length)return null;var n=-1;if(V(e))-1===(n=d.findIndex((function(n){var r,o=ns(n,2)[1];return o.acceptsType(Si.parse(e(ts(ts({},h),((r={})[t]=o,r)),a)))})))&&(n=d.findIndex((function(n){var r,o=ns(n,2)[1];return Si.parse(e(ts(ts({},h),(r={},r[t]=o,r)),a)).acceptsType(o)})));else{var r=Si.parse(e);n=d.findIndex((function(t){var e=ns(t,2)[1];return r.acceptsType(e)}))}if(-1===n)return null;var o=d[n];d.splice(n,1),y[o[0]]=t,h[t]=o[1]};try{for(var m=es(l.params),g=m.next();!g.done;g=m.next()){var T=g.value;if(null===v(T,f.params[T]))return null}}catch(t){r={error:t}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var b=es(l.optional),x=b.next();!x.done;x=b.next()){var O=x.value;v(O,f.optional[O])}}catch(t){i={error:t}}finally{try{x&&!x.done&&(s=b.return)&&s.call(b)}finally{if(i)throw i.error}}var E=d.map((function(t){return ns(t,1)[0]}));return{from:u,fromTypes:p,to:l,toTypes:f,mapping:y,unmapped:E}},e.prototype.getOperationInputType=function(t,e){return t instanceof q?t:"baseType"in t?t.baseType.clone():e?Si.parse(t(e,this)):null},e.prototype.getOperationsForExpression=function(t,e){var n=t.getType(this,e);return n?this.getOperationsForType(n.getSimplifiedType()):[]},e.prototype.getOperationsWithMapping=function(t,e){var n=this;return this.getOperations().map((function(r){var o=r.op;return n.getOperationMapping(t,e,o.id)})).filter((function(t){return!!t}))},e.prototype.getOperationsForType=function(t,e){var n=this;return void 0===e&&(e=!1),this.getOperations((function(r){var o,i=r.op,s=r.types,a=i.params[0],u=s.params[a];if(u){var p=n.getOperationInputType(u,((o={})[a]=t,o));if(p){if(t.acceptsType(p))return!0;if(e&&i.resultDependency.length>0&&V(s.returnType)&&(p instanceof ht||p instanceof ct))return!0}}return!1}))},e.prototype.getOperationsWithReturnExpression=function(t,e,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var o=t.getType(this,e);return o?this.getOperationsWithReturnType(o.getSimplifiedType(),n,r):[]},e.prototype.getOperationsWithReturnType=function(t,e,n){var r=this;return void 0===e&&(e={}),void 0===n&&(n=!1),this.getOperations((function(o){var i=o.op,s=o.types,a=r.getOperationInputType(s.returnType,e);if(a){if(t.acceptsType(a))return!0;if(n&&i.resultDependency.length>0&&V(s.returnType)&&(a instanceof ht||a instanceof ct))return!0}return!1}))},e.prototype.getOperationsForParamExpressions=function(t,e){var n=this;return this.getOperationsForParamTypes(O(t,(function(t){var r=t.getType(n,e);return r?r.getSimplifiedType():void 0})))},e.prototype.getOperationsForParamTypes=function(t){var e=this,n=Object.keys(t);return this.getOperations((function(r){var o,i,s=r.types;try{for(var a=es(n),u=a.next();!u.done;u=a.next()){var p=u.value,c=s.params[p]||s.optional[p];if(!c)return!1;var l=e.getOperationInputType(c,t);if(!l||!t[p].acceptsType(l))return!1}}catch(t){o={error:t}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return!0}))},e.prototype.getOperations=function(t){void 0===t&&(t=function(){return!0});var e=[],n=function(n){var r=n.map;for(var o in r){var i={op:r[o],types:n.types[o]};t(i)&&e.push(i)}};return n(this.operations),E(this.types,(function(t){return n(t.operations)})),e},e.prototype.getPathType=function(t,e,n){if(void 0===n&&(n=t.length),0===t.length)return null;var r=t[0].getType(this,e);if(!r)return null;for(var o=r.isOptional(),i=1;i<n;i++){var s=t[i];if(!(r=s.isPathNode()?s.getType(this,e,r):r.getSubType(s,this,e)))return null;o=o||r.isOptional()}return o&&!r.isOptional()?Si.optional(r):r},e.prototype.addExpression=function(t){this.expressions[t.id]=t,this.expressionParsers[t.id]=function(e,n){return t.decode(e,n)}},e.prototype.getExpressionKind=function(t,e,n){void 0===n&&(n=null);var r=this.getExpression(t);return r instanceof e?r:n},e.prototype.getExpression=function(t){if(t instanceof F)return t;if(i(t)){var e=this.expressionParsers[t[0]];if(!e)throw new Error("An expression was not found for: "+JSON.stringify(t));return e(t,this)}return new Kt(t)},e.prototype.isExpression=function(t){return t instanceof F||i(t)&&o(t[0])&&t[0]in this.expressions},e.prototype.getEntityReferences=function(t){var e=t?this.entities.nameOf(t):void 0,n=this.getTypeClassReferences(Oe).filter((function(t){return!e||e===t.value.options})),r=this.getExpressionClassReferences(we).filter((function(t){return!e||e===t.value.name}));return n.concat(r)},e.prototype.getDataReferences=function(t){var e=t?this.data.nameOf(t):void 0,n=this.getTypeClassReferences(Ji).filter((function(t){return!e||e===t.value.options})),r=this.getExpressionClassReferences(ue).filter((function(t){return!e||e===t.value.name}));return n.concat(r)},e.prototype.getEntityDataReferences=function(t){var e=t?this.entities.nameOf(t):void 0;return this.getDataTypeClassReferences(Oe).filter((function(t){return!e||e===t.type.options}))},e.prototype.getRelationReferences=function(t){var e=t?this.relations.nameOf(t):void 0;return this.getExpressionClassReferences(Pe).filter((function(t){return!e||e===t.value.name}))},e.prototype.getFunctionReferences=function(t,e){var n=t?this.functions.nameOf(t):void 0;return this.getExpressionClassReferences(Ne).filter((function(t){return!(n&&n!==t.value.name||e&&!(e in t.value.args))}))},e.prototype.getMethodReferences=function(t,e,n){var r=t?this.entities.nameOf(t):void 0,o=e?this.functions.nameOf(e):void 0;return this.getExpressionClassReferences(Le).filter((function(t){return!(r&&r!==t.value.entity||o&&o!==t.value.name||n&&!(n in t.value.args))}))},e.prototype.getTypeClassReferences=function(t){var e=[];return this.getTypeInstances().forEach((function(n){n.type.traverse(new L((function(r){r instanceof t&&e.push({value:r,root:n.type,source:n.source})})))})),e},e.prototype.getDataTypeClassReferences=function(t){var e=[];return this.getDataInstances().forEach((function(n){n.type.traverse(new L((function(r){r instanceof t&&e.push({type:r,data:n.data,root:n.type,source:n.source})})))})),e},e.prototype.getExpressionClassReferences=function(t){var e=[];return this.getExpressionInstances().forEach((function(n){n.expr.traverse(new L((function(r){r instanceof t&&e.push({value:r,root:n.expr,source:n.source})})))})),e},e.prototype.getDataInstances=function(){var t=[];return this.programs.forEach((function(e){e.datasets.forEach((function(n){t.push({data:n.data,type:e.dataType,source:[e,n]})}))})),this.functions.forEach((function(e){var n=e.type.getReturnType();e.tests.forEach((function(r){t.push({data:r.args,type:e.type.getParamTypesType(),source:[e,r,"args"]}),t.push({data:r.expected,type:n,source:[e,r,"expected"]})}))})),this.data.forEach((function(e){t.push({data:e.data,type:e.dataType,source:e})})),this.entities.forEach((function(e){e.instances&&e.instances.length>0&&t.push({data:e.instances,type:Si.list(e.type),source:e}),E(e.methods,(function(n){var r=n.type.getReturnType();n.tests.forEach((function(o){t.push({data:o.args,type:n.type.getParamTypesType(),source:[e,n,o,"args"]}),t.push({data:o.expected,type:r,source:[e,n,o,"expected"]})}))}))})),t},e.prototype.getTypeInstances=function(t){void 0===t&&(t=!1);var e=[];return this.programs.forEach((function(t){e.push({type:t.dataType,source:t})})),this.functions.forEach((function(t){e.push({type:t.type,source:[t]})})),this.data.forEach((function(t){e.push({type:t.dataType,source:t})})),this.entities.forEach((function(n){e.push({type:n.type,source:n}),E(n.methods,(function(t){e.push({type:t.type,source:[n,t]})})),t&&(n.key!==ft.instance&&e.push({type:n.getKeyContext(),source:[n,"key"]}),n.describe!==ft.instance&&e.push({type:n.getDescribeContext(),source:[n,"describe"]})),E(n.transcoders,(function(t,r){e.push({type:t.encodedType,source:[n,r,t]})}))})),t&&this.relations.forEach((function(t){t.morphs&&e.push({type:t.morphs[1],source:t})})),e},e.prototype.getExpressionInstances=function(){var t=this,e=[];return this.programs.forEach((function(t){e.push({context:t.dataType,expr:t.expression,source:t})})),this.functions.forEach((function(t){e.push({context:t.type.getParamTypesType(),expr:t.expression,source:t})})),this.entities.forEach((function(n){E(n.methods,(function(t){e.push({context:t.type.getParamTypesType(),expr:t.expression,source:[n,t]})})),n.canStore(t)&&(e.push({context:n.getKeyContext(),expr:n.key,source:[n,"key"]}),e.push({context:n.getDescribeContext(),expr:n.describe,source:[n,"describe"]}),E(n.transcoders,(function(t,r){e.push({context:n.getEncodeContext(r),expr:t.encode,source:[n,r,t,"encode"]}),e.push({context:n.getDecodeContext(r),expr:t.decode,source:[n,r,t,"decode"]})})))})),e},e.prototype.export=function(){return{entities:this.encodeMap(this.entities),functions:this.encodeMap(this.functions),relations:this.encodeMap(this.relations),programs:this.encodeMap(this.programs),data:this.encodeMap(this.data)}},e.prototype.sync=function(t){var e=this;t.data&&this.data.syncManual(t.data,(function(t,n){return e.addData(n,!1,!0)}),(function(t,n){return e.removeData(n,!1,!0,!0)}),(function(t,n,r){return e.addData(r,!0,!0)})),t.functions&&this.functions.syncManual(t.functions,(function(t,n){return e.addFunction(n,!1,!0)}),(function(t,n){return e.removeFunction(n,!1,!0,!0)}),(function(t,n,r){return e.addFunction(r,!0,!0)})),t.entities&&this.entities.syncManual(t.entities,(function(t,n){return e.addEntity(n,!1,!0)}),(function(t,n){return e.removeEntity(n,!1,!0,!0)}),(function(t,n,r){return e.addEntity(r,!0,!0)})),t.relations&&this.relations.syncManual(t.relations,(function(t,n){return e.addRelation(n,!1,!0)}),(function(t,n){return e.removeRelation(n,!1,!0,!0)}),(function(t,n,r){return e.addRelation(r,!0,!0)})),t.programs&&this.programs.syncManual(t.programs,(function(t,n){return e.addProgram(n,!1,!0)}),(function(t,n){return e.removeProgram(n,!0,!0)}),(function(t,n,r){return e.addProgram(r,!0,!0)}))},e.prototype.import=function(t){var e=this;t.data&&E(t.data,(function(t){return e.addData(t)})),t.functions&&E(t.functions,(function(t){return e.addFunction(t)})),t.entities&&E(t.entities,(function(t){return e.addEntity(t)})),t.relations&&E(t.relations,(function(t){return e.addRelation(t)})),t.programs&&E(t.programs,(function(t){return e.addProgram(t)}))},e}(Mi),os=function(){function t(e){this.defs=e,this.ops=Object.create(null),this.exprs=Object.create(null),this.flowProperty=t.DEFAULT_RETURN_PROPERTY}return t.prototype.extend=function(e){var n=new t(e||this.defs);return Object.assign(n.ops,this.ops),Object.assign(n.exprs,this.exprs),n.flowProperty=this.flowProperty,n},t.prototype.setOperation=function(t,e){return this.ops[t.id]=e,this},t.prototype.setExpression=function(t,e){return this.exprs[t.id]=e,this},t.prototype.getFunction=function(t){return this.defs.getFunction(t)},t.prototype.getOperation=function(t){return this.ops[t]},t.prototype.getComputed=function(t){return this.defs.getComputed(t)},t.prototype.getOperationScopeDefaults=function(t){var e=this.defs.getOperation(t);return e?e.scopeDefaults:{}},t.prototype.getExpression=function(t){return this.exprs[t]},t.prototype.getCommand=function(t,e){return void 0===e&&(e=this),this.exprs[t.getId()](t,e)},t.prototype.run=function(t,e,n){return void 0===n&&(n=this),this.eval(t,n)(e)},t.prototype.eval=function(t,e){return void 0===e&&(e=this),i(t)?this.getCommand(this.defs.getExpression(t),e):t instanceof F?this.getCommand(t,e):function(){return t}},t.DEFAULT_RETURN_PROPERTY="$$flow",t}(),is=new rs({types:[Oe,ht,Z,fi,jo,Ut,Re,De,mn,ko,Vo,Go,ct,An,be,Wo,Ji,Ei,qt,xn],expressions:[rt,_n,St,_t,re,Kt,Tt,Ot,se,Mn,Ct,ue,we,Pe,Me,Ne,Le,ft,et,Sn,We,Fe,ee,Ge,Xt,Ke,Xe,En,Xt,Ze]}),ss=Oe.operations,as=function(t,e){return t.name instanceof Oe?t.name:be.baseType},us=function(t,e){if(t.name instanceof Oe)return t.name;var n=e.getEntities().values.map((function(t){return new Oe(t.name,e)}));return 0===n.length?ct.baseType:1===n.length?n[0]:Si.many(n)},ps=function(t,e){if(!(t.name instanceof Oe))return null;var n=e.getRelations(t.name.options);if(t.relation instanceof Ut){var r=t.relation.options.constants.get("relation");if(r){var o=n.find((function(t){return t.name===r}));if(o)return o}}return n},cs=function(t,e){var n=ps(t,e);return null===n?ct.baseType:i(n)?Si.many(n.map((function(t){return Si.enum(qt,qt,[["relation",t.name]])}))):t.relation},ls=function(t,e){var n=ps(t,e);return null===n||i(n)?ct.baseType:t.related&&n.relationType.acceptsType(t.related)?t.related:n.relationType},fs=function(t,e){var n=ps(t,e);return null===n||i(n)?ct.baseType:t.related&&n.itemType.acceptsType(t.related)?t.related:n.itemType},ys={newInstance:ss.setTypes(fe.newInstance,as,{name:us},{initial:function(t,e){if(t.name instanceof Oe){var n=t.name.getType();if(n instanceof be){var r=n;return Si.object(O(r.options.props,(function(t){return Si.optional(t.clone())})))}}return be.baseType}}),get:ss.setTypes(fe.get,(function(t,e){if(!(t.name instanceof Oe))return ht;var n=e.getEntity(t.name.options);return n?Si.list(n.type):ht}),{name:us},{where:Z},{instance:as}),getKey:ss.setTypes(fe.getKey,(function(t,e){if(!(t.name instanceof Oe))return ht;var n=e.getEntity(t.name.options);return n&&n.key?n.keyType:ht}),{name:us,instance:as}),save:ss.setTypes(fe.save,Z,{name:us,instance:as}),remove:ss.setTypes(fe.remove,Z,{name:us,instance:as}),setRelated:ss.setTypes(fe.setRelated,An,{name:us,instance:as,relation:cs,related:ls}),addRelated:ss.setTypes(fe.addRelated,An,{name:us,instance:as,relation:cs,related:fs}),removeRelated:ss.setTypes(fe.removeRelated,An,{name:us,instance:as,relation:cs,related:fs}),clearRelated:ss.setTypes(fe.clearRelated,An,{name:us,instance:as,relation:cs}),getRelated:ss.setTypes(fe.getRelated,(function(t,e){return ls(t,e)}),{name:us,instance:as,relation:cs}),isRelated:ss.setTypes(fe.isRelated,An,{name:us,instance:as,relation:cs,related:fs})};ys.newInstance.rawTypes=!0,ys.get.rawTypes=!0,ys.getKey.rawTypes=!0,ys.save.rawTypes=!0,ys.remove.rawTypes=!0,ys.setRelated.rawTypes=!0,ys.addRelated.rawTypes=!0,ys.removeRelated.rawTypes=!0,ys.clearRelated.rawTypes=!0,ys.getRelated.rawTypes=!0,ys.isRelated.rawTypes=!0;var hs=ht.operations,ds={cmp:hs.setTypes(ut.cmp,An,{value:ht,test:ht}),copy:hs.setTypes(ut.copy,ht,{value:ht}),isDefined:hs.setTypes(ut.isDefined,Z,{value:ht}),getDefined:hs.setTypes(ut.getDefined,Z,{value:ht,defined:ht},{},{defined:function(t){return t.value instanceof Wo?t.value.options:t.value}}),coalesce:hs.setTypes(ut.coalesce,(function(t){return Si.coalesce([t.a,t.b,t.c,t.d,t.e])}),{a:ht,b:ht},{c:ht,d:ht,e:ht}),require:hs.setTypes(ut.require,(function(t){return t.value instanceof Wo?t.value.options:t.value||ht}),{value:function(t){return t.value||ht}}),ternary:hs.setTypes(ut.ternary,(function(t){return t.truthy&&t.falsy?Si.mergeMany([t.truthy,t.falsy]):t.truthy?t.truthy:t.falsy?t.falsy:ht}),{condition:Z,truthy:function(t){return t.truthy||ht},falsy:function(t){return t.falsy||ht}}),isValid:hs.setTypes(ut.isValid,Z,{value:ht}),isEqual:hs.setTypes(ut.isEqual,Z,{value:ht,test:ht}),isNotEqual:hs.setTypes(ut.isNotEqual,Z,{value:ht,test:ht}),isLess:hs.setTypes(ut.isLess,Z,{value:ht,test:ht}),isLessOrEqual:hs.setTypes(ut.isLessOrEqual,Z,{value:ht,test:ht}),isGreater:hs.setTypes(ut.isGreater,Z,{value:ht,test:ht}),isGreaterOrEqual:hs.setTypes(ut.isGreaterOrEqual,Z,{value:ht,test:ht}),asAny:hs.setTypes(ut.asAny,(function(t){return t.value||ht}),{value:ht}),asBoolean:hs.setTypes(ut.asBoolean,Z,{value:ht}),asColor:hs.setTypes(ut.asColor,fi,{value:ht}),asDate:hs.setTypes(ut.asDate,jo,{value:ht}),asList:hs.setTypes(ut.asList,(function(t){return mn.forItem(t.value||ht)}),{value:ht}),asMap:hs.setTypes(ut.asMap,(function(t){return Vo.forItem(t.value||ht)}),{value:ht}),asNumber:hs.setTypes(ut.asNumber,An,{value:ht}),asObject:hs.setTypes(ut.asObject,be,{value:ht}),asText:hs.setTypes(ut.asText,qt,{value:ht}),asTuple:hs.setTypes(ut.asTuple,(function(t){return xn.forItem([t.value||ht])}),{value:ht}),asSet:hs.setTypes(ut.asSet,(function(t){return Ei.forItem(t.value||ht)}),{value:ht})},vs=Z.operations,ms={create:vs.setTypes(K.create,Z),maybe:vs.setTypes(K.maybe,(function(t){return Si.maybe(t.value,Z)}),{value:ht}),and:vs.setTypes(K.and,Z,{a:Z,b:Z}),or:vs.setTypes(K.or,Z,{a:Z,b:Z}),xor:vs.setTypes(K.xor,Z,{a:Z,b:Z}),not:vs.setTypes(K.not,Z,{a:Z}),cmp:vs.setTypes(K.cmp,An,{value:Z,test:Z}),isValid:vs.setTypes(K.isValid,Z,{value:ht}),isTrue:vs.setTypes(K.isTrue,Z,{value:Z}),isFalse:vs.setTypes(K.isFalse,Z,{value:Z}),isEqual:vs.setTypes(K.isEqual,Z,{value:Z,test:Z}),isNotEqual:vs.setTypes(K.isNotEqual,Z,{value:Z,test:Z}),asAny:vs.setTypes(K.asAny,ht,{value:Z}),asBoolean:vs.setTypes(K.asBoolean,(function(t){return t.value||Z}),{value:Z}),asColor:vs.setTypes(K.asColor,fi,{value:Z}),asDate:vs.setTypes(K.asDate,jo,{value:Z}),asList:vs.setTypes(K.asList,(function(t){return mn.forItem(t.value||Z)}),{value:Z}),asMap:vs.setTypes(K.asMap,(function(t){return Vo.forItem(t.value||Z)}),{value:Z}),asNumber:vs.setTypes(K.asNumber,An,{value:Z}),asObject:vs.setTypes(K.asObject,be,{value:Z}),asText:vs.setTypes(K.asText,qt,{value:Z}),asTuple:vs.setTypes(K.asTuple,(function(t){return xn.forItem([t.value||Z])}),{value:Z}),asSet:vs.setTypes(K.asSet,(function(t){return Ei.forItem(t.value||ht)}),{value:Z})},gs=fi.operations,Ts=new Ut({key:qt.baseType,value:qt.baseType,constants:new Map([["r","r"],["g","g"],["b","b"],["a","a"]])}),bs=new ko([fi.baseType,new An({})]),xs=new Ut({key:qt.baseType,value:qt.baseType,constants:new Map([["Best Fit: #rrggbb or rgb()","rgb:bestfit"],["#rgb","rgb:hexShort"],["#rrggbb","rgb:hex"],["#rrggbbaa","rgb:hexLong"],["rgb(r, g, b)","rgb:rgb"],["rgba(r, g, b, a)","rgb:rgba"],["hsl(h, s, l)","hsl:hsl"],["hsla(h, s, l, a)","hsl:hsla"]])}),Os=new Ut({key:qt.baseType,value:fi.baseType,constants:new Map([["Transparent",{r:255,g:255,b:255,a:0}],["Alice Blue",{r:240,g:248,b:255,a:255}],["Antique White",{r:250,g:235,b:215,a:255}],["Aqua",{r:0,g:255,b:255,a:255}],["Aquamarine",{r:127,g:255,b:212,a:255}],["Azure",{r:240,g:255,b:255,a:255}],["Beige",{r:245,g:245,b:220,a:255}],["Bisque",{r:255,g:228,b:196,a:255}],["Black",{r:0,g:0,b:0,a:255}],["Blanched Almond",{r:255,g:235,b:205,a:255}],["Blue",{r:0,g:0,b:255,a:255}],["Blue Violet",{r:138,g:43,b:226,a:255}],["Brown",{r:165,g:42,b:42,a:255}],["Burly Wood",{r:222,g:184,b:135,a:255}],["Cadet Blue",{r:95,g:158,b:160,a:255}],["Chartreuse",{r:127,g:255,b:0,a:255}],["Chocolate",{r:210,g:105,b:30,a:255}],["Coral",{r:255,g:127,b:80,a:255}],["Cornflower Blue",{r:100,g:149,b:237,a:255}],["Cornsilk",{r:255,g:248,b:220,a:255}],["Crimson",{r:220,g:20,b:60,a:255}],["Cyan",{r:0,g:255,b:255,a:255}],["Dark Blue",{r:0,g:0,b:139,a:255}],["Dark Cyan",{r:0,g:139,b:139,a:255}],["Dark Goldenrod",{r:184,g:134,b:11,a:255}],["Dark Gray",{r:169,g:169,b:169,a:255}],["Dark Green",{r:0,g:100,b:0,a:255}],["Dark Khaki",{r:189,g:183,b:107,a:255}],["Dark Magenta",{r:139,g:0,b:139,a:255}],["Dark Olive Green",{r:85,g:107,b:47,a:255}],["Dark Orange",{r:255,g:140,b:0,a:255}],["Dark Orchid",{r:153,g:50,b:204,a:255}],["Dark Red",{r:139,g:0,b:0,a:255}],["Dark Salmon",{r:233,g:150,b:122,a:255}],["Dark Sea Green",{r:143,g:188,b:139,a:255}],["Dark Slate Blue",{r:72,g:61,b:139,a:255}],["Dark Slate Gray",{r:47,g:79,b:79,a:255}],["Dark Turquoise",{r:0,g:206,b:209,a:255}],["Dark Violet",{r:148,g:0,b:211,a:255}],["Deep Pink",{r:255,g:20,b:147,a:255}],["Deep Sky Blue",{r:0,g:191,b:255,a:255}],["Dim Gray",{r:105,g:105,b:105,a:255}],["Dodger Blue",{r:30,g:144,b:255,a:255}],["Firebrick",{r:178,g:34,b:34,a:255}],["Floral White",{r:255,g:250,b:240,a:255}],["Forest Green",{r:34,g:139,b:34,a:255}],["Fuchsia",{r:255,g:0,b:255,a:255}],["Gainsboro",{r:220,g:220,b:220,a:255}],["Ghost White",{r:248,g:248,b:255,a:255}],["Gold",{r:255,g:215,b:0,a:255}],["Goldenrod",{r:218,g:165,b:32,a:255}],["Gray",{r:128,g:128,b:128,a:255}],["Green",{r:0,g:128,b:0,a:255}],["Green Yellow",{r:173,g:255,b:47,a:255}],["Honeydew",{r:240,g:255,b:240,a:255}],["Hot Pink",{r:255,g:105,b:180,a:255}],["Indian Red",{r:205,g:92,b:92,a:255}],["Indigo",{r:75,g:0,b:130,a:255}],["Ivory",{r:255,g:255,b:240,a:255}],["Khaki",{r:240,g:230,b:140,a:255}],["Lavender",{r:230,g:230,b:250,a:255}],["Lavender Blush",{r:255,g:240,b:245,a:255}],["Lawn Green",{r:124,g:252,b:0,a:255}],["Lemon Chiffon",{r:255,g:250,b:205,a:255}],["Light Blue",{r:173,g:216,b:230,a:255}],["Light Coral",{r:240,g:128,b:128,a:255}],["Light Cyan",{r:224,g:255,b:255,a:255}],["Light Goldenrod Yellow",{r:250,g:250,b:210,a:255}],["Light Gray",{r:211,g:211,b:211,a:255}],["Light Green",{r:144,g:238,b:144,a:255}],["Light Pink",{r:255,g:182,b:193,a:255}],["Light Salmon",{r:255,g:160,b:122,a:255}],["Light Sea Green",{r:32,g:178,b:170,a:255}],["Light Sky Blue",{r:135,g:206,b:250,a:255}],["Light Slate Gray",{r:119,g:136,b:153,a:255}],["Light Steel Blue",{r:176,g:196,b:222,a:255}],["Light Yellow",{r:255,g:255,b:224,a:255}],["Lime",{r:0,g:255,b:0,a:255}],["LimeGreen",{r:50,g:205,b:50,a:255}],["Linen",{r:250,g:240,b:230,a:255}],["Magenta",{r:255,g:0,b:255,a:255}],["Maroon",{r:128,g:0,b:0,a:255}],["Medium Aquamarine",{r:102,g:205,b:170,a:255}],["Medium Blue",{r:0,g:0,b:205,a:255}],["Medium Orchid",{r:186,g:85,b:211,a:255}],["Medium Purple",{r:147,g:112,b:219,a:255}],["Medium Sea Green",{r:60,g:179,b:113,a:255}],["Medium Slate Blue",{r:123,g:104,b:238,a:255}],["Medium Spring Green",{r:0,g:250,b:154,a:255}],["Medium Turquoise",{r:72,g:209,b:204,a:255}],["Medium VioletRed",{r:199,g:21,b:133,a:255}],["Midnight Blue",{r:25,g:25,b:112,a:255}],["Mint Cream",{r:245,g:255,b:250,a:255}],["Misty Rose",{r:255,g:228,b:225,a:255}],["Moccasin",{r:255,g:228,b:181,a:255}],["Navajo White",{r:255,g:222,b:173,a:255}],["Navy",{r:0,g:0,b:128,a:255}],["Old Lace",{r:253,g:245,b:230,a:255}],["Olive",{r:128,g:128,b:0,a:255}],["Olive Drab",{r:107,g:142,b:35,a:255}],["Orange",{r:255,g:165,b:0,a:255}],["Orange Red",{r:255,g:69,b:0,a:255}],["Orchid",{r:218,g:112,b:214,a:255}],["Pale Goldenrod",{r:238,g:232,b:170,a:255}],["Pale Green",{r:152,g:251,b:152,a:255}],["Pale Turquoise",{r:175,g:238,b:238,a:255}],["Pale Violet Red",{r:219,g:112,b:147,a:255}],["Papaya Whip",{r:255,g:239,b:213,a:255}],["Peach Puff",{r:255,g:218,b:185,a:255}],["Peru",{r:205,g:133,b:63,a:255}],["Pink",{r:255,g:192,b:203,a:255}],["Plum",{r:221,g:160,b:221,a:255}],["Powder Blue",{r:176,g:224,b:230,a:255}],["Purple",{r:128,g:0,b:128,a:255}],["Red",{r:255,g:0,b:0,a:255}],["Rosy Brown",{r:188,g:143,b:143,a:255}],["Royal Blue",{r:65,g:105,b:225,a:255}],["Saddle Brown",{r:139,g:69,b:19,a:255}],["Salmon",{r:250,g:128,b:114,a:255}],["Sandy Brown",{r:244,g:164,b:96,a:255}],["Sea Green",{r:46,g:139,b:87,a:255}],["Sea Shell",{r:255,g:245,b:238,a:255}],["Sienna",{r:160,g:82,b:45,a:255}],["Silver",{r:192,g:192,b:192,a:255}],["Sky Blue",{r:135,g:206,b:235,a:255}],["Slate Blue",{r:106,g:90,b:205,a:255}],["Slate Gray",{r:112,g:128,b:144,a:255}],["Snow",{r:255,g:250,b:250,a:255}],["Spring Green",{r:0,g:255,b:127,a:255}],["Steel Blue",{r:70,g:130,b:180,a:255}],["Tan",{r:210,g:180,b:140,a:255}],["Teal",{r:0,g:128,b:128,a:255}],["Thistle",{r:216,g:191,b:216,a:255}],["Tomato",{r:255,g:99,b:71,a:255}],["Turquoise",{r:64,g:224,b:208,a:255}],["Violet",{r:238,g:130,b:238,a:255}],["Wheat",{r:245,g:222,b:179,a:255}],["White",{r:255,g:255,b:255,a:255}],["White Smoke",{r:245,g:245,b:245,a:255}],["Yellow",{r:255,g:255,b:0,a:255}],["Yellow Green",{r:154,g:205,b:50,a:255}]])}),Es=new Ut({key:qt.baseType,value:qt.baseType,constants:new Map([["Multiply","multiply"],["Screen","screen"],["Overlay","overlay"],["Hard Light","hard"],["Soft Light","soft"],["Dodge","dodge"],["Burn","burn"],["Divide","divide"],["Addition","add"],["Subtract","sub"],["Difference","diff"],["Darken Only","darken"],["Lighten Only","lighten"]])}),ws={create:gs.setTypes(Ko.create,fi),maybe:gs.setTypes(Ko.maybe,(function(t){return Si.maybe(t.value,fi)}),{value:ht}),cmp:gs.setTypes(Ko.cmp,An,{value:fi,test:fi}),copy:gs.setTypes(Ko.copy,fi,{value:fi}),build:gs.setTypes(Ko.build,fi,{r:An,g:An,b:An},{a:An}),map:gs.setTypes(Ko.map,fi,{value:fi,r:An,g:An,b:An},{a:An},{value:An,component:Ts}),op:gs.setTypes(Ko.op,fi,{value:fi,test:fi,r:An,g:An,b:An},{a:An},{value:An,test:An,component:Ts}),clamp:gs.setTypes(Ko.clamp,fi,{value:fi}),add:gs.setTypes(Ko.add,fi,{value:fi,addend:bs},{alpha:Z}),adds:gs.setTypes(Ko.adds,fi,{value:fi,addend:bs,addendScale:bs},{alpha:Z}),sub:gs.setTypes(Ko.sub,fi,{value:fi,subtrahend:bs},{alpha:Z}),mul:gs.setTypes(Ko.mul,fi,{value:fi,multiplier:bs},{alpha:Z}),div:gs.setTypes(Ko.div,fi,{value:fi,divisor:bs},{alpha:Z}),mod:gs.setTypes(Ko.mod,fi,{value:fi,divisor:bs},{alpha:Z}),format:gs.setTypes(Ko.format,qt,{value:fi,format:xs}),parse:gs.setTypes(Ko.parse,Si.optional(fi),{value:ht}),lerp:gs.setTypes(Ko.lerp,fi,{start:fi,end:fi,delta:An}),lighten:gs.setTypes(Ko.lighten,fi,{value:fi,amount:An}),darken:gs.setTypes(Ko.darken,fi,{value:fi,amount:An}),toHSL:gs.setTypes(Ko.toHSL,si.type,{value:fi}),fromHSL:gs.setTypes(Ko.fromHSL,fi,{value:si.type}),luminance:gs.setTypes(Ko.luminance,An,{value:fi}),contrast:gs.setTypes(Ko.contrast,An,{value:fi,test:fi}),invert:gs.setTypes(Ko.invert,fi,{value:fi},{alpha:Z}),opaque:gs.setTypes(Ko.opaque,fi,{value:fi}),alpha:gs.setTypes(Ko.alpha,fi,{value:fi,alpha:An}),distance:gs.setTypes(Ko.distance,An,{value:fi,test:fi}),named:gs.setTypes(Ko.named,fi,{name:Os}),getName:gs.setTypes(Ko.getName,qt,{value:fi}),blend:gs.setTypes(Ko.blend,fi,{top:fi,bottom:fi,mode:Es}),isValid:gs.setTypes(Ko.isValid,Z,{value:ht}),isEqual:gs.setTypes(Ko.isEqual,Z,{value:fi,test:fi},{epsilon:An}),isNotEqual:gs.setTypes(Ko.isNotEqual,Z,{value:fi,test:fi},{epsilon:An}),isLess:gs.setTypes(Ko.isLess,Z,{value:fi,test:fi}),isLessOrEqual:gs.setTypes(Ko.isLessOrEqual,Z,{value:fi,test:fi}),isGreater:gs.setTypes(Ko.isGreater,Z,{value:fi,test:fi}),isGreaterOrEqual:gs.setTypes(Ko.isGreaterOrEqual,Z,{value:fi,test:fi}),asAny:gs.setTypes(Ko.asAny,ht,{value:fi}),asBoolean:gs.setTypes(Ko.asBoolean,Z,{value:fi}),asColor:gs.setTypes(Ko.asColor,fi,{value:fi}),asDate:gs.setTypes(Ko.asDate,jo,{value:fi}),asList:gs.setTypes(Ko.asList,(function(t){return mn.forItem(t.value||fi)}),{value:fi}),asMap:gs.setTypes(Ko.asMap,(function(t){return Vo.forItem(t.value||fi)}),{value:fi}),asNumber:gs.setTypes(Ko.asNumber,An,{value:fi}),asObject:gs.setTypes(Ko.asObject,(function(t){return t.value||fi}),{value:fi}),asText:gs.setTypes(Ko.asText,qt,{value:fi}),asTuple:gs.setTypes(Ko.asTuple,(function(t){return xn.forItem([t.value||fi])}),{value:fi}),asSet:gs.setTypes(Ko.asSet,(function(t){return Ei.forItem(t.value||ht)}),{value:fi})},Ss=jo.operations,Ps=new Ut({key:qt.baseType.newInstance(),value:qt.baseType.newInstance(),constants:new Map([["Timestamp","timestamp"],["Timestamp (seconds)","timestampSeconds"],["Millisecond","millis"],["Second","second"],["Minute","minute"],["Hour","hour"],["Day","day"],["Day of Month","dayOfMonth"],["Last Day of Month","lastDayOfMonth"],["Day of Year","dayOfYear"],["Day of Week","dayOfWeek"],["Week","week"],["Week of Month","weekOfMonth"],["Weekspan of Month","weekspanOfMonth"],["Full Week of Month","fullWeekOfMonth"],["Last Weekspan of Month","lastWeekspanOfMonth"],["Last Full Week of Month","lastFullWeekOfMonth"],["Week of Year","weekOfYear"],["Weekspan of Year","weekspanOfYear"],["Full Week of Year","fullWeekOfYear"],["Last Weekspan of Year","lastWeekspanOfYear"],["Last Full Week of Year","lastFullWeekOfYear"],["Month","month"],["Quarter","quarter"],["Year","year"],["Time Identifier","timeIdentifier"],["Day Identifier","dayIdentifier"],["Week Identifier","weekIdentifier"],["Month Identifier","monthIdentifier"],["Quarter Identifier","quarterIdentifier"]])}),_s=new Ut({key:qt.baseType.newInstance(),value:qt.baseType.newInstance(),constants:new Map([["Millisecond","millis"],["Second","second"],["Minute","minute"],["Hour","hour"],["Day","day"],["Week","week"],["Month","month"],["Quarter","quarter"],["Year","year"]])}),Is=new Ut({key:qt.baseType.newInstance(),value:qt.baseType.newInstance(),constants:new Map([["None","none"],["Floor","floor"],["Ceil","ceil"],["Round","round"],["Truncate","truncate"],["Up","up"],["Down","down"]])}),Ms={create:Ss.setTypes(Mo.create,jo),now:Ss.setTypes(Mo.now,jo),today:Ss.setTypes(Mo.today,jo),tomorrow:Ss.setTypes(Mo.tomorrow,jo),yesterday:Ss.setTypes(Mo.yesterday,jo),maybe:Ss.setTypes(Mo.maybe,(function(t){return Si.maybe(t.value,Z)}),{value:ht}),parse:Ss.setTypes(Mo.parse,Si.optional(jo),{value:new ko([jo.baseType,An.baseType,qt.baseType])},{parseAsUTC:Z}),fromText:Ss.setTypes(Mo.fromText,Si.optional(jo),{value:qt},{parseAsUTC:Z}),fromTimestamp:Ss.setTypes(Mo.fromTimestamp,jo,{value:An}),fromTimestampSeconds:Ss.setTypes(Mo.fromTimestampSeconds,jo,{value:An}),min:Ss.setTypes(Mo.min,jo,{value:jo,test:jo}),max:Ss.setTypes(Mo.max,jo,{value:jo,test:jo}),get:Ss.setTypes(Mo.get,An,{value:jo,property:Ps}),set:Ss.setTypes(Mo.set,jo,{value:jo,property:Ps,set:An}),add:Ss.setTypes(Mo.add,jo,{value:jo,unit:_s},{amount:An}),sub:Ss.setTypes(Mo.sub,jo,{value:jo,unit:_s},{amount:An}),startOf:Ss.setTypes(Mo.startOf,jo,{value:jo,unit:_s}),endOf:Ss.setTypes(Mo.endOf,jo,{value:jo,unit:_s},{inclusive:Z}),daysInMonth:Ss.setTypes(Mo.daysInMonth,An,{value:jo}),daysInYear:Ss.setTypes(Mo.daysInYear,An,{value:jo}),weeksInYear:Ss.setTypes(Mo.weeksInYear,An,{value:jo}),copy:Ss.setTypes(Mo.copy,jo,{value:jo}),cmp:Ss.setTypes(Mo.cmp,An,{value:jo,test:jo},{unit:_s}),diff:Ss.setTypes(Mo.diff,An,{value:jo,test:jo},{unit:_s,absolute:Z,adjust:Is}),timezoneOffset:Ss.setTypes(Mo.timezoneOffset,An,{value:jo}),toText:Ss.setTypes(Mo.toText,qt,{value:jo,format:qt}),toISOText:Ss.setTypes(Mo.toISOText,qt,{value:jo}),isValid:Ss.setTypes(Mo.isValid,Z,{value:ht}),isEqual:Ss.setTypes(Mo.isEqual,Z,{value:jo,test:jo},{unit:_s}),isBefore:Ss.setTypes(Mo.isBefore,Z,{value:jo,test:jo},{unit:_s}),isBeforeOrEqual:Ss.setTypes(Mo.isBeforeOrEqual,Z,{value:jo,test:jo},{unit:_s}),isAfter:Ss.setTypes(Mo.isAfter,Z,{value:jo,test:jo},{unit:_s}),isAfterOrEqual:Ss.setTypes(Mo.isAfterOrEqual,Z,{value:jo,test:jo},{unit:_s}),isBetween:Ss.setTypes(Mo.isBetween,Z,{value:jo,start:jo,end:jo},{unit:_s,startInclusive:Z,endInclusive:Z}),isStartOf:Ss.setTypes(Mo.isStartOf,Z,{value:jo,unit:_s}),isEndOf:Ss.setTypes(Mo.isEndOf,Z,{value:jo,unit:_s},{inclusive:Z}),isDST:Ss.setTypes(Mo.isDST,Z,{value:jo}),isLeapYear:Ss.setTypes(Mo.isLeapYear,Z,{value:jo}),asAny:Ss.setTypes(Mo.asAny,ht,{value:jo}),asBoolean:Ss.setTypes(Mo.asBoolean,Z,{value:jo}),asColor:Ss.setTypes(Mo.asColor,fi,{value:jo}),asDate:Ss.setTypes(Mo.asDate,(function(t){return t.value||jo}),{value:jo}),asList:Ss.setTypes(Mo.asList,(function(t){return mn.forItem(t.value||jo)}),{value:jo}),asMap:Ss.setTypes(Mo.asMap,(function(t){return Vo.forItem(t.value||jo)}),{value:jo}),asNumber:Ss.setTypes(Mo.asNumber,An,{value:jo}),asObject:Ss.setTypes(Mo.asObject,be,{value:jo}),asText:Ss.setTypes(Mo.asText,qt,{value:jo}),asTuple:Ss.setTypes(Mo.asTuple,(function(t){return xn.forItem([t.value||jo])}),{value:jo}),asSet:Ss.setTypes(Mo.asSet,(function(t){return Ei.forItem(t.value||ht)}),{value:jo})};function Cs(t){var e,n,r={};try{for(var o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),i=o.next();!i.done;i=o.next()){var s=Ds(i.value,void 0,Cs);if(s instanceof be){var a=s.options.props;for(var u in a){var p=a[u];r[u]=u in r&&p instanceof Wo?Si.mergeMany([p,r[u]]):p}}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return new be({props:r})}function Ds(t,e,n){return t instanceof be?t:t instanceof Oe?t.getType():t instanceof Ut?Ds(t.options.value,e):t instanceof ko&&t.options.some((function(t){return Ds(t)}))&&n?n(t.options.filter((function(t){return Ds(t)}))):t instanceof Wo?Ds(t.options,e):e}var js=mn.operations,Rs=function(t,e){return t instanceof mn?t:e},As=function(t,e){return t instanceof mn?t.options.item:e},Ns=function(t){return Rs(t.list,mn)},ks=function(t){return Rs(t.value,mn)},Ls=function(t){return Rs(t.list)?t.list.options.item:ht},qs=function(t){return Si.optional(Ls(t))},Fs=function(t){return Rs(t.value)?t.value.options.item:ht},Vs=function(t){return t.reduce||t.initial||ht},Ys={list:Ns,value:Ls,test:Ls},Ws={list:ks,value:Fs,test:Fs},Hs={list:Ns,item:Ls,index:An},Gs={create:js.setTypes(fn.create,mn),createLike:js.setTypes(fn.createLike,Ns,{list:Ns}),createFor:js.setTypes(fn.createFor,(function(t){return mn.forItem(t.item||ht)}),{item:function(t){return t.item||ht}}),maybe:js.setTypes(fn.maybe,(function(t){return Si.maybe(t.value,mn)}),{value:ht}),build:js.setTypes(fn.build,(function(t){return mn.forItem(t.item||ht)}),{count:An,item:function(t){return t.item||ht}},{sameItem:Z},{list:function(t){return mn.forItem(t.item||ht)},index:An,last:function(t){return t.item||ht},count:An}),get:js.setTypes(fn.get,qs,{list:Ns,index:An}),set:js.setTypes(fn.set,qs,{list:Ns,index:An,value:Ls}),add:js.setTypes(fn.add,Ns,{list:Ns,item:Ls}),addFirst:js.setTypes(fn.addFirst,Ns,{list:Ns,item:Ls}),addLast:js.setTypes(fn.addLast,Ns,{list:Ns,item:Ls}),insert:js.setTypes(fn.insert,Ns,{list:Ns,item:Ls,index:An}),remove:js.setTypes(fn.remove,An,{list:Ns,item:Ls,isEqual:Z},{},Ys),removeFirst:js.setTypes(fn.removeFirst,qs,{list:Ns}),removeLast:js.setTypes(fn.removeLast,qs,{list:Ns}),removeAt:js.setTypes(fn.removeAt,qs,{list:Ns,index:An}),removeWhere:js.setTypes(fn.removeWhere,Ns,{list:Ns,where:Z},{},Hs),clear:js.setTypes(fn.clear,Ns,{list:Ns}),contains:js.setTypes(fn.contains,Z,{list:Ns,item:Ls,isEqual:Z},{},Ys),find:js.setTypes(fn.find,qs,{list:Ns,where:Z},{reverse:Z,start:An},Hs),copy:js.setTypes(fn.copy,Ns,{list:Ns},{deepCopy:Ls},{copy:Ls}),reverse:js.setTypes(fn.reverse,Ns,{list:Ns}),exclude:js.setTypes(fn.exclude,Ns,{list:Ns,exclude:Ns,isEqual:Z},{},Ys),overlap:js.setTypes(fn.overlap,Ns,{list:Ns,overlap:Ns,isEqual:Z},{},Ys),sort:js.setTypes(fn.sort,Ns,{list:Ns,compare:An},{},Ys),shuffle:js.setTypes(fn.shuffle,Ns,{list:Ns},{times:An}),unique:js.setTypes(fn.unique,Ns,{list:Ns,isEqual:Z},{},Ys),duplicates:js.setTypes(fn.duplicates,Ns,{list:Ns,isEqual:Z},{once:Z},Ys),take:js.setTypes(fn.take,Ns,{list:Ns,count:An}),skip:js.setTypes(fn.skip,Ns,{list:Ns,count:An}),drop:js.setTypes(fn.drop,Ns,{list:Ns,count:An}),append:js.setTypes(fn.append,Ns,{list:Ns,append:Ns}),prepend:js.setTypes(fn.prepend,Ns,{list:Ns,prepend:Ns}),indexOf:js.setTypes(fn.indexOf,An,{list:Ns,item:Ls,isEqual:Z},{start:An},Ys),lastIndexOf:js.setTypes(fn.lastIndexOf,An,{list:Ns,item:Ls,isEqual:Z},{start:An},Ys),findIndex:js.setTypes(fn.findIndex,An,{list:Ns,where:Z},{reverse:Z,start:An},Hs),last:js.setTypes(fn.last,qs,{list:Ns}),first:js.setTypes(fn.first,qs,{list:Ns}),count:js.setTypes(fn.count,An,{list:Ns}),randomList:js.setTypes(fn.randomList,Ns,{list:Ns,count:An}),random:js.setTypes(fn.random,qs,{list:Ns}),flatten:js.setTypes(fn.flatten,(function(t){return t.list instanceof mn&&Ds(t.list.options.item,void 0,Cs)?Ds(t.list.options.item,void 0,Cs):t.list instanceof xn&&t.list.options.some((function(t){return Ds(t,void 0,Cs)}))?Cs(t.list.options.filter((function(t){return Ds(t,void 0,Cs)}))):be}),{list:function(t){return t.list instanceof mn&&Ds(t.list.options.item,void 0,Cs)||t.list instanceof xn&&t.list.options.some((function(t){return Ds(t,void 0,Cs)}))?t.list:mn}}),join:js.setTypes(fn.join,qt,{list:Ns},{delimiter:qt,toText:qt,prefix:qt,suffix:qt},Hs),each:js.setTypes(fn.each,Ns,{list:Ns,each:ht},{reverse:Z},Hs),filter:js.setTypes(fn.filter,Ns,{list:Ns,filter:Z},{},Hs),not:js.setTypes(fn.not,Ns,{list:Ns,not:Z},{},Hs),map:js.setTypes(fn.map,(function(t){return mn.forItem(t.transform||ht)}),{list:Ns,transform:function(t){return t.transform||ht}},{},Hs),split:js.setTypes(fn.split,(function(t){return Si.object({pass:Ns(t),fail:Ns(t)})}),{list:Ns,pass:Z},{},Hs),reduce:js.setTypes(fn.reduce,Vs,{list:Ns,reduce:Vs,initial:Vs},{},{list:Ns,item:Ls,reduced:Vs,index:An}),cmp:js.setTypes(fn.cmp,Z,{value:ks,test:ks,compare:An},{},Ws),group:js.setTypes(fn.group,(function(t){return mn.forItem(Si.object({by:t.by||ht,group:mn.forItem(t.getValue||Ls(t))}))}),{list:Ns,by:function(t){return t.by||ht}},{getValue:function(t){return t.getValue||Ls(t)}},Hs),toListMap:js.setTypes(fn.toListMap,(function(t){return Vo.forItem(mn.forItem(t.getValue||Ls(t)),t.getKey||ht)}),{list:Ns,getKey:function(t){return t.getKey||ht}},{getValue:function(t){return t.getValue||Ls(t)}},Hs),toMap:js.setTypes(fn.toMap,(function(t){return Vo.forItem(t.getValue||Ls(t),t.getKey||ht)}),{list:Ns,getKey:function(t){return t.getKey||ht}},{getValue:function(t){return t.getValue||Ls(t)}},Hs),joinInner:js.setTypes(fn.joinInner,(function(t){return mn.forItem(t.join||ht)}),{a:function(t){return Rs(t.a,mn)},b:function(t){return Rs(t.b,mn)},on:Z,join:ht},{},{onA:function(t){return As(t.a,ht)},onB:function(t){return As(t.b,ht)},joinA:function(t){return As(t.a,ht)},joinB:function(t){return As(t.b,ht)}}),joinLeft:js.setTypes(fn.joinLeft,(function(t){return mn.forItem(t.join||ht)}),{a:function(t){return Rs(t.a,mn)},b:function(t){return Rs(t.b,mn)},on:Z,join:ht},{},{onA:function(t){return As(t.a,ht)},onB:function(t){return As(t.b,ht)},joinA:function(t){return As(t.a,ht)},joinB:function(t){return Si.optional(As(t.b,ht))}}),joinRight:js.setTypes(fn.joinRight,(function(t){return mn.forItem(t.join||ht)}),{a:function(t){return Rs(t.a,mn)},b:function(t){return Rs(t.b,mn)},on:Z,join:ht},{},{onA:function(t){return As(t.a,ht)},onB:function(t){return As(t.b,ht)},joinA:function(t){return Si.optional(As(t.a,ht))},joinB:function(t){return As(t.b,ht)}}),joinFull:js.setTypes(fn.joinFull,(function(t){return mn.forItem(t.join||ht)}),{a:function(t){return Rs(t.a,mn)},b:function(t){return Rs(t.b,mn)},on:Z,join:ht},{},{onA:function(t){return As(t.a,ht)},onB:function(t){return As(t.b,ht)},joinA:function(t){return Si.optional(As(t.a,ht))},joinB:function(t){return Si.optional(As(t.b,ht))}}),joinCross:js.setTypes(fn.joinCross,(function(t){return mn.forItem(t.join||ht)}),{a:function(t){return Rs(t.a,mn)},b:function(t){return Rs(t.b,mn)},join:ht},{},{joinA:function(t){return As(t.a,ht)},joinB:function(t){return As(t.b,ht)}}),min:js.setTypes(fn.min,Si.optional(An),{list:Ns,value:An},{},Hs),max:js.setTypes(fn.max,Si.optional(An),{list:Ns,value:An},{},Hs),sum:js.setTypes(fn.sum,Si.optional(An),{list:Ns,value:An},{},Hs),avg:js.setTypes(fn.avg,Si.optional(An),{list:Ns,value:An},{},Hs),std:js.setTypes(fn.std,Si.optional(An),{list:Ns,value:An},{},Hs),variance:js.setTypes(fn.variance,Si.optional(An),{list:Ns,value:An},{},Hs),median:js.setTypes(fn.median,Si.optional(An),{list:Ns,value:An},{},Hs),bitand:js.setTypes(fn.bitand,An,{list:Ns,value:An},{},Hs),bitor:js.setTypes(fn.bitor,An,{list:Ns,value:An},{},Hs),bitxor:js.setTypes(fn.bitxor,An,{list:Ns,value:An},{},Hs),isValid:js.setTypes(fn.isValid,Z,{value:ht}),isEmpty:js.setTypes(fn.isEmpty,Z,{list:Ns}),isNotEmpty:js.setTypes(fn.isNotEmpty,Z,{list:Ns}),isEqual:js.setTypes(fn.isEqual,Z,{list:Ns,test:Ns,isEqual:Z},{},Ys),isNotEqual:js.setTypes(fn.isNotEqual,Z,{list:Ns,test:Ns,isEqual:Z},{},Ys),isLess:js.setTypes(fn.isLess,Z,{value:ks,test:ks,compare:An},{},Ws),isLessOrEqual:js.setTypes(fn.isLessOrEqual,Z,{value:ks,test:ks,compare:An},{},Ws),isGreater:js.setTypes(fn.isGreater,Z,{value:ks,test:ks,compare:An},{},Ws),isGreaterOrEqual:js.setTypes(fn.isGreaterOrEqual,Z,{value:ks,test:ks,compare:An},{},Ws),asAny:js.setTypes(fn.asAny,ht,{value:ks}),asBoolean:js.setTypes(fn.asBoolean,Z,{value:ks}),asColor:js.setTypes(fn.asColor,fi,{value:ks}),asDate:js.setTypes(fn.asDate,jo,{value:ks}),asList:js.setTypes(fn.asList,ks,{value:ks}),asMap:js.setTypes(fn.asMap,(function(t){return Vo.forItem(Fs(t))}),{value:ks}),asNumber:js.setTypes(fn.asNumber,An,{value:ks}),asObject:js.setTypes(fn.asObject,be,{value:ks}),asText:js.setTypes(fn.asText,qt,{value:ks}),asTuple:js.setTypes(fn.asTuple,xn,{value:ks}),asSet:js.setTypes(fn.asSet,(function(t){return Ei.forItem(Fs(t))}),{value:ks})},Bs=Vo.operations,Us=function(t){return t instanceof Vo?t:void 0},Js=function(t){return Us(t.map)||Vo},Ks=function(t){return Us(t.map)?t.map.options.value:ht},zs=function(t){return Si.optional(Ks(t))},Xs=function(t){return Us(t.map)?t.map.options.key:qt},$s={map:Js,key:Xs,value:Ks},Qs=function(t){return Us(t.value)||Vo},Zs=function(t){return Us(t.value)?t.value.options.value:ht},ta={key:function(t){return Us(t.value)?t.value.options.key:qt},value:Zs,test:Zs},ea={create:Bs.setTypes(Wt.create,Vo),createLike:Bs.setTypes(Wt.createLike,Js,{map:Js}),createFor:Bs.setTypes(Wt.createFor,(function(t){return Vo.forItem(t.value||ht,t.key||qt)}),{value:function(t){return t.value||ht}},{key:function(t){return t.key||qt}}),maybe:Bs.setTypes(Wt.maybe,(function(t){return Si.maybe(t.value,Vo)}),{value:ht}),get:Bs.setTypes(Wt.get,zs,{map:Js,key:Xs}),set:Bs.setTypes(Wt.set,zs,{map:Js,key:Xs,value:Ks},{},{existingValue:Ks}),has:Bs.setTypes(Wt.has,Z,{map:Js,key:Xs}),delete:Bs.setTypes(Wt.delete,Z,{map:Js,key:Xs}),keys:Bs.setTypes(Wt.keys,(function(t){return mn.forItem(Xs(t))}),{map:Js}),values:Bs.setTypes(Wt.values,(function(t){return mn.forItem(Ks(t))}),{map:Js}),entries:Bs.setTypes(Wt.entries,(function(t){return Si.object({keys:mn.forItem(Xs(t)),values:mn.forItem(Ks(t))})}),{map:Js}),pairs:Bs.setTypes(Wt.pairs,(function(t){return mn.forItem(Si.object({key:Xs(t),value:Ks(t)}))}),{map:Js}),clear:Bs.setTypes(Wt.clear,Js,{map:Js}),count:Bs.setTypes(Wt.count,An,{map:Js}),cmp:Bs.setTypes(Wt.cmp,An,{value:Qs,test:Qs,compare:An},{},ta),copy:Bs.setTypes(Wt.copy,Js,{map:Js},{deepCopy:Ks,deepCopyKey:Xs},$s),map:Bs.setTypes(Wt.map,(function(t){return Vo.forItem(t.transform||Ks(t),t.transformKey||Xs(t))}),{map:Js},{transform:function(t){return t.transform||Ks(t)},transformKey:function(t){return t.transformKey||Xs(t)}},$s),toPlainObject:Bs.setTypes(Wt.toPlainObject,be,{map:Js}),fromPlainObject:Bs.setTypes(Wt.fromPlainObject,(function(t){if(!(t.object instanceof be))return Vo;var e=w(t.object.options.props);return Vo.forItem(Si.mergeMany(e,qt.baseType))}),{object:function(t){return t.object||be}}),isValid:Bs.setTypes(Wt.isValid,Z,{value:ht}),isEqual:Bs.setTypes(Wt.isEqual,Z,{value:Qs,test:Qs,isEqual:Z},{},ta),isNotEqual:Bs.setTypes(Wt.isNotEqual,Z,{value:Qs,test:Qs,isEqual:Z},{},ta),isLess:Bs.setTypes(Wt.isLess,Z,{value:Qs,test:Qs,compare:An},{},ta),isLessOrEqual:Bs.setTypes(Wt.isLessOrEqual,Z,{value:Qs,test:Qs,compare:An},{},ta),isGreater:Bs.setTypes(Wt.isGreater,Z,{value:Qs,test:Qs,compare:An},{},ta),isGreaterOrEqual:Bs.setTypes(Wt.isGreaterOrEqual,Z,{value:Qs,test:Qs,compare:An},{},ta),asAny:Bs.setTypes(Wt.asAny,ht,{value:Vo}),asBoolean:Bs.setTypes(Wt.asBoolean,Z,{value:Vo}),asColor:Bs.setTypes(Wt.asColor,fi,{value:Vo}),asDate:Bs.setTypes(Wt.asDate,jo,{value:Vo}),asList:Bs.setTypes(Wt.asList,(function(t){return mn.forItem(Zs(t))}),{value:Vo}),asMap:Bs.setTypes(Wt.asMap,(function(t){return t.value||Vo}),{value:Vo}),asNumber:Bs.setTypes(Wt.asNumber,(function(t){return An}),{value:Vo}),asObject:Bs.setTypes(Wt.asObject,be,{value:Vo}),asText:Bs.setTypes(Wt.asText,qt,{value:Vo}),asTuple:Bs.setTypes(Wt.asTuple,(function(t){return xn.forItem([t.value||Vo])}),{value:Vo}),asSet:Bs.setTypes(Wt.asSet,(function(t){return Ei.forItem(Zs(t))}),{value:Vo})},na=An.operations,ra=new Ut({key:qt.baseType.newInstance(),value:qt.baseType.newInstance(),constants:new Map([["has the bits","contain"],["does not have the bits","notcontain"],["has some of the bits","overlap"],["has none of the bits","none"],["has the same bits","equal"],["does not have the same bits","not"],["has all bits in","subset"]])}),oa={create:na.setTypes(un.create,An),pi:na.setTypes(un.pi,An),pi2:na.setTypes(un.pi2,An),piHalf:na.setTypes(un.piHalf,An),e:na.setTypes(un.e,An),sqrt2:na.setTypes(un.sqrt2,An),sqrt12:na.setTypes(un.sqrt12,An),ln2:na.setTypes(un.ln2,An),ln10:na.setTypes(un.ln10,An),log2e:na.setTypes(un.log2e,An),log10e:na.setTypes(un.log10e,An),add:na.setTypes(un.add,An,{value:An,addend:An}),sub:na.setTypes(un.sub,An,{value:An,subtrahend:An}),mul:na.setTypes(un.mul,An,{value:An,multiplier:An}),div:na.setTypes(un.div,An,{value:An,divisor:An}),mod:na.setTypes(un.mod,An,{value:An,divisor:An}),min:na.setTypes(un.min,An,{a:An,b:An}),max:na.setTypes(un.max,An,{a:An,b:An}),pow:na.setTypes(un.pow,An,{value:An,exponent:An}),atan2:na.setTypes(un.atan2,An,{x:An,y:An}),hypot:na.setTypes(un.hypot,An,{a:An,b:An}),choose:na.setTypes(un.choose,An,{n:An,k:An}),gcd:na.setTypes(un.gcd,An,{a:An,b:An}),bitAnd:na.setTypes(un.bitAnd,An,{a:An,b:An}),bitOr:na.setTypes(un.bitOr,An,{a:An,b:An}),bitXor:na.setTypes(un.bitXor,An,{a:An,b:An}),cmp:na.setTypes(un.cmp,An,{value:An,test:An}),maybe:na.setTypes(un.maybe,(function(t){return Si.maybe(t.value,An)}),{value:ht}),sqrt:na.setTypes(un.sqrt,An,{value:An}),sq:na.setTypes(un.sq,An,{value:An}),cbrt:na.setTypes(un.cbrt,An,{value:An}),floor:na.setTypes(un.floor,An,{value:An}),ceil:na.setTypes(un.ceil,An,{value:An}),up:na.setTypes(un.up,An,{value:An}),down:na.setTypes(un.down,An,{value:An}),round:na.setTypes(un.round,An,{value:An}),abs:na.setTypes(un.abs,An,{value:An}),neg:na.setTypes(un.neg,An,{value:An}),sign:na.setTypes(un.sign,An,{value:An}),log:na.setTypes(un.log,An,{value:An}),sin:na.setTypes(un.sin,An,{value:An}),cos:na.setTypes(un.cos,An,{value:An}),tan:na.setTypes(un.tan,An,{value:An}),sinh:na.setTypes(un.sinh,An,{value:An}),cosh:na.setTypes(un.cosh,An,{value:An}),asin:na.setTypes(un.asin,An,{value:An}),acos:na.setTypes(un.acos,An,{value:An}),atan:na.setTypes(un.atan,An,{value:An}),factorial:na.setTypes(un.factorial,An,{value:An}),bitFlip:na.setTypes(un.bitFlip,An,{value:An}),clamp:na.setTypes(un.clamp,An,{value:An,min:An,max:An}),triangleHeight:na.setTypes(un.triangleHeight,An,{base:An,side1:An,side2:An}),lerp:na.setTypes(un.lerp,An,{delta:An,start:An,end:An}),rnd:na.setTypes(un.rnd,An,{},{min:An,max:An,whole:Z,includeMax:Z}),toBaseText:na.setTypes(un.toBaseText,qt,{value:An},{base:An,minDigits:An}),toText:na.setTypes(un.toText,qt,{value:An},{prefix:qt,suffix:qt,minPlaces:An,maxPlaces:An,useExponent:Z,thousandSeparator:qt}),toPercent:na.setTypes(un.toPercent,qt,{value:An},{minPlaces:An,maxPlaces:An,thousandSeparator:qt}),fromPercent:na.setTypes(un.fromPercent,Si.optional(An),{value:qt}),isValid:na.setTypes(un.isValid,Z,{value:ht}),isZero:na.setTypes(un.isZero,Z,{value:An},{epsilon:An}),isEqual:na.setTypes(un.isEqual,Z,{value:An,test:An},{epsilon:An}),isNotEqual:na.setTypes(un.isNotEqual,Z,{value:An,test:An},{epsilon:An}),isLess:na.setTypes(un.isLess,Z,{value:An,test:An}),isLessOrEqual:na.setTypes(un.isLessOrEqual,Z,{value:An,test:An}),isGreater:na.setTypes(un.isGreater,Z,{value:An,test:An}),isGreaterOrEqual:na.setTypes(un.isGreaterOrEqual,Z,{value:An,test:An}),isBetween:na.setTypes(un.isBetween,Z,{value:An,min:An,max:An},{minInclusive:Z,maxInclusive:Z}),isWhole:na.setTypes(un.isWhole,Z,{value:An},{epsilon:An}),isDecimal:na.setTypes(un.isDecimal,Z,{value:An},{epsilon:An}),isPositive:na.setTypes(un.isPositive,Z,{value:An}),isNegative:na.setTypes(un.isNegative,Z,{value:An}),isDivisible:na.setTypes(un.isDivisible,Z,{value:An,by:An},{epsilon:An}),bitCompare:na.setTypes(un.bitCompare,Z,{value:An,method:ra,test:An}),asAny:na.setTypes(un.asAny,ht,{value:An}),asBoolean:na.setTypes(un.asBoolean,Z,{value:An}),asColor:na.setTypes(un.asColor,fi,{value:An}),asDate:na.setTypes(un.asDate,jo,{value:An}),asList:na.setTypes(un.asList,(function(t){return mn.forItem(t.value||An)}),{value:An}),asMap:na.setTypes(un.asMap,(function(t){return Vo.forItem(t.value||An)}),{value:An}),asNumber:na.setTypes(un.asNumber,(function(t){return t.value||An}),{value:An}),asObject:na.setTypes(un.asObject,be,{value:An}),asText:na.setTypes(un.asText,qt,{value:An}),asTuple:na.setTypes(un.asTuple,(function(t){return xn.forItem([t.value||An])}),{value:An}),asSet:na.setTypes(un.asSet,(function(t){return Ei.forItem(t.value||An)}),{value:An})},ia=be.operations,sa=function(t){return t.object||be},aa={create:ia.setTypes(ve.create,sa),maybe:ia.setTypes(ve.maybe,(function(t){return Si.maybe(t.value,be)}),{value:ht}),has:ia.setTypes(ve.has,Z,{object:sa,key:qt}),get:ia.setTypes(ve.get,ht,{object:sa,key:qt}),set:ia.setTypes(ve.set,sa,{object:sa,key:qt,value:ht},{},{existingValue:ht}),delete:ia.setTypes(ve.delete,ht,{object:sa,key:qt}),cmp:ia.setTypes(ve.cmp,An,{value:be,test:be}),copy:ia.setTypes(ve.copy,sa,{object:sa}),merge:ia.setTypes(ve.merge,(function(t){return Cs(["a","b","c","d","e"].map((function(e){return t[e]})))}),{a:be,b:be},{c:be,d:be,e:be}),isValid:ia.setTypes(ve.isValid,Z,{value:ht}),isEqual:ia.setTypes(ve.isEqual,Z,{value:be,test:be}),isNotEqual:ia.setTypes(ve.isNotEqual,Z,{value:be,test:be}),isLess:ia.setTypes(ve.isLess,Z,{value:be,test:be}),isLessOrEqual:ia.setTypes(ve.isLessOrEqual,Z,{value:be,test:be}),isGreater:ia.setTypes(ve.isGreater,Z,{value:be,test:be}),isGreaterOrEqual:ia.setTypes(ve.isGreaterOrEqual,Z,{value:be,test:be}),asAny:ia.setTypes(ve.asAny,ht,{value:be}),asBoolean:ia.setTypes(ve.asBoolean,Z,{value:be}),asColor:ia.setTypes(ve.asColor,fi,{value:be}),asDate:ia.setTypes(ve.asDate,jo,{value:be}),asList:ia.setTypes(ve.asList,(function(t){return mn.forItem(t.value||be)}),{value:be}),asMap:ia.setTypes(ve.asMap,(function(t){return Vo.forItem(t.value||be)}),{value:be}),asNumber:ia.setTypes(ve.asNumber,An,{value:be}),asObject:ia.setTypes(ve.asObject,(function(t){return t.value||be}),{value:be}),asText:ia.setTypes(ve.asText,qt,{value:be}),asTuple:ia.setTypes(ve.asTuple,(function(t){return xn.forItem([t.value||be])}),{value:be}),asSet:ia.setTypes(ve.asSet,(function(t){return Ei.forItem(t.value||be)}),{value:be})},ua=Ei.operations,pa=function(t){return t instanceof Ei?t:void 0},ca=function(t){return pa(t.set)||Ei},la=function(t){return pa(t.set)?t.set.options.value:ht},fa={set:ca,value:la},ya=function(t){return pa(t.value)||Ei},ha=function(t){return pa(t.value)?t.value.options.value:ht},da={create:ua.setTypes(vi.create,Ei),createLike:ua.setTypes(vi.createLike,ca,{set:ca}),createFor:ua.setTypes(vi.createFor,(function(t){return mn.forItem(t.value||ht)}),{value:function(t){return t.value||ht}}),maybe:ua.setTypes(vi.maybe,(function(t){return Si.maybe(t.value,Ei)}),{value:ht}),add:ua.setTypes(vi.add,ca,{set:ca,value:la}),has:ua.setTypes(vi.has,Z,{set:ca,value:la}),delete:ua.setTypes(vi.delete,Z,{set:ca,value:la}),values:ua.setTypes(vi.values,(function(t){return mn.forItem(la(t))}),{set:ca}),clear:ua.setTypes(vi.clear,ca,{set:ca}),count:ua.setTypes(vi.count,An,{set:ca}),cmp:ua.setTypes(vi.cmp,An,{value:ya,test:ya}),copy:ua.setTypes(vi.copy,ca,{set:ca},{deepCopy:la},fa),map:ua.setTypes(vi.map,(function(t){return Ei.forItem(t.transform||la(t))}),{set:ca},{transform:function(t){return t.transform||la(t)}},fa),isValid:ua.setTypes(vi.isValid,Z,{value:ht}),isEqual:ua.setTypes(vi.isEqual,Z,{value:ya,test:ya}),isNotEqual:ua.setTypes(vi.isNotEqual,Z,{value:ya,test:ya}),isLess:ua.setTypes(vi.isLess,Z,{value:ya,test:ya}),isLessOrEqual:ua.setTypes(vi.isLessOrEqual,Z,{value:ya,test:ya}),isGreater:ua.setTypes(vi.isGreater,Z,{value:ya,test:ya}),isGreaterOrEqual:ua.setTypes(vi.isGreaterOrEqual,Z,{value:ya,test:ya}),asAny:ua.setTypes(vi.asAny,ht,{value:Ei}),asBoolean:ua.setTypes(vi.asBoolean,Z,{value:Ei}),asColor:ua.setTypes(vi.asColor,fi,{value:Ei}),asDate:ua.setTypes(vi.asDate,jo,{value:Ei}),asList:ua.setTypes(vi.asList,(function(t){return mn.forItem(ha(t))}),{value:Ei}),asMap:ua.setTypes(vi.asMap,(function(t){return Vo.forItem(ha(t),ha(t))}),{value:Ei}),asNumber:ua.setTypes(vi.asNumber,(function(t){return An}),{value:Ei}),asObject:ua.setTypes(vi.asObject,be,{value:Ei}),asText:ua.setTypes(vi.asText,qt,{value:Ei}),asTuple:ua.setTypes(vi.asTuple,(function(t){return xn.forItem([t.value||Ei])}),{value:Ei}),asSet:ua.setTypes(vi.asSet,(function(t){return t.value||Ei}),{value:Ei})},va=qt.operations,ma=mn.forItem(qt),ga=Si.object({index:An,lastIndex:An,input:qt,groups:ma}),Ta={create:va.setTypes(At.create,qt),uuid:va.setTypes(At.uuid,qt),maybe:va.setTypes(At.maybe,(function(t){return Si.maybe(t.value,qt)}),{value:ht}),append:va.setTypes(At.append,qt,{value:qt,append:qt}),prepend:va.setTypes(At.prepend,qt,{value:qt,prepend:qt}),lower:va.setTypes(At.lower,qt,{value:qt}),upper:va.setTypes(At.upper,qt,{value:qt}),char:va.setTypes(At.char,qt,{value:qt,index:An},{outside:qt}),replace:va.setTypes(At.replace,qt,{value:qt,find:qt,replace:qt}),repeat:va.setTypes(At.repeat,qt,{value:qt,times:An}),split:va.setTypes(At.split,ma,{value:qt,by:qt},{limit:An}),chars:va.setTypes(At.chars,ma,{value:qt}),sub:va.setTypes(At.sub,qt,{value:qt},{start:An,end:An}),indexOf:va.setTypes(At.indexOf,An,{value:qt,search:qt},{start:An}),lastIndexOf:va.setTypes(At.lastIndexOf,An,{value:qt,search:qt},{start:An}),trim:va.setTypes(At.trim,qt,{value:qt},{start:Z,end:Z}),startsWith:va.setTypes(At.startsWith,Z,{value:qt,test:qt}),endsWith:va.setTypes(At.endsWith,Z,{value:qt,test:qt}),soundex:va.setTypes(At.soundex,qt,{value:qt},{max:An,min:An}),metaphone:va.setTypes(At.metaphone,qt,{value:qt}),distance:va.setTypes(At.distance,An,{value:qt,test:qt}),length:va.setTypes(At.length,An,{value:qt}),compare:va.setTypes(At.compare,An,{value:qt,test:qt},{ignoreCase:Z}),like:va.setTypes(At.like,Z,{value:qt,pattern:qt},{ignoreCase:Z}),pad:va.setTypes(At.pad,qt,{value:qt,padding:qt,min:An},{max:An,append:Z}),regexTest:va.setTypes(At.regexTest,Z,{value:qt,regex:qt},{ignoreCase:Z,multiline:Z}),regexSplit:va.setTypes(At.regexSplit,ma,{value:qt,regex:qt},{limit:An,ignoreCase:Z,multiline:Z}),regexMatch:va.setTypes(At.regexMatch,ma,{value:qt,regex:qt},{ignoreCase:Z,multiline:Z}),regexMatchAll:va.setTypes(At.regexMatchAll,mn.forItem(ga),{value:qt,regex:qt},{ignoreCase:Z,multiline:Z}),regexReplace:va.setTypes(At.regexReplace,qt,{value:qt,regex:qt,replacement:qt},{all:Z,ignoreCase:Z,multiline:Z}),regexReplaceDynamic:va.setTypes(At.regexReplaceDynamic,qt,{value:qt,regex:qt,replace:qt},{all:Z,ignoreCase:Z,multiline:Z},{match:ga}),regexIndexOf:va.setTypes(At.regexIndexOf,An,{value:qt,regex:qt},{ignoreCase:Z,multiline:Z}),base64:va.setTypes(At.base64,qt,{value:qt}),unbase64:va.setTypes(At.unbase64,qt,{value:qt}),encodeURI:va.setTypes(At.encodeURI,qt,{value:qt}),decodeURI:va.setTypes(At.decodeURI,qt,{value:qt}),encodeURIComponent:va.setTypes(At.encodeURIComponent,qt,{value:qt}),decodeURIComponent:va.setTypes(At.decodeURIComponent,qt,{value:qt}),md5:va.setTypes(At.md5,qt,{value:qt}),encrypt:va.setTypes(At.encrypt,qt,{value:qt,secret:qt}),decrypt:va.setTypes(At.decrypt,qt,{value:qt,secret:qt}),toNumber:va.setTypes(At.toNumber,An,{value:qt},{invalidValue:An}),isValid:va.setTypes(At.isValid,Z,{value:ht}),isEmpty:va.setTypes(At.isEmpty,Z,{value:qt}),isNotEmpty:va.setTypes(At.isNotEmpty,Z,{value:qt}),isEqual:va.setTypes(At.isEqual,Z,{a:qt,b:qt},{ignoreCase:Z}),isNotEqual:va.setTypes(At.isNotEqual,Z,{a:qt,b:qt},{ignoreCase:Z}),isLess:va.setTypes(At.isLess,Z,{value:qt,test:qt},{ignoreCase:Z}),isLessOrEqual:va.setTypes(At.isLessOrEqual,Z,{value:qt,test:qt},{ignoreCase:Z}),isGreater:va.setTypes(At.isGreater,Z,{value:qt,test:qt},{ignoreCase:Z}),isGreaterOrEqual:va.setTypes(At.isGreaterOrEqual,Z,{value:qt,test:qt},{ignoreCase:Z}),isLower:va.setTypes(At.isLower,Z,{value:qt}),isUpper:va.setTypes(At.isUpper,Z,{value:qt}),isUuid:va.setTypes(At.isUuid,Z,{value:qt}),asAny:va.setTypes(At.asAny,ht,{value:qt}),asBoolean:va.setTypes(At.asBoolean,Z,{value:qt}),asColor:va.setTypes(At.asColor,fi,{value:qt}),asDate:va.setTypes(At.asDate,jo,{value:qt}),asList:va.setTypes(At.asList,(function(t){return mn.forItem(t.value||qt)}),{value:qt}),asMap:va.setTypes(At.asMap,(function(t){return Vo.forItem(t.value||qt)}),{value:qt}),asNumber:va.setTypes(At.asNumber,An,{value:qt}),asObject:va.setTypes(At.asObject,be,{value:qt}),asText:va.setTypes(At.asText,(function(t){return t.value||qt}),{value:qt}),asTuple:va.setTypes(At.asTuple,(function(t){return xn.forItem([t.value||qt])}),{value:qt}),asSet:va.setTypes(At.asSet,(function(t){return Ei.forItem(t.value||qt)}),{value:qt})},ba=xn.operations,xa={create:ba.setTypes(rn.create,xn),maybe:ba.setTypes(rn.maybe,(function(t){return Si.maybe(t.value,xn)}),{value:ht}),cmp:ba.setTypes(rn.cmp,An,{value:xn,test:xn}),copy:ba.setTypes(rn.copy,xn,{value:xn}),build:ba.setTypes(rn.build,(function(t){var e,n,r=[],o=!1;try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(["a","b","c","d","e"]),s=i.next();!s.done;s=i.next()){var a=t[s.value];a&&(a instanceof xn?r=r.concat(a.options):a instanceof mn?(o=!0,r.push(a.options.item)):r.push(a))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o?mn.forItem(Si.mergeMany(r,ct.baseType)):new xn(r)}),{a:ht,b:ht},{c:ht,d:ht,e:ht}),get:ba.setTypes(rn.get,ht,{value:xn,index:An}),set:ba.setTypes(rn.set,ht,{value:xn,index:An,element:ht}),isValid:ba.setTypes(rn.isValid,Z,{value:ht}),isEqual:ba.setTypes(rn.isEqual,Z,{value:xn,test:xn}),isNotEqual:ba.setTypes(rn.isNotEqual,Z,{value:xn,test:xn}),isLess:ba.setTypes(rn.isLess,Z,{value:xn,test:xn}),isLessOrEqual:ba.setTypes(rn.isLessOrEqual,Z,{value:xn,test:xn}),isGreater:ba.setTypes(rn.isGreater,Z,{value:xn,test:xn}),isGreaterOrEqual:ba.setTypes(rn.isGreaterOrEqual,Z,{value:xn,test:xn}),asAny:ba.setTypes(rn.asAny,ht,{value:xn}),asBoolean:ba.setTypes(rn.asBoolean,Z,{value:xn}),asColor:ba.setTypes(rn.asColor,fi,{value:xn}),asDate:ba.setTypes(rn.asDate,jo,{value:xn}),asList:ba.setTypes(rn.asList,(function(t){return mn.forItem(t.value||xn)}),{value:xn}),asMap:ba.setTypes(rn.asMap,(function(t){return Vo.forItem(t.value||xn)}),{value:xn}),asNumber:ba.setTypes(rn.asNumber,An,{value:xn}),asObject:ba.setTypes(rn.asObject,be,{value:xn}),asText:ba.setTypes(rn.asText,qt,{value:xn}),asTuple:ba.setTypes(rn.asTuple,(function(t){return t.value||xn}),{value:xn}),asSet:ba.setTypes(rn.asSet,(function(t){return Ei.forItem(t.value||xn)}),{value:xn})},Oa=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ea=function(){function t(t,e){void 0===e&&(e={}),this.cached={},this.sections=[],this.add(t),this.escapes=e}return t.prototype.add=function(t,e){if(o(t))e&&(this.getSection(t.length).formats[t]=e);else for(var n in t)this.getSection(n.length).formats[n]=t[n];return this},t.prototype.getSection=function(t){var e,n,r=this.sections.length-t,o=this.sections[r];if(o&&o.size===t)return o;try{for(var i=Oa(this.sections),s=i.next();!s.done;s=i.next()){var a=s.value;if(a.size===t)return a}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}var u={size:t,formats:{}};return this.sections.push(u),this.sortBySize(),u},t.prototype.getFormatter=function(t,e){if(void 0===e&&(e=!1),t in this.cached)return this.cached[t];for(var n,r=this.sections,o=[],i="",s=function(e){var s=a.getEscaped(t,e);if(!1!==s){var u=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(s,2),p=u[0],c=u[1];return i+=p,n=e=c-1,"continue"}for(var l=!1,f=0;f<r.length&&!l;f++){var y=r[f],h=t.substring(e,e+y.size);if(h.length===y.size){var d=y.formats[h];d&&(o.push(d),e+=y.size-1,l=!0)}}if(l){if(i){var v=i;o.splice(o.length-1,0,(function(){return v})),i=""}}else i+=t.charAt(e);n=e},a=this,u=0;u<t.length;u++)s(u),u=n;i&&o.push((function(){return i}));var p=function(t){var e,n,r="";try{for(var i=Oa(o),s=i.next();!s.done;s=i.next())r+=(0,s.value)(t)}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r};return e&&(this.cached[t]=p),p},t.prototype.format=function(t,e,n){return void 0===n&&(n=!1),this.getFormatter(t,n)(e)},t.prototype.sortBySize=function(){this.sections.sort((function(t,e){return e.size-t.size}))},t.prototype.getEscaped=function(t,e){var n=t.charAt(e),r=this.escapes[n];if(!r)return!1;var o=r.start,i=r.end,s=r.startEscape,a=r.endEscape;if(t.substring(e,e+o.length)!==o)return!1;var u=e-s.indexOf(o);if(t.substring(u,u+s.length)===s)return!1;e+=o.length;var p=a.indexOf(i),c=t.indexOf(i,e),l=t.substring(e,c);for(e=c-p;-1!==c&&t.substring(e,e+a.length)===a;)l=l.substring(0,l.length-p),l+=i,e+=a.length,c=t.indexOf(i,e),l+=t.substring(e,c),e=c-p;return-1!==c&&[l,c+i.length]},t}(),wa=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Sa=new Ea({M:function(t){return wa(t,1)[0].getMonth()+1+""},Mo:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(n.getMonth()+1)},MM:function(t){return M(wa(t,1)[0].getMonth()+1,2)},MMm:function(t){var e=wa(t,2),n=e[0];return e[1].months[3][n.getMonth()]},MMM:function(t){var e=wa(t,2),n=e[0];return e[1].months[2][n.getMonth()]},MMMm:function(t){var e=wa(t,2),n=e[0];return e[1].months[1][n.getMonth()]},MMMM:function(t){var e=wa(t,2),n=e[0];return e[1].months[0][n.getMonth()]},Q:function(t){return Gr(wa(t,1)[0])+1+""},Qo:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(Gr(n)+1)},D:function(t){return wa(t,1)[0].getDate()+""},Do:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(n.getDate())},DD:function(t){return M(wa(t,1)[0].getDate(),2)},DDD:function(t){return Nr(wa(t,1)[0])+""},DDDo:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(Nr(n))},DDDD:function(t){return M(Nr(wa(t,1)[0]),3)},d:function(t){return wa(t,1)[0].getDay()+""},do:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(n.getDay())},dd:function(t){var e=wa(t,2),n=e[0];return e[1].weekdays[3][n.getDay()]},ddd:function(t){var e=wa(t,2),n=e[0];return e[1].weekdays[2][n.getDay()]},dddd:function(t){var e=wa(t,2),n=e[0];return e[1].weekdays[0][n.getDay()]},e:function(t){return Ar(wa(t,1)[0])+""},E:function(t){return Ar(wa(t,1)[0])+1+""},eo:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(Ar(n))},Eo:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(Ar(n)+1)},w:function(t){return br(wa(t,1)[0])+""},wo:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(br(n))},ww:function(t){return M(br(wa(t,1)[0]),2)},W:function(t){return Tr(wa(t,1)[0])+""},Wo:function(t){var e=wa(t,2),n=e[0];return e[1].suffix(Tr(n))},WW:function(t){return M(Tr(wa(t,1)[0]),2)},Y:function(t){return wa(t,1)[0].getFullYear()+""},YY:function(t){return M(wa(t,1)[0].getFullYear()%100,2)},YYYY:function(t){return M(wa(t,1)[0].getFullYear(),4,10)},gg:function(t){return M(wa(t,1)[0].getFullYear()%100,2)},gggg:function(t){return M(wa(t,1)[0].getFullYear(),4,10)},GG:function(t){return M(wa(t,1)[0].getFullYear()%100,2)},GGGG:function(t){return M(wa(t,1)[0].getFullYear(),4,10)},a:function(t){var e=wa(t,2),n=e[0],r=e[1];return n.getHours()<12?r.am:r.pm},A:function(t){var e=wa(t,2),n=e[0],r=e[1];return n.getHours()<12?r.am.toUpperCase():r.pm.toUpperCase()},H:function(t){return wa(t,1)[0].getHours()+""},HH:function(t){return M(wa(t,1)[0].getHours(),2)},h:function(t){return(wa(t,1)[0].getHours()%12||12)+""},hh:function(t){return M(wa(t,1)[0].getHours()%12||12,2)},k:function(t){return wa(t,1)[0].getHours()+1+""},kk:function(t){return M(wa(t,1)[0].getHours()+1,2)},m:function(t){return wa(t,1)[0].getMinutes()+""},mm:function(t){return M(wa(t,1)[0].getMinutes(),2)},s:function(t){return wa(t,1)[0].getSeconds()+""},ss:function(t){return M(wa(t,1)[0].getSeconds(),2)},S:function(t){return M(wa(t,1)[0].getMilliseconds(),3,1)},SS:function(t){return M(wa(t,1)[0].getMilliseconds(),3,2)},SSS:function(t){return M(wa(t,1)[0].getMilliseconds(),3)},SSSS:function(t){return M(wa(t,1)[0].getMilliseconds(),3)+"0"},SSSSS:function(t){return M(wa(t,1)[0].getMilliseconds(),3)+"00"},SSSSSS:function(t){return M(wa(t,1)[0].getMilliseconds(),3)+"000"},SSSSSSS:function(t){return M(wa(t,1)[0].getMilliseconds(),3)+"0000"},SSSSSSSS:function(t){return M(wa(t,1)[0].getMilliseconds(),3)+"00000"},SSSSSSSSS:function(t){return M(wa(t,1)[0].getMilliseconds(),3)+"000000"},z:function(t){return wa(t,1)[0].toLocaleTimeString("en-us",{timeZoneName:"short"}).split(" ")[2]},zz:function(t){return wa(t,1)[0].toLocaleTimeString("en-us",{timeZoneName:"long"}).split(" ")[2]},Z:function(t){return _a(wa(t,1)[0],":")},ZZ:function(t){return _a(wa(t,1)[0],"")},X:function(t){var e=wa(t,1)[0];return Math.floor(e.valueOf()/1e3)+""},x:function(t){return wa(t,1)[0].valueOf()+""},LT:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatLT,[n,r])},LTS:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatLTS,[n,r])},L:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatL,[n,r])},l:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatl,[n,r])},LL:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatLL,[n,r])},ll:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatll,[n,r])},LLL:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatLLL,[n,r])},lll:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatlll,[n,r])},LLLL:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatLLLL,[n,r])},llll:function(t){var e=wa(t,2),n=e[0],r=e[1];return Pa.format(r.formatllll,[n,r])}},{"[":{start:"[",startEscape:"\\[",end:"]",endEscape:"\\]"},"'":{start:"'",startEscape:"''",end:"'",endEscape:"''"}}),Pa=Sa;function _a(t,e){var n=kr(t),r=Math.floor(Math.abs(n)/100),o=Math.abs(n)%100;return(n<0?"-":"+")+M(r,2)+e+M(o,2)}var Ia=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function Ma(t){t.expressionParsers.return=function(t,e){return e.setLegacy(),Ge.decode([t[0],A.RETURN,t[1]],e)},t.expressionParsers.up=function(t,e){return e.setLegacy(),Xt.decode([t[0],t[1],t[2],t[3]||"current"],e)},t.expressionParsers.sub=function(t,e){var n=e.getExpression(t[1]),r=t[2].map((function(t){return e.getExpression(t)}));return e.setLegacy(),ee.createForLegacy(function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ia(arguments[e]));return t}([n],r))}}}},e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}return n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(961)})()}));
//# sourceMappingURL=expangine-runtime.js.map