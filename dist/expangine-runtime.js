!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["expangine-runtime"]=t():e["expangine-runtime"]=t()}(self,(function(){return(()=>{"use strict";var e={16:(e,t,n)=>{n.r(t),n.d(t,{AndExpression:()=>ne,AnyComputeds:()=>oe,AnyOperations:()=>re,AnyOps:()=>ae,AnyOpsTypes:()=>ls,AnyType:()=>ye,BooleanComputeds:()=>B,BooleanOperations:()=>H,BooleanOps:()=>J,BooleanOpsTypes:()=>ys,BooleanType:()=>Q,COMPONENT_MAX:()=>Ho,COMPONENT_MIN:()=>Go,ChainExpression:()=>Ee,ColorBlendModes:()=>Ts,ColorComponentEnum:()=>ds,ColorComputeds:()=>Vo,ColorFormats:()=>ms,ColorNames:()=>gs,ColorOperations:()=>Fo,ColorOps:()=>Wo,ColorOpsTypes:()=>bs,ColorOrNumber:()=>vs,ColorSpace:()=>Jo,ColorSpaceHSL:()=>ei,ColorSpaceRGB:()=>zo,ColorType:()=>si,CommentExpression:()=>Se,ComputedExpression:()=>rt,Computeds:()=>W,ConstantExpression:()=>Ue,DAYS_IN_WEEK:()=>An,DAY_MAX:()=>Yn,DAY_MIN:()=>Vn,DataTypeRegistry:()=>z,DataTypes:()=>X,DateComputeds:()=>xo,DateFormat:()=>xa,DateOperations:()=>bo,DateOps:()=>Eo,DateOpsTypes:()=>Ss,DateParsers:()=>or,DateType:()=>Po,DefineExpression:()=>ve,Definitions:()=>Xi,DoExpression:()=>be,Entity:()=>Ci,EntityComputeds:()=>lt,EntityKeyType:()=>fi,EntityOperations:()=>ct,EntityOps:()=>yt,EntityOpsTypes:()=>ps,EntityPrimaryType:()=>yi,EntityType:()=>Et,EnumType:()=>He,EventBase:()=>Oi,Expression:()=>q,Exprs:()=>Pn,FastMap:()=>Gi,ForExpression:()=>at,Format:()=>Ta,Func:()=>Si,GetDataExpression:()=>pt,GetEntityExpression:()=>St,GetExpression:()=>_e,GetRelationExpression:()=>Mt,HOURS_IN_DAY:()=>kn,HOUR_MAX:()=>Wn,ID:()=>G,IfExpression:()=>Ct,InvokeExpression:()=>jt,LinkedNode:()=>Ti,ListComputeds:()=>un,ListOperations:()=>an,ListOps:()=>cn,ListOpsTypes:()=>Vs,ListType:()=>dn,MILLIS_IN_DAY:()=>Ln,MILLIS_IN_HOUR:()=>Rn,MILLIS_IN_MINUTE:()=>Nn,MILLIS_IN_SECOND:()=>Dn,MILLIS_MAX:()=>Bn,MINUTE_MAX:()=>Gn,MONTHS_IN_QUARTER:()=>qn,MONTHS_IN_YEAR:()=>Fn,ManyType:()=>Co,MapComputeds:()=>qe,MapOperations:()=>Le,MapOps:()=>Ve,MapOpsTypes:()=>$s,MapType:()=>Ao,MethodExpression:()=>At,NamedMap:()=>Bi,NoExpression:()=>le,NotExpression:()=>ee,NotType:()=>qo,NullType:()=>pe,NumberComputeds:()=>rn,NumberOperations:()=>nn,NumberOps:()=>sn,NumberOpsTypes:()=>ea,NumberType:()=>_n,ObjectComputeds:()=>dt,ObjectExpression:()=>En,ObjectOperations:()=>ht,ObjectOps:()=>mt,ObjectOpsTypes:()=>ra,ObjectType:()=>xt,OperationExpression:()=>Ft,Operations:()=>Y,OptionalType:()=>Ro,OrExpression:()=>Rt,PathExpression:()=>tt,Program:()=>Ni,ReferenceData:()=>qi,Relation:()=>ji,RelationCascade:()=>Ii,RelationKind:()=>_i,ReturnExpression:()=>Yt,Runtime:()=>$i,SECONDS_IN_MINUTE:()=>jn,SECOND_MAX:()=>Hn,SetComputeds:()=>ui,SetExpression:()=>Ke,SetOperations:()=>ai,SetOps:()=>ci,SetOpsTypes:()=>la,SetType:()=>mi,SubExpression:()=>es,SwitchExpression:()=>Bt,TemplateExpression:()=>Jt,TextComputeds:()=>Ce,TextOperations:()=>Ie,TextOps:()=>je,TextOpsTypes:()=>da,TextType:()=>Re,TraverseRemoveNoop:()=>A,TraverseReplaceNoop:()=>N,Traverser:()=>R,TupleComputeds:()=>Zt,TupleExpression:()=>xn,TupleOperations:()=>Qt,TupleOps:()=>tn,TupleOpsTypes:()=>ma,TupleType:()=>Tn,Type:()=>L,Types:()=>gi,UpdateExpression:()=>$e,ValidationSeverity:()=>j,ValidationType:()=>k,WEEKDAY_MAX:()=>Un,WhileExpression:()=>$t,add:()=>er,addDays:()=>io,addHours:()=>oo,addMilliseconds:()=>to,addMinutes:()=>ro,addMonths:()=>ao,addQuarters:()=>uo,addSeconds:()=>no,addWeeks:()=>so,addYears:()=>po,adjusters:()=>zn,arraySync:()=>b,clamp:()=>m,clampComponent:()=>Uo,coalesce:()=>_,compareDates:()=>rr,currentLocale:()=>Cn,daysInMonth:()=>Ar,defs:()=>ts,diff:()=>tr,diffDays:()=>ho,diffHours:()=>yo,diffMilliseconds:()=>co,diffMinutes:()=>fo,diffMonths:()=>mo,diffQuarters:()=>go,diffSeconds:()=>lo,diffWeeks:()=>vo,diffYears:()=>To,endOf:()=>Zn,endOfDay:()=>Xr,endOfHour:()=>zr,endOfMinute:()=>Kr,endOfMonth:()=>Qr,endOfQuarter:()=>Zr,endOfSecond:()=>Jr,endOfWeek:()=>$r,endOfYear:()=>eo,getAbsoluteTimestamp:()=>Rr,getDateOffset:()=>Cr,getDayIdentifier:()=>ar,getDayOfWeek:()=>_r,getDayOfYear:()=>Ir,getDaysInMonth:()=>Nr,getDaysInYear:()=>kr,getFullWeekOf:()=>Mr,getFullWeekOfMonth:()=>xr,getFullWeekOfYear:()=>vr,getLastDayOfMonth:()=>lr,getLastFullWeekOfMonth:()=>Or,getLastFullWeekOfYear:()=>gr,getLastWeekspanOfMonth:()=>br,getLastWeekspanOfYear:()=>fr,getMonthIdentifier:()=>pr,getQuarter:()=>qr,getQuarterIdentifier:()=>cr,getTimeIdentifier:()=>sr,getTimezoneOffsetInMilliseconds:()=>Lr,getWeek:()=>Pr,getWeekISO:()=>Sr,getWeekIdentifier:()=>ur,getWeekOfMonth:()=>wr,getWeekOfMonthISO:()=>Er,getWeekOfYear:()=>hr,getWeekOfYearISO:()=>yr,getWeeksInYear:()=>mr,getWeekspanOfMonth:()=>Tr,getWeekspanOfYear:()=>dr,getters:()=>Xn,isArray:()=>i,isBoolean:()=>p,isColor:()=>Bo,isColorHSL:()=>Zo,isDate:()=>s,isDaylightSavingTime:()=>Dr,isEmpty:()=>d,isFunction:()=>c,isLeapYear:()=>jr,isMap:()=>a,isNumber:()=>r,isObject:()=>l,isOperationTypeFunction:()=>F,isSameClass:()=>y,isSet:()=>u,isString:()=>o,isUndefined:()=>f,isWhole:()=>h,mutate:()=>nr,now:()=>v,objectEach:()=>E,objectFromProps:()=>P,objectMap:()=>O,objectReduce:()=>S,objectSync:()=>x,objectToArray:()=>M,objectValues:()=>w,pad:()=>C,padNumber:()=>I,parse:()=>ir,reverseMap:()=>T,setters:()=>$n,startOf:()=>Qn,startOfDay:()=>Wr,startOfHour:()=>Yr,startOfMinute:()=>Vr,startOfMonth:()=>Hr,startOfQuarter:()=>Br,startOfSecond:()=>Fr,startOfWeek:()=>Gr,startOfYear:()=>Ur,toMap:()=>g,toString:()=>D});function r(e){return"number"==typeof e&&isFinite(e)}function o(e){return"string"==typeof e}function i(e){return Array.isArray(e)}function s(e){return e instanceof Date}function a(e){return e instanceof Map}function u(e){return e instanceof Set}function p(e){return"boolean"==typeof e}function c(e){return"function"==typeof e}function l(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function f(e){return void 0===e}function y(e,t){return e.constructor===t.constructor}function h(e,t){return void 0===t&&(t=1e-6),Math.abs(e-Math.round(e))<=t}function d(e){if(i(e))return 0===e.length;if(l(e)){for(var t in e)return!1;return!0}return null==e}function v(){return(new Date).getTime()}function m(e,t,n){return e<t?t:e>n?n:e}function g(e){return i(e)?new Map(e):a(e)?e:l(e)?new Map(M(e,(function(e,t){return[t,e]}))):new Map}function T(e){return new Map(Array.from(e.entries()).map((function(e){var t=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(e,2),n=t[0];return[t[1],n]})))}function b(e,t,n,r,o,i){for(var s=t.map((function(){return!1})),a=function(r){var a=e[r],u=t.findIndex((function(e){return n(a,e)}));-1!==u?(i(e,r,a,t[u]),s[u]=!0):o(e,r,a)},u=e.length-1;u>=0;u--)a(u);for(u=0;u<t.length;u++)s[u]||r(e,t[u]);return e}function x(e,t,n,r,o){for(var i in e)i in t||r(e,i,e[i]);for(var i in t)i in e?o(e,i,e[i],t[i]):n(e,i,t[i]);return e}function O(e,t,n){return void 0===n&&(n=function(e){return e}),S(e,(function(e,r,o){return o[n(r,e)]=t(e,r),o}),Object.create(null))}function E(e,t){return S(e,(function(n,r){return t(n,r,e)}),void 0)}function w(e,t){return void 0===t&&(t=function(e){return e}),S(e,(function(e,n,r){return r.push(t(e,n)),r}),[])}function S(e,t,n){for(var r in e)n=t(e[r],r,n);return n}function P(e,t){for(var n=Object.create(null),r=0;r<e.length;r++){var o=e[r];n[o]=t(o,r)}return n}function M(e,t){var n=[];for(var r in e)n.push(t(e[r],r));return n}function _(e,t){return void 0===e?t:e}function I(e,t,n){return void 0===n&&(n=t),C(e+"",t,"0",!0).substring(0,n)}function C(e,t,n,r){for(;e.length<t;)r?e=n+e:e+=n;return e}function D(e){return i(e)||l(e)?JSON.stringify(e):e+""}var j,k,A=function(){},N=function(){},R=function(){function e(e,t){this.remove=A,this.replace=N,this.callback=e,this.stack=[],this.path=[],this.stopped=!1,this.result=t}return e.isTraversable=function(e){return e&&c(e.traverse)},e.prototype.enter=function(e,t){return this.stopped||(this.callback(e,this.stack,this.path,this),this.remove=A,this.replace=N,t&&!this.stopped&&(this.stack.push(e),t(),this.stack.pop())),this.result},e.prototype.step=function(t,n,r,o){return void 0===r&&(r=N),void 0===o&&(o=A),this.stopped||(this.path.push(t),this.remove=o,this.replace=r,e.isTraversable(n)?n.traverse(this):n(),this.path.pop()),this},e.prototype.modify=function(e){var t=e(this.result);return void 0!==t&&(this.result=t),this},e.prototype.stop=function(e){return this.result=e,this},e.prototype.getResult=function(){return this.result},e.prototype.removeOrReplace=function(e){var t=this.canRemove(),n=this.canReplace();return!(!t&&!n||(t?this.remove():this.replace(c(e)?e():e),0))},e.prototype.canRemove=function(){return this.remove!==A},e.prototype.canReplace=function(){return this.replace!==N},e.prototype.filterClass=function(e,t){return void 0===t&&(t=this.result),this.filter((function(t){return t.constructor===e}),t)},e.prototype.filter=function(t,n){var r=this;return void 0===n&&(n=this.result),new e((function(e,n,o,i){t(e,n,o)&&r.callback(e,n,o,i)}),n)},e.list=function(){var t=[];return new e((function(e,n,r){t.push({value:e,stack:n.slice(),path:r.slice()})}),t)},e.count=function(){return new e((function(e,t,n,r){return r.result++}),0)},e}(),L=function(){function e(e){this.parent=null,this.options=e}return e.prototype.getRequired=function(){return this},e.prototype.isWrapper=function(){return!1},e.prototype.getWrappedType=function(){return this},e.prototype.isCompatible=function(e,t){return void 0===t&&(t={}),e===this||!(t.exact||!e.isWrapper()||!this.isCompatible(e.getWrappedType(),t))||!(t.strict&&!y(this,e)&&!this.acceptsOtherTypes())&&this.isDeepCompatible(e,t)},e.prototype.acceptsOtherTypes=function(){return!1},e.prototype.acceptsType=function(e){return this.isCompatible(e,{strict:!0})},e.prototype.acceptsData=function(e){return this.isCompatible(e,{strict:!0,value:!0})},e.prototype.exactType=function(e){return this.isCompatible(e,{exact:!0,strict:!0})},e.prototype.exactData=function(e){return this.isCompatible(e,{exact:!0,strict:!0,value:!0})},e.prototype.getValueChangeExpression=function(e,t,n){return e},e.prototype.getValueChangeAt=function(e){for(var t=this.parent,n=this.getPath();t;){var r=n.pop();e=t.getValueChangeExpression(e,r,r),t=t.parent}return e},e.prototype.getPath=function(){var e=this;return this.getRootType().traverse(new R((function(t,n,r,o){t===e&&o.stop(r.slice())})))},e.prototype.getTypeFromPath=function(e){if(0===e.length)return this;var t=this.getTypeFromStep(e[0]);return t?t.getTypeFromPath(e.slice(1)):null},e.prototype.getTypeFromStep=function(e){return null},e.prototype.getRootType=function(){for(var e=this;e.parent;)e=e.parent;return e},e}();!function(e){e[e.LOW=1]="LOW",e[e.MEDIUM=2]="MEDIUM",e[e.HIGH=3]="HIGH"}(j||(j={})),function(e){e[e.UNSAFE_OPERATION=1]="UNSAFE_OPERATION",e[e.POSSIBLY_NULL=2]="POSSIBLY_NULL",e[e.INCOMPATIBLE_TYPES=3]="INCOMPATIBLE_TYPES",e[e.INVALID_EXPRESSION=4]="INVALID_EXPRESSION",e[e.MISSING_FUNCTION=5]="MISSING_FUNCTION",e[e.MISSING_EXPRESSION=6]="MISSING_EXPRESSION",e[e.MISSING_OPERATION=7]="MISSING_OPERATION",e[e.MISSING_TYPE_NAME=8]="MISSING_TYPE_NAME",e[e.MISSING_TYPE=9]="MISSING_TYPE",e[e.MISSING_RELATION_NAME=10]="MISSING_RELATION_NAME",e[e.MISSING_RELATION=11]="MISSING_RELATION",e[e.MISSING_DATA_NAME=12]="MISSING_DATA_NAME",e[e.MISSING_DATA=13]="MISSING_DATA",e[e.OUTSIDE_PATH=14]="OUTSIDE_PATH",e[e.READONLY=15]="READONLY",e[e.EMPTY_PATH=16]="EMPTY_PATH",e[e.INVALID_THIS=17]="INVALID_THIS",e[e.MISSING_METHOD=18]="MISSING_METHOD"}(k||(k={}));var q=function(){function e(){this.parent=null}return e.prototype.isDynamic=function(){return!0},e.prototype.getInnerExpression=function(e){return!1},e.prototype.isPathStart=function(){return!1},e.prototype.isPathNode=function(){return!1},e.prototype.isPathWritable=function(e){return!0},e.prototype.getPath=function(){var e=this;return this.getRootExpression().traverse(new R((function(t,n,r,o){t===e&&o.stop(r.slice())})))},e.prototype.getExpressionFromPath=function(e){if(0===e.length)return this;var t=this.getExpressionFromStep(e);if(!t||!t[1])return null;var n=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(t,2),r=n[0];return n[1].getExpressionFromPath(e.slice(r))},e.prototype.getExpressionFromStep=function(e){return null},e.prototype.getRootExpression=function(){for(var e=this;e.parent;)e=e.parent;return e},e.prototype.validations=function(e,t){var n=[];return this.validate(e,t,(function(e){return n.push(e)})),n},e.prototype.validateType=function(e,t,n,r,o,i){void 0===i&&(i=this);var s=n?n.getSimplifiedType():null,a=r?r.getType(e,t):null,u=a?a.getSimplifiedType():null,p=u;u?(u.isOptional()&&!s.isOptional()&&(p=p.getRequired()),s.acceptsType(p)?p!==u&&o({type:k.POSSIBLY_NULL,severity:j.MEDIUM,context:t,subject:r,parent:i,expected:s,actual:u}):o({type:k.INCOMPATIBLE_TYPES,severity:s.isCompatible(u)?j.MEDIUM:j.HIGH,context:t,subject:r,parent:i,expected:s,actual:u})):s&&!s.isOptional()&&o({type:k.INCOMPATIBLE_TYPES,severity:j.HIGH,context:t,subject:r,parent:i,expected:s}),r&&r.validate(e,t,o)},e.INSTANCE="instance",e}();function F(e){return!("baseType"in e)&&c(e)}var V,Y=function(){function e(e){this.prefix=e,this.map=Object.create(null),this.types=Object.create(null)}return e.prototype.get=function(e){return this.map[e]||this.map[this.prefix+e]},e.prototype.getTypes=function(e){return this.types[e]||this.types[this.prefix+e]},e.prototype.set=function(e,t,n,r,o,i,s){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===o&&(o=[]),void 0===i&&(i=[]),void 0===s&&(s=[]);var a=this.prefix+e,u=t.mutates||[],p=t.complexity||0,c=Object.create(null);o.forEach((function(e){return c[e]=e}));var l={id:a,mutates:u,complexity:p,params:n,optional:r,scope:o,scopeDefaults:c,hasScope:i,resultDependency:s};return this.map[a]=l,l},e.prototype.setTypes=function(e,t,n,r,o){void 0===n&&(n=Object.create(null)),void 0===r&&(r=Object.create(null)),void 0===o&&(o=Object.create(null));var i={returnType:t,params:n,optional:r,scope:o};return this.types[e.id]=i,i},e}(),W=function(){function e(e){this.prefix=e,this.map=Object.create(null),this.list=[]}return e.prototype.set=function(e,t,n,r){var o=this.prefix+e,i={id:o,op:t.id,value:n||t.params[0],params:r||{}};return this.map[o]=i,this.list.push(i),i},e.prototype.setWritable=function(e,t,n,r,o){var i=this.prefix+e,s=this.map[i];return s.writeable={op:t.id,value:n,newValue:r,params:o||{}},s},e.prototype.get=function(e){return this.map[e]||this.map[this.prefix+e]},e}(),G={Entity:"@",Any:"any",Boolean:"bool",Color:"color",Date:"date",Enum:"enum",Function:"func",List:"list",Many:"many",Not:"not",Map:"map",Null:"null",Number:"num",Object:"obj",Optional:"?",Reference:"ref",Relation:"rel",Set:"set",Text:"text",Tuple:"tuple",Delimiter:":"},H=new Y(G.Boolean+G.Delimiter),B=new W(G.Boolean+G.Delimiter),U=H,J={create:U.set("create"),maybe:U.set("maybe",{},["value"]),and:U.set("&",{},["a","b"]),or:U.set("|",{},["a","b"]),xor:U.set("^",{},["a","b"]),not:U.set("!",{},["a"]),cmp:U.set("cmp",{},["value","test"]),isValid:U.set("?",{},["value"]),isTrue:U.set("t?",{},["value"]),isFalse:U.set("f?",{},["value"]),isEqual:U.set("=",{},["value","test"]),isNotEqual:U.set("!=",{},["value","test"]),asAny:U.set("~"+G.Any,{},["value"]),asBoolean:U.set("~"+G.Boolean,{},["value"]),asColor:U.set("~"+G.Color,{},["value"]),asDate:U.set("~"+G.Date,{},["value"]),asList:U.set("~"+G.List,{},["value"]),asMap:U.set("~"+G.Map,{},["value"]),asNumber:U.set("~"+G.Number,{},["value"]),asObject:U.set("~"+G.Object,{},["value"]),asText:U.set("~"+G.Text,{},["value"]),asTuple:U.set("~"+G.Tuple,{},["value"]),asSet:U.set("~"+G.Set,{},["value"])},K=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},z=function(){function e(){this.objectSet=function(e,t,n){return e[t]=n},this.objectRemove=function(e,t){return delete e[t]},this.arrayAdd=function(e,t){return e.push(t)},this.arrayRemove=function(e,t){return e.splice(t,1)[0]},this.arraySet=function(e,t,n){return e.splice(t,1,n)[0]},this.compareTypes=this.createTypeMap((function(e,t){return t})),this.compareMap=this.createTypeMap((function(){return[]})),this.equalsMap=this.createTypeMap((function(){return[]})),this.copyList=[],this.jsonList=[],this.accessorList=[]}return e.prototype.compare=function(e,t){var n=this,r=function(e,t){var o,i,s=typeof e,a=typeof t;if(s!==a)return n.compareTypes[s]-n.compareTypes[a];var u=n.compareMap[s];try{for(var p=K(u),c=p.next();!c.done;c=p.next()){var l=c.value.compare(e,t,r);if(void 0!==l)return l}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return e===t?0:e<t?-1:1};return r(e,t)},e.prototype.getCompare=function(e,t){return 0===e&&0===t?0:e<t?1:-1},e.prototype.addCompare=function(e){return this.addToPriorityList(this.compareMap[e.type],e)},e.prototype.equals=function(e,t){var n=this,r=function(e,t){var o,i;if(e===t)return!0;var s=typeof e;if(s!==typeof t)return!1;var a=n.equalsMap[s];try{for(var u=K(a),p=u.next();!p.done;p=u.next()){var c=p.value.equals(e,t,r);if(void 0!==c)return c}}catch(e){o={error:e}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return!1};return r(e,t)},e.prototype.addEquals=function(e){return this.addToPriorityList(this.equalsMap[e.type],e)},e.prototype.copy=function(e,t){if(void 0===t&&(t=!1),!e)return e;if("object"==typeof e){var n=this.copyList;if(t){var r=new Map,o=function(e,t){r.set(e,t)},i=function(e){var t,s;if(!e)return e;if("object"==typeof e){var a=r.get(e);if(void 0!==a)return a;try{for(var u=K(n),p=u.next();!p.done;p=u.next()){var c=p.value.copy(e,i,o);if(void 0!==c)return c}}catch(e){t={error:e}}finally{try{p&&!p.done&&(s=u.return)&&s.call(u)}finally{if(t)throw t.error}}}return e};return i(e)}var s=function(e,t){},a=function(e){var t,r;if(!e)return e;if("object"==typeof e)try{for(var o=K(n),i=o.next();!i.done;i=o.next()){var u=i.value.copy(e,a,s);if(void 0!==u)return u}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return e};return a(e)}return e},e.prototype.addCopier=function(e){return this.addToPriorityList(this.copyList,e)},e.prototype.toJson=function(e){if(!e)return e;if("object"==typeof e){var t=this.jsonList,n=function(e){var r,o;if(!e)return e;if("object"==typeof e)try{for(var i=K(t),s=i.next();!s.done;s=i.next()){var a=s.value.toJson(e,n);if(void 0!==a)return a}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return e};return n(e)}return e},e.prototype.fromJson=function(e){if(!e)return e;if("object"==typeof e){var t=this.jsonList,n=function(e){var r,o;if(!e)return e;if("object"==typeof e)try{for(var i=K(t),s=i.next();!s.done;s=i.next()){var a=s.value.fromJson(e,n);if(void 0!==a)return a}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return e};return n(e)}return e},e.prototype.addJson=function(e){return this.addToPriorityList(this.jsonList,e)},e.prototype.get=function(e,t){var n,r,o=this.accessorList;try{for(var i=K(o),s=i.next();!s.done;s=i.next()){var a=s.value;if(a.isValid(e,t))return a.get(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.set=function(e,t,n){var r,o,i=this.accessorList;try{for(var s=K(i),a=s.next();!a.done;a=s.next()){var u=a.value;if(u.isValid(e,t))return u.set(e,t,n),!0}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return!1},e.prototype.remove=function(e,t){var n,r,o=this.accessorList;try{for(var i=K(o),s=i.next();!s.done;s=i.next()){var a=s.value;if(a.isValid(e,t))return a.remove(e,t),!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1},e.prototype.has=function(e,t,n){var r,o;void 0===n&&(n=!1);var i=this.accessorList;try{for(var s=K(i),a=s.next();!a.done;a=s.next()){var u=a.value;if(u.isValid(e,t))return u.has(e,t)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return n},e.prototype.addAccessor=function(e){return this.addToPriorityList(this.accessorList,e)},e.prototype.createTypeMap=function(t){var n=Object.create(null);return e.TYPES.forEach((function(e,r){n[e]=t(e,r)})),n},e.prototype.addToPriorityList=function(e,t){return e.push(t),e.sort((function(e,t){return t.priority-e.priority})),this},e.TYPES=["boolean","number","bigint","string","symbol","object","undefined","function"],e}(),X=new z,$=(V=function(e,t){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $(t,e),t.decode=function(e,n){return new t(e[1]||{})},t.encode=function(e){return d(e.options)?this.id:[this.id,e.options]},t.describe=function(e,t,n){return p(e)?this.baseType:null},t.register=function(){var e="boolean";X.addCompare({priority:0,type:e,compare:function(e,t){return(e?1:0)-(t?1:0)}}),X.addEquals({priority:0,type:e,equals:function(e,t){return e===t}})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){return!n.exact&&!n.strict||e instanceof t},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return Pn.op(J.create,{})},t.prototype.getValidateExpression=function(){return Pn.op(J.isValid,{value:Pn.get("value")})},t.prototype.getCompareExpression=function(){return Pn.op(J.cmp,{value:Pn.get("value"),test:Pn.get("test")})},t.prototype.isValid=function(e){if(p(e))return!0;var t=e+"";return!(!this.options.true||!this.options.true[t])||!(!this.options.false||!this.options.false[t])},t.prototype.normalize=function(e){if(!p(e)){var t=e+"";if(this.options.true&&this.options.true[t])return!0;if(this.options.false&&this.options.false[t])return!1}return e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t(X.copy(this.options))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return!1},t.prototype.random=function(e){return e(0,1,!1)<.5},t.prototype.fromJson=function(e){return e},t.prototype.toJson=function(e){return e},t.id=G.Boolean,t.operations=H,t.computeds=B,t.baseType=new t({}),t.describePriority=4,t.registered=!1,t}(L),Z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(e){function t(t){var n=e.call(this)||this;return n.expression=t,n}return Z(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]))},t.encode=function(e){var t=e.expression.encode();return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.expression.getComplexity(e,t)},t.prototype.isDynamic=function(){return this.expression.isDynamic()},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expression.clone())},t.prototype.getType=function(e,t){return Q.baseType},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){return e.step(t.STEP_NOT,n.expression,(function(e){return n.expression=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_NOT?[1,this.expression]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.expression.setParent(this)},t.prototype.validate=function(e,t,n){this.validateType(e,t,Q.baseType,this.expression,n)},t.prototype.mutates=function(e,t){return this.expression.mutates(e,t)},t.STEP_NOT="not",t.id="not",t}(q),te=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ne=function(e){function t(t){var n=e.call(this)||this;return n.expressions=t,n}return te(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){return n.getExpression(e)})))},t.encode=function(e){var t=e.expressions.map((function(e){return e.encode()}));return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.expressions.reduce((function(n,r){return Math.max(n,r.getComplexity(e,t))}),0)},t.prototype.isDynamic=function(){return this.expressions.some((function(e){return e.isDynamic()}))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expressions.map((function(e){return e.clone()})))},t.prototype.getType=function(e,t){return Q.baseType},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return t.expressions.forEach((function(n,r){return e.step(r,n,(function(e){return t.expressions.splice(r,1,e)}),(function(){return t.expressions.splice(r,1)}))}))}))},t.prototype.getExpressionFromStep=function(e){return r(e[0])&&e[0]<this.expressions.length?[1,this.expressions[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.expressions.forEach((function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){var r=this,o=Q.baseType;this.expressions.forEach((function(i){r.validateType(e,t,o,i,n)}))},t.prototype.mutates=function(e,t,n){var r,o;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.expressions),s=i.next();!s.done;s=i.next())if(s.value.mutates(e,t,n))return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},t.id="and",t}(q),re=new Y(G.Any+G.Delimiter),oe=new W(G.Any+G.Delimiter),ie=re,se={complexity:2},ae={cmp:ie.set("cmp",se,["value","test"]),copy:ie.set("copy",se,["value"]),isDefined:ie.set("isDefined",{},["value"]),getDefined:ie.set("getDefined",{},["value","defined"],[],["defined"],["defined"],["value"]),coalesce:ie.set("coalesce",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),require:ie.set("require",{},["value"],[],[],[],["value"]),ternary:ie.set("ternary",{},["condition","truthy","falsy"],[],[],[],["truthy","falsy"]),isValid:ie.set("?",{},["value"]),isEqual:ie.set("=",se,["value","test"]),isNotEqual:ie.set("!=",se,["value","test"]),isLess:ie.set("<",se,["value","test"]),isLessOrEqual:ie.set("<=",se,["value","test"]),isGreater:ie.set(">",se,["value","test"]),isGreaterOrEqual:ie.set(">=",se,["value","test"]),asAny:ie.set("~"+G.Any,{},["value"]),asBoolean:ie.set("~"+G.Boolean,{},["value"]),asColor:ie.set("~"+G.Color,{},["value"]),asDate:ie.set("~"+G.Date,{},["value"]),asList:ie.set("~"+G.List,{},["value"]),asMap:ie.set("~"+G.Map,{},["value"]),asNumber:ie.set("~"+G.Number,{},["value"]),asObject:ie.set("~"+G.Object,{},["value"]),asText:ie.set("~"+G.Text,{},["value"]),asTuple:ie.set("~"+G.Tuple,{},["value"]),asSet:ie.set("~"+G.Set,{},["value"])},ue=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ue(t,e),t.decode=function(e){return t.baseType},t.encode=function(e){return this.id},t.describe=function(e,t,n){return null===e?this.baseType:null},t.register=function(){},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){return e instanceof t},t.prototype.isOptional=function(){return!0},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null)},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return Pn.null()},t.prototype.getValidateExpression=function(){return Pn.op(ae.isEqual,{value:Pn.get("value"),test:Pn.null()})},t.prototype.getCompareExpression=function(){return Pn.op(ae.cmp,{value:Pn.get("value"),test:Pn.get("test")})},t.prototype.isValid=function(e){return null==e},t.prototype.normalize=function(e){return e},t.prototype.newInstance=function(){return this},t.prototype.clone=function(){return this},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return null},t.prototype.random=function(e){return null},t.prototype.fromJson=function(e){return null},t.prototype.toJson=function(e){return null},t.id=G.Null,t.operations=new Y(G.Null+G.Delimiter),t.computeds=new W(G.Null+G.Delimiter),t.baseType=new t(null),t.describePriority=6,t.registered=!1,t}(L),ce=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ce(t,e),t.decode=function(e,t){return this.instance},t.encode=function(e){return[this.id]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return 0},t.prototype.isDynamic=function(){return!1},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return this},t.prototype.getType=function(e,t){return pe.baseType},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null)},t.prototype.validate=function(e,t,n){},t.prototype.mutates=function(e,t){return!1},t.id="noop",t.instance=new t,t}(q),fe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fe(t,e),t.decode=function(e,t){return this.baseType},t.encode=function(e){return this.id},t.describe=function(e,n,r){return l(e)&&o(e.$any)?new t({}):null},t.register=function(){},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isCompatible=function(e){return!0},t.prototype.isDeepCompatible=function(e,t){return!0},t.prototype.isOptional=function(){return!0},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return Pn.string()},t.prototype.getValidateExpression=function(){return Pn.true()},t.prototype.getCompareExpression=function(){return Pn.op(ae.cmp,{value:Pn.get("value"),test:Pn.get("test")})},t.prototype.isValid=function(e){return!0},t.prototype.normalize=function(e){return e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t({})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return""},t.prototype.random=function(e){return null},t.prototype.fromJson=function(e){return X.fromJson(e)},t.prototype.toJson=function(e){return X.toJson(e)},t.id=G.Any,t.operations=re,t.computeds=oe,t.baseType=new t({}),t.describePriority=8,t.registered=!1,t}(L),he=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ve=function(e){function t(t,n){var r=e.call(this)||this;return r.define=t,r.body=n,r}return he(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){var t=de(e,2),r=t[0],o=t[1];return[r,n.getExpression(o)]})),n.getExpression(e[2]))},t.encode=function(e){var t=e.define.map((function(e){var t=de(e,2);return[t[0],t[1].encode()]}));return[this.id,t,e.body.encode()]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.define.reduce((function(n,r){var o=de(r,2),i=(o[0],o[1]);return Math.max(n,i.getComplexity(e,t))}),this.body.getComplexity(e,t))},t.prototype.isDynamic=function(){return this.body.isDynamic()},t.prototype.getScope=function(){var e={};return this.define.forEach((function(t){var n=de(t,2),r=n[0];return n[1],e[r]=ye.baseType})),e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.define.map((function(e){var t=de(e,2);return[t[0],t[1].clone()]})),this.body.clone())},t.prototype.getType=function(e,t){var n=e.getContextWithScope(t),r=n.scope,o=n.context;return this.define.forEach((function(t){var n=de(t,2),i=n[0],s=n[1];return r[i]=s.getType(e,o)})),this.body.getType(e,o)},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_DEFINE,(function(){return n.define.forEach((function(t,r){var o=de(t,2),i=o[0],s=o[1];return e.step(i,s,(function(e){return n.define[r].splice(1,1,e)}),(function(){return n.define.splice(r,1)}))}))})),e.step(t.STEP_BODY,n.body,(function(e){return n.body=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_BODY?[1,this.body]:e[0]===t.STEP_DEFINE?[2,this.define.filter((function(t){return de(t,1)[0]===e[1]})).map((function(e){var t=de(e,2);return t[0],t[1]}))[0]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.define.forEach((function(e){var n=de(e,2);return n[0],n[1].setParent(t)})),this.body.setParent(this)},t.prototype.validate=function(e,t,n){var r=e.getContextWithScope(t);this.define.forEach((function(t){var o=de(t,2),i=o[0],s=o[1];s.validate(e,r.context,n),r.scope[i]=s.getType(e,r.context)})),this.body.validate(e,r.context,n)},t.prototype.mutates=function(e,t,n){var r,o;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.define),s=i.next();!s.done;s=i.next())if(de(s.value,2)[1].mutates(e,t,n))return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return this.body.mutates(e,t,n)},t.prototype.with=function(e,t){var n,r=o(e)?((n={})[e]=t,n):e,i=function(e){var t=Pn.parse(r[e]),n=s.define.find((function(t){return de(t,1)[0]===e}));n?n[1]=t:s.define.push([e,t]),t.setParent(s)},s=this;for(var a in r)i(a);return this},t.prototype.run=function(e){return this.body=e,this.body.setParent(this),this},t.STEP_DEFINE="define",t.STEP_BODY="body",t.id="def",t}(q),me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=1e5,Te="break",be=function(e){function t(t,n,r,o){void 0===r&&(r=Te),void 0===o&&(o=ge);var i=e.call(this)||this;return i.condition=t,i.body=n,i.breakVariable=r,i.maxIterations=o,i}return me(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]),n.getExpression(e[2]),e[3]||Te,parseInt(e[4])||this.MAX_ITERATIONS)},t.encode=function(e){var t=[this.id,e.condition.encode(),e.body.encode()],n=e.maxIterations!==this.MAX_ITERATIONS;return(e.breakVariable!==Te||n)&&t.push(e.breakVariable),n&&t.push(e.maxIterations),t},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return Math.max(this.condition.getComplexity(e,t),this.body.getComplexity(e,t))+1},t.prototype.isDynamic=function(){return this.body.isDynamic()},t.prototype.getScope=function(){var e;return(e={})[this.breakVariable]=Q.baseType,e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.condition.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},t.prototype.getType=function(e,t){var n=e.getContextWithScope(t,this.getScope()).context,r=this.body.getType(e,n);return r?gi.optional(r):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_CONDITION,n.condition,(function(e){return n.condition=e})),e.step(t.STEP_BODY,n.body,(function(e){return n.body=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_CONDITION?[1,this.condition]:e[0]===t.STEP_BODY?[1,this.body]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.condition.setParent(this),this.body.setParent(this)},t.prototype.validate=function(e,t,n){this.validateType(e,t,Q.baseType,this.condition,n);var r=e.getContext(t,this.getScope());this.body.validate(e,r,n)},t.prototype.mutates=function(e,t,n){return this.condition.mutates(e,t,n)||this.body.mutates(e,t,n)},t.prototype.do=function(e,t){return this.body=e,this.body.setParent(this),t&&(this.condition=t,this.condition.setParent(this)),this},t.prototype.while=function(e){return this.condition=e,this.condition.setParent(this),this},t.prototype.withBreak=function(e){return this.breakVariable=e,this},t.prototype.withMax=function(e){return this.maxIterations=e,this},t.STEP_CONDITION="condition",t.STEP_BODY="body",t.MAX_ITERATIONS=ge,t.id="do",t}(q),xe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oe=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ee=function(e){function t(t){var n=e.call(this)||this;return n.chain=t,n}return xe(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){return n.getExpression(e)})))},t.encode=function(e){var t=e.chain.map((function(e){return e.encode()}));return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.chain.reduce((function(n,r){return Math.max(n,r.getComplexity(e,t))}),0)},t.prototype.isDynamic=function(){return!!this.chain.length&&this.chain[this.chain.length-1].isDynamic()},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.chain.map((function(e){return e.clone()})))},t.prototype.getType=function(e,t){return this.chain[this.chain.length-1].getType(e,t)},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return t.chain.forEach((function(n,r){return e.step(r,n,(function(e){return t.chain.splice(r,1,e)}),(function(){return t.chain.splice(r,1)}))}))}))},t.prototype.getExpressionFromStep=function(e){return r(e[0])&&e[0]<this.chain.length?[1,this.chain[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.chain.forEach((function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){this.chain.forEach((function(r){r.validate(e,t,n)}))},t.prototype.mutates=function(e,t,n){var r,o;try{for(var i=Oe(this.chain),s=i.next();!s.done;s=i.next())if(s.value.mutates(e,t,n))return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},t.prototype.add=function(e){var t,n,r=i(e)?e:[e];try{for(var o=Oe(r),s=o.next();!s.done;s=o.next()){var a=s.value;this.chain.push(a),a.setParent(this)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this},t.id="chain",t}(q),we=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Se=function(e){function t(t){var n=e.call(this)||this;return n.comment=t,n}return we(t,e),t.decode=function(e,n){return new t(e[1])},t.encode=function(e){return[this.id,e.comment]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return 0},t.prototype.isDynamic=function(){return!1},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.comment)},t.prototype.getType=function(e,t){return pe.baseType},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){},t.prototype.isPathWritable=function(e){return!1},t.prototype.mutates=function(e,t){return!1},t.id="comment",t.instance=new t(""),t}(q),Pe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Me=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pe(t,e),t.decode=function(e,n){if(e[1]){var r=e[1].map((function(e){return n.getExpression(e)}));return n.setLegacy(),tt.createForLegacy(function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Me(arguments[t]));return e}([new t],r))}return new t},t.encode=function(e){return[this.id]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t},t.prototype.getType=function(e,t){return t},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.getExpressionFromStep=function(e){return null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){},t.prototype.mutates=function(e,t){return!1},t.prototype.isPathStart=function(){return!0},t.prototype.isPathNode=function(){return!0},t.id="get",t}(q),Ie=new Y(G.Text+G.Delimiter),Ce=new W(G.Text+G.Delimiter),De=Ie,je={create:De.set("create"),uuid:De.set("uuid"),maybe:De.set("maybe",{},["value"]),append:De.set("+",{},["value","append"]),prepend:De.set("pre",{},["value","prepend"]),lower:De.set("lo",{},["value"]),upper:De.set("up",{},["value"]),char:De.set("@",{},["value","index"],["outside"]),replace:De.set("replace",{},["value","find","replace"]),repeat:De.set("repeat",{},["value","times"]),split:De.set("split",{},["value","by"],["limit"]),chars:De.set("chars",{},["value"]),sub:De.set("sub",{},["value"],["start","end"]),indexOf:De.set("i?",{},["value","search"],["start"]),lastIndexOf:De.set("li?",{},["value","search"],["start"]),trim:De.set("trim",{},["value"],["start","end"]),startsWith:De.set("starts",{},["value","test"]),endsWith:De.set("ends",{},["value","test"]),soundex:De.set("soundex",{complexity:1},["value"],["max","min"]),metaphone:De.set("metaphone",{complexity:1},["value"]),distance:De.set("dist",{complexity:1},["value","test"]),length:De.set("len",{},["value"]),compare:De.set("cmp",{},["value","test"],["ignoreCase"]),like:De.set("like",{},["value","pattern"],["ignoreCase"]),pad:De.set("pad",{},["value","padding","min"],["max","append"]),regexTest:De.set("regexTest",{},["value","regex"],["ignoreCase","multiline"]),regexSplit:De.set("regexSplit",{},["value","regex"],["limit","ignoreCase","multiline"]),regexMatch:De.set("regexMatch",{},["value","regex"],["ignoreCase","multiline"]),regexMatchAll:De.set("regexMatchAll",{},["value","regex"],["ignoreCase","multiline"]),regexReplace:De.set("regexReplace",{},["value","regex","replacement"],["all","ignoreCase","multiline"]),regexReplaceDynamic:De.set("regexReplaceDynamic",{},["value","regex","replace"],["all","ignoreCase","multiline"],["match"],["replace"]),regexIndexOf:De.set("regexIndexOf",{},["value","regex"],["ignoreCase","multiline"]),base64:De.set("base64",{},["value"]),unbase64:De.set("unbase64",{},["value"]),encodeURI:De.set("encodeURI",{},["value"]),decodeURI:De.set("decodeURI",{},["value"]),encodeURIComponent:De.set("encodeURIComponent",{},["value"]),decodeURIComponent:De.set("decodeURIComponent",{},["value"]),md5:De.set("md5",{},["value"]),encrypt:De.set("encrypt",{},["value","secret"]),decrypt:De.set("decrypt",{},["value","secret"]),toNumber:De.set("toNumber",{},["value"],["invalidValue"]),isValid:De.set("?",{},["value"]),isEmpty:De.set("0?",{},["value"]),isNotEmpty:De.set("n?",{},["value"]),isEqual:De.set("=",{},["a","b"],["ignoreCase"]),isNotEqual:De.set("!=",{},["a","b"],["ignoreCase"]),isLess:De.set("<",{},["value","test"],["ignoreCase"]),isLessOrEqual:De.set("<=",{},["value","test"],["ignoreCase"]),isGreater:De.set(">",{},["value","test"],["ignoreCase"]),isGreaterOrEqual:De.set(">=",{},["value","test"],["ignoreCase"]),isLower:De.set("lo?",{},["value"]),isUpper:De.set("up?",{},["value"]),isUuid:De.set("uuid?",{},["value"]),asAny:De.set("~"+G.Any,{},["value"]),asBoolean:De.set("~"+G.Boolean,{},["value"]),asColor:De.set("~"+G.Color,{},["value"]),asDate:De.set("~"+G.Date,{},["value"]),asList:De.set("~"+G.List,{},["value"]),asMap:De.set("~"+G.Map,{},["value"]),asNumber:De.set("~"+G.Number,{},["value"]),asObject:De.set("~"+G.Object,{},["value"]),asText:De.set("~"+G.Text,{},["value"]),asTuple:De.set("~"+G.Tuple,{},["value"]),asSet:De.set("~"+G.Set,{},["value"])};Ce.set("toUpper",je.upper),Ce.set("toLower",je.lower),Ce.set("chars",je.chars),Ce.set("trim",je.trim),Ce.set("soundex",je.soundex),Ce.set("metaphone",je.metaphone),Ce.set("base64",je.base64),Ce.set("unbase64",je.unbase64),Ce.set("encodeURI",je.encodeURI),Ce.set("decodeURI",je.decodeURI),Ce.set("encodeURIComponent",je.encodeURIComponent),Ce.set("decodeURIComponent",je.decodeURIComponent),Ce.set("md5",je.md5),Ce.set("toNumber",je.toNumber),Ce.set("isEmpty",je.isEmpty),Ce.set("isNotEmpty",je.isNotEmpty),Ce.set("isLower",je.isLower),Ce.set("isUpper",je.isUpper);var ke=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ae=function(){return(Ae=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ne="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-+=:.",Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ke(t,e),t.decode=function(e){return new t(this.decodeOptions(e[1]||{}))},t.encode=function(e){return d(e.options)?this.id:[this.id,this.encodeOptions(e.options)]},t.decodeOptions=function(e){var t=e.matches;return t&&(e.matches=new RegExp(t[0],t[1])),e},t.encodeOptions=function(e){var t=Ae({},e),n=t.matches;return n&&(t.matches=[n.source,n.flags]),t},t.describe=function(e,n,r){return o(e)?new t({min:e.length,max:e.length,requireLower:e.toLowerCase()===e,requireUpper:e.toUpperCase()===e}):null},t.register=function(){var e="string";X.addCompare({priority:4,type:e,compare:function(e,t){return e.localeCompare(t)}}),X.addEquals({priority:4,type:e,equals:function(e,t){return e===t}}),X.addAccessor({priority:4,isValid:o,get:function(e,t){return e[t]},set:function(e,t,n){},remove:function(e,t){return e.substring(0,t)+e.substring(t+1)},has:function(e,t){return void 0!==e[t]}})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.max=Math.max(t.max,n.max),t.min=Math.min(t.min,n.min),t.requireLower=t.requireLower&&n.requireLower,t.requireUpper=t.requireUpper&&n.requireUpper},t.prototype.getSubType=function(e,n,o){if(Ue.is(e)){if("length"===e.value)return gi.LENGTH;if(r(e.value))return gi.CHAR}var i=e.getType(n,o);if(i){if((i=i.getRequired())instanceof _n)return gi.CHAR;if(i instanceof He){if(i.options.value instanceof _n)return gi.CHAR;if(i.options.value instanceof t){var s=Array.from(i.options.constants.values());if(1===s.length&&"length"===s[0])return gi.LENGTH}}}},t.prototype.getSubTypes=function(e){return[{key:"length",value:gi.LENGTH},{key:gi.INDEX,value:gi.optional(gi.CHAR)}]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){if(!(e instanceof t))return!1;if(n.value){var r=this.options.min,o=e.options.min;if(r&&(!o||o<r))return!1;var i=this.options.max,s=e.options.max;if(i&&(!s||s>i))return!1;var a=this.options.forceLower||this.options.requireUpper,u=e.options.forceLower||e.options.requireLower;if(a&&!u)return!1;var p=this.options.forceUpper||this.options.requireUpper,c=e.options.forceUpper||e.options.requireUpper;if(p&&!c)return!1;var l=this.options.matches,f=e.options.matches;if(l&&(!f||f.source!==l.source))return!1}return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){this.options={}},t.prototype.getCreateExpression=function(){return Pn.op(je.create,{})},t.prototype.getValidateExpression=function(){return Pn.op(je.isValid,{value:Pn.get("value")})},t.prototype.getCompareExpression=function(){return Pn.op(je.compare,{value:Pn.get("value"),test:Pn.get("test"),ignoreCase:Pn.true()})},t.prototype.isValid=function(e){if(!o(e))return!1;var t=this.options,n=t.min,i=t.max,s=t.requireLower,a=t.requireUpper,u=t.matches,p=t.forceLower,c=t.forceUpper;return!(r(n)&&e.length<n||r(i)&&e.length>i||s&&e!==e.toLowerCase()&&!p||a&&e!==e.toUpperCase()&&!c||u&&u instanceof RegExp&&!u.test(e))},t.prototype.normalize=function(e){return o(e)&&(this.options.forceLower&&(e=e.toLowerCase()),this.options.forceUpper&&(e=e.toUpperCase())),e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t(X.copy(this.options))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return""},t.prototype.random=function(e){for(var t=this.options,n=t.min,r=t.max,o=t.requireLower,i=t.forceLower,s=t.requireUpper,a=t.forceUpper,u=o||i,p=s||a,c=e(_(n,1),_(r,16)+1,!0),l="",f=0;f<c;f++)l+=Ne.charAt(e(0,Ne.length,!0));return u&&(l=l.toLowerCase()),p&&(l=l.toUpperCase()),l},t.prototype.fromJson=function(e){return e},t.prototype.toJson=function(e){return e},t.id=G.Text,t.operations=Ie,t.computeds=Ce,t.baseType=new t({}),t.describePriority=3,t.registered=!1,t}(L),Le=new Y(G.Map+G.Delimiter),qe=new W(G.Map+G.Delimiter),Fe=Le,Ve={create:Fe.set("create"),createLike:Fe.set("createLike",{},["map"],[],[],[],["map"]),createFor:Fe.set("createFor",{},["value"],["key"],[],[],["value","key"]),maybe:Fe.set("maybe",{},["value"]),get:Fe.set("get",{},["map","key"],[],[],[],["map"]),set:Fe.set("set",{mutates:["map"]},["map","key","value"],[],["existingValue"],["value"],["map"]),has:Fe.set("has",{},["map","key"]),delete:Fe.set("delete",{mutates:["map"]},["map","key"]),keys:Fe.set("keys",{complexity:1},["map"],[],[],[],["map"]),values:Fe.set("values",{complexity:1},["map"],[],[],[],["map"]),entries:Fe.set("entries",{complexity:1},["map"],[],[],[],["map"]),pairs:Fe.set("pairs",{complexity:1},["map"],[],[],[],["map"]),clear:Fe.set("clear",{mutates:["map"]},["map"],[],[],[],["map"]),count:Fe.set("count",{},["map"]),cmp:Fe.set("cmp",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),copy:Fe.set("copy",{complexity:1},["map"],["deepCopy","deepCopyKey"],["map","key","value"],["deepCopy","deepCopyKey"],["map"]),map:Fe.set("map",{complexity:1},["map"],["transform","transformKey"],["map","key","value"],["transform","transformKey"],["map"]),toPlainObject:Fe.set("plain",{complexity:1},["map"]),fromPlainObject:Fe.set("fromPlain",{complexity:1},["object"],[],[],[],["object"]),isValid:Fe.set("?",{},["value"]),isEqual:Fe.set("=",{complexity:1},["value","test","isEqual"],[],["key","value","test"],["isEqual"]),isNotEqual:Fe.set("!=",{complexity:1},["value","test","isEqual"],[],["key","value","test"],["isEqual"]),isLess:Fe.set("<",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isLessOrEqual:Fe.set("<=",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isGreater:Fe.set(">",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isGreaterOrEqual:Fe.set(">=",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),asAny:Fe.set("~"+G.Any,{},["value"]),asBoolean:Fe.set("~"+G.Boolean,{},["value"]),asColor:Fe.set("~"+G.Color,{},["value"]),asDate:Fe.set("~"+G.Date,{},["value"]),asList:Fe.set("~"+G.List,{},["value"]),asMap:Fe.set("~"+G.Map,{},["value"]),asNumber:Fe.set("~"+G.Number,{},["value"]),asObject:Fe.set("~"+G.Object,{},["value"]),asText:Fe.set("~"+G.Text,{},["value"]),asTuple:Fe.set("~"+G.Tuple,{},["value"]),asSet:Fe.set("~"+G.Set,{},["value"])};qe.set("copy",Ve.copy),qe.set("keys",Ve.keys),qe.set("values",Ve.values),qe.set("entries",Ve.entries),qe.set("pairs",Ve.pairs),qe.set("count",Ve.count);var Ye=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),We=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ge=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ye(t,e),t.decode=function(e,n){var r=n.getType(e[1]),o=n.getType(e[2]),i=new Map(e[3].map((function(e){var t=We(e,2),n=t[0],i=t[1];return[r.fromJson(n),o.fromJson(i)]})));return new t({key:r,value:o,constants:i})},t.encode=function(e){var t=e.options,n=t.key,r=t.value,o=t.constants;return[this.id,n.encode(),r.encode(),Array.from(o.entries()).map((function(e){var t=We(e,2),o=t[0],i=t[1];return[n.toJson(o),r.toJson(i)]}))]},t.describe=function(){return null},t.register=function(){},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return this.options.value.getOperations()},t.prototype.merge=function(e){var t,n,r=this.options.constants,o=e.options.constants;this.options.key=gi.merge(this.options.key,e.options.key),this.options.value=gi.merge(this.options.value,e.options.value);try{for(var i=Ge(o.entries()),s=i.next();!s.done;s=i.next()){var a=We(s.value,2),u=a[0],p=a[1];r.set(u,p)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.getSubType=function(e,t,n){return this.options.value.getSubType(e,t,n)},t.prototype.getSubTypes=function(e){return this.options.value.getSubTypes(e)},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this.options.value},t.prototype.isWrapper=function(){return!0},t.prototype.getWrappedType=function(){return this.options.value},t.prototype.isDeepCompatible=function(e,n){if(void 0===n&&(n={}),!(e instanceof t))return!1;var r=this.options,o=r.key,i=r.value;return!(n.exact&&!o.isCompatible(e.options.key,n))&&i.isCompatible(e.options.value)},t.prototype.isOptional=function(){return this.options.value.isOptional()},t.prototype.isSimple=function(){return this.options.value.isSimple()},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_KEY,n.options.key,(function(e){return n.options.key=e})),e.step(t.STEP_VALUE,n.options.value,(function(e){return n.options.value=e}))}))},t.prototype.getTypeFromStep=function(e){return e===t.STEP_KEY?this.options.key:e===t.STEP_VALUE?this.options.value:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.key.setParent(this),this.options.value.setParent(this)},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return this.options.value.getCreateExpression()},t.prototype.getValidateExpression=function(){return this.options.value.getValidateExpression()},t.prototype.getCompareExpression=function(){return this.options.value.getCompareExpression()},t.prototype.getValueChangeExpression=function(e,n,r){return n===t.STEP_KEY?Pn.op(Ve.map,{map:Pn.get("value"),transformKey:e},{key:"value",value:"actualValue"}):Pn.op(Ve.map,{map:Pn.get("value"),transform:e})},t.prototype.isValid=function(e){var t,n,r=this.options,o=r.constants;if(!r.value.isValid(e))return!1;try{for(var i=Ge(o.values()),s=i.next();!s.done;s=i.next()){var a=s.value;if(0===X.compare(a,e))return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!1},t.prototype.normalize=function(e){return this.options.value.normalize(e)},t.prototype.newInstance=function(){var e=this.options,n=e.key,r=e.value;return new t({key:n.newInstance(),value:r.newInstance(),constants:new Map})},t.prototype.clone=function(){var e=this.options,n=e.key,r=e.value,o=e.constants;return new t({key:n.clone(),value:r.clone(),constants:new Map(o.entries())})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){var e=this.options,t=e.value,n=e.constants,r=n.keys().next();return r?n.get(r):t.create()},t.prototype.random=function(e){var t=Array.from(this.options.constants.values());return t[e(0,t.length,!0)]},t.prototype.fromJson=function(e){return this.options.value.fromJson(e)},t.prototype.toJson=function(e){return this.options.value.toJson(e)},t.STEP_KEY="key",t.STEP_VALUE="value",t.id=G.Enum,t.operations=new Y(G.Enum+G.Delimiter),t.computeds=new W(G.Enum+G.Delimiter),t.baseType=new t({key:Re.baseType,value:Re.baseType,constants:new Map}),t.describePriority=-1,t.registered=!1,t}(L),Be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=function(e){function t(t){var n=e.call(this)||this;return n.value=t,n}return Be(t,e),t.has=function(e,n){return e instanceof t&&e.value===n},t.is=function(e){return e instanceof t},t.decode=function(e,n){return new t(ye.baseType.fromJson(e[1]))},t.encode=function(e){var t=ye.baseType.toJson(e.value);return i(t)?[this.id,t]:t},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(){return 0},t.prototype.isDynamic=function(){return!1},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(X.copy(this.value))},t.prototype.getType=function(e,t){var n=this.value;if(o(n))return new He({key:Re.baseType.newInstance(),value:Re.baseType.newInstance(),constants:new Map([[n,n]])});if(r(n))return new He({key:_n.baseType.newInstance(),value:_n.baseType.newInstance(),constants:new Map([[n,n]])});var i=e.describe(this.value);return i&&i.removeDescribedRestrictions(),i},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){},t.prototype.mutates=function(e,t){return!1},t.id="constant",t}(q),Je=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ke=function(e){function t(t,n){var r=e.call(this)||this;return r.path=t,r.value=n,r}return Je(t,e),t.decode=function(e,n){return new t(tt.fromPartial(e[1],n),n.getExpression(e[2]))},t.encode=function(e){return[this.id,e.path.encode(),e.value.encode()]},t.create=function(e,n){return new t(Pn.path(e),Pn.parse(n))},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return Math.max(this.path.getComplexity(e,t),this.value.getComplexity(e,t))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.path.clone(),this.value.clone())},t.prototype.getType=function(e,t){return Q.baseType},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_PATH,n.path,(function(e){return n.path=Pn.path(e)})),e.step(t.STEP_VALUE,n.value,(function(e){return n.value=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_PATH?[1,this.path]:e[0]===t.STEP_VALUE?[1,this.value]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.path.setParent(this),this.value.setParent(this)},t.prototype.validate=function(e,t,n){this.path.validate(e,t,n);var r=this.path.getType(e,t);this.path.isWritable(e)||n({type:k.READONLY,severity:j.HIGH,context:t,subject:this.path,parent:this}),r?this.validateType(e,t,r,this.value,n):n({type:k.INVALID_EXPRESSION,severity:j.HIGH,context:t,subject:this.path,parent:this})},t.prototype.to=function(e){return this.value=Pn.parse(e),this.value.setParent(this),this},t.prototype.mutates=function(e,t,n){return this.path.isMutating(t,n)||this.value.mutates(e,t,n)||this.path.mutates(e,t,n)},t.STEP_PATH="path",t.STEP_VALUE="value",t.id="set",t}(q),ze=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xe="current",$e=function(e){function t(t,n,r){void 0===r&&(r=Xe);var o=e.call(this)||this;return o.path=t,o.value=n,o.currentVariable=r,o}return ze(t,e),t.decode=function(e,n){return new t(tt.fromPartial(e[1],n),n.getExpression(e[2]),e[3]||Xe)},t.encode=function(e){var t=e.path.encode(),n=e.value.encode();return e.currentVariable===Xe?[this.id,t,n]:[this.id,t,n,e.currentVariable]},t.create=function(e,n,r){return void 0===r&&(r=Xe),new t(Pn.path(e),Pn.parse(n),r)},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return Math.max(this.path.getComplexity(e,t),this.value.getComplexity(e,t))},t.prototype.getScope=function(){var e;return(e={})[this.currentVariable]=ye.baseType,e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.path.clone(),this.value.clone(),this.currentVariable)},t.prototype.getType=function(e,t){return Q.baseType},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_PATH,n.path,(function(e){return n.path=Pn.path([e])})),e.step(t.STEP_VALUE,n.value,(function(e){return n.value=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_PATH?[1,this.path]:e[0]===t.STEP_VALUE?[1,this.value]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.path.setParent(this),this.value.setParent(this)},t.prototype.validate=function(e,t,n){var r;this.path.validate(e,t,n);var o=this.path.getType(e,t);if(this.path.isWritable(e)||n({type:k.READONLY,severity:j.HIGH,context:t,subject:this.path,parent:this}),o){var i=e.getContext(t,((r={})[this.currentVariable]=o,r));this.validateType(e,i,o,this.value,n)}else n({type:k.INVALID_EXPRESSION,severity:j.HIGH,context:t,subject:this.path,parent:this})},t.prototype.mutates=function(e,t,n){return this.path.isMutating(t,n)||this.value.mutates(e,t,n)||this.path.mutates(e,t,n)},t.prototype.to=function(e,t){return this.value=Pn.parse(e),this.value.setParent(this),this.currentVariable=t||this.currentVariable,this},t.prototype.withVariable=function(e){return this.currentVariable=e,this},t.STEP_PATH="path",t.STEP_VALUE="value",t.id="up",t}(q),Qe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ze=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},et=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ze(arguments[t]));return e},tt=function(e){function t(t){var n=e.call(this)||this;return n.expressions=t,n}return Qe(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){return n.getExpression(e)})))},t.encode=function(e){return[this.id,e.expressions.map((function(e){return e.encode()}))]},t.createForLegacy=function(e){for(var n=e.length-1;n>=0;n--){var r=e[n];r instanceof t&&(0!==r.expressions.length&&r.expressions[0].isPathStart()||e.splice.apply(e,et([n,1],r.expressions)))}return new t(e)},t.fromPartial=function(e,n){var r=e[0]===t.id,o=r?t.decode(e,n):t.decode(["path",et([new _e],e)],n);return r&&n.setLegacy(),o},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.expressions.reduce((function(n,r){return Math.max(n,r.getComplexity(e,t))}),0)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expressions.map((function(e){return e.clone()})))},t.prototype.getType=function(e,t){return e.getPathType(this.expressions,t)},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return t.expressions.forEach((function(n,r){return e.step(r,n,(function(e){return t.expressions.splice(r,1,e)}),(function(){return t.expressions.splice(r,1)}))}))}))},t.prototype.getExpressionFromStep=function(e){return r(e[0])&&e[0]<this.expressions.length?[1,this.expressions[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.expressions.forEach((function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){var r=this.expressions;if(0!==r.length){var o=r[0].getType(e,t);if(o){r[0].validate(e,t,n);for(var i=1;i<r.length;i++){var s=r[i];if(s.validate(e,t,n,o),!(o=s.isPathNode()?s.getType(e,t,o):o.getSubType(s,e,t))){n({type:k.INVALID_EXPRESSION,severity:j.HIGH,context:t,subject:s,parent:this});break}}}else n({type:k.INVALID_EXPRESSION,severity:j.HIGH,context:t,subject:r[0],parent:this})}else n({type:k.EMPTY_PATH,severity:j.HIGH,context:t,subject:this})},t.prototype.mutates=function(e,t,n){var r,o;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.expressions),s=i.next();!s.done;s=i.next())if(s.value.mutates(e,t,n))return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},t.prototype.isWritable=function(e){return this.expressions.length>0&&this.expressions[this.expressions.length-1].isPathWritable(e)},t.prototype.isMutating=function(e,t){void 0===t&&(t=!1);var n=this.expressions[0],r=this.expressions[1],o=this.expressions[2];return n instanceof _e&&r instanceof Ue&&r.value===e&&(!!t||!!o)},t.prototype.set=function(e){return new Ke(this.clone(),e)},t.prototype.update=function(e,t){return new $e(this.clone(),e,t)},t.id="path",t}(q),nt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rt=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n}return nt(t,e),t.decode=function(e,n){var r=e[1];if(e[2]){var o=n.getExpression(e[2]);return n.setLegacy(),tt.createForLegacy([o,new t(r)])}return new t(r)},t.encode=function(e){return[this.id,e.name]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){var n=e.getComputed(this.name);if(!n)return 0;var r=e.getOperation(n.op);return r?r.complexity:0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name)},t.prototype.getType=function(e,t,n){return n?e.getComputedReturnType(this.name,n):null},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.getExpressionFromStep=function(e){return null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n,r){r?e.hasComputed(r,this.name)||n({type:k.INVALID_EXPRESSION,severity:j.HIGH,context:t,subject:this}):n({type:k.OUTSIDE_PATH,severity:j.HIGH,context:t,subject:this})},t.prototype.mutates=function(e,t){return!1},t.prototype.isPathNode=function(){return!0},t.prototype.isPathWritable=function(e){var t=e.getComputed(this.name);return!t||!!t.writeable},t.STEP_EXPRESSION="expression",t.id="comp",t}(q),ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=1e5,st="break",at=function(e){function t(t,n,r,o,i,s){void 0===i&&(i=st),void 0===s&&(s=it);var a=e.call(this)||this;return a.variable=t,a.start=n,a.end=r,a.body=o,a.breakVariable=i,a.maxIterations=s,a}return ot(t,e),t.decode=function(e,n){return new t(e[1],n.getExpression(e[2]),n.getExpression(e[3]),n.getExpression(e[4]),e[5]||st,parseInt(e[6])||this.MAX_ITERATIONS)},t.encode=function(e){var t=[this.id,e.variable,e.start.encode(),e.end.encode(),e.body.encode()],n=e.maxIterations!==this.MAX_ITERATIONS;return(e.breakVariable!==st||n)&&t.push(e.breakVariable),n&&t.push(e.maxIterations),t},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return Math.max(this.start.getComplexity(e,t),this.end.getComplexity(e,t),this.body.getComplexity(e,t))+1},t.prototype.isDynamic=function(){return this.body.isDynamic()},t.prototype.getScope=function(){var e;return(e={})[this.variable]=_n.baseType.newInstance(),e[this.breakVariable]=Q.baseType,e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.variable,this.start.clone(),this.end.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},t.prototype.getType=function(e,t){var n=e.getContextWithScope(t,this.getScope()).context,r=this.body.getType(e,n);return r?gi.optional(r):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_START,n.start,(function(e){return n.start=e})),e.step(t.STEP_END,n.end,(function(e){return n.end=e})),e.step(t.STEP_BODY,n.body,(function(e){return n.body=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_START?[1,this.start]:e[0]===t.STEP_END?[1,this.end]:e[0]===t.STEP_BODY?[1,this.body]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.start.setParent(this),this.end.setParent(this),this.body.setParent(this)},t.prototype.validate=function(e,t,n){this.validateType(e,t,_n.baseType,this.start,n),this.validateType(e,t,_n.baseType,this.end,n);var r=e.getContext(t,this.getScope());this.body.validate(e,r,n)},t.prototype.mutates=function(e,t,n){return this.start.mutates(e,t,n)||this.end.mutates(e,t,n)||this.body.mutates(e,t,n)},t.prototype.loop=function(e,t,n,o,i,s){return this.variable=e,this.start=Pn.parse(t),this.start.setParent(this),this.end=Pn.parse(n),this.end.setParent(this),o&&(this.body=o,this.body.setParent(this)),i&&(this.breakVariable=i),r(s)&&(this.maxIterations=s),this},t.prototype.startAt=function(e){return this.start=Pn.parse(e),this.start.setParent(this),this},t.prototype.endAt=function(e){return this.end=Pn.parse(e),this.end.setParent(this),this},t.prototype.run=function(e){return this.body=e,this.body.setParent(this),this},t.prototype.withVariable=function(e){return this.variable=e,this},t.prototype.withBreak=function(e){return this.breakVariable=e,this},t.prototype.withMax=function(e){return this.maxIterations=e,this},t.STEP_START="start",t.STEP_END="end",t.STEP_BODY="body",t.MAX_ITERATIONS=it,t.id="for",t}(q),ut=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pt=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n}return ut(t,e),t.decode=function(e,n){return new t(e[1])},t.encode=function(e){return[this.id,e.name]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name)},t.prototype.getType=function(e,t){var n=e.getData(this.name);return n?n.dataType:pe.baseType},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){this.name?e.getData(this.name)||n({type:k.MISSING_DATA,severity:j.HIGH,context:t,parent:this}):n({type:k.MISSING_DATA_NAME,severity:j.HIGH,context:t,parent:this})},t.prototype.mutates=function(e,t){return!1},t.prototype.isPathStart=function(){return!0},t.prototype.isPathNode=function(){return!0},t.id="data",t.instance=new t(""),t}(q),ct=new Y(G.Entity+G.Delimiter),lt=new W(G.Entity+G.Delimiter),ft=ct,yt={newInstance:ft.set("newInstance",{},["name"],["initial"],[],[],["name"]),get:ft.set("get",{},["name"],["where"],["instance"],["where"],["name"]),getKey:ft.set("getKey",{},["name","instance"],[],[],[],["name"]),save:ft.set("save",{mutates:["instance"]},["name","instance"],[],[],[],["name"]),remove:ft.set("remove",{mutates:["instance"]},["name","instance"],[],[],[],["name"]),setRelated:ft.set("setRelated",{complexity:1,mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),addRelated:ft.set("addRelated",{mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),removeRelated:ft.set("removeRelated",{mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),clearRelated:ft.set("clearRelated",{complexity:1,mutates:["instance"]},["name","instance","relation"],[],[],[],["name","relation"]),getRelated:ft.set("getRelated",{complexity:1},["name","instance","relation"],[],[],[],["name","relation"]),isRelated:ft.set("isRelated",{},["name","instance","relation","related"],[],[],[],["name","relation"])},ht=new Y(G.Object+G.Delimiter),dt=new W(G.Object+G.Delimiter),vt=ht,mt={create:vt.set("create"),maybe:vt.set("maybe",{},["value"]),has:vt.set("has",{},["object","key"]),get:vt.set("get",{},["object","key"]),set:vt.set("set",{mutates:["object"]},["object","key","value"],[],["existingValue"],[],["object"]),delete:vt.set("del",{mutates:["object"]},["object","key"]),cmp:vt.set("cmp",{},["value","test"]),copy:vt.set("copy",{},["object"],[],[],[],["object"]),merge:vt.set("merge",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),isValid:vt.set("?",{},["value"]),isEqual:vt.set("=",{},["value","test"]),isNotEqual:vt.set("!=",{},["value","test"]),isLess:vt.set("<",{},["value","test"]),isLessOrEqual:vt.set("<=",{},["value","test"]),isGreater:vt.set(">",{},["value","test"]),isGreaterOrEqual:vt.set(">=",{},["value","test"]),asAny:vt.set("~"+G.Any,{},["value"]),asBoolean:vt.set("~"+G.Boolean,{},["value"]),asColor:vt.set("~"+G.Color,{},["value"]),asDate:vt.set("~"+G.Date,{},["value"]),asList:vt.set("~"+G.List,{},["value"]),asMap:vt.set("~"+G.Map,{},["value"]),asNumber:vt.set("~"+G.Number,{},["value"]),asObject:vt.set("~"+G.Object,{},["value"]),asText:vt.set("~"+G.Text,{},["value"]),asTuple:vt.set("~"+G.Tuple,{},["value"]),asSet:vt.set("~"+G.Set,{},["value"])};dt.set("copy",mt.copy);var gt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},bt=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Tt(arguments[t]));return e},xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gt(t,e),t.decode=function(e,n){return new t({props:O(e[1],(function(e){return n.getType(e)}))})},t.encode=function(e){var t=O(e.options.props,(function(e){return e.encode()}));return[this.id,t]},t.describe=function(e,n,r){if(!l(e)||null===e)return null;var o=new t({props:{}});return r.set(e,o),o.options.props=O(e,(function(e){return n.describe(e)})),o},t.register=function(){var e="object";X.addJson({priority:7,fromJson:function(e,t){if(l(e))return O(e,t)},toJson:function(e,t){if(l(e))return O(e,t)}}),X.addCopier({priority:7,copy:function(e,t,n){if(l(e)){var r={};for(var o in n(e,r),e)r[t(o)]=t(e[o]);return r}}}),X.addCompare({priority:7,type:e,compare:function(e,t,n){if(null===e)return 1;if(null===t)return-1;var r=0,o=0;for(var i in e)i in t||r++;for(var i in t)i in e||o++;for(var i in e)if(i in t){var s=n(e[i],t[i]);s<0&&r++,s>0&&o++}return X.getCompare(r,o)}}),X.addEquals({priority:7,type:e,equals:function(e,t,n){if(null===e!=(null===t))return!1;for(var r in e)if(!(r in t))return!1;for(var r in t){if(!(r in e))return!1;if(!n(e[r],t[r]))return!1}return!0}}),X.addAccessor({priority:7,isValid:function(e){return l(e)},get:function(e,t){return e[t]},set:function(e,t,n){return X.objectSet(e,t,n)},remove:function(e,t){return X.objectRemove(e,t)},has:function(e,t){return t in e}})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options.props,n=e.options.props;for(var r in t)r in n&&n[r]?t[r]=gi.merge(t[r],n[r]):t[r]&&(t[r]=gi.optional(t[r]));for(var r in n)!(r in t)&&n[r]&&(t[r]=gi.optional(n[r]))},t.prototype.getSubType=function(e,t,n){var r=this;if(Ue.is(e)&&o(e.value))return this.options.props[e.value];var i=e.getType(t,n);if(i){if((i=i.getRequired())instanceof Re){var s=w(this.options.props);return gi.mergeMany(s,pe.baseType)}if(i instanceof He)return s=Array.from(i.options.constants.values()).map((function(e){return r.options.props[e]})).filter((function(e){return!!e})),gi.mergeMany(s,pe.baseType)}return this.getWildcardType()},t.prototype.getSubTypes=function(e){var t=w(this.options.props);return bt(w(this.options.props,(function(e,t){return{key:t,value:e}})),[{key:new He({key:Re.baseType,value:Re.baseType,constants:new Map(w(this.options.props,(function(e,t){return[t,t]})))}),value:gi.mergeMany(t,pe.baseType)},{key:Re.baseType,value:gi.optional(gi.mergeMany(t,pe.baseType))}])},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return E(t.options.props,(function(n,r){return e.step(r,n,(function(e){return t.options.props[r]=e}),(function(){return X.objectRemove(t.options.props,r)}))}))}))},t.prototype.getTypeFromStep=function(e){return this.options.props[e]||null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,E(this.options.props,(function(e){return e?e.setParent(t):0}))},t.prototype.removeDescribedRestrictions=function(){E(this.options.props,(function(e){return e?e.removeDescribedRestrictions():0}))},t.prototype.isDeepCompatible=function(e,n){if(!(e instanceof t))return!1;var r=this.options.props;for(var o in r)if(o!==t.wilcardProperty&&r[o]){if(!e.options.props[o]){if(r[o].isOptional())continue;return!1}if(!r[o].isCompatible(e.options.props[o],n))return!1}var i=this.getWildcardType();if(n.exact){for(var o in e.options.props)if(!r[o]&&e.options.props[o])return!1}else if(i)for(var o in e.options.props)if(!r[o]&&e.options.props[o]&&!i.isCompatible(e.options.props[o],n))return!1;return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.getCreateExpression=function(){return Pn.object(O(this.options.props,(function(e){return e?e.getCreateExpression():Pn.noop()})))},t.prototype.getValidateExpression=function(){return Pn.and.apply(Pn,bt([Pn.op(mt.isValid,{value:Pn.get("value")})],w(this.options.props,(function(e,t){return Pn.define({value:Pn.get("value",t)}).run(e?e.getValidateExpression():Pn.true())}))))},t.prototype.getCompareExpression=function(){return Pn.or.apply(Pn,bt(w(this.options.props,(function(e,t){return Pn.define({value:Pn.get("value",t),test:Pn.get("test",t)}).run(e?e.getCompareExpression():Pn.true())}))))},t.prototype.getValueChangeExpression=function(e,t,n){var r=null!=t,o=null!=n;return!r&&o?Pn.define({parent:Pn.get("value")},Pn.op(mt.set,{object:Pn.get("value"),key:n,value:e})):r&&!o?Pn.body(Pn.op(mt.delete,{object:Pn.get("value"),key:t}),Pn.get("value")):t!==n?Pn.body(Pn.op(mt.set,{object:Pn.get("value"),key:n,value:Pn.get("value",t)}),Pn.op(mt.delete,{object:Pn.get("value"),key:t}),Pn.get("value")):t===n&&r?Pn.body(Pn.update("value",t).to(e,"value"),Pn.get("value")):e},t.prototype.isValid=function(e){if(!l(e))return!1;var n=this.options.props;for(var r in n)if(r!==t.wilcardProperty&&n[r]&&!n[r].isValid(e[r]))return!1;var o=this.getWildcardType();if(o)for(var r in e)if(!n[r]&&!o.isValid(e[r]))return!1;return!0},t.prototype.normalize=function(e){return e},t.prototype.newInstance=function(){return new t({props:{}})},t.prototype.clone=function(){return new t({props:O(this.options.props,(function(e){return e?e.clone():e}))})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){var e=this.options.props,t=Object.create(null);for(var n in e){var r=e[n];r&&!r.isOptional()&&(t[n]=r.create())}return t},t.prototype.random=function(e){var t=this.options.props,n=Object.create(null);for(var r in t)t[r]&&(n[r]=t[r].random(e));return n},t.prototype.fromJson=function(e){var t=this;return O(e,(function(e,n){var r=t.options.props[n];return r?r.fromJson(e):e}))},t.prototype.toJson=function(e){var t=this;return O(e,(function(e,n){var r=t.options.props[n];return r?r.toJson(e):e}))},t.prototype.getWildcardType=function(){return this.options.props[t.wilcardProperty]||null},t.wilcardProperty="*",t.id=G.Object,t.operations=ht,t.computeds=dt,t.baseType=new t({props:{}}),t.describePriority=5,t.registered=!1,t}(L),Ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(e){function t(t,n){var r=e.call(this,t)||this;return r.provider=n,r}return Ot(t,e),t.decode=function(e,n){return new t(e[1],n)},t.encode=function(e){return[this.id,e.options]},t.describe=function(e,t,n){return null},t.register=function(){},t.for=function(e,n){return new t(e,n)},t.prototype.getType=function(){return this.provider?this.provider.getType(this.options,pe.baseType):xt.baseType},t.prototype.getOperations=function(){return this.getType().getOperations()},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return this.getType().getSubType(e,t,n)},t.prototype.getSubTypes=function(e){return this.getType().getSubTypes(e)},t.prototype.getExactType=function(e){return this.getType().getExactType(e)},t.prototype.getSimplifiedType=function(){return this},t.prototype.isWrapper=function(){return!0},t.prototype.getWrappedType=function(){return this.getType()},t.prototype.isDeepCompatible=function(e,n){return e instanceof t?this.getType().isCompatible(e.getType(),n):this.getType().isCompatible(e,n)},t.prototype.isOptional=function(){return this.getType().isOptional()},t.prototype.isSimple=function(){return this.getType().isSimple()},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){return e.step(t.STEP_ENTITY,n.getType(),(function(e){return e instanceof t?n.options=e.options:0}))}))},t.prototype.getTypeFromStep=function(e){return e===t.STEP_ENTITY?this.getType():null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return this.getType().getCreateExpression()},t.prototype.getValidateExpression=function(){return this.getType().getValidateExpression()},t.prototype.getCompareExpression=function(){return this.getType().getCompareExpression()},t.prototype.getValueChangeExpression=function(e,t,n){return e},t.prototype.isValid=function(e){return this.getType().isValid(e)},t.prototype.normalize=function(e){return this.getType().normalize(e)},t.prototype.newInstance=function(){return new t(this.options,this.provider)},t.prototype.clone=function(){return new t(this.options,this.provider)},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.getType().create()},t.prototype.random=function(e){return this.getType().random(e)},t.prototype.fromJson=function(e){return this.getType().fromJson(e)},t.prototype.toJson=function(e){return this.getType().toJson(e)},t.STEP_ENTITY="entity",t.id=G.Entity,t.operations=ct,t.computeds=lt,t.baseType=new t("",null),t.describePriority=-1,t.registered=!1,t}(L),wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),St=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n}return wt(t,e),t.decode=function(e,n){return new t(e[1])},t.encode=function(e){return[this.id,e.name]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name)},t.prototype.getType=function(e,t){return new Et(this.name,e)},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){this.name?e.getEntity(this.name)||n({type:k.MISSING_TYPE,severity:j.HIGH,context:t,parent:this}):n({type:k.MISSING_TYPE_NAME,severity:j.HIGH,context:t,parent:this})},t.prototype.mutates=function(e,t){return!1},t.id="entity",t.instance=new t(""),t}(q),Pt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n}return Pt(t,e),t.decode=function(e,n){return new t(e[1])},t.encode=function(e){return[this.id,e.name]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name)},t.prototype.getType=function(e,t){return new He({key:Re.baseType,value:Re.baseType,constants:new Map([["relation",this.name]])})},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){this.name?e.getRelation(this.name)||n({type:k.MISSING_RELATION,severity:j.HIGH,context:t,parent:this}):n({type:k.MISSING_RELATION_NAME,severity:j.HIGH,context:t,parent:this})},t.prototype.mutates=function(e,t){return!1},t.id="relation",t.instance=new t(""),t}(q),_t=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),It=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ct=function(e){function t(t,n){var r=e.call(this)||this;return r.cases=t,r.otherwise=n,r}return _t(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){var t=It(e,2),r=t[0],o=t[1];return[n.getExpression(r),n.getExpression(o)]})),n.getExpression(e[2]))},t.encode=function(e){var t=e.cases.map((function(e){var t=It(e,2),n=t[0],r=t[1];return[n.encode(),r.encode()]}));return Ue.has(e.otherwise,void 0)?[this.id,t]:[this.id,t,e.otherwise.encode()]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.cases.reduce((function(n,r){var o=It(r,2),i=o[0],s=o[1];return Math.max(n,i.getComplexity(e,t),s.getComplexity(e,t))}),this.otherwise.getComplexity(e,t))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.cases.map((function(e){var t=It(e,2),n=t[0],r=t[1];return[n.clone(),r.clone()]})),this.otherwise.clone())},t.prototype.getType=function(e,t){var n=this.cases.map((function(e){var t=It(e,2);return t[0],t[1]})).concat(this.otherwise).filter((function(e){return!!e})).map((function(n){return n.getType(e,t)})).filter((function(e){return!!e}));return gi.mergeMany(n,pe.baseType)},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_CASES,(function(){return n.cases.forEach((function(r,o){var i=It(r,2),s=i[0],a=i[1];return e.step(o,(function(){e.step(t.STEP_IF,s,(function(e){return n.cases[o].splice(0,1,e)})),e.step(t.STEP_THEN,a,(function(e){return n.cases[o].splice(1,1,e)}))}))}))})),n.otherwise!==le.instance&&e.step(t.STEP_ELSE,n.otherwise,(function(e){return n.otherwise=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_CASES?r(e[1])&&e[1]<this.cases.length?e[2]===t.STEP_IF?[3,this.cases[e[1]][0]]:e[2]===t.STEP_THEN?[3,this.cases[e[1]][1]]:null:null:e[0]===t.STEP_ELSE?[1,this.otherwise]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.cases.forEach((function(e){var n=It(e,2),r=n[0],o=n[1];r.setParent(t),o.setParent(t)})),this.otherwise.setParent(this)},t.prototype.validate=function(e,t,n){var r=this,o=Q.baseType;this.cases.forEach((function(i){var s=It(i,2),a=s[0],u=s[1];r.validateType(e,t,o,a,n),u.validate(e,t,n)})),this.otherwise.validate(e,t,n)},t.prototype.mutates=function(e,t,n){var r,o;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.cases),s=i.next();!s.done;s=i.next()){var a=It(s.value,2),u=a[0],p=a[1];if(u.mutates(e,t,n)||p.mutates(e,t,n))return!0}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return this.otherwise.mutates(e,t,n)},t.prototype.if=function(e,t){return this.cases.push([e,t||le.instance]),e.setParent(this),t&&t.setParent(this),this},t.prototype.than=function(e){return this.cases[this.cases.length-1][1]=e,e.setParent(this),this},t.prototype.elseif=function(e,t){return this.cases.push([e,t||le.instance]),e.setParent(this),t&&t.setParent(this),this},t.prototype.else=function(e){return this.otherwise=e,this.otherwise.setParent(this),this},t.STEP_CASES="cases",t.STEP_IF="if",t.STEP_THEN="then",t.STEP_ELSE="else",t.id="if",t}(q),Dt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jt=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t,r.args=n,r}return Dt(t,e),t.decode=function(e,n){return new t(e[1],O(e[2],(function(e){return n.getExpression(e)})))},t.encode=function(e){var t=O(e.args,(function(e){return e.encode()}));return[this.id,e.name,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){var n=e.getFunction(this.name);return n?n.expression.getComplexity(e,t):0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name,O(this.args,(function(e){return e.clone()})))},t.prototype.getType=function(e,t){var n=e.getFunction(this.name),r=O(this.args,(function(n){return n.getType(e,t)}));return n?n.getReturnType(e,r):null},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return E(t.args,(function(n,r){return e.step(r,n,(function(e){return t.args[r]=e}),(function(){return X.objectRemove(t.args,r)}))}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]in this.args?[1,this.args[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,E(this.args,(function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){var r=this,o=e.getFunction(this.name);if(o){var i={};E(o.params.options.props,(function(o,s){var a=r.args[s];r.validateType(e,t,o,a,n),a&&(i[s]=a.getType(e,t))}))}else n({type:k.MISSING_FUNCTION,severity:j.HIGH,context:t,subject:this})},t.prototype.mutates=function(e,t,n){var r=e.getFunction(this.name);if(!r)return!1;for(var o in this.args){var i=this.args[o];if(i.mutates(e,t,n)||i instanceof tt&&i.isMutating(t,!0)&&r.mutates(e,o))return!0}return!1},t.prototype.getInnerExpression=function(e){var t=e.getFunction(this.name);return t?t.expression:'Function "'+this.name+'" does not exist'},t.prototype.named=function(e){return this.name=e,this},t.prototype.arg=function(e,t){var n,r=o(e)?((n={})[e]=t,n):e;for(var i in r){var s=Pn.parse(r[i]);this.args[i]=s,s.setParent(this)}return this},t.id="invoke",t}(q),kt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=function(e){function t(t,n,r){var o=e.call(this)||this;return o.entity=t,o.name=n,o.args=r,o}return kt(t,e),t.decode=function(e,n){return new t(e[1],e[2],O(e[3],(function(e){return n.getExpression(e)})))},t.encode=function(e){var t=O(e.args,(function(e){return e.encode()}));return[this.id,e.entity,e.name,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){var n=e.getEntity(this.entity);return n&&n.methods[this.name]?n.methods[this.name].expression.getComplexity(e,t):0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.entity,this.name,O(this.args,(function(e){return e.clone()})))},t.prototype.getType=function(e,t,n){if(!(n&&n instanceof Et&&n.options===this.entity))return null;var r=e.getEntity(this.entity);if(!r)return null;var o=r.methods[this.name];if(!o)return null;var i=O(this.args,(function(n){return n.getType(e,t)}));return i[q.INSTANCE]=r.type,o.getReturnType(e,i)},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return E(t.args,(function(n,r){return e.step(r,n,(function(e){return t.args[r]=e}),(function(){return X.objectRemove(t.args,r)}))}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]in this.args?[1,this.args[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,E(this.args,(function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n,r){var o=this;if(r&&r instanceof Et&&r.options===this.entity){var i=e.getEntity(this.entity);if(i){var s=i.methods[this.name];if(s){var a={};a[q.INSTANCE]=i.type,E(s.params.options.props,(function(r,i){var s=o.args[i];o.validateType(e,t,r,s,n),s&&(a[i]=s.getType(e,t))}))}else n({type:k.MISSING_METHOD,severity:j.HIGH,context:t,subject:this})}else n({type:k.MISSING_TYPE,severity:j.HIGH,context:t,subject:this})}else n({type:k.INVALID_THIS,severity:j.HIGH,context:t,subject:this})},t.prototype.mutates=function(e,t,n){var r=e.getEntity(this.entity);if(!r)return!1;var o=r.methods[this.name];if(!o)return!1;for(var i in this.args){var s=this.args[i];if(s.mutates(e,t,n)||s instanceof tt&&s.isMutating(t,!0)&&o.mutates(e,i))return!0}return!1},t.prototype.getInnerExpression=function(e){var t=e.getEntity(this.entity);if(!t)return'Entity "'+this.entity+'" does not exist';var n=t.methods[this.name];return n?n.expression:'Method "'+this.name+'" on Entity "'+this.entity+'" does not exist'},t.prototype.isPathNode=function(){return!0},t.prototype.named=function(e){return this.name=e,this},t.prototype.arg=function(e,t){var n,r=o(e)?((n={})[e]=t,n):e;for(var i in r){var s=Pn.parse(r[i]);this.args[i]=s,s.setParent(this)}return this},t.id="method",t}(q),Nt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(e){function t(t){var n=e.call(this)||this;return n.expressions=t,n}return Nt(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){return n.getExpression(e)})))},t.encode=function(e){var t=e.expressions.map((function(e){return e.encode()}));return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.expressions.reduce((function(n,r){return Math.max(n,r.getComplexity(e,t))}),0)},t.prototype.isDynamic=function(){return this.expressions.some((function(e){return e.isDynamic()}))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expressions.map((function(e){return e.clone()})))},t.prototype.getType=function(e,t){var n=this.expressions.map((function(n){return n.getType(e,t)})).concat(Q.baseType).filter((function(e){return!!e}));return gi.mergeMany(n,pe.baseType)},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return t.expressions.forEach((function(n,r){return e.step(r,n,(function(e){return t.expressions.splice(r,1,e)}),(function(){return t.expressions.splice(r,1)}))}))}))},t.prototype.getExpressionFromStep=function(e){return r(e[0])&&e[0]<this.expressions.length?[1,this.expressions[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.expressions.forEach((function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){var r=this,o=Q.baseType;this.expressions.forEach((function(i){r.validateType(e,t,o,i,n)}))},t.prototype.mutates=function(e,t,n){var r,o;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.expressions),s=i.next();!s.done;s=i.next())if(s.value.mutates(e,t,n))return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},t.id="or",t}(q),Lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qt=function(){return(qt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ft=function(e){function t(t,n,r){void 0===r&&(r={});var o=e.call(this)||this;return o.name=t,o.params=n,o.scopeAlias=r,o}return Lt(t,e),t.decode=function(e,n){return new t(e[1],O(e[2],(function(e){return n.getExpression(e)})),e[3]||{})},t.encode=function(e){var t=O(e.params,(function(e){return e.encode()}));return d(e.scopeAlias)?[this.id,e.name,t]:[this.id,e.name,t,e.scopeAlias]},t.create=function(e,n,r){return void 0===r&&(r=Object.create(null)),new t(e.id,n,r)},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){var n=e.getOperation(this.name),r=n?n.complexity:0;for(var o in this.params)r=Math.max(r,this.params[o].getComplexity(e,t));return r},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name,O(this.params,(function(e){return e.clone()})),qt({},this.scopeAlias))},t.prototype.getType=function(e,t){return e.getOperationReturnType(this.name,this.params,this.scopeAlias,t)},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return E(t.params,(function(n,r){return e.step(r,n,(function(e){return t.params[r]=e}),(function(){return X.objectRemove(t.params,r)}))}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]in this.params?[1,this.params[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,E(this.params,(function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){var r=this,o=r.name,i=r.params,s=r.scopeAlias,a=e.getOperation(o),u=e.getOperationTypes(o);if(a){var p=e.getOperationExpectedTypes(o,i,s,t),c=a.hasScope.length>0?e.getOperationScopeContext(o,p,s,t):t;for(var l in p){var f=-1!==a.optional.indexOf(l),y=p[l],h=f?gi.optional(y):y,d=i[l],v=-1!==a.hasScope.indexOf(l)?c:t;this.validateType(e,v,h,d,n)}for(var l in i){d=i[l];var m=u.params[l];!(l in p)&&m&&(v=-1!==a.hasScope.indexOf(l)?c:t,n({type:k.MISSING_EXPRESSION,severity:j.HIGH,context:v,subject:d,parent:this}),i[l].validate(e,v,n))}}else n({type:k.MISSING_OPERATION,severity:j.HIGH,context:t,subject:this})},t.prototype.mutates=function(e,t,n){var r=this.name,o=this.params,i=e.getOperation(r);if(!i)return!1;for(var s in o){var a=o[s];if(a.mutates(e,t,n)||a instanceof tt&&a.isMutating(t,!0)&&-1!==i.mutates.indexOf(s))return!0}return!1},t.prototype.param=function(e,t){var n=Pn.parse(t);return this.params[e]=n,n.setParent(this),this},t.prototype.alias=function(e,t){return this.scopeAlias[e]=t,this},t.prototype.and=function(e){var t=i(e)?e:[e];return new ne([this].concat(t))},t.prototype.or=function(e){var t=i(e)?e:[e];return new Rt([this].concat(t))},t.prototype.not=function(){return new ee(this)},t.id="op",t}(q),Vt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yt=function(e){function t(t){var n=e.call(this)||this;return n.value=t,n}return Vt(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]))},t.encode=function(e){var t=e.value.encode();return void 0!==t?[this.id,t]:[this.id]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.value.getComplexity(e,t)},t.prototype.isDynamic=function(){return this.value.isDynamic()},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.value.encode())},t.prototype.getType=function(e,t){return this.value?this.value.getType(e,t):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){return e.step(t.STEP_VALUE,n.value,(function(e){return n.value=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_VALUE?[1,this.value]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.value.setParent(this)},t.prototype.validate=function(e,t,n){this.value.validate(e,t,n)},t.prototype.mutates=function(e,t,n){return this.value.mutates(e,t,n)},t.prototype.isPathWritable=function(e){return!1},t.STEP_VALUE="value",t.id="return",t}(q),Wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ht=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Bt=function(e){function t(t,n,r,o){var i=e.call(this)||this;return i.value=t,i.op=n,i.cases=r,i.defaultCase=o,i}return Wt(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]),e[2],e[3].map((function(e){var t=Gt(e,2),r=t[0],o=t[1];return[r.map((function(e){return n.getExpression(e)})),n.getExpression(o)]})),n.getExpression(e[4]))},t.encode=function(e){var t=e.value.encode(),n=e.cases.map((function(e){var t=Gt(e,2),n=t[0],r=t[1];return[n.map((function(e){return e.encode()})),r.encode()]}));return Ue.has(e.defaultCase,void 0)?[this.id,t,e.op,n]:[this.id,t,e.op,n,e.defaultCase.encode()]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.cases.reduce((function(n,r){var o=Gt(r,2),i=o[0],s=o[1];return Math.max(n,s.getComplexity(e,t),i.reduce((function(n,r){return Math.max(n,r.getComplexity(e,t))}),0))}),Math.max(this.value.getComplexity(e,t),this.defaultCase.getComplexity(e,t)))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.value.clone(),this.op,this.cases.map((function(e){var t=Gt(e,2),n=t[0],r=t[1];return[n.map((function(e){return e.clone()})),r.clone()]})),this.defaultCase.clone())},t.prototype.getType=function(e,t){var n=this.cases.map((function(e){var t=Gt(e,2);return t[0],t[1]})).concat(this.defaultCase).filter((function(e){return!!e})).map((function(n){return n.getType(e,t)})).filter((function(e){return!!e}));return gi.mergeMany(n,pe.baseType)},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_VALUE,n.value,(function(e){return n.value=e})),e.step(t.STEP_CASES,(function(){return n.cases.forEach((function(r,o){var i=Gt(r,2),s=i[0],a=i[1];return e.step(o,(function(){e.step(t.STEP_CASE,(function(){return s.forEach((function(t,n){return e.step(n,t,(function(e){return s.splice(n,1,e)}),(function(){return s.splice(n,1)}))}))})),e.step(t.STEP_RESULT,a,(function(e){return n.cases[o].splice(1,1,e)}))}))}))})),e.step(t.STEP_DEFAULT,n.defaultCase,(function(e){return n.defaultCase=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_VALUE?[1,this.value]:e[0]===t.STEP_CASES?r(e[1])&&e[1]<this.cases.length?e[2]===t.STEP_CASE?r(e[3])&&e[3]<this.cases[e[1]][0].length?[4,this.cases[e[1]][0][e[3]]]:null:e[2]===t.STEP_RESULT?[3,this.cases[e[1]][1]]:null:null:e[0]===t.STEP_DEFAULT?[1,this.defaultCase]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.value.setParent(this),this.cases.forEach((function(e){var n=Gt(e,2),r=n[0],o=n[1];r.forEach((function(e){return e.setParent(t)})),o.setParent(t)})),this.defaultCase.setParent(this)},t.prototype.validate=function(e,t,n){this.value.validate(e,t,n),this.cases.forEach((function(r){var o=Gt(r,2),i=o[0],s=o[1];i.forEach((function(r){return r.validate(e,t,n)})),s.validate(e,t,n)})),this.defaultCase.validate(e,t,n)},t.prototype.mutates=function(e,t,n){var r,o,i,s;if(this.value.mutates(e,t,n))return!0;try{for(var a=Ht(this.cases),u=a.next();!u.done;u=a.next()){var p=Gt(u.value,2),c=p[0];if(p[1].mutates(e,t,n))return!0;try{for(var l=(i=void 0,Ht(c)),f=l.next();!f.done;f=l.next())if(f.value.mutates(e,t,n))return!0}catch(e){i={error:e}}finally{try{f&&!f.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return this.defaultCase.mutates(e,t,n)},t.prototype.val=function(e,t){return this.value=Pn.parse(e),this.value.setParent(this),this.op=t?t.id:this.op,this},t.prototype.case=function(e){var t=this.cases.length-1,n=Pn.parse(e);return n.setParent(this),t>=0&&this.cases[t][1]===le.instance?this.cases[t][0].push(n):this.cases.push([[n],le.instance]),this},t.prototype.than=function(e){var t=Pn.parse(e);return this.cases[this.cases.length-1][1]=t,t.setParent(this),this},t.prototype.default=function(e){return this.defaultCase=Pn.parse(e),this.defaultCase.setParent(this),this},t.STEP_VALUE="value",t.STEP_CASES="cases",t.STEP_CASE="case",t.STEP_RESULT="result",t.STEP_DEFAULT="default",t.id="switch",t}(q),Ut=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jt=function(e){function t(t,n){var r=e.call(this)||this;return r.template=t,r.params=n,r}return Ut(t,e),t.decode=function(e,n){return new t(e[1],O(e[2],(function(e){return n.getExpression(e)})))},t.encode=function(e){var t=O(e.params,(function(e){return e.encode()}));return[this.id,e.template,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){var n=0;for(var r in this.params)n=Math.max(n,this.params[r].getComplexity(e,t));return n},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.template,O(this.params,(function(e){return e.clone()})))},t.prototype.getType=function(e,t){return Re.baseType.newInstance()},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return E(t.params,(function(n,r){return e.step(r,n,(function(e){return t.params[r]=e}),(function(){return X.objectRemove(t.params,r)}))}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]in this.params?[1,this.params[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,E(this.params,(function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){var r=this;E(this.params,(function(o){r.validateType(e,t,Re.baseType,o,n)}))},t.prototype.mutates=function(e,t,n){for(var r in this.params)if(this.params[r].mutates(e,t,n))return!0;return!1},t.prototype.param=function(e,t){var n,r=o(e)?((n={})[e]=t,n):e;for(var i in r){var s=Pn.parse(r[i]);this.params[i]=s,s.setParent(this)}return this},t.id="tmpl",t}(q),Kt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zt=1e5,Xt="break",$t=function(e){function t(t,n,r,o){void 0===r&&(r=Xt),void 0===o&&(o=zt);var i=e.call(this)||this;return i.condition=t,i.body=n,i.breakVariable=r,i.maxIterations=o,i}return Kt(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]),n.getExpression(e[2]),e[3]||Xt,parseInt(e[4])||this.MAX_ITERATIONS)},t.encode=function(e){var t=[this.id,e.condition.encode(),e.body.encode()],n=e.maxIterations!==this.MAX_ITERATIONS;return(e.breakVariable!==Xt||n)&&t.push(e.breakVariable),n&&t.push(e.maxIterations),t},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return Math.max(this.condition.getComplexity(e,t),this.body.getComplexity(e,t))+1},t.prototype.isDynamic=function(){return this.body.isDynamic()},t.prototype.getScope=function(){var e;return(e={})[this.breakVariable]=Q.baseType,e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.condition.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},t.prototype.getType=function(e,t){var n=e.getContextWithScope(t,this.getScope()).context,r=this.body.getType(e,n);return r?gi.optional(r):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_CONDITION,n.condition,(function(e){return n.condition=e})),e.step(t.STEP_BODY,n.body,(function(e){return n.body=e}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_CONDITION?[1,this.condition]:e[0]===t.STEP_BODY?[1,this.body]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.condition.setParent(this),this.body.setParent(this)},t.prototype.validate=function(e,t,n){this.validateType(e,t,Q.baseType,this.condition,n);var r=e.getContext(t,this.getScope());this.body.validate(e,r,n)},t.prototype.mutates=function(e,t,n){return this.condition.mutates(e,t,n)||this.body.mutates(e,t,n)},t.prototype.while=function(e){return this.condition=e,this.condition.setParent(this),this},t.prototype.do=function(e){return this.body=e,this.body.setParent(this),this},t.prototype.withBreak=function(e){return this.breakVariable=e,this},t.prototype.withMax=function(e){return this.maxIterations=e,this},t.STEP_CONDITION="condition",t.STEP_BODY="body",t.MAX_ITERATIONS=zt,t.id="while",t}(q),Qt=new Y(G.Tuple+G.Delimiter),Zt=new W(G.Tuple+G.Delimiter),en=Qt,tn={create:en.set("create"),maybe:en.set("maybe",{},["value"]),cmp:en.set("cmp",{},["value","test"]),copy:en.set("copy",{},["value"]),build:en.set("build",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),get:en.set("get",{},["value","index"]),set:en.set("set",{mutates:["value"]},["value","index","element"]),isValid:en.set("?",{},["value"]),isEqual:en.set("=",{},["value","test"]),isNotEqual:en.set("!=",{},["value","test"]),isLess:en.set("<",{},["value","test"]),isLessOrEqual:en.set("<=",{},["value","test"]),isGreater:en.set(">",{},["value","test"]),isGreaterOrEqual:en.set(">=",{},["value","test"]),asAny:en.set("~"+G.Any,{},["value"]),asBoolean:en.set("~"+G.Boolean,{},["value"]),asColor:en.set("~"+G.Color,{},["value"]),asDate:en.set("~"+G.Date,{},["value"]),asList:en.set("~"+G.List,{},["value"]),asMap:en.set("~"+G.Map,{},["value"]),asNumber:en.set("~"+G.Number,{},["value"]),asObject:en.set("~"+G.Object,{},["value"]),asText:en.set("~"+G.Text,{},["value"]),asTuple:en.set("~"+G.Tuple,{},["value"]),asSet:en.set("~"+G.Set,{},["value"])};Zt.set("copy",tn.copy);var nn=new Y(G.Number+G.Delimiter),rn=new W(G.Number+G.Delimiter),on=nn,sn={create:on.set("create"),pi:on.set("pi"),pi2:on.set("2pi"),piHalf:on.set("hpi"),e:on.set("e"),sqrt2:on.set("sqrt2"),sqrt12:on.set("sqrt1/2"),ln2:on.set("ln2"),ln10:on.set("ln10"),log2e:on.set("log2e"),log10e:on.set("log10e"),add:on.set("+",{},["value","addend"]),sub:on.set("-",{},["value","subtrahend"]),mul:on.set("*",{},["value","multiplier"]),div:on.set("/",{},["value","divisor"]),mod:on.set("%",{},["value","divisor"]),min:on.set("min",{},["a","b"]),max:on.set("max",{},["a","b"]),pow:on.set("^^",{},["value","exponent"]),atan2:on.set("atan2",{},["x","y"]),hypot:on.set("hyp",{},["a","b"]),choose:on.set("choose",{complexity:1},["n","k"]),gcd:on.set("gcd",{complexity:1},["a","b"]),bitAnd:on.set("&",{},["a","b"]),bitOr:on.set("|",{},["a","b"]),bitXor:on.set("^",{},["a","b"]),cmp:on.set("cmp",{},["value","test"]),maybe:on.set("maybe",{},["value"]),sqrt:on.set("sqrt",{},["value"]),sq:on.set("^2",{},["value"]),cbrt:on.set("cbrt",{},["value"]),floor:on.set("floor",{},["value"]),ceil:on.set("ceil",{},["value"]),up:on.set("up",{},["value"]),down:on.set("down",{},["value"]),round:on.set("round",{},["value"]),abs:on.set("abs",{},["value"]),neg:on.set("neg",{},["value"]),sign:on.set("sign",{},["value"]),log:on.set("log",{},["value"]),sin:on.set("sin",{},["value"]),cos:on.set("cos",{},["value"]),tan:on.set("tan",{},["value"]),sinh:on.set("sinh",{},["value"]),cosh:on.set("cosh",{},["value"]),asin:on.set("asin",{},["value"]),acos:on.set("acos",{},["value"]),atan:on.set("atan",{},["value"]),factorial:on.set("!",{},["value"]),bitFlip:on.set("~",{},["value"]),clamp:on.set("clamp",{},["value","min","max"]),triangleHeight:on.set("triangleHeight",{},["base","side1","side2"]),lerp:on.set("lerp",{},["delta","start","end"]),rnd:on.set("rnd",{},[],["min","max","whole","includeMax"]),toBaseText:on.set("toBaseText",{},["value"],["base","minDigits"]),toText:on.set("toText",{},["value"],["prefix","suffix","minPlaces","maxPlaces","useExponent","thousandSeparator"]),toPercent:on.set("toPercent",{},["value"],["minPlaces","maxPlaces","thousandSeparator"]),fromPercent:on.set("fromPercent",{},["value"]),isValid:on.set("?",{},["value"]),isZero:on.set("0?",{},["value"],["epsilon"]),isEqual:on.set("=",{},["value","test"],["epsilon"]),isNotEqual:on.set("!=",{},["value","test"],["epsilon"]),isLess:on.set("<",{},["value","test"]),isLessOrEqual:on.set("<=",{},["value","test"]),isGreater:on.set(">",{},["value","test"]),isGreaterOrEqual:on.set(">=",{},["value","test"]),isBetween:on.set("><",{},["value","min","max"],["minInclusive","maxInclusive"]),isWhole:on.set("w?",{},["value"],["epsilon"]),isDecimal:on.set("d?",{},["value"],["epsilon"]),isPositive:on.set("+?",{},["value"]),isNegative:on.set("-?",{},["value"]),isDivisible:on.set("%?",{},["value","by"],["epsilon"]),bitCompare:on.set("bit",{},["value","method","test"]),asAny:on.set("~"+G.Any,{},["value"]),asBoolean:on.set("~"+G.Boolean,{},["value"]),asColor:on.set("~"+G.Color,{},["value"]),asDate:on.set("~"+G.Date,{},["value"]),asList:on.set("~"+G.List,{},["value"]),asMap:on.set("~"+G.Map,{},["value"]),asNumber:on.set("~"+G.Number,{},["value"]),asObject:on.set("~"+G.Object,{},["value"]),asText:on.set("~"+G.Text,{},["value"]),asTuple:on.set("~"+G.Tuple,{},["value"]),asSet:on.set("~"+G.Set,{},["value"])};rn.set("floor",sn.floor),rn.set("ceil",sn.ceil),rn.set("up",sn.up),rn.set("down",sn.down),rn.set("round",sn.round),rn.set("abs",sn.abs),rn.set("negate",sn.neg),rn.set("sign",sn.sign),rn.set("isZero",sn.isZero),rn.set("isWhole",sn.isWhole),rn.set("isDecimal",sn.isDecimal),rn.set("isPositive",sn.isPositive),rn.set("isNegative",sn.isNegative),rn.set("toText",sn.toText);var an=new Y(G.List+G.Delimiter),un=new W(G.List+G.Delimiter),pn=an,cn={create:pn.set("create"),createLike:pn.set("createLike",{},["list"],[],[],[],["list"]),createFor:pn.set("createFor",{},["item"],[],[],[],["item"]),maybe:pn.set("maybe",{},["value"]),build:pn.set("new",{},["count","item"],["sameItem"],["list","index","last","count"],["item"],["item"]),get:pn.set("get",{},["list","index"],[],[],[],["list"]),set:pn.set("set",{},["list","index","value"],[],[],[],["list"]),add:pn.set("+",{mutates:["list"]},["list","item"],[],[],[],["list"]),addFirst:pn.set("+f",{mutates:["list"]},["list","item"],[],[],[],["list"]),addLast:pn.set("+l",{mutates:["list"]},["list","item"],[],[],[],["list"]),insert:pn.set("+@",{mutates:["list"]},["list","item","index"],[],[],[],["list"]),remove:pn.set("-",{mutates:["list"],complexity:1},["list","item","isEqual"],[],["list","value","test"],["isEqual"],["list"]),removeFirst:pn.set("-f",{mutates:["list"]},["list"],[],[],[],["list"]),removeLast:pn.set("-l",{mutates:["list"]},["list"],[],[],[],["list"]),removeAt:pn.set("-@",{mutates:["list"]},["list","index"],[],[],[],["list"]),removeWhere:pn.set("-?",{mutates:["list"]},["list","where"],[],["list","item","index"],["where"],["list"]),clear:pn.set("clear",{mutates:["list"]},["list"],[],[],[],["list"]),contains:pn.set("contains",{complexity:1},["list","item","isEqual"],[],["list","value","test"],["isEqual"]),find:pn.set("find",{complexity:1},["list","where"],["start","reverse"],["list","item","index"],["where"],["list"]),copy:pn.set("copy",{complexity:1},["list"],["deepCopy"],["copy"],["deepCopy"],["list"]),reverse:pn.set("reverse",{complexity:.5},["list"],[],[],[],["list"]),exclude:pn.set("exclude",{mutates:["list"],complexity:2},["list","exclude","isEqual"],[],["list","value","test"],["isEqual"],["list"]),overlap:pn.set("overlap",{complexity:2},["list","overlap","isEqual"],[],["list","value","test"],["isEqual"],["list"]),sort:pn.set("sort",{mutates:["list"],complexity:1},["list","compare"],[],["list","value","test"],["compare"],["list"]),shuffle:pn.set("shuffle",{mutates:["list"],complexity:1},["list"],["times"],[],[],["list"]),unique:pn.set("unique",{complexity:2},["list","isEqual"],[],["list","value","test"],["isEqual"],["list"]),duplicates:pn.set("dupes",{complexity:2},["list","isEqual"],["once"],["list","value","test"],["isEqual"],["list"]),take:pn.set("take",{},["list","count"],[],[],[],["list"]),skip:pn.set("skip",{},["list","count"],[],[],[],["list"]),drop:pn.set("drop",{},["list","count"],[],[],[],["list"]),append:pn.set("append",{},["list","append"],[],[],[],["list"]),prepend:pn.set("prepend",{},["list","prepend"],[],[],[],["list"]),indexOf:pn.set("indexOf",{complexity:1},["list","item","isEqual"],["start"],["list","value","test"],["isEqual"],["list"]),lastIndexOf:pn.set("lastIndexOf",{complexity:1},["list","item","isEqual"],["start"],["list","value","test"],["isEqual"],["list"]),findIndex:pn.set("findIndex",{complexity:1},["list","where"],["reverse","start"],["list","item","index"],["where"]),last:pn.set("last",{},["list"],[],[],[],["list"]),first:pn.set("first",{},["list"],[],[],[],["list"]),count:pn.set("count",{},["list"]),randomList:pn.set("randomList",{},["list","count"],[],[],[],["list"]),random:pn.set("random",{},["list"],[],[],[],["list"]),flatten:pn.set("flatten",{},["list"],[],[],[],["list"]),join:pn.set("join",{complexity:1},["list"],["delimiter","toText","prefix","suffix"],["list","item","index"],["toText"]),each:pn.set("each",{complexity:1},["list","each"],["reverse"],["list","item","index"],["each"],["list"]),filter:pn.set("filter",{complexity:1},["list","filter"],[],["list","item","index"],["filter"],["list"]),not:pn.set("not",{complexity:1},["list","not"],[],["list","item","index"],["not"],["list"]),map:pn.set("map",{complexity:1},["list","transform"],[],["list","item","index"],["transform"],["list"]),split:pn.set("split",{complexity:1},["list","pass"],[],["list","item","index"],["pass"],["list"]),reduce:pn.set("reduce",{complexity:1},["list","reduce","initial"],[],["list","item","index","reduced"],["reduce"],["reduce"]),cmp:pn.set("cmp",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),group:pn.set("group",{complexity:1},["list","by"],["getValue"],["list","item","index"],["by","getValue"],["list","by","getValue"]),toListMap:pn.set("toListMap",{complexity:1},["list","getKey"],["getValue"],["list","item","index"],["getKey","getValue"],["list","getKey","getValue"]),toMap:pn.set("toMap",{complexity:1},["list","getKey"],["getValue"],["list","item","index"],["getKey","getValue"],["list","getKey","getValue"]),joinInner:pn.set("joinInner",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinLeft:pn.set("joinLeft",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinRight:pn.set("joinRight",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinFull:pn.set("joinFull",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinCross:pn.set("joinCross",{complexity:2},["a","b","join"],[],["joinA","joinB"],["join"],["join"]),min:pn.set("min",{complexity:1},["list","value"],[],["list","item","index"],["value"]),max:pn.set("max",{complexity:1},["list","value"],[],["list","item","index"],["value"]),sum:pn.set("sum",{complexity:1},["list","value"],[],["list","item","index"],["value"]),avg:pn.set("avg",{complexity:1},["list","value"],[],["list","item","index"],["value"]),std:pn.set("std",{complexity:1},["list","value"],[],["list","item","index"],["value"]),variance:pn.set("variance",{complexity:1},["list","value"],[],["list","item","index"],["value"]),median:pn.set("median",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitand:pn.set("band",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitor:pn.set("bor",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitxor:pn.set("bxor",{complexity:1},["list","value"],[],["list","item","index"],["value"]),isValid:pn.set("?",{},["value"]),isEmpty:pn.set("0?",{},["list"]),isNotEmpty:pn.set("!0",{},["list"]),isEqual:pn.set("=",{complexity:1},["list","test","isEqual"],[],["list","value","test"],["isEqual"]),isNotEqual:pn.set("!=",{complexity:1},["list","test","isEqual"],[],["list","value","test"],["isEqual"]),isLess:pn.set("<",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isLessOrEqual:pn.set("<=",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isGreater:pn.set(">",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isGreaterOrEqual:pn.set(">=",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),asAny:pn.set("~"+G.Any,{},["value"]),asBoolean:pn.set("~"+G.Boolean,{},["value"]),asColor:pn.set("~"+G.Color,{},["value"]),asDate:pn.set("~"+G.Date,{},["value"]),asList:pn.set("~"+G.List,{},["value"]),asMap:pn.set("~"+G.Map,{},["value"]),asNumber:pn.set("~"+G.Number,{},["value"]),asObject:pn.set("~"+G.Object,{},["value"]),asText:pn.set("~"+G.Text,{},["value"]),asTuple:pn.set("~"+G.Tuple,{},["value"]),asSet:pn.set("~"+G.Set,{},["value"])};un.set("copy",cn.copy),un.set("reversed",cn.reverse),un.set("shuffled",cn.shuffle),un.set("first",cn.first),un.set("last",cn.last),un.set("random",cn.random),un.set("isEmpty",cn.isEmpty),un.set("isNotEmpty",cn.isNotEmpty);var ln=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fn=function(){return(fn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},yn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},hn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ln(t,e),t.decode=function(e,n){var r=n.getType(e[1]),o=e[2]||{};return new t(fn({item:r},o))},t.encode=function(e){var t=fn({},e.options),n=t.item;return delete t.item,d(t)?[this.id,n.encode()]:[this.id,n.encode(),t]},t.describe=function(e,n,r){if(!i(e))return null;var o=new t({item:ye.baseType,min:e.length,max:e.length});r.set(e,o);for(var s=n.describe(e[0]),a=1;a<e.length;a++)s=n.merge(s,e[a]);return o.options.item=s,o},t.register=function(){var e="object";X.addJson({priority:8,toJson:function(e,t){if(i(e))return e.map(t)},fromJson:function(e,t){if(i(e))return e.map(t)}}),X.addCompare({priority:8,type:e,compare:function(e,t,n){var r=i(e),o=i(t);if(r!==o)return(r?1:0)-(o?1:0);if(r){var s=e.length-t.length;if(0===s){for(var a=0,u=0,p=0;p<e.length;p++){var c=n(e[p],t[p]);c<0&&a++,c>0&&u++}s=X.getCompare(a,u)}return s}}}),X.addEquals({priority:8,type:e,equals:function(e,t,n){var r=i(e);if(r!==i(t))return!1;if(r){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!n(e[o],t[o]))return!1;return!0}}}),X.addCopier({priority:8,copy:function(e,t,n){var r,o;if(i(e)){var s=[];n(e,s);try{for(var a=yn(e),u=a.next();!u.done;u=a.next()){var p=u.value;s.push(t(p))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return s}}}),X.addAccessor({priority:8,isValid:function(e){return i(e)},get:function(e,t){return e[t]},set:function(e,t,n){return X.arraySet(e,t,n)},remove:function(e,t){return X.arrayRemove(e,t)},has:function(e,t){return void 0!==e[t]}})},t.forItem=function(e){return new t({item:gi.parse(e)})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.item=gi.merge(t.item,n.item),t.min=Math.min(t.min,n.min),t.max=Math.max(t.max,n.max)},t.prototype.getSubType=function(e,t,n){var o=this;if(Ue.is(e)){if("length"===e.value)return gi.LENGTH;if(r(e.value))return r(this.options.min)&&e.value<this.options.min?this.options.item:gi.optional(this.options.item)}var i=e.getType(t,n);if(i){if((i=i.getRequired())instanceof _n)return gi.optional(this.options.item);if(i instanceof He){var s=Array.from(i.options.constants.values());if(i.options.value instanceof _n)return r(this.options.min)&&!s.some((function(e){return e>=o.options.min}))?this.options.item:gi.optional(this.options.item);if(i.options.value instanceof Re&&1===s.length&&"length"===s[0])return gi.LENGTH}}return null},t.prototype.getSubTypes=function(e){for(var t=this.options,n=t.min,o=t.item,i=r(n)&&n>0&&n<=10?n:0,s=[],a=0;a<i;a++)s.push({key:a,value:o});return function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(hn(arguments[t]));return e}(s,[{key:"length",value:gi.LENGTH},{key:gi.INDEX,value:gi.optional(o)}])},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){var r=this.options,o=r.item,i=r.min,s=r.max;if(!n.strict&&!n.exact&&e instanceof Tn&&!e.options.some((function(e){return!o.isCompatible(e,n)})))return!0;if(!(e instanceof t))return!1;if(!o.isCompatible(e.options.item,n))return!1;if(n.value){var a=e.options.min;if(i&&(!a||a<i))return!1;var u=e.options.max;if(s&&(!u||u<s))return!1}return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){return e.step(t.STEP_ITEM,n.options.item,(function(e){return n.options.item=e}))}))},t.prototype.getTypeFromStep=function(e){return e===t.STEP_ITEM?this.options.item:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.item.setParent(this)},t.prototype.removeDescribedRestrictions=function(){var e=this.options.item;e.removeDescribedRestrictions(),this.options={item:e}},t.prototype.getCreateExpression=function(){return Pn.op(cn.create,{})},t.prototype.getValidateExpression=function(){return Pn.and(Pn.op(cn.isValid,{value:Pn.get("value")}),Pn.not(Pn.op(cn.contains,{list:Pn.get("value"),item:Pn.null(),isEqual:Pn.not(this.options.item.getValidateExpression())},{value:"ignore",test:"value"})))},t.prototype.getCompareExpression=function(){return Pn.op(cn.cmp,{value:Pn.get("value"),test:Pn.get("test"),compare:this.options.item.getCompareExpression()})},t.prototype.getValueChangeExpression=function(e,t,n){return Pn.op(cn.map,{list:Pn.get("value"),transform:e},{item:"value"})},t.prototype.isValid=function(e){var t,n;if(!Array.isArray(e))return!1;var o=this.options,i=o.item,s=o.min,a=o.max;if(r(s)&&e.length<s)return!1;if(r(a)&&e.length>a)return!1;try{for(var u=yn(e),p=u.next();!p.done;p=u.next()){var c=p.value;if(!i.isValid(c))return!1}}catch(e){t={error:e}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return!0},t.prototype.normalize=function(e){if(i(e))for(var t=this.options.item,n=0;n<e.length;n++)e[n]=t.normalize(e[n]);return e},t.prototype.newInstance=function(){return new t({item:this.options.item.newInstance()})},t.prototype.clone=function(){var e=this.options,n=e.item,r=e.min,o=e.max;return new t({item:n.clone(),min:r,max:o})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return[]},t.prototype.random=function(e){for(var t=this.options,n=t.min,r=t.max,o=_(n,2),i=_(r,5),s=e(Math.min(o,i),Math.max(o,i)+1,!0),a=[],u=0;u<s;u++)a.push(this.options.item.random(e));return a},t.prototype.fromJson=function(e){var t=this;return e?e.map((function(e){return t.options.item.fromJson(e)})):null},t.prototype.toJson=function(e){var t=this;return e?e.map((function(e){return t.options.item.toJson(e)})):null},t.STEP_ITEM="item",t.id=G.List,t.operations=an,t.computeds=un,t.baseType=new t({item:ye.baseType}),t.describePriority=6,t.registered=!1,t}(L),vn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},gn=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(mn(arguments[t]));return e},Tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vn(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){return n.getType(e)})))},t.encode=function(e){var t=e.options.map((function(e){return e.encode()}));return[this.id,t]},t.describe=function(e,t,n){return null},t.register=function(){},t.forItem=function(e){return new t(e.map((function(e){return gi.parse(e)})))},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){var o=this;if(Ue.is(e)){if("length"===e.value)return gi.LENGTH;if(r(e.value))return this.options[e.value]}var i=e.getType(t,n);if(i){if((i=i.getRequired())instanceof _n)return gi.mergeMany(this.options,pe.baseType);if(i instanceof He){if(i.options.value instanceof _n){var s=(a=Array.from(i.options.constants.values())).map((function(e){return o.options[e]})).filter((function(e){return!!e}));return gi.mergeMany(s,pe.baseType)}var a;if(i.options.value instanceof Re&&1===(a=Array.from(i.options.constants.values())).length&&"length"===a[0])return gi.LENGTH}}},t.prototype.getSubTypes=function(e){return gn(this.options.map((function(e,t){return{key:t,value:e}})),[{key:"length",value:gi.LENGTH},{key:new He({key:_n.baseType,value:_n.baseType,constants:new Map(this.options.map((function(e,t){return[t,t]})))}),value:gi.mergeMany(this.options,pe.baseType)},{key:gi.INDEX,value:gi.optional(gi.mergeMany(this.options,pe.baseType))}])},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.getCreateExpression=function(){return Pn.tuple.apply(Pn,gn(this.options.map((function(e){return e.getCreateExpression()}))))},t.prototype.getValidateExpression=function(){return Pn.op(tn.isValid,{value:Pn.get("value")}).and(this.options.map((function(e,t){return Pn.define({value:Pn.get("value",t)}).run(e.getValidateExpression())})))},t.prototype.getCompareExpression=function(){return Pn.or.apply(Pn,gn([Pn.op(sn.cmp,{value:Pn.get("value","length"),test:Pn.get("test","length")})],this.options.map((function(e,t){return Pn.define({value:Pn.get("value",t),test:Pn.get("test",t)}).run(e.getCompareExpression())}))))},t.prototype.getValueChangeExpression=function(e,t,n){var o=r(t),i=r(n);return!o&&i?Pn.define({parent:Pn.get("value")},Pn.op(cn.insert,{list:Pn.get("value"),index:n,item:e})):o&&!i?Pn.body(Pn.op(cn.removeAt,{list:Pn.get("value"),index:t}),Pn.get("value")):t===n&&o?Pn.body(Pn.update("value",t).to(e,"value"),Pn.get("value")):e},t.prototype.isDeepCompatible=function(e,n){if(!n.exact&&!n.strict&&e instanceof dn&&!this.options.some((function(t){return!t.isCompatible(e.options.item,n)}))&&r(e.options.min)&&e.options.min>=this.options.length)return!0;if(!(e instanceof t))return!1;var o=this.options,i=e.options;if(i.length<o.length||n.exact&&o.length!==i.length)return!1;for(var s=0;s<o.length;s++)if(!o[s].isCompatible(i[s],n))return!1;return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return t.options.map((function(n,r){return e.step(r,n,(function(e){return t.options.splice(r,1,e)}),(function(){return t.options.splice(r,1)}))}))}))},t.prototype.getTypeFromStep=function(e){return this.options[e]||null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.options.forEach((function(e){return e.setParent(t)}))},t.prototype.removeDescribedRestrictions=function(){this.options.forEach((function(e){return e.removeDescribedRestrictions()}))},t.prototype.isValid=function(e){if(!i(e))return!1;for(var t=this.options,n=0;n<t.length;n++)if(!t[n].isValid(e[n]))return!1;return!0},t.prototype.normalize=function(e){if(!i(e))return e;for(var t=this.options,n=0;n<t.length;n++)e[n]=t[n].normalize(e[n]);return e},t.prototype.newInstance=function(){return new t([])},t.prototype.clone=function(){return new t(this.options.map((function(e){return e.clone()})))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.options.map((function(e){return e.create()}))},t.prototype.random=function(e){return this.options.map((function(t){return t.random(e)}))},t.prototype.fromJson=function(e){return this.options.map((function(t,n){return t.fromJson(e[n])}))},t.prototype.toJson=function(e){return this.options.map((function(t,n){return t.toJson(e[n])}))},t.id=G.Tuple,t.operations=Qt,t.computeds=Zt,t.baseType=new t([]),t.describePriority=-1,t.registered=!1,t}(L),bn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xn=function(e){function t(t){var n=e.call(this)||this;return n.expressions=t,n}return bn(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){return n.getExpression(e)})))},t.encode=function(e){var t=e.expressions.map((function(e){return e.encode()}));return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return this.expressions.reduce((function(n,r){return Math.max(n,r.getComplexity(e,t))}),0)},t.prototype.isDynamic=function(){return this.expressions.some((function(e){return e.isDynamic()}))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expressions.map((function(e){return e.clone()})))},t.prototype.getType=function(e,t){return new Tn(this.expressions.map((function(n){return gi.simplify(n.getType(e,t))})))},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return t.expressions.forEach((function(n,r){return e.step(r,n,(function(e){return t.expressions.splice(r,1,e)}),(function(){return t.expressions.splice(r,1)}))}))}))},t.prototype.getExpressionFromStep=function(e){return r(e[0])&&e[0]<this.expressions.length?[1,this.expressions[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.expressions.forEach((function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){this.expressions.forEach((function(r){r.validate(e,t,n)}))},t.prototype.mutates=function(e,t,n){var r,o;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.expressions),s=i.next();!s.done;s=i.next())if(s.value.mutates(e,t,n))return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1},t.id="tuple",t}(q),On=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),En=function(e){function t(t){var n=e.call(this)||this;return n.props=t,n}return On(t,e),t.decode=function(e,n){return new t(O(e[1],(function(e){return n.getExpression(e)})))},t.encode=function(e){var t=O(e.props,(function(e){return e.encode()}));return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e,t){return S(this.props,(function(n,r,o){return Math.max(o,n.getComplexity(e,t))}),0)},t.prototype.isDynamic=function(){for(var e in this.props){var t=this.props[e];if(t&&t.isDynamic())return!0}return!1},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(O(this.props,(function(e){return e.clone()})))},t.prototype.getType=function(e,t){return new xt({props:O(this.props,(function(n){return gi.simplify(n.getType(e,t))}))})},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return E(t.props,(function(n,r){return e.step(r,n,(function(e){return t.props[r]=e}),(function(){return X.objectRemove(t.props,r)}))}))}))},t.prototype.getExpressionFromStep=function(e){return e[0]in this.props?[1,this.props[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,E(this.props,(function(e){return e.setParent(t)}))},t.prototype.validate=function(e,t,n){E(this.props,(function(r){return r.validate(e,t,n)}))},t.prototype.mutates=function(e,t,n){for(var r in this.props)if(this.props[r].mutates(e,t,n))return!0;return!1},t.id="obj",t}(q),wn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Sn=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(wn(arguments[t]));return e},Pn=function(){function e(){}return e.setParent=function(e,t){return void 0===t&&(t=!1),(this.autoSetParent||t)&&e.setParent(),e},e.parse=function(e){var t=this;return i(e)?e.map((function(e){return t.parse(e)})):e instanceof q?e:l(e)?O(e,(function(e){return t.parse(e)})):new Ue(e)},e.cast=function(e,t,n){void 0===n&&(n=!0);var r=e.getId()+":~"+t.getId(),o=e.getOperations()[r];return o?this.op(o,{value:this.get("value")}):n?this.setParent(t.getCreateExpression()):null},e.and=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new ne(e))},e.body=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new Ee(e))},e.const=function(e){return new Ue(e)},e.define=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=le.instance),this.setParent(new ve([],t).with(e))},e.do=function(e,t,n,r){return void 0===t&&(t=le.instance),this.setParent(new be(t,e,n,r))},e.for=function(e,t,n,r,o,i){return void 0===t&&(t=new Ue(0)),void 0===n&&(n=new Ue(0)),void 0===r&&(r=le.instance),this.setParent(new at(e,this.parse(t),this.parse(n),r,o,i))},e.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?new _e:this.setParent(new tt(Sn([new _e],this.parse(e))))},e.sub=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.setParent(new tt(Sn([this.parse(e)],this.parse(t))))},e.computed=function(e){return this.setParent(new rt(e))},e.if=function(e,t,n){return void 0===t&&(t=le.instance),void 0===n&&(n=le.instance),this.setParent(new Ct([[e,t]],n))},e.invoke=function(e,t){return void 0===t&&(t={}),this.setParent(new jt(e,this.parse(t)))},e.method=function(e,t,n){return void 0===n&&(n={}),this.setParent(new At(e,t,this.parse(n)))},e.noop=function(){return le.instance},e.not=function(e){return this.setParent(new ee(e))},e.object=function(e){return this.setParent(new En(this.parse(e)))},e.op=function(e,t,n){return void 0===n&&(n=Object.create(null)),this.setParent(new Ft(e.id,this.parse(t),n))},e.or=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new Rt(e))},e.path=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(1===e.length&&e[0]instanceof tt?e[0]:new tt(this.parse(e)))},e.return=function(e){return void 0===e&&(e=le.instance),this.setParent(new Yt(this.parse(e)))},e.set=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new Ke(this.path.apply(this,Sn(e)),le.instance))},e.switch=function(e,t){return this.setParent(new Bt(e,t.id,[],le.instance))},e.template=function(e,t){return void 0===t&&(t={}),this.setParent(new Jt(e,this.parse(t)))},e.tuple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new xn(this.parse(e)))},e.update=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new $e(this.path.apply(this,Sn(e)),le.instance))},e.while=function(e,t,n,r){return void 0===t&&(t=le.instance),this.setParent(new $t(e,t,n,r))},e.undefined=function(){return this.const(void 0)},e.null=function(){return this.const(null)},e.true=function(){return this.const(!0)},e.false=function(){return this.const(!1)},e.zero=function(){return this.const(0)},e.one=function(){return this.const(1)},e.compareEqual=function(){return this.const(1)},e.compareLess=function(){return this.const(-1)},e.compareGreater=function(){return this.const(1)},e.string=function(){return this.const("")},e.comment=function(e){return new Se(e)},e.entity=function(e){return new St(e)},e.relation=function(e){return new Mt(e)},e.data=function(e){return new pt(e)},e.autoSetParent=!0,e}(),Mn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Mn(t,e),t.decode=function(e){return new t(e[1]||{})},t.encode=function(e){return d(e.options)?this.id:[this.id,e.options]},t.describe=function(e,n,o){return r(e)?new t({min:e,max:e,whole:Math.abs(Math.floor(e)-e)<=t.WHOLE_EPSILON}):null},t.register=function(){var e=this,t="number";X.addCompare({priority:0,type:t,compare:function(t,n){return t<n?n-t<e.COMPARES_EPSILON?0:-1:t-n<e.COMPARES_EPSILON?0:1}}),X.addEquals({priority:0,type:t,equals:function(t,n){return Math.abs(t-n)<e.EQUALS_EPSILON}}),X.addCompare({priority:0,type:"bigint",compare:function(e,t){return e-t}}),X.addEquals({priority:0,type:"bigint",equals:function(e,t){return e===t}})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.max=Math.max(t.max,n.max),t.min=Math.min(t.min,n.min),t.whole=t.whole&&n.whole},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){if(!(e instanceof t))return!1;if(n.value){var o=this.options.min,i=e.options.min;if(r(o)&&(!r(i)||i<o))return!1;var s=this.options.max,a=e.options.max;if(r(s)&&(!r(a)||a<s))return!1}return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){this.options={}},t.prototype.getCreateExpression=function(){return Pn.op(sn.create,{})},t.prototype.getValidateExpression=function(){return Pn.op(sn.isValid,{value:Pn.get("value")})},t.prototype.getCompareExpression=function(){return Pn.op(sn.cmp,{value:Pn.get("value"),test:Pn.get("test")})},t.prototype.isValid=function(e){if(!r(e))return!1;var t=this.options,n=t.min,o=t.max,i=t.whole;return!(r(n)&&e<n||r(o)&&e>o||i&&!h(e))},t.prototype.normalize=function(e){return e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t(X.copy(this.options))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return 0},t.prototype.random=function(e){var t=this.options,n=t.min,r=t.max,o=t.whole;return e(_(n,0),_(r,10),o)},t.prototype.fromJson=function(e){return e},t.prototype.toJson=function(e){return e},t.WHOLE_EPSILON=1e-6,t.id=G.Number,t.operations=nn,t.computeds=rn,t.baseType=new t({}),t.describePriority=4,t.registered=!1,t.EQUALS_EPSILON=1e-6,t.COMPARES_EPSILON=1e-6,t}(L),In=["th","st","nd","rd","th","th","th","th","th","th"],Cn={weekStartsOn:0,firstWeekContainsDate:4,am:"am",pm:"pm",formatLT:"h:mm A",formatLTS:"h:mm:ss A",formatL:"MM/DD/Y",formatl:"M/D/Y",formatLL:"MMMM D, Y",formatll:"MMM D, Y",formatLLL:"MMMM D, Y h:mm A",formatlll:"MMM D, Y h:mm A",formatLLLL:"dddd, MMMM D, Y h:mm A",formatllll:"ddd, MMM D, Y h:mm A",suffix:function(e){return e+(e>=11&&e<=13?"th":In[e%In.length])},list:function(e){for(var t=e.length-1,n=e[0],r=1;r<t;r++)n+=", "+e[r];return t>0&&(n+=" and "+e[t]),n},months:[["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["Ja","F","Mr","Ap","My","Je","Jl","Ag","S","O","N","D"]],weekdays:[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Su","M","Tu","W","Th","F","Sa"]]},Dn=1e3,jn=60,kn=24,An=7,Nn=Dn*jn,Rn=Nn*jn,Ln=Rn*kn,qn=3,Fn=12,Vn=1,Yn=31,Wn=23,Gn=59,Hn=59,Bn=999,Un=6,Jn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Kn=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Jn(arguments[t]));return e},zn={none:function(e){return e},floor:function(e){return Math.floor(e)},ceil:function(e){return Math.ceil(e)},round:function(e){return Math.round(e)},truncate:function(e){return e<0?Math.ceil(e):Math.floor(e)},down:function(e){return e<0?Math.ceil(e):Math.floor(e)},up:function(e){return e<0?Math.floor(e):Math.ceil(e)}},Xn={timestamp:function(e){return e.valueOf()},timestampSeconds:function(e){return Math.floor(e.valueOf()/Dn)},millis:function(e){return e.getMilliseconds()},second:function(e){return e.getSeconds()},minute:function(e){return e.getMinutes()},hour:function(e){return e.getHours()},day:function(e){return e.getDay()},dayOfMonth:function(e){return e.getDate()},lastDayOfMonth:lr,dayOfYear:Ir,dayOfWeek:_r,week:hr,weekOfMonth:Er,weekspanOfMonth:Tr,fullWeekOfMonth:xr,lastWeekspanOfMonth:br,lastFullWeekOfMonth:Or,weekOfYear:yr,weekspanOfYear:dr,fullWeekOfYear:vr,lastWeekspanOfYear:fr,lastFullWeekOfYear:gr,month:function(e){return e.getMonth()},quarter:qr,year:function(e){return e.getFullYear()},timeIdentifier:sr,dayIdentifier:ar,weekIdentifier:ur,monthIdentifier:pr,quarterIdentifier:cr},$n={timestamp:function(e,t){return nr(e,(function(e){return e.setTime(t)}))},timestampSeconds:function(e,t){return nr(e,(function(e){return e.setTime(1e3*t)}))},millis:function(e,t){return nr(e,(function(e){return e.setMilliseconds(t)}))},second:function(e,t){return nr(e,(function(e){return e.setSeconds(t)}))},minute:function(e,t){return nr(e,(function(e){return e.setMinutes(t)}))},hour:function(e,t){return nr(e,(function(e){return e.setHours(t)}))},day:function(e,t){return nr(e,(function(e){return er.day(e,t-e.getDay())}))},dayOfMonth:function(e,t){return nr(e,(function(e){return e.setDate(t)}))},lastDayOfMonth:function(e,t){return nr(e,(function(e){return er.day(e,t-lr(e))}))},dayOfYear:function(e,t){return nr(e,(function(e){return er.day(e,t-Ir(e))}))},dayOfWeek:function(e,t){return nr(e,(function(e){return er.day(e,t-_r(e))}))},week:function(e,t){return nr(e,(function(e){return er.week(e,t-hr(e))}))},weekOfMonth:function(e,t){return nr(e,(function(e){return er.week(e,t-Er(e))}))},weekspanOfMonth:function(e,t){return nr(e,(function(e){return er.week(e,t-Tr(e))}))},fullWeekOfMonth:function(e,t){return nr(e,(function(e){return er.week(e,t-xr(e))}))},lastWeekspanOfMonth:function(e,t){return nr(e,(function(e){return er.week(e,t-br(e))}))},lastFullWeekOfMonth:function(e,t){return nr(e,(function(e){return er.week(e,t-Or(e))}))},weekOfYear:function(e,t){return nr(e,(function(e){return er.week(e,t-yr(e))}))},weekspanOfYear:function(e,t){return nr(e,(function(e){return er.week(e,t-dr(e))}))},fullWeekOfYear:function(e,t){return nr(e,(function(e){return er.week(e,t-vr(e))}))},lastWeekspanOfYear:function(e,t){return nr(e,(function(e){return er.week(e,t-fr(e))}))},lastFullWeekOfYear:function(e,t){return nr(e,(function(e){return er.week(e,t-gr(e))}))},month:function(e,t){return nr(e,(function(e){return e.setMonth(t)}))},quarter:function(e,t){return nr(e,(function(e){return er.quarter(e,t-qr(e))}))},year:function(e,t){return nr(e,(function(e){return e.setFullYear(t)}))}},Qn={millis:function(e){return e},second:Fr,minute:Vr,hour:Yr,day:Wr,week:Gr,month:Hr,quarter:Br,year:Ur},Zn={millis:function(e){return e},second:Jr,minute:Kr,hour:zr,day:Xr,week:$r,month:Qr,quarter:Zr,year:eo},er={millis:to,second:no,minute:ro,hour:oo,day:io,week:so,month:ao,quarter:uo,year:po},tr={millis:co,second:lo,minute:fo,hour:yo,day:ho,week:vo,month:mo,quarter:go,year:To};function nr(e,t,n){var r=new Date(e.getTime());return t(r,n),r}function rr(e,t,n,r){void 0===n&&(n="millis"),void 0===r&&(r=Cn);var o=Qn[n],i=nr(e,o,r),s=nr(t,o,r);return i.getTime()-s.getTime()}var or=[{pattern:/^(\d{4})[-/](\d{1,22})[-/](\d{1,2})(|[T ](\d{1,2})((|:(\d{1,2})(|:(\d{1,2})(|\.(\d+)Z?)))))$/,groups:[1,2,3,5,8,10,12]},{pattern:/^(\d{1,2})[-/](\d{1,2})[-/](\d{4})(|[T ](\d{1,2})((|:(\d{1,2})(|:(\d{1,2})(|\.(\d+)Z?)))))$/,groups:[3,1,2,5,8,10,12]}];function ir(e,t){var n,i;if(void 0===t&&(t=!1),s(e))return e;if(r(e)&&e>0)return new Date(e);if(o(e)){try{for(var a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(or),u=a.next();!u.done;u=a.next()){var p=u.value,c=p.pattern,l=p.groups,f=c.exec(e);if(f){for(var y=[0,0,1,0,0,0,0],h=0;h<y.length;h++){var d=parseInt(f[l[h]]);isFinite(d)&&(y[h]=1===h?d-1:d)}return t?new Date(Date.UTC.apply(Date,Kn(y))):new(Date.bind.apply(Date,Kn([void 0],y)))}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}if(t){var v=e+" UTC",m=Date.parse(v);if(isFinite(m))return new Date(m)}var g=Date.parse(e);if(isFinite(g))return new Date(g)}return null}function sr(e){return 1e8*e.getFullYear()+1e6*(e.getMonth()+1)+1e4*e.getDate()+100*e.getHours()+e.getMinutes()}function ar(e){return 1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate()}function ur(e){return 1e3*e.getFullYear()+hr(e)}function pr(e){return 100*e.getFullYear()+(e.getMonth()+1)}function cr(e){return 10*e.getFullYear()+qr(e)}function lr(e){return Nr(e)-e.getDate()+1}function fr(e){var t=kr(e)-Ir(e);return Math.floor(t/An)}function yr(e,t){return void 0===t&&(t=Cn),Sr(nr(e,Ur),Ir(e),t)}function hr(e,t){return void 0===t&&(t=Cn),Pr(nr(e,Ur),Ir(e),t)}function dr(e){return Math.floor((Ir(e)-1)/An)}function vr(e,t){return void 0===t&&(t=Cn),Mr(nr(e,Ur),kr(e),t)}function mr(e,t){return void 0===t&&(t=Cn),yr(nr(e,eo),t)+1}function gr(e,t){void 0===t&&(t=Cn);var n=nr(e,eo),r=yr(e,t),o=yr(n,t)-r;return _r(n,t)===Un?o+1:o}function Tr(e){return Math.floor((e.getDate()-1)/An)}function br(e){var t=Nr(e)-e.getDate();return Math.floor(t/An)}function xr(e,t){return void 0===t&&(t=Cn),Mr(nr(e,Hr),e.getDate(),t)}function Or(e,t){void 0===t&&(t=Cn);var n=Nr(e)-e.getDate(),r=Un-_r(e,t);return Math.floor((n-r+An)/An)}function Er(e,t){return void 0===t&&(t=Cn),Sr(nr(e,Hr),e.getDate(),t)}function wr(e,t){return void 0===t&&(t=Cn),Pr(nr(e,Hr),e.getDate(),t)}function Sr(e,t,n){void 0===n&&(n=Cn);var r=n.firstWeekContainsDate,o=_r(e,n),i=An-o<r?o-1:o-1+An;return Math.floor((t+i)/An)}function Pr(e,t,n){var r=_r(e,n)-1+An;return Math.floor((t+r)/An)}function Mr(e,t,n){void 0===n&&(n=Cn);var r=_r(e,n),o=0!==r?r-1:r-1+An;return Math.floor((t+o)/An)}function _r(e,t){void 0===t&&(t=Cn);var n=t.weekStartsOn,r=e.getDay();return r<n?r-n+An:r-n}function Ir(e){return Math.round(ho(e,nr(e,Ur)))+1}function Cr(e){return 15*-Math.round(e.getTimezoneOffset()/15)}function Dr(e){var t=Cr(e);return t>Cr(nr(e,(function(e){return e.setMonth(0)})))||t>Cr(nr(e,(function(e){return e.setMonth(5)})))}function jr(e){var t=e.getFullYear();return t%400==0||t%4==0&&t%100!=0}function kr(e){return jr(e)?366:365}var Ar=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]];function Nr(e){return Ar[jr(e)?1:0][e.getMonth()]}function Rr(e){return e.getTime()-Lr(e)}function Lr(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();t.setSeconds(0,0);var r=t.getTime()%Nn;return n*Nn+r}function qr(e){return Math.floor(e.getMonth()/qn)}function Fr(e){e.setMilliseconds(0)}function Vr(e){e.setSeconds(0,0)}function Yr(e){e.setMinutes(0,0,0)}function Wr(e){e.setHours(0,0,0,0)}function Gr(e,t){void 0===t&&(t=Cn);var n=_r(e,t);e.setDate(e.getDate()-n),e.setHours(0,0,0,0)}function Hr(e){e.setDate(Vn),e.setHours(0,0,0,0)}function Br(e){var t=e.getMonth();e.setMonth(t-t%qn,Vn),e.setHours(0,0,0,0)}function Ur(e){var t=e.getFullYear();e.setTime(0),e.setFullYear(t,0,1),e.setHours(0,0,0,0)}function Jr(e){e.setMilliseconds(Bn)}function Kr(e){e.setSeconds(Hn,Bn)}function zr(e){e.setMinutes(Gn,Hn,Bn)}function Xr(e){e.setHours(Wn,Gn,Hn,Bn)}function $r(e,t){void 0===t&&(t=Cn);var n=_r(e,t);e.setDate(e.getDate()+(Un-n)),Xr(e)}function Qr(e){e.setFullYear(e.getFullYear(),e.getMonth()+1,0),Xr(e)}function Zr(e){var t=e.getMonth();e.setMonth(t-t%qn+qn,Vn),Xr(e)}function eo(e){e.setFullYear(e.getFullYear()+1,0,0),Xr(e)}function to(e,t){e.setTime(e.getTime()+t)}function no(e,t){to(e,t*Dn)}function ro(e,t){to(e,t*Nn)}function oo(e,t){to(e,t*Rn)}function io(e,t){e.setDate(e.getDate()+t)}function so(e,t){io(e,t*An)}function ao(e,t){var n=e.getMonth()+t,r=new Date(0);r.setFullYear(r.getFullYear(),n,1),r.setHours(0,0,0,0);var o=Nr(r);e.setMonth(n,Math.min(o,e.getDate()))}function uo(e,t){ao(e,t*qn)}function po(e,t){ao(e,t*Fn)}function co(e,t){return e.getTime()-t.getTime()}function lo(e,t){return co(e,t)/Dn}function fo(e,t){return co(e,t)/Nn}function yo(e,t){return co(e,t)/Rn}function ho(e,t){return(Rr(e)-Rr(t))/Ln}function vo(e,t){return ho(e,t)/An}function mo(e,t){var n=e.getFullYear()-t.getFullYear(),r=e.getMonth()-t.getMonth(),o=(e.getDate()-t.getDate())/Yn;return n*Fn+r+o}function go(e,t){return mo(e,t)/qn}function To(e,t){return mo(e,t)/Fn}var bo=new Y(G.Date+G.Delimiter),xo=new W(G.Date+G.Delimiter),Oo=bo,Eo={create:Oo.set("create"),now:Oo.set("now"),today:Oo.set("today"),tomorrow:Oo.set("today+"),yesterday:Oo.set("today-"),maybe:Oo.set("maybe",{},["value"]),parse:Oo.set("parse",{},["value"],["parseAsUTC"]),fromText:Oo.set(">txt",{},["value"],["parseAsUTC"]),fromTimestamp:Oo.set(">tms",{},["value"]),fromTimestampSeconds:Oo.set(">tmss",{},["value"]),min:Oo.set("min",{},["value","test"]),max:Oo.set("max",{},["value","test"]),get:Oo.set("get",{},["value","property"]),set:Oo.set("set",{},["value","property","set"]),add:Oo.set("+",{},["value","unit"],["amount"]),sub:Oo.set("-",{},["value","unit"],["amount"]),startOf:Oo.set("startOf",{},["value","unit"]),endOf:Oo.set("endOf",{},["value","unit"],["inclusive"]),daysInMonth:Oo.set("dim",{},["value"]),daysInYear:Oo.set("diy",{},["value"]),weeksInYear:Oo.set("wiy",{},["value"]),copy:Oo.set("copy",{},["value"]),cmp:Oo.set("cmp",{},["value","test"],["unit"]),diff:Oo.set("diff",{},["value","test"],["unit","absolute","adjust"]),timezoneOffset:Oo.set("offset",{},["value"]),toText:Oo.set("toText",{},["value","format"]),toISOText:Oo.set("toISOText",{},["value"]),isValid:Oo.set("?",{},["value"]),isEqual:Oo.set("=",{},["value","test"],["unit"]),isBefore:Oo.set("<",{},["value","test"],["unit"]),isBeforeOrEqual:Oo.set("<=",{},["value","test"],["unit"]),isAfter:Oo.set(">",{},["value","test"],["unit"]),isAfterOrEqual:Oo.set(">=",{},["value","test"],["unit"]),isBetween:Oo.set("between",{},["value","start","end"],["unit","startInclusive","endInclusive"]),isStartOf:Oo.set("startOf?",{},["value","unit"]),isEndOf:Oo.set("endOf?",{},["value","unit"],["inclusive"]),isDST:Oo.set("dst?",{},["value"]),isLeapYear:Oo.set("leap?",{},["value"]),asAny:Oo.set("~"+G.Any,{},["value"]),asBoolean:Oo.set("~"+G.Boolean,{},["value"]),asColor:Oo.set("~"+G.Color,{},["value"]),asDate:Oo.set("~"+G.Date,{},["value"]),asList:Oo.set("~"+G.List,{},["value"]),asMap:Oo.set("~"+G.Map,{},["value"]),asNumber:Oo.set("~"+G.Number,{},["value"]),asObject:Oo.set("~"+G.Object,{},["value"]),asText:Oo.set("~"+G.Text,{},["value"]),asTuple:Oo.set("~"+G.Tuple,{},["value"]),asSet:Oo.set("~"+G.Set,{},["value"])};xo.set("timestamp",Eo.get,"value",{property:"timestamp"}),xo.setWritable("timestamp",Eo.set,"value","set",{property:"timestamp"}),xo.set("timestampSeconds",Eo.get,"value",{property:"timestampSeconds"}),xo.setWritable("timestampSeconds",Eo.set,"value","set",{property:"timestampSeconds"}),xo.set("millis",Eo.get,"value",{property:"millis"}),xo.setWritable("millis",Eo.set,"value","set",{property:"millis"}),xo.set("second",Eo.get,"value",{property:"second"}),xo.setWritable("second",Eo.set,"value","set",{property:"second"}),xo.set("minute",Eo.get,"value",{property:"minute"}),xo.setWritable("minute",Eo.set,"value","set",{property:"minute"}),xo.set("hour",Eo.get,"value",{property:"hour"}),xo.setWritable("hour",Eo.set,"value","set",{property:"hour"}),xo.set("day",Eo.get,"value",{property:"day"}),xo.setWritable("day",Eo.set,"value","set",{property:"day"}),xo.set("dayOfMonth",Eo.get,"value",{property:"dayOfMonth"}),xo.setWritable("dayOfMonth",Eo.set,"value","set",{property:"dayOfMonth"}),xo.set("lastDayOfMonth",Eo.get,"value",{property:"lastDayOfMonth"}),xo.setWritable("lastDayOfMonth",Eo.set,"value","set",{property:"lastDayOfMonth"}),xo.set("dayOfYear",Eo.get,"value",{property:"dayOfYear"}),xo.setWritable("dayOfYear",Eo.set,"value","set",{property:"dayOfYear"}),xo.set("dayOfWeek",Eo.get,"value",{property:"dayOfWeek"}),xo.setWritable("dayOfWeek",Eo.set,"value","set",{property:"dayOfWeek"}),xo.set("week",Eo.get,"value",{property:"week"}),xo.setWritable("week",Eo.set,"value","set",{property:"week"}),xo.set("weekOfMonth",Eo.get,"value",{property:"weekOfMonth"}),xo.setWritable("weekOfMonth",Eo.set,"value","set",{property:"weekOfMonth"}),xo.set("weekspanOfMonth",Eo.get,"value",{property:"weekspanOfMonth"}),xo.setWritable("weekspanOfMonth",Eo.set,"value","set",{property:"weekspanOfMonth"}),xo.set("fullWeekOfMonth",Eo.get,"value",{property:"fullWeekOfMonth"}),xo.setWritable("fullWeekOfMonth",Eo.set,"value","set",{property:"fullWeekOfMonth"}),xo.set("lastWeekspanOfMonth",Eo.get,"value",{property:"lastWeekspanOfMonth"}),xo.setWritable("lastWeekspanOfMonth",Eo.set,"value","set",{property:"lastWeekspanOfMonth"}),xo.set("lastFullWeekOfMonth",Eo.get,"value",{property:"lastFullWeekOfMonth"}),xo.setWritable("lastFullWeekOfMonth",Eo.set,"value","set",{property:"lastFullWeekOfMonth"}),xo.set("weekOfYear",Eo.get,"value",{property:"weekOfYear"}),xo.setWritable("weekOfYear",Eo.set,"value","set",{property:"weekOfYear"}),xo.set("weekspanOfYear",Eo.get,"value",{property:"weekspanOfYear"}),xo.setWritable("weekspanOfYear",Eo.set,"value","set",{property:"weekspanOfYear"}),xo.set("fullWeekOfYear",Eo.get,"value",{property:"fullWeekOfYear"}),xo.setWritable("fullWeekOfYear",Eo.set,"value","set",{property:"fullWeekOfYear"}),xo.set("lastWeekspanOfYear",Eo.get,"value",{property:"lastWeekspanOfYear"}),xo.setWritable("lastWeekspanOfYear",Eo.set,"value","set",{property:"lastWeekspanOfYear"}),xo.set("lastFullWeekOfYear",Eo.get,"value",{property:"lastFullWeekOfYear"}),xo.setWritable("lastFullWeekOfYear",Eo.set,"value","set",{property:"lastFullWeekOfYear"}),xo.set("month",Eo.get,"value",{property:"month"}),xo.setWritable("month",Eo.set,"value","set",{property:"month"}),xo.set("quarter",Eo.get,"value",{property:"quarter"}),xo.setWritable("quarter",Eo.set,"value","set",{property:"quarter"}),xo.set("year",Eo.get,"value",{property:"year"}),xo.setWritable("year",Eo.set,"value","set",{property:"year"}),xo.set("timeIdentifier",Eo.get,"value",{property:"timeIdentifier"}),xo.setWritable("timeIdentifier",Eo.set,"value","set",{property:"timeIdentifier"}),xo.set("dayIdentifier",Eo.get,"value",{property:"dayIdentifier"}),xo.setWritable("dayIdentifier",Eo.set,"value","set",{property:"dayIdentifier"}),xo.set("weekIdentifier",Eo.get,"value",{property:"weekIdentifier"}),xo.setWritable("weekIdentifier",Eo.set,"value","set",{property:"weekIdentifier"}),xo.set("monthIdentifier",Eo.get,"value",{property:"monthIdentifier"}),xo.setWritable("monthIdentifier",Eo.set,"value","set",{property:"monthIdentifier"}),xo.set("quarterIdentifier",Eo.get,"value",{property:"quarterIdentifier"}),xo.setWritable("quarterIdentifier",Eo.set,"value","set",{property:"quarterIdentifier"}),xo.set("startOfSecond",Eo.startOf,"value",{unit:"second"}),xo.set("startOfMinute",Eo.startOf,"value",{unit:"minute"}),xo.set("startOfHour",Eo.startOf,"value",{unit:"hour"}),xo.set("startOfDay",Eo.startOf,"value",{unit:"day"}),xo.set("startOfWeek",Eo.startOf,"value",{unit:"week"}),xo.set("startOfMonth",Eo.startOf,"value",{unit:"month"}),xo.set("startOfQuarter",Eo.startOf,"value",{unit:"quarter"}),xo.set("startOfYear",Eo.startOf,"value",{unit:"year"}),xo.set("endOfSecond",Eo.endOf,"value",{unit:"second"}),xo.set("endOfMinute",Eo.endOf,"value",{unit:"minute"}),xo.set("endOfHour",Eo.endOf,"value",{unit:"hour"}),xo.set("endOfDay",Eo.endOf,"value",{unit:"day"}),xo.set("endOfWeek",Eo.endOf,"value",{unit:"week"}),xo.set("endOfMonth",Eo.endOf,"value",{unit:"month"}),xo.set("endOfQuarter",Eo.endOf,"value",{unit:"quarter"}),xo.set("endOfYear",Eo.endOf,"value",{unit:"year"}),xo.set("daysInMonth",Eo.daysInMonth),xo.set("daysInYear",Eo.daysInYear),xo.set("weeksInYear",Eo.weeksInYear),xo.set("timezoneOffset",Eo.timezoneOffset),xo.set("toISOText",Eo.toISOText),xo.set("isDST",Eo.isDST),xo.set("isLeapYear",Eo.isLeapYear);var wo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),So=function(){return(So=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Po=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return wo(t,e),t.decode=function(e,n){return new t(this.decodeOptions(e[1]||{}))},t.encode=function(e){return d(e.options)?this.id:[this.id,this.encodeOptions(e.options)]},t.decodeOptions=function(e){return e.validateMin&&(e.validateMin=new Date(e.validateMin)),e.validateMax&&(e.validateMax=new Date(e.validateMax)),e.forceMin&&(e.forceMin=new Date(e.forceMin)),e.forceMax&&(e.forceMax=new Date(e.forceMax)),e},t.encodeOptions=function(e){var t=So({},e);return t.validateMin&&(t.validateMin=t.validateMin.toISOString()),t.validateMax&&(t.validateMax=t.validateMax.toISOString()),t.forceMin&&(t.forceMin=t.forceMin.toISOString()),t.forceMax&&(t.forceMax=t.forceMax.toISOString()),t},t.describe=function(e,n,r){return s(e)?new t({validateMin:new Date(e.getTime()),validateMax:new Date(e.getTime())}):null},t.register=function(){var e="object";X.addCompare({priority:9,type:e,compare:function(e,t){var n=s(e),r=s(t);return n!==r?(n?1:0)-(r?1:0):n?e.getTime()-t.getTime():void 0}}),X.addEquals({priority:9,type:e,equals:function(e,t){var n=s(e);return n===s(t)&&(n?e.getTime()===t.getTime():void 0)}}),X.addJson({priority:9,fromJson:function(e){if(l(e)&&o(e.$any)&&"date"===e.$any)return new Date(e.value)},toJson:function(e){if(s(e))return{$any:"date",value:e.toISOString()}}}),X.addCopier({priority:9,copy:function(e,t,n){if(s(e)){var r=new Date(e.getTime());return n(e,r),r}}})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.parseAsUTC=t.parseAsUTC&&n.parseAsUTC,t.validateMin&&n.validateMin&&t.validateMin.setTime(Math.min(t.validateMin.getTime(),n.validateMin.getTime())),t.validateMax&&n.validateMax&&t.validateMax.setTime(Math.max(t.validateMax.getTime(),n.validateMax.getTime()))},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){if(void 0===n&&(n={}),!(e instanceof t))return!1;if(n.value){if(e.options.withTime&&!this.options.withTime)return!1;var r=this.getMin(),o=e.getMin();if(r&&(!o||o.getTime()<r.getTime()))return!1;var i=this.getMax(),s=e.getMax();if(i&&(!s||s.getTime()>i.getTime()))return!1;var a=this.options,u=a.forceStartOf,p=a.forceEndOf;if(u&&u!==e.options.forceStartOf)return!1;if(p&&p!==e.options.forceEndOf)return!1}return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){var e=this.options,t=e.parseAsUTC,n=e.withTime;this.options={parseAsUTC:t,withTime:n}},t.prototype.getCreateExpression=function(){return Pn.op(Eo.create,{})},t.prototype.getValidateExpression=function(){return Pn.op(Eo.isValid,{value:Pn.get("value")})},t.prototype.getCompareExpression=function(){return Pn.op(Eo.cmp,{value:Pn.get("value"),test:Pn.get("test")})},t.prototype.isValid=function(e){var t=this.options,n=t.parseAsUTC,r=t.validateMin,o=t.validateMax,i=ir(e,n);return!(!i||r&&i.getTime()<r.getTime()||o&&i.getTime()>o.getTime())},t.prototype.normalize=function(e){var t=this.options,n=t.parseAsUTC,r=t.forceMin,o=t.forceMax,i=t.forceStartOf,s=t.forceEndOf,a=ir(e,n);return a?(r&&a.getTime()<r.getTime()&&a.setTime(r.getTime()),o&&a.getTime()>o.getTime()&&a.setTime(o.getTime()),i&&Qn[i](a),s&&Zn[s](a),a):e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t(X.copy(this.options))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return new Date},t.prototype.random=function(e){var t=new Date,n=this.getMin(),r=this.getMax(),o=n?n.getTime():t.getTime(),i=r?r.getTime():t.getTime();return new Date(e(o,i,!0))},t.prototype.getMin=function(){return this.options.validateMin||this.options.forceMin},t.prototype.getMax=function(){return this.options.validateMax||this.options.forceMax},t.prototype.fromJson=function(e){return new Date(e)},t.prototype.toJson=function(e){return e?e.toISOString():null},t.id=G.Date,t.operations=bo,t.computeds=xo,t.baseType=new t({}),t.describePriority=6,t.registered=!1,t}(L),Mo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Io=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Mo(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){return n.getType(e)})))},t.encode=function(e){var t=e.options.map((function(e){return e.encode()}));return[this.id,t]},t.describe=function(e,t,n){return null},t.register=function(){},t.prototype.getOperations=function(){var e=this;return this.operations||(this.operations={},this.options.forEach((function(t){var n=t.getOperations();for(var r in n)e.operations[r]=n[r]}))),this.operations},t.prototype.forMany=function(e,t){var n,r,o=this.options;try{for(var i=_o(o),s=i.next();!s.done;s=i.next()){var a=t(s.value);if(void 0!==a)return a}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return e},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){var r,o;try{for(var i=_o(this.options),s=i.next();!s.done;s=i.next()){var a=s.value.getSubType(e,t,n);if(a)return a}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return null},t.prototype.getSubTypes=function(e){var t=[];return this.options.forEach((function(n){n.getSubTypes(e).forEach((function(e){t.find((function(t){return t.key===e.key||t.key instanceof L&&e.key instanceof L&&y(t.key,e.key)}))||t.push(e)}))})),t.sort((function(e,t){return(e.key instanceof L?1:0)-(t.key instanceof L?1:0)})),t},t.prototype.getExactType=function(e){return this.forMany(this,(function(t){return t.isValid(e)?t:void 0}))},t.prototype.getSimplifiedType=function(){return 1===this.options.length?this.options[0]:this},t.prototype.getRequired=function(){return this.isOptional()?new t(this.options.map((function(e){return e.getRequired()}))):this},t.prototype.isDeepCompatible=function(e,t){return this.forMany(!1,(function(n){return!!n.isCompatible(e,t)||void 0}))},t.prototype.isOptional=function(){return this.forMany(!0,(function(e){return!!e.isOptional()&&void 0}))},t.prototype.isSimple=function(){return this.forMany(!0,(function(e){return!!e.isSimple()&&void 0}))},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return t.options.map((function(n,r){return e.step(r,n,(function(e){return t.options.splice(r,1,e)}),(function(){return t.options.splice(r,1)}))}))}))},t.prototype.getTypeFromStep=function(e){return this.options[e]||null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.options.forEach((function(e){return e.setParent(t)}))},t.prototype.removeDescribedRestrictions=function(){this.options.forEach((function(e){return e.removeDescribedRestrictions()}))},t.prototype.getCreateExpression=function(){return this.options[0].getCreateExpression()},t.prototype.getValidateExpression=function(){return Pn.or.apply(Pn,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Io(arguments[t]));return e}(this.options.map((function(e){return e.getValidateExpression()}))))},t.prototype.getCompareExpression=function(){return Pn.op(ae.cmp,{value:Pn.get("value"),test:Pn.get("test")})},t.prototype.getValueChangeExpression=function(e,t,n){var o=r(t),i=r(n);if(o&&!i){var s=0===t?this.options[1]:this.options[0],a=this.options[t],u=Pn.cast(a,s);return Pn.if(s.getValidateExpression()).than(Pn.get("value")).else(u)}return!o&&i?e:n===t&&o?Pn.if(Pn.not(this.getValidateExpression())).than(e).else(Pn.get("value")):e},t.prototype.isValid=function(e){return this.forMany(!1,(function(t){return!!t.isValid(e)||void 0}))},t.prototype.normalize=function(e){return this.forMany(e,(function(t){return t.isValid(e)?t.normalize(e):void 0}))},t.prototype.newInstance=function(){return new t([])},t.prototype.clone=function(){return new t(this.options.map((function(e){return e.clone()})))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.options.length>0?this.options[0].create():null},t.prototype.random=function(e){var t=this.options;return t[e(0,t.length,!0)].random(e)},t.prototype.fromJson=function(e){var t,n,r=this.options;try{for(var o=_o(r),i=o.next();!i.done;i=o.next()){var s=i.value.normalize(e);if(null!=s)return s}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e},t.prototype.toJson=function(e){var t,n,r=this.options;try{for(var o=_o(r),i=o.next();!i.done;i=o.next()){var s=i.value;if(s.isValid(e))return s.toJson(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e},t.id=G.Many,t.operations=new Y(G.Many+G.Delimiter),t.computeds=new W(G.Many+G.Delimiter),t.baseType=new t([ye.baseType]),t.describePriority=-1,t.registered=!1,t}(L),Do=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jo=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ko=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Do(t,e),t.decode=function(e,n){var r=n.getType(e[1]);return new t({key:e[2]?n.getType(e[2]):Re.baseType,value:r})},t.encode=function(e){var t=e.options,n=t.key,r=t.value;return n!==Re.baseType?[this.id,r.encode()]:[this.id,r.encode(),n.encode()]},t.describe=function(e,n,r){var o,i;if(!a(e))return null;var s=new ye({}),u=new ye({}),p=new t({key:s,value:u});r.set(e,p);try{for(var c=jo(e.entries()),l=c.next();!l.done;l=c.next()){var f=ko(l.value,2),y=f[0],h=f[1];s=n.merge(s,y),u=n.merge(u,h)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}return p.options.key=s,p.options.value=u,p},t.register=function(){var e="object";X.addJson({priority:10,fromJson:function(e,t){if(l(e)&&o(e.$any)&&"map"===e.$any)return new Map(e.value.map((function(e){var n=ko(e,2),r=n[0],o=n[1];return[t(r),t(o)]})))},toJson:function(e,t){if(a(e))return{$any:"map",value:Array.from(e.entries()).map((function(e){var n=ko(e,2),r=n[0],o=n[1];return[t(r),t(o)]}))}}}),X.addCopier({priority:10,copy:function(e,t,n){var r,o;if(a(e)){var i=new Map;n(e,i);try{for(var s=jo(e.entries()),u=s.next();!u.done;u=s.next()){var p=ko(u.value,2),c=p[0],l=p[1];i.set(t(c),t(l))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}}}),X.addCompare({priority:10,type:e,compare:function(e,t,n){var r,o,i,s,u=a(e),p=a(t);if(u!==p)return(u?1:0)-(p?1:0);if(a(e)&&a(t)){var c=0,l=0;try{for(var f=jo(e.keys()),y=f.next();!y.done;y=f.next()){var h=y.value;t.has(h)||c++}}catch(e){r={error:e}}finally{try{y&&!y.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}try{for(var d=jo(t.keys()),v=d.next();!v.done;v=d.next())if(h=v.value,e.has(h)){var m=n(e.get(h),t.get(h));m<0&&c++,m>0&&l++}else l++}catch(e){i={error:e}}finally{try{v&&!v.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}return X.getCompare(c,l)}}}),X.addEquals({priority:10,type:e,equals:function(e,t,n){var r,o;if(a(e)!==a(t))return!1;if(a(e)&&a(t)){if(e.size!==t.size)return!1;try{for(var i=jo(e.entries()),s=i.next();!s.done;s=i.next()){var u=ko(s.value,2),p=u[0],c=u[1];if(!t.has(p))return!1;if(!n(c,t.get(p)))return!1}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!0}}}),X.addAccessor({priority:10,isValid:function(e){return a(e)},get:function(e,t){return e.get(t)},set:function(e,t,n){return e.set(t,n)},remove:function(e,t){return e.delete(t)},has:function(e,t){return e.has(t)}})},t.forItem=function(e,n){void 0===n&&(n=Re);var r=gi.parse(e);return new t({key:gi.parse(n),value:r})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.key=gi.merge(t.key,n.key),t.value=gi.merge(t.value,n.value)},t.prototype.getSubType=function(e,t,n){if(Ue.is(e)&&this.options.key.isValid(e.value))return this.options.value;var r=e.getType(t,n);return r&&y(r=r.getRequired(),this.options.key)?this.options.value:null},t.prototype.getSubTypes=function(e){return[{key:this.options.key,value:this.options.value}]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){return e instanceof t&&this.options.key.isCompatible(e.options.key,n)&&this.options.value.isCompatible(e.options.value,n)},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_KEY,n.options.key,(function(e){return n.options.key=e})),e.step(t.STEP_VALUE,n.options.value,(function(e){return n.options.value=e}))}))},t.prototype.getTypeFromStep=function(e){return e===t.STEP_KEY?this.options.key:e===t.STEP_VALUE?this.options.value:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.key.setParent(this),this.options.value.setParent(this)},t.prototype.removeDescribedRestrictions=function(){this.options.key.removeDescribedRestrictions(),this.options.value.removeDescribedRestrictions()},t.prototype.getCreateExpression=function(){return Pn.op(Ve.create,{})},t.prototype.getValidateExpression=function(){return Pn.and(Pn.op(Ve.isValid,{value:Pn.get("value")}),Pn.not(Pn.op(cn.contains,{list:Pn.op(Ve.values,{map:Pn.get("value")}),item:Pn.null(),isEqual:Pn.not(this.options.value.getValidateExpression())},{value:"ignore",test:"value"})),Pn.not(Pn.op(cn.contains,{list:Pn.op(Ve.keys,{map:Pn.get("value")}),item:Pn.null(),isEqual:Pn.not(this.options.key.getValidateExpression())},{value:"ignore",test:"value"})))},t.prototype.getCompareExpression=function(){return Pn.op(Ve.cmp,{value:Pn.get("value"),test:Pn.get("test"),compare:this.options.value.getValidateExpression()})},t.prototype.getValueChangeExpression=function(e,n,r){return n===t.STEP_KEY?Pn.op(Ve.map,{map:Pn.get("value"),transformKey:e},{key:"value",value:"actualValue"}):Pn.op(Ve.map,{map:Pn.get("value"),transform:e})},t.prototype.isValid=function(e){if(e instanceof Map||l(e)){var t=this.options,n=t.key,r=t.value;return this.iterate(e,!0,(function(e,t){if(!n.isValid(e)||!r.isValid(t))return!1}))}return!1},t.prototype.normalize=function(e){var t=this.options,n=t.key,r=t.value,o=[];return this.iterate(e,void 0,(function(e,t){o.push([n.normalize(e),r.normalize(t)])})),new Map(o)},t.prototype.iterate=function(e,t,n){var r,o;if(e instanceof Map)try{for(var i=jo(e.entries()),s=i.next();!s.done;s=i.next()){var a=ko(s.value,2);if(void 0!==(p=n(a[0],a[1])))return p}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}else if(l(e))for(var u in e){var p;if(void 0!==(p=n(u,e[u])))return p}return t},t.prototype.newInstance=function(){var e=this.options,n=e.key,r=e.value;return new t({key:n.newInstance(),value:r.newInstance()})},t.prototype.clone=function(){var e=this.options,n=e.key,r=e.value;return new t({key:n.clone(),value:r.clone()})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return new Map},t.prototype.random=function(e){for(var t=this.options,n=t.key,r=t.value,o=e(2,6,!0),i=new Map,s=0;s<o;s++){var a=n.random(e),u=r.random(e);i.set(a,u)}return i},t.prototype.fromJson=function(e){var t=this.options,n=t.key,r=t.value;return new Map(e.map((function(e){var t=ko(e,2),o=t[0],i=t[1];return[n.fromJson(o),r.fromJson(i)]})))},t.prototype.toJson=function(e){var t=this.options,n=t.key,r=t.value;return Array.from(e.entries()).map((function(e){var t=ko(e,2),o=t[0],i=t[1];return[n.toJson(o),r.toJson(i)]}))},t.STEP_KEY="key",t.STEP_VALUE="value",t.id=G.Map,t.operations=Le,t.computeds=qe,t.baseType=new t({key:Re.baseType,value:ye.baseType}),t.describePriority=7,t.registered=!1,t}(L),No=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return No(t,e),t.decode=function(e,n){return new t(n.getType(e[1]))},t.encode=function(e){return[this.id,e.options.encode()]},t.describe=function(e,t,n){return null},t.register=function(){},t.for=function(e){return new t(gi.parse(e))},t.prototype.getOperations=function(){return this.options.getOperations()},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return this.options.getSubType(e,t,n)},t.prototype.getSubTypes=function(e){return this.options.getSubTypes(e)},t.prototype.getExactType=function(e){return this.options.getExactType(e)},t.prototype.getSimplifiedType=function(){return this},t.prototype.getRequired=function(){return this.options},t.prototype.isDeepCompatible=function(e,n){return e instanceof t?this.options.isCompatible(e.options,n):this.options.isCompatible(e,n)},t.prototype.isOptional=function(){return!0},t.prototype.isSimple=function(){return this.options.isSimple()},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){return e.step(t.STEP_OPTIONAL,n.options,(function(e){return n.options=e}))}))},t.prototype.getTypeFromStep=function(e){return e===t.STEP_OPTIONAL?this.options:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.setParent(this)},t.prototype.removeDescribedRestrictions=function(){this.options.removeDescribedRestrictions()},t.prototype.getCreateExpression=function(){return this.options.getCreateExpression()},t.prototype.getValidateExpression=function(){return Pn.or(Pn.op(ae.isEqual,{value:Pn.get("value"),test:Pn.undefined()}),this.options.getValidateExpression())},t.prototype.getCompareExpression=function(){return Pn.define({valueMissing:Pn.op(ae.isEqual,{value:Pn.get("value"),test:Pn.undefined()}),testMissing:Pn.op(ae.isEqual,{value:Pn.get("test"),test:Pn.undefined()})},Pn.if(Pn.and(Pn.get("valueMissing"),Pn.get("testMissing"))).than(Pn.compareEqual()).if(Pn.get("valueMissing")).than(Pn.compareLess()).if(Pn.get("testMissing")).than(Pn.compareGreater()).else(this.options.getCompareExpression()))},t.prototype.getValueChangeExpression=function(e,t,n){return Pn.if(this.options.getValidateExpression()).than(e).else(Pn.get("value"))},t.prototype.isValid=function(e){return null==e||this.options.isValid(e)},t.prototype.normalize=function(e){return null==e?e:this.options.normalize(e)},t.prototype.newInstance=function(){return new t(this.options.newInstance())},t.prototype.clone=function(){return new t(this.options.clone())},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.options?this.options.create():void 0},t.prototype.random=function(e){return this.options&&e(0,1,!1)>.3?this.options.random(e):void 0},t.prototype.fromJson=function(e){return null==e?void 0:this.options.fromJson(e)},t.prototype.toJson=function(e){return null==e?void 0:this.options.toJson(e)},t.STEP_OPTIONAL="optional",t.id=G.Optional,t.operations=new Y(G.Optional+G.Delimiter),t.computeds=new W(G.Optional+G.Delimiter),t.baseType=new t(ye.baseType),t.describePriority=-1,t.registered=!1,t}(L),Lo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Lo(t,e),t.decode=function(e,n){return new t(e[1].map((function(e){return n.getType(e)})))},t.encode=function(e){var t=e.options.map((function(e){return e.encode()}));return[this.id,t]},t.describe=function(e,t,n){return null},t.register=function(){},t.prototype.getOperations=function(){return{}},t.prototype.forNot=function(e,t){var n,r,o=this.options;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),s=i.next();!s.done;s=i.next()){var a=t(s.value);if(void 0!==a)return a}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return e},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,t){return this.forNot(!0,(function(n){return!n.isCompatible(e,t)&&void 0}))},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.isOptional=function(){return!0},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var t=this;return e.enter(this,(function(){return t.options.map((function(n,r){return e.step(r,n,(function(e){return t.options.splice(r,1,e)}),(function(){return t.options.splice(r,1)}))}))}))},t.prototype.getTypeFromStep=function(e){return this.options[e]||null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.options.forEach((function(e){return e.setParent(t)}))},t.prototype.removeDescribedRestrictions=function(){this.options.forEach((function(e){return e.removeDescribedRestrictions()}))},t.prototype.getCreateExpression=function(){return le.instance},t.prototype.getValidateExpression=function(){return le.instance},t.prototype.getCompareExpression=function(){return le.instance},t.prototype.isValid=function(e){return this.forNot(!0,(function(t){return!t.isValid(e)&&void 0}))},t.prototype.normalize=function(e){return this.forNot(e,(function(t){return t.isValid(e)?null:void 0}))},t.prototype.newInstance=function(){return new t([])},t.prototype.clone=function(){return new t(this.options.map((function(e){return e.clone()})))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return null},t.prototype.random=function(e){return null},t.prototype.fromJson=function(e){return ye.baseType.fromJson(e)},t.prototype.toJson=function(e){return ye.baseType.toJson(e)},t.id=G.Not,t.operations=new Y(G.Not+G.Delimiter),t.computeds=new W(G.Not+G.Delimiter),t.baseType=new t([ye.baseType]),t.describePriority=-1,t.registered=!1,t}(L),Fo=new Y(G.Color+G.Delimiter),Vo=new W(G.Color+G.Delimiter),Yo=Fo,Wo={create:Yo.set("create",{}),maybe:Yo.set("maybe",{},["value"]),cmp:Yo.set("cmp",{},["value","test"]),copy:Yo.set("copy",{},["value"]),build:Yo.set("build",{},["r","g","b"],["a"]),map:Yo.set("map",{},["value","r","g","b"],["a"],["value","component"],["r","g","b","a"]),op:Yo.set("op",{},["value","test","r","g","b"],["a"],["value","test","component"],["r","g","b","a"]),clamp:Yo.set("clamp",{},["value"]),add:Yo.set("+",{},["value","addend"],["alpha"]),adds:Yo.set("+*",{},["value","addend","addendScale"],["alpha"]),sub:Yo.set("-",{},["value","subtrahend"],["alpha"]),mul:Yo.set("*",{},["value","multiplier"],["alpha"]),div:Yo.set("/",{},["value","divisor"],["alpha"]),mod:Yo.set("%",{},["value","divisor"],["alpha"]),format:Yo.set("format",{},["value","format"]),parse:Yo.set("parse",{},["value"]),lerp:Yo.set("lerp",{},["start","end","delta"]),lighten:Yo.set("lighten",{},["value","amount"]),darken:Yo.set("darken",{},["value","amount"]),toHSL:Yo.set("->hsl",{},["value"]),fromHSL:Yo.set("<-hsl",{},["value"]),luminance:Yo.set("luminance",{},["value"]),contrast:Yo.set("contrast",{},["value","test"]),invert:Yo.set("invert",{},["value"],["alpha"]),opaque:Yo.set("opaque",{},["value"]),alpha:Yo.set("alpha",{},["value","alpha"]),distance:Yo.set("distance",{},["value","test"]),named:Yo.set("named",{},["name"]),getName:Yo.set("getName",{},["value"]),blend:Yo.set("blend",{},["top","bottom","mode"]),isValid:Yo.set("?",{},["value"]),isEqual:Yo.set("=",{},["value","test"],["epsilon"]),isNotEqual:Yo.set("!=",{},["value","test"],["epsilon"]),isLess:Yo.set("<",{},["value","test"]),isLessOrEqual:Yo.set("<=",{},["value","test"]),isGreater:Yo.set(">",{},["value","test"]),isGreaterOrEqual:Yo.set(">=",{},["value","test"]),asAny:Yo.set("~"+G.Any,{},["value"]),asBoolean:Yo.set("~"+G.Boolean,{},["value"]),asColor:Yo.set("~"+G.Color,{},["value"]),asDate:Yo.set("~"+G.Date,{},["value"]),asList:Yo.set("~"+G.List,{},["value"]),asMap:Yo.set("~"+G.Map,{},["value"]),asNumber:Yo.set("~"+G.Number,{},["value"]),asObject:Yo.set("~"+G.Object,{},["value"]),asText:Yo.set("~"+G.Text,{},["value"]),asTuple:Yo.set("~"+G.Tuple,{},["value"]),asSet:Yo.set("~"+G.Set,{},["value"])};Vo.set("toHSL",Wo.toHSL),Vo.set("luminance",Wo.luminance),Vo.set("inverted",Wo.invert),Vo.set("opaque",Wo.opaque),Vo.set("name",Wo.getName);var Go=0,Ho=255;function Bo(e){return l(e)&&r(e.r)&&r(e.g)&&r(e.b)}function Uo(e){return m(Math.round(e),Go,Ho)}var Jo=function(){function e(e,t){this.code=e,this.name=t,this.formatMap={},this.formats=[]}return e.prototype.setType=function(e){return this.type=e,this},e.prototype.setToColor=function(e){return this.toColor=e,this},e.prototype.setFromColor=function(e){return this.fromColor=e,this},e.prototype.addFormat=function(e){return this.formatMap[e.code]=e,this.formats.push(e),this},e}(),Ko=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},zo=new Jo("rgb","RGB").setToColor((function(e){return e})).setFromColor((function(e){return e})).addFormat({code:"default",name:"Default",parser:function(e){return Bo(e)?e:null},formatter:function(e){return e}}).addFormat({code:"bestfit",name:"Best Fit",parser:function(e){return null},formatter:function(e){return e.a===Ho?"#"+$o(e.r)+$o(e.g)+$o(e.b):"rgba("+Uo(e.r)+","+Uo(e.g)+","+Uo(e.b)+","+Uo(e.a)/Ho+")"}}).addFormat({code:"hexShort",name:"Hex (#rgb)",parser:function(e){if(!o(e))return null;var t=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);if(!t)return null;var n=Ko(t,4),r=n[1],i=n[2],s=n[3];return{r:parseInt(r+r,16),g:parseInt(i+i,16),b:parseInt(s+s,16),a:Ho}},formatter:function(e){return"#"+$o(e.r).substring(0,1)+$o(e.g).substring(0,1)+$o(e.b).substring(0,1)}}).addFormat({code:"hex",name:"Hex (#rrggbb)",parser:function(e){if(!o(e))return null;var t=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e);if(!t)return null;var n=Ko(t,4),r=n[1],i=n[2],s=n[3];return{r:parseInt(r,16),g:parseInt(i,16),b:parseInt(s,16),a:Ho}},formatter:function(e){return"#"+$o(e.r)+$o(e.g)+$o(e.b)}}).addFormat({code:"hexLong",name:"Hex (#rrggbbaa)",parser:function(e){if(!o(e))return null;var t=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e);if(!t)return null;var n=Ko(t,5),r=n[1],i=n[2],s=n[3],a=n[4];return{r:parseInt(r,16),g:parseInt(i,16),b:parseInt(s,16),a:parseInt(a,16)}},formatter:function(e){return"#"+$o(e.r)+$o(e.g)+$o(e.b)+$o(e.a)}}).addFormat({code:"rgb",name:"rgb(r, g, b)",parser:function(e){if(!o(e))return null;var t=/^rgb\(\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*\)$/i.exec(e);if(!t)return null;var n=Ko(t,4),r=n[1],i=n[2],s=n[3];return{r:Xo(r),g:Xo(i),b:Xo(s),a:Ho}},formatter:function(e){return"rgb("+Uo(e.r)+","+Uo(e.g)+","+Uo(e.b)+")"}}).addFormat({code:"rgba",name:"rgba(r, g, b, a)",parser:function(e){if(!o(e))return null;var t=/^rgb\(\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*([01]?\.?[0-9]*)\s*\)$/i.exec(e);if(!t)return null;var n=Ko(t,5),r=n[1],i=n[2],s=n[3],a=n[4];return{r:Xo(r),g:Xo(i),b:Xo(s),a:Uo(Math.floor(parseFloat(a)*Ho))}},formatter:function(e){return"rgba("+Uo(e.r)+","+Uo(e.g)+","+Uo(e.b)+","+Uo(e.a)/Ho+")"}});function Xo(e){return-1===e.indexOf("%")?Uo(parseInt(e,10)):Uo(2.55*parseInt(e.substring(0,e.length-1),10))}function $o(e){return C(Uo(e).toString(16),2,"0",!0)}var Qo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function Zo(e){return l(e)&&r(e.h)&&r(e.s)&&r(e.l)}var ei=new Jo("hsl","HSL").setType(new xt({props:{h:new _n({min:0,max:360,whole:!0}),s:new _n({min:0,max:100,whole:!0}),l:new _n({min:0,max:100,whole:!0}),a:new _n({min:0,max:255,whole:!0})}})).setToColor((function(e){var t=ti(e.h),n=ni(e.l)/100,r=ni(e.s)/100,o=(1-Math.abs(2*n-1))*r,i=o*(1-Math.abs(t/60%2-1)),s=n-o/2,a=t>=240?0:t>=60&&t<180?o:i,u=t<=120?0:t>=180&&t<300?o:i;return{r:Uo(((t<60||t>=300?o:t>=120&&t<240?0:i)+s)*Ho),g:Uo((a+s)*Ho),b:Uo((u+s)*Ho),a:e.a}})).setFromColor((function(e){var t=Uo(e.r),n=Uo(e.g),r=Uo(e.b),o=t/Ho,i=n/Ho,s=r/Ho,a=Math.max(o,i,s),u=Math.min(o,i,s),p=a-u,c=(a+u)/2,l=0===p?0:a===o?(i-s)/p%6:a===i?(s-o)/p+2:(o-i)/p+4,f=0===p?0:p/(1-Math.abs(2*c-1));return{h:ti(Math.round(60*l)),s:ni(Math.round(100*f)),l:ni(Math.round(100*c)),a:e.a}})).addFormat({code:"hsl",name:"HSL",parser:function(e){if(!o(e))return null;var t=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*\)$/i.exec(e);if(!t)return null;var n=Qo(t,4),r=n[1],i=n[2],s=n[3];return{h:ti(parseInt(r,10)),s:ni(parseInt(i,10)),l:ni(parseInt(s,10)),a:Ho}},formatter:function(e){return"hsl("+ti(Math.round(e.h))+","+ni(Math.round(e.s))+"%,"+ni(Math.round(e.l))+"%)"}}).addFormat({code:"hsla",name:"HSLA",parser:function(e){if(!o(e))return null;var t=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*,\s*([01]?\.?[0-9]*)\s*\)$/i.exec(e);if(!t)return null;var n=Qo(t,5),r=n[1],i=n[2],s=n[3],a=n[4];return{h:ti(parseInt(r,10)),s:ni(parseInt(i,10)),l:ni(parseInt(s,10)),a:Uo(Math.floor(parseFloat(a)*Ho))}},formatter:function(e){return"hsla("+ti(Math.round(e.h))+","+ni(Math.round(e.s))+"%,"+ni(Math.round(e.l))+"%,"+Uo(e.a)/Ho+")"}});function ti(e){return e<0?360-Math.abs(e%360):e%360}function ni(e){return m(e,0,100)}var ri=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oi=function(){return(oi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ii=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},si=function(e){function t(n){return void 0===n&&(n={}),e.call(this,oi(oi({},n),{props:t.componentProps}))||this}return ri(t,e),t.decode=function(e){return new t(e[1]||{})},t.encode=function(e){return e.options.hasAlpha?[this.id,{hasAlpha:!0}]:this.id},t.describe=function(e,n,r){var o=t.baseType.normalize(e);return o?new t({hasAlpha:o.a!==Ho}):null},t.register=function(){},t.getFormat=function(e){var t=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(e.split(":"),2),n=t[0],r=t[1],o=this.spaces.find((function(e){return e.code===n}));return o?o.formatMap[r]:void 0},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.hasAlpha=t.hasAlpha||n.hasAlpha},t.prototype.isDeepCompatible=function(e,n){return e instanceof t||!(n.strict||n.exact||!(e instanceof xt)||!e.isCompatible(this))},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.removeDescribedRestrictions=function(){e.prototype.removeDescribedRestrictions.call(this),delete this.options.hasAlpha},t.prototype.getCreateExpression=function(){return Pn.op(Wo.create,{})},t.prototype.getValidateExpression=function(){return Pn.op(Wo.isValid,{value:Pn.get("value")})},t.prototype.getCompareExpression=function(){return Pn.op(Wo.cmp,{value:Pn.get("value"),test:Pn.get("test")})},t.prototype.isValid=function(e){return void 0!==this.normalize(e)},t.prototype.normalize=function(e){var n,r,o,i;try{for(var s=ii(t.spaces),a=s.next();!a.done;a=s.next()){var u=a.value;try{for(var p=(o=void 0,ii(u.formats)),c=p.next();!c.done;c=p.next()){var l=c.value.parser(e);if(null!==l)return u.toColor(l)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t({hasAlpha:this.options.hasAlpha})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return{r:0,g:0,b:0,a:0}},t.prototype.random=function(e){return{r:e(Go,Ho,!0),g:e(Go,Ho,!0),b:e(Go,Ho,!0),a:Ho}},t.prototype.fromJson=function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}},t.prototype.toJson=function(e){return e?{r:e.r,g:e.g,b:e.b,a:e.a}:null},t.componentType=new _n({min:Go,max:Ho,whole:!0}),t.componentProps={r:t.componentType,g:t.componentType,b:t.componentType,a:t.componentType},t.spaces=[zo,ei],t.id=G.Color,t.operations=Fo,t.computeds=Vo,t.baseType=new t({hasAlpha:!0}),t.describePriority=7,t.registered=!1,t}(xt);zo.setType(si.baseType);var ai=new Y(G.Set+G.Delimiter),ui=new W(G.Set+G.Delimiter),pi=ai,ci={create:pi.set("create"),createLike:pi.set("createLike",{},["set"],[],[],[],["set"]),createFor:pi.set("createFor",{},["value"],[],[],[],["value"]),maybe:pi.set("maybe",{},["value"]),add:pi.set("add",{mutates:["set"]},["set","value"],[],[],[],["set"]),has:pi.set("has",{},["set","value"]),delete:pi.set("delete",{mutates:["set"]},["set","value"]),values:pi.set("values",{complexity:1},["set"],[],[],[],["set"]),clear:pi.set("clear",{mutates:["set"]},["set"],[],[],[],["set"]),count:pi.set("count",{},["set"]),cmp:pi.set("cmp",{complexity:1},["value","test"]),copy:pi.set("copy",{complexity:1},["set"],["deepCopy"],["set","value"],["deepCopy"],["set"]),map:pi.set("map",{complexity:1},["set"],["transform"],["set","value"],["transform"],["set"]),isValid:pi.set("?",{},["value"]),isEqual:pi.set("=",{complexity:1},["value","test"]),isNotEqual:pi.set("!=",{complexity:1},["value","test"]),isLess:pi.set("<",{complexity:1},["value","test"]),isLessOrEqual:pi.set("<=",{complexity:1},["value","test"]),isGreater:pi.set(">",{complexity:1},["value","test"]),isGreaterOrEqual:pi.set(">=",{complexity:1},["value","test"]),asAny:pi.set("~"+G.Any,{},["value"]),asBoolean:pi.set("~"+G.Boolean,{},["value"]),asColor:pi.set("~"+G.Color,{},["value"]),asDate:pi.set("~"+G.Date,{},["value"]),asList:pi.set("~"+G.List,{},["value"]),asMap:pi.set("~"+G.Map,{},["value"]),asNumber:pi.set("~"+G.Number,{},["value"]),asObject:pi.set("~"+G.Object,{},["value"]),asText:pi.set("~"+G.Text,{},["value"]),asTuple:pi.set("~"+G.Tuple,{},["value"]),asSet:pi.set("~"+G.Set,{},["value"])};ui.set("copy",ci.copy),ui.set("values",ci.values),ui.set("count",ci.count);var li,fi,yi,hi=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),di=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},vi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},mi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return hi(t,e),t.decode=function(e,n){return new t({value:n.getType(e[1])})},t.encode=function(e){var t=e.options.value;return[this.id,t.encode()]},t.describe=function(e,n,r){var o,i;if(!u(e))return null;var s=new ye({}),a=new t({value:s});r.set(e,a);try{for(var p=di(e.entries()),c=p.next();!c.done;c=p.next()){var l=vi(c.value,1)[0];s=n.merge(s,l)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return a.options.value=s,a},t.register=function(){var e="object";X.addJson({priority:11,fromJson:function(e,t){if(l(e)&&o(e.$any)&&"set"===e.$any)return new Set(e.value.map(t))},toJson:function(e,t){if(u(e))return{$any:"set",value:Array.from(e.entries()).map(t)}}}),X.addCopier({priority:11,copy:function(e,t,n){var r,o;if(u(e)){var i=new Set;n(e,i);try{for(var s=di(e.entries()),a=s.next();!a.done;a=s.next()){var p=vi(a.value,1)[0];i.add(t(p))}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}}}),X.addCompare({priority:11,type:e,compare:function(e,t,n){var r=u(e),o=u(t);if(r!==o)return(r?1:0)-(o?1:0);if(u(e)&&u(t)){var i=e.size-t.size;if(0===i){for(var s=0,a=0,p=Array.from(e),c=Array.from(t),l=0;l<p.length;l++){var f=n(p[l],c[l]);f<0&&s++,f>0&&a++}i=X.getCompare(s,a)}return i}}}),X.addEquals({priority:11,type:e,equals:function(e,t,n){var r,o;if(u(e)!==u(t))return!1;if(u(e)&&u(t)){if(e.size!==t.size)return!1;try{for(var i=di(e),s=i.next();!s.done;s=i.next()){var a=s.value;if(!t.has(a))return!1}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!0}}})},t.forItem=function(e){return new t({value:gi.parse(e)})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.value=gi.merge(t.value,n.value)},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){return e instanceof t&&this.options.value.isCompatible(e.options.value,n)},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){e.step(t.STEP_VALUE,n.options.value,(function(e){return n.options.value=e}))}))},t.prototype.getTypeFromStep=function(e){return e===t.STEP_VALUE?this.options.value:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.value.setParent(this)},t.prototype.removeDescribedRestrictions=function(){this.options.value.removeDescribedRestrictions()},t.prototype.getCreateExpression=function(){return Pn.op(ci.create,{})},t.prototype.getValidateExpression=function(){return Pn.and(Pn.op(ci.isValid,{value:Pn.get("value")}),Pn.not(Pn.op(cn.contains,{list:Pn.op(ci.values,{set:Pn.get("value")}),item:Pn.null(),isEqual:Pn.not(this.options.value.getValidateExpression())},{value:"ignore",test:"value"})))},t.prototype.getCompareExpression=function(){return Pn.op(ci.cmp,{value:Pn.get("value"),test:Pn.get("test")})},t.prototype.getValueChangeExpression=function(e,t,n){return Pn.op(ci.map,{set:Pn.get("value"),transform:e},{value:"value"})},t.prototype.isValid=function(e){if(e instanceof Set||i(e)){var t=this.options.value;return!Array.from(e).some((function(e){return!t.isValid(e)}))}return!1},t.prototype.normalize=function(e){var t=this.options.value;return new Set(Array.from(e).map((function(e){return t.normalize(e)})))},t.prototype.newInstance=function(){return new t({value:this.options.value.newInstance()})},t.prototype.clone=function(){return new t({value:this.options.value.clone()})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return new Set},t.prototype.random=function(e){for(var t=this.options.value,n=e(2,6,!0),r=new Set,o=0;o<n;o++){var i=t.random(e);r.add(i)}return r},t.prototype.fromJson=function(e){var t=this.options.value;return new Set(e.map((function(e){return t.fromJson(e)})))},t.prototype.toJson=function(e){var t=this.options.value;return Array.from(e.entries()).map((function(e){return t.toJson(e)}))},t.STEP_VALUE="value",t.id=G.Set,t.operations=ai,t.computeds=ui,t.baseType=new t({value:ye.baseType}),t.describePriority=7,t.registered=!1,t}(L),gi=function(){function e(){}return e.setParent=function(e,t){return void 0===t&&(t=!1),(this.autoSetParent||t)&&e.setParent(),e},e.any=function(){return new ye({})},e.bool=function(e,t){return new Q({true:e,false:t})},e.date=function(e){return void 0===e&&(e={}),new Po(e)},e.entity=function(e,t){return new Et(e,t)},e.enum=function(e,t,n){return void 0===t&&(t=Re),void 0===n&&(n=new Map([])),this.setParent(new He({value:this.parse(e),key:this.parse(t),constants:g(n)}))},e.enumForText=function(e){return this.setParent(new He({value:this.text(),key:this.text(),constants:a(e)?e:i(e[0])?new Map(e):new Map(e.map((function(e){return[e,e]})))}))},e.list=function(e,t,n){return this.setParent(new dn({item:this.parse(e),min:t,max:n}))},e.many=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.setParent(new Co(i(t[0])?t[0].map((function(t){return e.parse(t)})):t.map((function(t){return e.parse(t)}))))},e.not=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.setParent(new qo(i(t[0])?t[0].map((function(t){return e.parse(t)})):t.map((function(t){return e.parse(t)}))))},e.map=function(e,t){return void 0===t&&(t=Re),this.setParent(new Ao({key:this.parse(t),value:this.parse(e)}))},e.null=function(){return pe.baseType},e.number=function(e,t,n){return new _n({min:e,max:t,whole:n})},e.int=function(e,t){return new _n({min:e,max:t,whole:!0})},e.index=function(e){return new _n({min:0,max:e,whole:!0})},e.char=function(){return new Re({min:1,max:1})},e.object=function(e){return void 0===e&&(e={}),this.setParent(new xt({props:this.resolve(e)}))},e.optional=function(e){var t=this.parse(e);return this.setParent(t.isOptional()?t:new Ro(t))},e.color=function(e){return void 0===e&&(e={}),this.setParent(new si(e))},e.set=function(e){return this.setParent(new mi({value:this.parse(e)}))},e.text=function(e){return void 0===e&&(e={}),new Re(e)},e.tuple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.setParent(new Tn(i(t[0])?t[0].map((function(t){return e.parse(t)})):t.map((function(t){return e.parse(t)}))))},e.parse=function(e){return e instanceof L?e:e.baseType.newInstance()},e.simplify=function(e){return e?e.getSimplifiedType():null},e.resolve=function(e){var t,n=this;return e&&(e instanceof L?t=e:e.baseType instanceof L?t=e.baseType.newInstance():i(e)?t=e.map((function(e){return n.resolve(e)})):l(e)&&(t=O(e,(function(e){return n.resolve(e)})))),t},e.reduce=function(e){return 1===e.length?e[0]:new Co(e)},e.explode=function(e){return e instanceof Co?e.options:[e]},e.maybe=function(e,t){if(e instanceof t)return e;if(e instanceof Ro&&e.options instanceof t)return e;if(e instanceof Co){var n=e.options.find((function(e){return e instanceof t}));if(n)return this.optional(n);var r=e.options.find((function(e){return e instanceof Ro&&e.options instanceof t}));if(r)return r}return this.optional(t)},e.mergeMany=function(e,t){var n=this;return void 0===t&&(t=null),0===e.length?t:e.find((function(e){return e instanceof ye}))?ye.baseType:e.map((function(e){return e?e.clone():null})).reduce((function(e,t){return e&&t?n.merge(e,t):e||t}))},e.merge=function(e,t){var n,r;if(e instanceof ye)return t;var o=e instanceof Ro||t instanceof Ro,i=e.getRequired(),s=t.getRequired();if(y(i,s))return i.merge(s),o?this.optional(i):i;if(i instanceof Co||s instanceof Co){var a=this.explode(i),u=this.explode(s),p=a.length;try{for(var c=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(u),l=c.next();!l.done;l=c.next()){for(var f=l.value,h=!1,d=f instanceof Ro,v=d?f.options:f,m=0;m<p;m++){var g=a[m],T=g instanceof Ro,b=T?g.options:g;y(b,v)&&(h=!0,b.merge(v),d&&!T&&(a[m]=this.optional(b)))}h||a.push(f)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return o?this.optional(this.reduce(a)):this.reduce(a)}return this.many(e,t)},e.INDEX=e.index(),e.LENGTH=e.index(),e.CHAR=e.char(),e.autoSetParent=!0,e}(),Ti=function(){function e(e){this.value=e,this.next=this.prev=this}return e.prototype.isEmpty=function(){return this.next===this},e.prototype.clear=function(){this.next=this.prev=this},e.prototype.addLast=function(t){var n=new e(t);return n.linkAfter(this.prev),n},e.prototype.addFirst=function(t){var n=new e(t);return n.linkAfter(this),n},e.prototype.each=function(e){for(var t=this.next,n=0;t!==this;){var r=t.next;e(t.value,n,t),t=r,n++}return n},e.prototype.isRemoved=function(){return this.next===this},e.prototype.remove=function(){this.isRemoved()||(this.next.prev=this.prev,this.prev.next=this.next,this.next=this.prev=this)},e.prototype.linkAfter=function(e){this.remove(),this.next=e.next,this.prev=e,e.next.prev=this,e.next=this},e}(),bi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},xi=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(bi(arguments[t]));return e},Oi=function(){function e(){this.listeners=Object.create(null)}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.getListeners(e,!1),o=[];return r&&r.each((function(n){return o.push(n.apply(void 0,xi([e],t)))})),o},e.prototype.hasListeners=function(e){return null!==this.getListeners(e)},e.prototype.getListeners=function(e,t){void 0===t&&(t=!0);var n=this.listeners[e];return!n&&t&&(n=this.listeners[e]=new Ti((function(){}))),n||null},e.prototype.on=function(e,t){var n=this,r=(i(e)?e:[e]).map((function(e){return n.getListeners(e,!0).addLast(t)}));return function(){return r.forEach((function(e){return e.remove()}))}},e.prototype.once=function(e,t){var n=this.on(e,(function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return n(),t.apply(void 0,xi([e],r))}));return n},e.prototype.off=function(e,t){var n=this;if(e)if(Array.isArray(e))e.forEach((function(e){return n.off(e,t)}));else{var r=this.listeners[e];r&&(t?r.each((function(e,n,r){e===t&&r.remove()})):r.clear())}else this.listeners=Object.create(null);return this},e}(),Ei=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wi=function(){return(wi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Si=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t.name,r.created=t.created||v(),r.updated=t.updated||v(),r.description=t.description,r.meta=t.meta,r.params=n.getTypeKind(t.params,xt,gi.object()),r.expression=n.getExpression(t.expression),r.defaults=r.params.fromJson(t.defaults),r.tests=t.tests.map((function(e){return wi(wi({},e),{args:r.params.fromJson(e.args)})})),r}return Ei(t,e),t.create=function(e,n){return void 0===n&&(n={}),new t(wi({name:"",created:v(),updated:v(),description:"",meta:null,params:gi.object(),expression:Pn.noop(),defaults:{},tests:[]},n),e)},t.prototype.sync=function(e,n){var r=this;this.hasChanges(e)&&(this.name=e.name,this.created=e.created||v(),this.updated=e.updated||v(),this.description=e.description,this.meta=e.meta,this.params=e instanceof t?e.params:n.getTypeKind(e.params,xt,gi.object()),this.expression=e instanceof t?e.expression:n.getExpression(e.expression),this.defaults=e instanceof t?e.defaults:this.params.fromJson(e.defaults),b(this.tests,e instanceof t?e.tests:e.tests.map((function(e){return wi(wi({},e),{args:r.params.fromJson(e.args)})})),(function(e,t){return e.name===t.name||X.equals(e.args,t.args)}),(function(e,t){return r.addTest(t,!0)}),(function(e,t){return r.removeTest(t,!0)}),(function(e,t,n,o){return r.updateTest(n,o,!0)})),this.trigger("sync",this,e,n),this.changed())},t.prototype.hasChanges=function(e){return!X.equals(e instanceof t?e.encode():e,this.encode())},t.prototype.changed=function(){this.updated=v(),this.trigger("changed",this)},t.prototype.encode=function(){var e=this,t=e.name,n=e.created,r=e.updated,o=e.description,i=e.meta,s=e.params,a=e.expression,u=e.defaults,p=e.tests;return{name:t,created:n,updated:r,description:o,meta:i,params:s.encode(),expression:a.encode(),defaults:s.toJson(u),tests:p.map((function(e){return wi(wi({},e),{args:s.toJson(e.args)})}))}},t.prototype.renameParameter=function(e,t){var n=this.params.options.props[e];return n&&(X.objectSet(this.params.options.props,t,n),X.objectRemove(this.params.options.props,e),e in this.defaults&&(X.objectSet(this.defaults,t,this.defaults[e]),X.objectRemove(this.defaults,e)),this.trigger("renameParameter",this,t,e),this.changed()),!!n},t.prototype.removeParameter=function(e){var t=e in this.params.options.props;return t&&(X.objectRemove(this.params.options.props,e),X.objectRemove(this.defaults,e),this.trigger("removeParameter",this,e),this.changed()),t},t.prototype.addTest=function(e,t){void 0===t&&(t=!1),this.tests.push(e),this.trigger("addTest",this,e),t||this.changed()},t.prototype.updateTest=function(e,t,n){void 0===n&&(n=!1);var o=r(e)?this.tests[e]:e,i=!!o;return i&&(Object.assign(o,t),this.trigger("updateTest",this,o),n||this.changed()),i},t.prototype.removeTest=function(e,t){void 0===t&&(t=!1);var n=r(e)?e:this.tests.indexOf(e),o=n>=0&&n<this.tests.length;if(o){var i=this.tests[n];this.trigger("removeTest",this,i),t||this.changed()}return o},t.prototype.getReturnType=function(e,t){void 0===t&&(t={});var n=gi.object(wi(wi({},this.params.options.props),t));return this.expression.getType(e,n)},t.prototype.getParamTypes=function(){var e=this;return d(this.defaults)?this.params:gi.object(O(this.params.options.props,(function(t,n){return e.getParamType(n)})))},t.prototype.getParamType=function(e){var t=this.params.options.props[e];return t.isOptional()&&e in this.defaults&&t.isValid(this.defaults[e])?t.getRequired():t},t.prototype.getArguments=function(e,t){void 0===t&&(t=!0);var n=t?wi({},e):e;for(var r in this.defaults)this.params.options.props[r].getRequired().isValid(n[r])||X.objectSet(n,r,X.copy(this.defaults[r]));return n},t.prototype.refactor=function(e,t){var n=t.getCommand(e);this.tests.forEach((function(e){e.args=n({value:e.args})})),this.changed()},t.prototype.mutates=function(e,t){return t in this.params.options.props&&this.expression.mutates(e,t,!1)},t}(Oi),Pi=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mi=function(){return(Mi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};!function(e){e[e.PRIMARY=0]="PRIMARY",e[e.FOREIGN=1]="FOREIGN",e[e.NONE=2]="NONE"}(fi||(fi={})),function(e){e[e.GIVEN=0]="GIVEN",e[e.AUTO_INCREMENT=1]="AUTO_INCREMENT",e[e.UUID=2]="UUID"}(yi||(yi={}));var _i,Ii,Ci=function(e){function t(t,n){var o=e.call(this)||this;return o.name=t.name,o.created=t.created||v(),o.updated=t.updated||v(),o.description=t.description,o.meta=t.meta,o.type=n.getTypeKind(t.type,xt,gi.object()),o.instances=t.instances&&t.instances.length?t.instances.map((function(e){return o.type.fromJson(e)})):[],o.methods=o.decodeMethods(n,t.methods),o.transcoders=o.decodeTranscoders(n,t.transcoders),o.indexes=o.decodeIndexes(t.indexes),o.primaryType=r(t.primaryType)?t.primaryType:yi.AUTO_INCREMENT,o.key=t.key?n.getExpression(t.key):o.getPrimaryKeyExpression(),o.keyType=o.key.getType(n,o.getKeyContext()),o.describe=t.describe?n.getExpression(t.describe):Pn.noop(),o}return Pi(t,e),t.create=function(e,n){return void 0===n&&(n={}),new t(Mi({name:"",created:v(),updated:v(),description:"",meta:null,type:gi.object(),instances:[],methods:Object.create(null)},n),e)},t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.prototype.sync=function(e,n){var o=this;this.hasChanges(e)&&(this.name=e.name,this.created=e.created||v(),this.updated=e.updated||v(),this.description=e.description,this.meta=e.meta,this.type=n.getTypeKind(e.type,xt,gi.object()),this.instances=e instanceof t?e.instances:e.instances&&e.instances.length?e.instances.map((function(e){return o.type.fromJson(e)})):[],x(this.methods,this.decodeMethods(n,e.methods),(function(e,t,n){return o.addMethod(n,!0)}),(function(e,t){return o.removeMethod(t,!0)}),(function(e,t,r,o){return r.sync(o,n)})),x(this.transcoders,this.decodeTranscoders(n,e.transcoders),(function(e,t,r){return o.addTranscoder(n,t,r,!0)}),(function(e,t){return o.removeTranscoder(t,!0)}),(function(e,t,r,i){return o.addTranscoder(n,t,i,!0)})),x(this.indexes,this.decodeIndexes(e.indexes),(function(e,t,n){return o.addIndex(t,n,!0)}),(function(e,t){return o.removeIndex(t,!0)}),(function(e,t,n,r){return o.addIndex(t,r,!0)})),this.primaryType=r(e.primaryType)?e.primaryType:yi.AUTO_INCREMENT,this.key=e.key?n.getExpression(e.key):this.getPrimaryKeyExpression(),this.keyType=this.key.getType(n,this.getKeyContext()),this.describe=e.describe?n.getExpression(e.describe):Pn.noop(),this.trigger("sync",this,e,n),this.trigger("change",this))},t.prototype.hasChanges=function(e){return!X.equals(e instanceof t?e.encode():e,this.encode())},t.prototype.changed=function(){this.updated=v(),this.trigger("change",this)},t.prototype.decodeMethods=function(e,t){var n=this;return t?O(t,(function(t){return n.decodeMethod(e,t)})):{}},t.prototype.decodeMethod=function(e,t){return t instanceof Si?t:Si.create(e,t)},t.prototype.decodeTranscoders=function(e,t){var n=this;return t?O(t,(function(t){return n.decodeTranscoder(e,t)})):{}},t.prototype.decodeTranscoder=function(e,t){return t.encode instanceof q?t:{encode:e.getExpression(t.encode),decode:e.getExpression(t.decode),encodedType:e.getType(t.encodedType)}},t.prototype.decodeIndexes=function(e){return e?O(e,(function(e,t){var n=e.unique,r=e.primary;return{name:t,props:e.props,unique:n,primary:r}})):{}},t.prototype.encode=function(){var e=this,t=e.name,n=e.created,r=e.updated,o=e.description,i=e.meta,s=e.type,a=e.instances,u=e.methods,p=e.key,c=e.describe,l=e.transcoders,f=e.indexes;return{name:t,created:n,updated:r,description:o,meta:i,type:s.encode(),instances:a.map((function(e){return s.toJson(e)})),methods:O(u,(function(e){return e.encode()})),key:p.encode(),describe:c.encode(),transcoders:O(l,(function(e){var t=e.encode,n=e.decode,r=e.encodedType;return{encode:t.encode(),decode:n.encode(),encodedType:r.encode()}})),indexes:O(f,(function(e){return{props:e.props,unique:e.unique,primary:e.primary}}))}},t.prototype.canStore=function(e){if(!(this.primaryType!==yi.GIVEN||this.keyType&&e.keyExpectedType.acceptsType(this.keyType)))return!1;var t=this.describe.getType(e,this.getDescribeContext());return!(!t||!e.describeExpectedType.acceptsType(t))},t.prototype.updateKeyType=function(e){var t=this.key.getType(e,this.getKeyContext());t&&(this.keyType=t)},t.prototype.renameProp=function(e,t){var n=this,r=!1,o=this.transcoders[e];o&&(X.objectRemove(this.transcoders,e),X.objectSet(this.transcoders,t,o),r=!0),E(this.indexes,(function(o){var i=o.props.indexOf(e);-1!==i&&(o.props[i]=t,n.updateIndex(o.name,!0),r=!0)})),this.trigger("renameProp",this,t,e),r&&this.changed()},t.prototype.removeProp=function(e){var t=this,n=!1;e in this.transcoders&&(this.removeTranscoder(e,!0),n=!0),E(this.indexes,(function(r,o){var i=r.props.indexOf(e);-1!==i&&(r.props.splice(i,1),n=!0,0===r.props.length?t.removeIndex(o,!0):t.updateIndex(o,!0))})),this.trigger("removeProp",this,e),n&&this.changed()},t.prototype.getEntityProps=function(){var e=this,t=this.getPrimary(),n=t.props.map((function(n,r){return[n,t.types&&t.types[r]?t.types[r]:e.type.options.props[n]]}));return{type:fi.PRIMARY,props:n}},t.prototype.getKey=function(e,t){var n=this.type,r=this.key;return e.run(r,{instance:t,type:n})},t.prototype.setKey=function(e){if(this.primaryType!==yi.GIVEN){var n=this.getDynamicPrimaryKey();if(!e[n])switch(this.primaryType){case yi.AUTO_INCREMENT:X.objectSet(e,n,this.instances.reduce((function(e,t){return r(t[n])?Math.max(e,t[n]):e}),0)+1);break;case yi.UUID:X.objectSet(e,n,t.uuid())}}},t.prototype.takeKey=function(e,t){return this.setKey(t),this.getKey(e,t)},t.prototype.getDescribe=function(e,t){var n=this.type,r=this.describe;return e.run(r,{instance:t,type:n})},t.prototype.getDecodedPropertyTypes=function(){return this.type.options.props},t.prototype.getPropertyTypeFor=function(e){return e?gi.enumForText([e]):this.getPropertyType()},t.prototype.getEncodedPropertyTypes=function(){var e=this;return O(this.type.options.props,(function(t,n){return n in e.transcoders?e.transcoders[n].encodedType:t}))},t.prototype.getEncodedType=function(){return gi.object(this.getEncodedPropertyTypes())},t.prototype.getDecodedType=function(){return this.type},t.prototype.getProperties=function(){return Object.keys(this.getDecodedPropertyTypes())},t.prototype.getPropertyType=function(){return gi.enumForText(this.getProperties())},t.prototype.getKeyReturnType=function(){return this.keyType},t.prototype.getKeyContext=function(){return gi.object({instance:this.type,type:gi.text()})},t.prototype.getDescribeContext=function(){return gi.object({instance:this.type,type:gi.text()})},t.prototype.getEncoded=function(e,t){var n={};for(var r in this.getDecodedPropertyTypes())n[r]=this.getEncodedValue(e,t,r);return n},t.prototype.getEncodedValue=function(e,t,n){var r=this.name,o=this.transcoders,i=n in o?o[n].encode:null,s=t[n];return i?e.run(i,{name:r,instance:t,property:n,value:s}):s},t.prototype.getEncodeContext=function(e){var t=gi.enumForText([this.name]),n=this.getDecodedType(),r=this.getPropertyTypeFor(e),o=this.getDecodeExpected(e);return gi.object({name:t,instance:n,property:r,value:o})},t.prototype.getEncodeExpected=function(e,t){return void 0===t&&(t=gi.any()),e&&e in this.transcoders?this.transcoders[e].encodedType:t},t.prototype.getDecoded=function(e,t){var n={};for(var r in this.getDecodedPropertyTypes())n[r]=this.getDecodedValue(e,t,r);return n},t.prototype.getDecodedValue=function(e,t,n){var r=this.name,o=this.transcoders,i=n in o?o[n].decode:null,s=t[n];return i?e.run(i,{name:r,instance:t,property:n,value:s}):s},t.prototype.getDecodeContext=function(e,t){var n=gi.enumForText([this.name]),r=this.getEncodedType(),o=this.getPropertyTypeFor(e),i=this.getEncodeExpected(e,t);return gi.object({name:n,instance:r,property:o,value:i})},t.prototype.getDecodeExpected=function(e){return e&&this.type.options.props[e]||gi.any()},t.prototype.getIndexExpectedType=function(){return gi.set(this.getPropertyType())},t.prototype.getDynamicPrimaryKey=function(){var e=this.type.options.props;return"id"in e?"_id"in e?"__id":"_id":"id"},t.prototype.getPrimaryKeyExpression=function(e,t){void 0===e&&(e="/"),void 0===t&&(t="primary");var n=this.getPrimary(t);return n.props.length>1?Pn.op(cn.join,{list:n.props.map((function(e){return Pn.get("instance",e)})),delimiter:Pn.const(e),toText:Pn.op(ae.asText,{value:Pn.get("item")})}):Pn.get("instance",n.props[0])},t.prototype.getPrimary=function(e,n){return void 0===e&&(e="primary"),void 0===n&&(n=!0),(e in this.indexes?this.indexes[e]:S(this.indexes,(function(e,t,n){return n||(e.primary?e:n)}),null))||(n?{name:e,props:[this.getDynamicPrimaryKey()],types:[t.PRIMARY_TYPES[this.primaryType]],unique:!0,primary:!0}:null)},t.prototype.getUniqueIndexes=function(){return S(this.indexes,(function(e,t,n){return e.unique&&n.push(e),n}),[])},t.prototype.addPrimary=function(e){return this.addIndex("primary",{props:i(e)?e:[e],unique:!0,primary:!0}),this.primaryType=yi.GIVEN,this},t.prototype.addIndex=function(e,t,n){void 0===n&&(n=!1);var r=this.indexes[e],o=Mi(Mi({},t),{name:e});return X.objectSet(this.indexes,e,o),r?this.trigger("updateIndex",this,o,r):this.trigger("addIndex",this,o),n||this.changed(),this},t.prototype.updateIndex=function(e,t){void 0===t&&(t=!1);var n=this.indexes[e];return this.trigger("updateIndex",this,n,n),t||this.changed(),this},t.prototype.removeIndex=function(e,t){void 0===t&&(t=!1);var n=this.indexes[e];return X.objectRemove(this.indexes,e),this.trigger("removeIndex",this,n),t||this.changed(),this},t.prototype.renameIndex=function(e,t){var n=this.indexes[e];if(n&&e!==t){var r=Mi(Mi({},n),{props:n.props.slice()});n.name=t,X.objectRemove(this.indexes,e),X.objectSet(this.indexes,t,n),this.trigger("updateIndex",this,n,r),this.changed()}return this},t.prototype.addTranscoder=function(e,t,n,r){void 0===r&&(r=!1);var o=this.transcoders[t],i=this.decodeTranscoder(e,n);return X.objectSet(this.transcoders,t,i),o?this.trigger("updateTranscoder",this,name,i,o):this.trigger("addTranscoder",this,name,i),r||this.changed(),this},t.prototype.removeTranscoder=function(e,t){void 0===t&&(t=!1);var n=this.transcoders[e];return n&&(X.objectRemove(this.transcoders,e),this.trigger("removeTranscoder",this,e,n),t||this.changed()),this},t.prototype.updateTranscoder=function(e,t){void 0===t&&(t=!1);var n=this.transcoders[e];return n&&(this.trigger("updateTranscoder",this,e,n,n),t||this.changed()),this},t.prototype.addMethod=function(e,t){void 0===t&&(t=!1);var n=this.methods[e.name];return X.objectSet(this.methods,e.name,e),n?this.trigger("updateMethod",this,e,n):this.trigger("addMethod",this,e),t||this.changed(),this},t.prototype.renameMethod=function(e,t,n){void 0===n&&(n=!1);var r=this.methods[e];return r&&e!==t&&(r.name=t,X.objectRemove(this.methods,e),X.objectSet(this.methods,t,r),this.trigger("updateMethod",this,r,r),n||this.changed()),this},t.prototype.removeMethod=function(e,t){void 0===t&&(t=!1);var n=this.methods[e];return n&&(X.objectRemove(this.methods,e),this.trigger("removeMethod",this,n),t||this.changed()),this},t.PRIMARY_TYPES=((li={})[yi.GIVEN]=null,li[yi.AUTO_INCREMENT]=gi.int(1),li[yi.UUID]=gi.text({min:36,max:36,forceLower:!0,matches:/^[\da-f]{8}\-[\da-f]{4}\-[\da-f]{4}\-[\da-f]{4}\-[\da-f]{12}$/i}),li),t}(Oi),Di=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e[e.HAS_MANY=0]="HAS_MANY",e[e.BELONGS_TO=1]="BELONGS_TO",e[e.HAS_ONE=2]="HAS_ONE",e[e.ONE=3]="ONE",e[e.HAS_ONE_POLYMORPHIC=4]="HAS_ONE_POLYMORPHIC",e[e.ONE_POLYMORPHIC=5]="ONE_POLYMORPHIC"}(_i||(_i={})),function(e){e[e.NONE=0]="NONE",e[e.CASCADE=1]="CASCADE",e[e.SET_NULL=2]="SET_NULL",e[e.RESTRICT=3]="RESTRICT"}(Ii||(Ii={}));var ji=function(e){function t(t,n){var r=e.call(this)||this;return r.defs=t,r.name=n.name,r.updated=n.updated||v(),r.created=n.created||v(),r.kind=n.kind,r.subject=n.subject,r.subjectRelationName=n.subjectRelationName||n.related[0].name,r.morphs=n.morphs?r.decodeTypePair(n.morphs):null,r.morphsToRelated=g(n.morphsToRelated),r.related=n.related,r.relatedRelationName=n.relatedRelationName||n.subject.name,r.relatedToMorphs=T(r.morphsToRelated),r.multiple=!!n.multiple,r.required=!!n.required,r.owns=!!n.owns,r.extension=!!n.extension,r}return Di(t,e),t.prototype.sync=function(e,t){this.hasChanges(e)&&(this.name=e.name,this.updated=e.updated||v(),this.created=e.created||v(),this.kind=e.kind,this.subject=e.subject,this.subjectRelationName=e.subjectRelationName||e.related[0].name,this.morphs=e.morphs?this.decodeTypePair(e.morphs):null,this.morphsToRelated=g(e.morphsToRelated),this.related=e.related,this.relatedRelationName=e.relatedRelationName||e.subject.name,this.relatedToMorphs=T(this.morphsToRelated),this.multiple=!!e.multiple,this.required=!!e.required,this.owns=!!e.owns,this.extension=!!e.extension,this.trigger("sync",this,e,t),this.changed())},t.prototype.hasChanges=function(e){return!X.equals(e instanceof t?e.encode():e,this.encode())},t.prototype.changed=function(){this.updated=v(),this.trigger("changed",this)},t.prototype.decodeTypePair=function(e){var t=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(e,2),n=t[0],r=t[1];return[n,this.defs.getType(r)]},t.prototype.encodeTypePair=function(e){return e?[e[0],e[1].encode()]:null},t.prototype.encode=function(){var e=this,t=e.name,n=e.created,r=e.updated,o=e.kind,i=e.subject,s=e.subjectRelationName,a=e.morphs,u=e.morphsToRelated,p=e.related,c=e.relatedRelationName,l=e.multiple,f=e.required,y=e.owns,h=e.extension;return{name:t,updated:r,created:n,kind:o,subject:i,subjectRelationName:s,morphs:this.encodeTypePair(a),morphsToRelated:Array.from(u.entries()),related:p,relatedRelationName:c,multiple:l,required:f,owns:y,extension:h}},t.prototype.getRelatedWithName=function(e,t){return t.find((function(t){return t.name===e}))},t.prototype.rename=function(e,t){this.renameReference(e,t,[this.subject]),this.renameReference(e,t,this.related),this.changed()},t.prototype.renameReference=function(e,t,n){var r=this.getRelatedWithName(e,n);r&&(r.name=t)},t.prototype.remove=function(e){this.removeReference(e,[this.subject]),this.removeReference(e,this.related),this.changed()},t.prototype.removeReference=function(e,t){var n=t.findIndex((function(t){return t.name===e}));-1!==n&&(t.splice(n,1),t[n].props=[])},t.prototype.renameProp=function(e,t,n){this.renamePropReference(e,t,n,[this.subject]),this.renamePropReference(e,t,n,this.related),this.changed()},t.prototype.renamePropReference=function(e,t,n,r){var o=this.getRelatedWithName(e,r);if(o){var i=o.props.indexOf(t);-1!==i&&(o.props[i]=n)}},t.prototype.removeProp=function(e,t){this.removePropReference(e,t,[this.subject]),this.removePropReference(e,t,this.related),this.changed()},t.prototype.removePropReference=function(e,t,n){var r=n.findIndex((function(t){return t.name===e}));if(-1!==r){var o=n[r],i=o.props.indexOf(t);if(-1!==i&&(o.props.splice(i,1),0===o.props.length))return n.splice(r,1),!0}return!1},t.prototype.getPropTypes=function(e){var t=this,n=[];return e.forEach((function(e){var r=e.name,o=e.props,i=t.defs.getEntity(r).getEntityProps();o.forEach((function(e,t){var r=i.props[t][1];n[t]=n[t]?gi.merge(n[t],r):r.clone()}))})),n},t.prototype.isEmpty=function(){return 0===this.subject.props.length||0===this.related.length},t.prototype.getItemType=function(e){var t=this,n=e.map((function(e){return t.defs.getType(e.name)}));return n.length>1?gi.many(n):n[0]},t.prototype.getSubjectRelation=function(e){if(this.subject.name!==e)return null;var t=this.subjectRelationName,n=this.subject.props,r=this.related,o=this.getItemType(r),i=this.owns&&this.multiple?Ii.CASCADE:this.required?Ii.RESTRICT:Ii.SET_NULL,s=this.required?o:gi.optional(o),a={relation:this,name:t,kind:this.kind===_i.HAS_MANY?_i.BELONGS_TO:this.kind,local:n,cascade:i,related:r,itemType:o,relationType:s};return this.morphs&&(a.morphs=this.morphs,a.morphsToRelated=this.morphsToRelated,a.relatedToMorphs=this.relatedToMorphs),a},t.prototype.getRelatedRelation=function(e){var t=this.getRelatedWithName(e,this.related);if(!t)return null;var n=this.relatedRelationName,r=t.props,o=[this.subject],i=this.getItemType(o),s=Ii.NONE,a=this.multiple?gi.list(i):this.required?i:gi.optional(i),u={relation:this,name:n,kind:this.kind===_i.HAS_MANY?_i.HAS_MANY:this.morphs?_i.ONE_POLYMORPHIC:_i.ONE,local:r,cascade:s,related:o,itemType:i,relationType:a};return this.morphs&&(u.where=[this.morphs[0],this.relatedToMorphs.get(e)]),u},t.prototype.getTypeProps=function(e){var t=[];if(this.subject.name===e){var n=this.getPropTypes(this.related),r=this.subject.props.map((function(e,t){return[e,n[t]]}));t.push({type:fi.FOREIGN,props:r,relation:this}),this.morphs&&t.push({type:fi.NONE,props:[this.morphs],relation:this})}return t},t.hasMany=function(e,n){var r=n.oneRelationName||n.many,o=n.manyRelationName||n.one,i=n.foreignKeyPrefix||o+"_",s=n.name||o+"_hasMany_"+r,a=e.getEntity(n.one).getPrimary().props,u=a.map((function(e){return i+e}));return new t(e,{name:s,created:n.created||v(),updated:n.updated||v(),kind:_i.HAS_MANY,subject:{name:n.many,props:u},subjectRelationName:o,related:[{name:n.one,props:a}],relatedRelationName:r,multiple:!0,owns:!1!==n.owns,required:!1!==n.owns})},t.belongsTo=function(e,t){return this.hasMany(e,{name:t.name,one:t.belongsTo,many:t.oneOfMany,oneRelationName:t.belongsToRelationName,manyRelationName:t.oneOfManyRelationName,foreignKeyPrefix:t.foreignKeyPrefix,owns:t.owns})},t.hasOne=function(e,n){var r=n.oneRelationName||n.hasOne,o=n.hasOneRelationName||n.one,i=n.foreignKeyPrefix||o+"_",s=n.name||o+"_hasOne_"+r,a=e.getEntity(n.one).getPrimary().props,u=a.map((function(e){return i+e}));return new t(e,{name:s,created:n.created||v(),updated:n.updated||v(),kind:_i.HAS_ONE,subject:{name:n.hasOne,props:u},subjectRelationName:o,related:[{name:n.one,props:a}],relatedRelationName:r,required:n.required,owns:n.owns})},t.belongsToOne=function(e,t){return this.hasOne(e,{name:t.name,hasOne:t.belongsTo,one:t.one,required:t.required,owns:t.owns,hasOneRelationName:t.belongsToRelationName,oneRelationName:t.oneRelationName,foreignKeyPrefix:t.foreignKeyPrefix})},t.hasOnePolymorphic=function(e,n){var r=n.hasOneRelationName,o=n.polyRelationName||n.hasOne,i=n.name||r+"_hasOnePolymorphic_"+o,s=n.foreignKeyPrefix||r+"_",a=n.poly.map((function(t){return{name:t,props:e.getEntity(t).getPrimary().props}})),u=a[0].props.map((function(e){return s+e}));return new t(e,{name:i,created:n.created||v(),updated:n.updated||v(),kind:_i.HAS_ONE_POLYMORPHIC,subject:{name:n.hasOne,props:u},subjectRelationName:r,related:a,relatedRelationName:o,morphs:n.morphs,morphsToRelated:n.morphsToRelated,required:n.required,owns:n.owns})},t}(Oi),ki=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ai=function(){return(Ai=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ni=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t.name,r.author=t.author,r.description=t.description,r.meta=t.meta,r.created=t.created,r.updated=t.updated,r.dataType=n.getType(t.dataType),r.expression=n.getExpression(t.expression),r.datasets=t.datasets.map((function(e){return Ai(Ai({},e),{data:r.dataType.fromJson(e.data)})})),r}return ki(t,e),t.create=function(e,n){return void 0===n&&(n={}),new t(Ai({name,author:"",description:"",meta:null,created:v(),updated:v(),dataType:gi.object(),datasets:[{name:"Data Set #1",data:Object.create(null),created:v(),updated:v(),meta:null}],expression:le.instance},n),e)},t.prototype.sync=function(e,n){var r=this;this.hasChanges(e)&&(this.name=e.name,this.created=e.created||v(),this.updated=e.updated||v(),this.author=e.author,this.description=e.description,this.meta=e.meta,this.created=e.created,this.updated=e.updated,this.dataType=e instanceof t?e.dataType:n.getType(e.dataType),this.expression=e instanceof t?e.expression:n.getExpression(e.expression),b(this.datasets,e instanceof t?e.datasets:e.datasets.map((function(e){return Ai(Ai({},e),{data:r.dataType.fromJson(e.data)})})),(function(e,t){return e.name===t.name||e.created===t.created}),(function(e,t){return r.addDataset(t,!0)}),(function(e,t,n){return r.removeDataset(t,!0)}),(function(e,t,n,o){return r.updateDataset(n,o,!0)})),this.trigger("sync",this,e,n),this.changed())},t.prototype.hasChanges=function(e){return!X.equals(e instanceof t?e.encode():e,this.encode())},t.prototype.changed=function(){this.updated=v(),this.trigger("changed",this)},t.prototype.encode=function(){var e=this,t=e.name,n=e.author,r=e.description,o=e.meta,i=e.created,s=e.updated,a=e.dataType,u=e.datasets,p=e.expression;return{name:t,author:n,description:r,meta:o,created:i,updated:s,dataType:a.encode(),datasets:u.map((function(e){return Ai(Ai({},e),{data:a.toJson(e.data)})})),expression:p.encode()}},t.prototype.addDataset=function(e,t){void 0===t&&(t=!1),this.datasets.push(e),this.trigger("addDataset",this,e),t||this.changed()},t.prototype.moveDataset=function(e,t,n){void 0===n&&(n=!1);var o=r(e)?e:this.datasets.indexOf(e),i=o>=0&&o<this.datasets.length,s=t>=0&&t<this.datasets.length,a=i&&s;if(a){var u=this.datasets[o];this.datasets.splice(o,1),this.datasets.splice(t,0,u),this.trigger("moveDataset",this,u,o,t),n||this.changed()}return a},t.prototype.updateDataset=function(e,t,n){void 0===n&&(n=!1);var o=r(e)?this.datasets[e]:e,i=!!o;return i&&(Object.assign(o,t),this.trigger("updateDataset",this,o),n||this.changed()),i},t.prototype.removeDataset=function(e,t){void 0===t&&(t=!1);var n=r(e)?e:this.datasets.indexOf(e),o=n>=0&&n<this.datasets.length;if(o){var i=this.datasets[n];X.arrayRemove(this.datasets,n),this.trigger("removeDataset",this,i),t||this.changed()}return o},t.prototype.refactor=function(e,t){var n=t.getCommand(e);this.datasets.forEach((function(e){e.data=n({value:e.data})})),this.changed()},t}(Oi),Ri=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Li=function(){return(Li=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},qi=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t.name,r.created=t.created||v(),r.updated=t.updated||v(),r.meta=t.meta,r.dataType=n.getType(t.dataType),r.data=r.dataType.fromJson(t.data),r}return Ri(t,e),t.create=function(e,n){return void 0===n&&(n={}),new t(Li({name:"",created:v(),updated:v(),dataType:gi.object(),data:Object.create(null),meta:null},n),e)},t.prototype.sync=function(e,n){this.hasChanges(e)&&(this.name=e.name,this.created=e.created||v(),this.updated=e.updated||v(),this.meta=e.meta,this.dataType=e instanceof t?e.dataType:n.getType(e.dataType),this.data=e instanceof t?e.data:this.dataType.fromJson(e.data),this.trigger("sync",this,e,n),this.changed())},t.prototype.hasChanges=function(e){return!X.equals(e instanceof t?e.encode():e,this.encode())},t.prototype.changed=function(){this.updated=v(),this.trigger("changed",this)},t.prototype.encode=function(){var e=this,t=e.name,n=e.created,r=e.updated,o=e.meta,i=e.dataType,s=e.data;return{name:t,created:n,updated:r,meta:o,dataType:i.encode(),data:i.toJson(s)}},t.prototype.refactor=function(e,t){this.data=t.run(e,{value:this.data}),this.changed()},t}(Oi),Fi=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vi=function(e){function t(t,n){var r=e.call(this,t)||this;return r.provider=n,r}return Fi(t,e),t.decode=function(e,n){return new t(e[1],n)},t.encode=function(e){return[this.id,e.options]},t.describe=function(e,t,n){return null},t.register=function(){},t.prototype.getType=function(){if(!this.provider)return pe.baseType;var e=this.provider.getData(this.options);return e?e.dataType:pe.baseType},t.prototype.getOperations=function(){return this.getType().getOperations()},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return this.getType().getSubType(e,t,n)},t.prototype.getSubTypes=function(e){return this.getType().getSubTypes(e)},t.prototype.getExactType=function(e){return this.getType().getExactType(e)},t.prototype.getSimplifiedType=function(){return this.getType().getSimplifiedType()},t.prototype.isDeepCompatible=function(e,n){return e instanceof t?this.getType().isCompatible(e.getType(),n):this.getType().isCompatible(e,n)},t.prototype.isOptional=function(){return this.getType().isOptional()},t.prototype.isSimple=function(){return this.getType().isSimple()},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.traverse=function(e){var n=this;return e.enter(this,(function(){return e.step(t.STEP_REFERENCED,n.getType(),(function(e){return e instanceof t?n.options=e.options:0}))}))},t.prototype.getTypeFromStep=function(e){return e===t.STEP_REFERENCED?this.getType():null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return this.getType().getCreateExpression()},t.prototype.getValidateExpression=function(){return this.getType().getValidateExpression()},t.prototype.getCompareExpression=function(){return this.getType().getCompareExpression()},t.prototype.getValueChangeExpression=function(e,t,n){return e},t.prototype.isValid=function(e){return this.getType().isValid(e)},t.prototype.normalize=function(e){return this.getType().normalize(e)},t.prototype.newInstance=function(){return new t(this.options,this.provider)},t.prototype.clone=function(){return new t(this.options,this.provider)},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.getType().create()},t.prototype.random=function(e){return this.getType().random(e)},t.prototype.fromJson=function(e){return this.getType().fromJson(e)},t.prototype.toJson=function(e){return this.getType().toJson(e)},t.STEP_REFERENCED="referenced",t.id=G.Reference,t.operations=new Y(G.Reference+G.Delimiter),t.computeds=new W(G.Reference+G.Delimiter),t.baseType=new t("",null),t.describePriority=-1,t.registered=!1,t}(L),Yi=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Wi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Gi=function(){function e(e){this.clear(),e&&this.merge(e)}return e.prototype.reset=function(e){this.clear(),this.merge(e)},e.prototype.merge=function(t){var n,r,o,s;if(t instanceof Map)try{for(var a=Yi(t.entries()),u=a.next();!u.done;u=a.next()){var p=Wi(u.value,2),c=p[0],f=p[1];this.set(c,f)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}else if(t instanceof e)for(var y=0;y<t.length();y++)this.set(t.keyAt(y),t.valueAt(y));else if(i(t))try{for(var h=Yi(t),d=h.next();!d.done;d=h.next()){var v=Wi(d.value,2);c=v[0],f=v[1],this.set(c,f)}}catch(e){o={error:e}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}else if(l(t))for(var c in t)this.set(c,t[c])},e.prototype.sync=function(t,n){var r=this,o=new e(t);this.filter((function(e,t){return o.has(t)})),o.forEach((function(e,t){r.has(t)&&n?n(r.get(t),e):r.set(t,e)}))},e.prototype.clear=function(){this.indexes=Object.create(null),this.keys=[],this.values=[]},e.prototype.length=function(){return this.keys.length},e.prototype.valueAt=function(e){return this.values[e]},e.prototype.keyAt=function(e){return this.keys[e]},e.prototype.pairAt=function(e){return[this.keys[e],this.values[e]]},e.prototype.has=function(e){return o(e)?e in this.indexes:this.values.includes(e)},e.prototype.set=function(e,t){var n=this.indexes[e];r(n)?this.values.splice(n,1,t):(this.indexes[e]=this.values.length,this.values.push(t),this.keys.push(e))},e.prototype.rekey=function(e,t){var n=this.indexOf(e),r=-1!==n;return r&&(delete this.indexes[this.keys[n]],this.indexes[t]=n,this.keys.splice(n,1,t)),r},e.prototype.sort=function(e){this.reset(this.toPairs().sort((function(t,n){var r=Wi(t,2),o=(r[0],r[1]),i=Wi(n,2),s=(i[0],i[1]);return e(o,s)})))},e.prototype.sortByKey=function(e){void 0===e&&(e=function(e,t){return e.localeCompare(t)}),this.reset(this.toPairs().sort((function(t,n){var r=Wi(t,2),o=r[0],i=(r[1],Wi(n,2)),s=i[0];return i[1],e(o,s)})))},e.prototype.reindex=function(){for(var e=this.keys,t=Object.create(null),n=0;n<e.length;n++)t[e[n]]=n;this.indexes=t},e.prototype.swap=function(e,t){if(e===t||e<0||t<0||e>=this.keys.length||t>=this.keys.length)return!1;var n=this.keys[e],r=this.values[e],o=this.keys[t],i=this.values[t];return this.indexes[n]=t,this.indexes[o]=e,this.keys.splice(e,1,o),this.keys.splice(t,1,n),this.values.splice(e,1,i),this.values.splice(t,1,r),!0},e.prototype.get=function(e,t){return o(e)?this.values[this.indexes[e]]||t:e},e.prototype.remove=function(e,t){void 0===t&&(t=!1);var n=this.indexOf(e);if(-1!==n){var r=this.keys,o=this.values,i=o[n];if(t)this.removeAt(n);else{delete this.indexes[r[n]];var s=r.pop(),a=o.pop();n!==r.length&&(r.splice(n,1,s),o.splice(n,1,a),this.indexes[s]=n)}return i}},e.prototype.removeAt=function(e){var t=this.keys,n=this.values;if(e<0||e>=t.length)return!1;for(delete this.indexes[t[e]],t.splice(e,1),n.splice(e,1);++e<t.length;)this.indexes[t[e]]--;return!0},e.prototype.move=function(e,t){var n=this.keys,r=this.values;if(e<0||t<0||e>=n.length||t>=n.length)return!1;if(e!==t){var o=r[e],i=n[e];r.splice(e,1),n.splice(e,1),r.splice(t,0,o),n.splice(t,0,i),this.reindex()}return!0},e.prototype.moveToFront=function(e){var t=this.indexOf(e);return-1!==t&&this.move(t,0)},e.prototype.moveToBack=function(e){var t=this.indexOf(e);return-1!==t&&this.move(t,this.keys.length-1)},e.prototype.indexOf=function(e){return o(e)?e in this.indexes?this.indexes[e]:-1:this.values.indexOf(e)},e.prototype.keyOf=function(e){var t=this.values.indexOf(e);return-1===t?void 0:this.keys[t]},e.prototype.toPairs=function(){var e=this;return this.values.map((function(t,n){return[e.keys[n],t]}))},e.prototype.toMap=function(){return new Map(this.toPairs())},e.prototype.toObject=function(){for(var e=Object.create(null),t=0;t<this.keys.length;t++)e[this.keys[t]]=this.values[t];return e},e.prototype.clone=function(){return new e(this)},e.prototype.forEach=function(e){for(var t=this.keys,n=this.values,r=0;r<t.length;){var o=t[r];e(n[r],o),t[r]===o&&r++}},e.prototype.filter=function(e){for(var t=this,n=t.values,r=t.keys,o=t.indexes,i=0,s=0;s<n.length;s++){var a=n[s],u=r[s];e(a,u)?(n[i]=a,r[i]=u,o[u]=i,i++):delete o[u]}i<n.length&&(n.splice(i,n.length-i),r.splice(i,r.length-i))},e}(),Hi=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bi=function(e){function t(t){var n=e.call(this)||this;return t&&n.merge(t),n}return Hi(t,e),t.isNamedArray=function(e){return i(e)&&e.length>0&&o(e[0].name)},t.prototype.reset=function(e){this.clear(),this.merge(e)},t.prototype.merge=function(n){var r,o;if(t.isNamedArray(n))try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),s=i.next();!s.done;s=i.next()){var a=s.value;this.add(a)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}else e.prototype.merge.call(this,n)},t.prototype.sync=function(n,r){e.prototype.sync.call(this,new t(n),r)},t.prototype.syncManual=function(e,n,r,o,i){var s=this,a=new t(e);return i?b(this.values,a.values,i,(function(e,t){return n(s,t,t.name)}),(function(e,t,n){return r(s,n,n.name)}),(function(e,t,n,r){return o(s,n,r,n.name)})):(this.forEach((function(e,t){var n=a.get(t);void 0===n?r(s,e,t):o(s,e,n,t)})),a.forEach((function(e,t){s.has(t)||n(s,e,t)}))),this},t.prototype.rename=function(e,t){var n=this.get(e),r=!!n&&n.name!==t;return r&&(this.rekey(n,t),n.name=t),r},t.prototype.has=function(e){return this.nameOf(e)in this.indexes},t.prototype.add=function(e){this.set(e.name,e)},t.prototype.nameOf=function(e){return o(e)?e:e.name},t.prototype.valueOf=function(e){return o(e)?this.get(e):e},t.prototype.indexOf=function(e){var t=this.indexes[this.nameOf(e)];return r(t)?t:-1},t.prototype.keyOf=function(e){return e.name},t.prototype.clone=function(){return new t(this)},t}(Gi),Ui=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ji=function(){return(Ji=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ki=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},zi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Xi=function(e){function t(t){var n=e.call(this)||this;return n.legacy=!1,n.types=Object.create(null),n.typeList=[],n.describers=[],n.expressions=Object.create(null),n.operations=new Y(""),n.computeds=new W(""),n.parsers=Object.create(null),n.entities=new Bi,n.functions=new Bi,n.relations=new Bi,n.programs=new Bi,n.data=new Bi,n.keyExpectedType=gi.many(gi.text(),gi.number()),n.describeExpectedType=gi.text(),t&&n.add(t),n}return Ui(t,e),t.prototype.isLegacy=function(){return this.legacy},t.prototype.setLegacy=function(){this.legacy=!0},t.prototype.encodeMap=function(e,t){return void 0===t&&(t=!0),O(e.toObject(),(function(e){return t?e.encode():e}))},t.prototype.extend=function(e,n){void 0===e&&(e=!1);var r=new t({types:w(this.types),expressions:w(this.expressions),entities:this.encodeMap(this.entities,e),functions:this.encodeMap(this.functions,e),relations:this.encodeMap(this.relations,e),programs:this.encodeMap(this.programs,e),data:this.encodeMap(this.data,e)});return n&&r.add(n),r},t.prototype.changed=function(){this.trigger("changed",this)},t.prototype.add=function(e){var t=this;e.types&&e.types.forEach((function(e){return t.addType(e,!0)})),this.sortDescribers(),e.expressions&&e.expressions.forEach((function(e){return t.addExpression(e)})),this.import(e)},t.prototype.describe=function(e){var t=this,n=new Map,r={describe:function(e){var o,i,s=n.get(e);if(void 0!==s)return s;try{for(var a=Ki(t.describers),u=a.next();!u.done;u=a.next())if(s=u.value.describe(e,r,n))return s}catch(e){o={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return ye.baseType},merge:function(e,n){return t.merge(e,n)}};return r.describe(e)},t.prototype.merge=function(e,t){return gi.merge(e,this.describe(t))},t.prototype.sortDescribers=function(){this.describers.sort((function(e,t){return t.describePriority-e.describePriority}))},t.prototype.addType=function(e,t){void 0===t&&(t=!1),this.types[e.id]=e,this.typeList.push(e),this.parsers[e.id]=function(t,n){return e.decode(t,n)},this.describers.push(e),t||this.sortDescribers(),e.registered||(e.registered=!0,e.register())},t.prototype.findEntity=function(e,t){void 0===t&&(t={strict:!0,value:!1,exact:!1});var n=this.entities.values.find((function(n){return n.type.isCompatible(e,t)}));return!!n&&n.name},t.prototype.addData=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=e instanceof qi?e:qi.create(this,e),o=this.data.get(r.name);return o?(t?o.sync(r,this):this.data.add(r),this.trigger("updateData",this,r)):(this.data.add(r),this.trigger("addData",this,r)),this.trigger("changedData",this),n||this.changed(),this},t.prototype.getData=function(e){return this.data.get(e,null)},t.prototype.getDatas=function(){return this.data},t.prototype.removeData=function(e,t,n,r){void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.data.valueOf(e);return!o||!(t&&this.getDataReferences(o).length>0)&&(this.data.remove(o,n),this.trigger("removeData",this,o),this.trigger("changedData",this),r||this.changed(),!0)},t.prototype.clearData=function(e){void 0===e&&(e=!1);var t=this.data.values.slice();this.data.clear(),this.trigger("clearData",this,t),this.trigger("changedData",this),e||this.changed()},t.prototype.renameData=function(e,t,n){void 0===n&&(n=!1);var r=this.data.valueOf(e),o=r.name;if(!this.data.rename(r,t))return!1;var i=this.getDataReferences(r);return i.forEach((function(e){e.value instanceof Vi?e.value.options=t:e.value.name=t})),r.trigger("renamed",r,o),r.changed(),this.trigger("renameData",this,r,o),this.trigger("changedData",this),n||this.changed(),i},t.prototype.addFunction=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=e instanceof Si?e:Si.create(this,e),o=this.functions.get(r.name);return o?(t?o.sync(r,this):this.functions.add(r),this.trigger("updateFunction",this,r)):(this.functions.add(r),this.trigger("addFunction",this,r)),this.trigger("changedFunctions",this),n||this.changed(),this},t.prototype.getFunction=function(e){return this.functions.get(e,null)},t.prototype.getFunctions=function(){return this.functions},t.prototype.addProgram=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=e instanceof Ni?e:Ni.create(this,e),o=this.programs.get(r.name);return o?(t?o.sync(r,this):this.programs.add(r),this.trigger("updateProgram",this,r)):(this.programs.add(r),this.trigger("addProgram",this,r)),this.trigger("changedPrograms",this),n||this.changed(),this},t.prototype.getProgram=function(e){return this.programs.get(e,null)},t.prototype.getPrograms=function(){return this.programs},t.prototype.removeProgram=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=this.programs.valueOf(e);return!r||(this.programs.remove(r,t),this.trigger("removeProgram",this,r),this.trigger("changedPrograms",this),n||this.changed(),!0)},t.prototype.clearPrograms=function(e){void 0===e&&(e=!1);var t=this.programs.values.slice();this.programs.clear(),this.trigger("clearPrograms",this,t),this.trigger("changedPrograms",this),e||this.changed()},t.prototype.addEntity=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=e instanceof Ci?e:Ci.create(this,e),o=this.entities.get(r.name);return o?(t?o.sync(r,this):this.entities.add(r),this.trigger("updateEntity",this,r)):(this.entities.add(r),this.trigger("addEntity",this,r)),this.trigger("changedEntities",this),n||this.changed(),this},t.prototype.getEntity=function(e){return this.entities.get(e,null)},t.prototype.getEntities=function(){return this.entities},t.prototype.addRelation=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=e instanceof ji?e:new ji(this,e),o=this.relations.get(r.name);return o?(t?o.sync(r,this):this.relations.add(r),this.trigger("updateRelation",this,r)):(this.relations.add(r),this.trigger("addRelation",this,r)),this.trigger("changedRelations",this),n||this.changed(),this},t.prototype.getRelation=function(e){return this.relations.get(e,null)},t.prototype.getRelations=function(e){var t=[];return this.relations.forEach((function(n){var r=n.getSubjectRelation(e);r&&t.push(r);var o=n.getRelatedRelation(e);o&&t.push(o)})),t},t.prototype.getEntityProps=function(e){var t=[],n=this.entities.get(e);return n&&(t.push(n.getEntityProps()),this.relations.forEach((function(n){t.push.apply(t,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(zi(arguments[t]));return e}(n.getTypeProps(e)))}))),t},t.prototype.removeRelation=function(e,t,n,r){void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.relations.valueOf(e);return!o||!(t&&this.getRelationReferences(o).length>0)&&(this.relations.remove(o,n),this.trigger("removeRelation",this,o),this.trigger("changedRelations",this),r||this.changed(),!0)},t.prototype.clearRelations=function(e){void 0===e&&(e=!1);var t=this.relations.values.slice();this.relations.clear(),this.trigger("clearRelations",this,t),this.trigger("changedRelations",this),e||this.changed()},t.prototype.renameProgram=function(e,t,n){void 0===n&&(n=!1);var r=this.programs.valueOf(e),o=r.name;return!!this.programs.rename(r,t)&&(r.trigger("renamed",r,o),r.changed(),this.trigger("renameProgram",this,r,o),this.trigger("changedPrograms",this),n||this.changed(),!0)},t.prototype.renameEntity=function(e,t,n){void 0===n&&(n=!1);var r=this.entities.valueOf(e),o=r.name;if(!this.entities.rename(r,t))return!1;this.relations.forEach((function(e){e.rename(name,t)}));var i=this.getEntityReferences(name);return i.forEach((function(e){e.value instanceof Et?e.value.options=t:e.value.name=t})),this.getMethodReferences(name).forEach((function(e){e.value.name=t})),r.trigger("renamed",r,o),r.changed(),this.trigger("renameEntity",this,r,o),this.trigger("changedEntities",this),n||this.changed(),i},t.prototype.renameEntityProp=function(e,t,n){var r=this.entities.get(e);r&&(r.renameProp(t,n),this.relations.forEach((function(e){e.renameProp(r.name,t,n)})))},t.prototype.removeEntityProp=function(e,t){var n=this,r=this.entities.get(e);r&&(r.removeProp(t),this.relations.forEach((function(e){e.removeProp(r.name,t),e.isEmpty()&&n.relations.remove(e)})))},t.prototype.removeEntity=function(e,t,n,r){var o=this;void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.entities.valueOf(e);return!i||!(t&&this.getEntityReferences(i).length>0)&&(this.entities.remove(i,n),this.relations.forEach((function(e){e.remove(name),e.isEmpty()&&o.relations.remove(e,n)})),this.trigger("removeEntity",this,i),this.trigger("changedEntities",this),r||this.changed(),!0)},t.prototype.clearEntities=function(e){void 0===e&&(e=!1);var t=this.entities.values.slice();this.entities.clear(),this.trigger("clearEntities",this,t),this.trigger("changedEntities",this),e||this.changed()},t.prototype.refactorEntity=function(e,t,n){var r=this.getEntityDataReferences(e);return r.forEach((function(e){e.root.setParent();var r=e.type.getValueChangeAt(t);e.data=n.run(r,{value:e.data})})),r},t.prototype.renameRelation=function(e,t,n){void 0===n&&(n=!1);var r=this.relations.valueOf(e),o=r.name;if(!this.relations.rename(r,t))return!1;var i=this.getRelationReferences(r);return i.forEach((function(e){e.value.name=t})),r.trigger("renamed",r,o),r.changed(),this.trigger("renameRelation",this,r,o),this.trigger("changedRelations",this),n||this.changed(),i},t.prototype.renameFunction=function(e,t,n){void 0===n&&(n=!1);var r=this.functions.valueOf(e),o=r.name;if(!this.functions.rename(r,t))return!1;var i=this.getFunctionReferences(r);return i.forEach((function(e){e.value.name=t})),r.trigger("renamed",r,o),r.changed(),this.trigger("renameFunction",this,r,o),this.trigger("changedFunctions",this),n||this.changed(),i},t.prototype.renameFunctionParameter=function(e,t,n){var r=this.functions.get(e);if(!r)return!1;if(!r.renameParameter(t,n))return!1;var o=this.getFunctionReferences(e,t);return o.forEach((function(e){X.objectSet(e.value.args,n,e.value.args[t]),X.objectRemove(e.value.args,t)})),o},t.prototype.removeFunctionParameter=function(e,t){var n=this.functions.get(e);if(!n)return!1;if(!n.removeParameter(t))return!1;var r=this.getFunctionReferences(e,t);return r.forEach((function(e){X.objectRemove(e.value.args,t)})),r},t.prototype.removeFunction=function(e,t,n,r){void 0===t&&(t=!0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=this.functions.valueOf(e);return!o||!(t&&this.getFunctionReferences(o).length>0)&&(this.functions.remove(o,n),this.trigger("removeFunction",this,o),this.trigger("changedFunctions",this),r||this.changed(),!0)},t.prototype.clearFunctions=function(e){void 0===e&&(e=!1);var t=this.functions.values.slice();this.functions.clear(),this.trigger("clearFunctions",this,t),this.trigger("changedFunctions",this),e||this.changed()},t.prototype.addMethod=function(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=!1);var o=this.entities.valueOf(e);if(!o)return!1;var i=t instanceof Si?t:Si.create(this,t),s=o.methods[i.name];return s?(n?s.sync(i,this):o.addMethod(i),this.trigger("updateMethod",this,i,o)):(o.addMethod(i),this.trigger("addMethod",this,i,o)),this.trigger("changedMethods",this),r||this.changed(),!0},t.prototype.renameMethod=function(e,t,n,r){void 0===r&&(r=!1);var o=this.entities.valueOf(e);if(!o)return!1;var i=o.methods[this.functions.nameOf(t)];if(!i)return!1;var s=i.name;o.renameMethod(s,n);var a=this.getMethodReferences(o,i);return a.forEach((function(e){e.value.name=n})),i.trigger("renamed",i,s),i.changed(),this.trigger("renameMethod",this,i,o,s),this.trigger("changedMethods",this),r||this.changed(),a},t.prototype.renameMethodParameter=function(e,t,n,r){var o=this.entities.valueOf(e);if(!o)return!1;var i=o.methods[this.functions.nameOf(t)];if(!i)return!1;if(!i.renameParameter(n,r))return!1;var s=this.getMethodReferences(e,t,n);return s.forEach((function(e){X.objectSet(e.value.args,r,e.value.args[n]),X.objectRemove(e.value.args,n)})),s},t.prototype.removeMethodParameter=function(e,t,n){var r=this.entities.valueOf(e);if(!r)return!1;var o=r.methods[this.functions.nameOf(t)];if(!o)return!1;if(!o.removeParameter(n))return!1;var i=this.getMethodReferences(e,t,n);return i.forEach((function(e){X.objectRemove(e.value.args,n)})),i},t.prototype.removeMethod=function(e,t,n,r,o){void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===o&&(o=!1);var i=this.entities.valueOf(e);if(!i)return!1;var s=i.methods[this.functions.nameOf(t)];return!(!s||n&&this.getMethodReferences(e,t).length>0||(i.removeMethod(s.name),this.trigger("removeMethod",this,s,i),this.trigger("changedMethods",this),o||this.changed(),0))},t.prototype.getTypeKind=function(e,t,n){void 0===n&&(n=null);var r=this.getType(e);return r instanceof t?r:n},t.prototype.getType=function(e,t){if(e instanceof L)return e;var n=i(e)?e[0]:e,r=i(e)?e:[],o=this.parsers[n];if(!o){if(this.entities.has(n))return this.entities.get(n).type;if(t)return t;throw new Error("No parser found for "+n+" with payload "+JSON.stringify(r))}return o(r,this)},t.prototype.getBaseTypes=function(){return this.typeList.map((function(e){return e.baseType}))},t.prototype.getSimpleTypes=function(){return this.getBaseTypes().filter((function(e){return e.isSimple()}))},t.prototype.getComplexTypes=function(){return this.getBaseTypes().filter((function(e){return!e.isSimple()}))},t.prototype.getSimpleTypeClasses=function(){return this.typeList.filter((function(e){return e.baseType.isSimple()}))},t.prototype.getComplexTypeClasses=function(){return this.typeList.filter((function(e){return!e.baseType.isSimple()}))},t.prototype.getComputed=function(e){var t=this.computeds.get(e);if(t)return t;var n=zi(e.split(G.Delimiter),1)[0],r=this.types[n];return r?r.computeds.get(e):null},t.prototype.getComputedReturnType=function(e,t){var n;void 0===t&&(t=null);var r=this.getComputed(e);if(!r)return null;var o=this.getOperation(r.op),i=this.getOperationTypes(r.op);return o&&i?this.getOperationInputType(i.returnType,((n={})[r.value]=t,n)):null},t.prototype.getComputedsFor=function(e){var t=this.types[e.getId()];return t?t.computeds.list:[]},t.prototype.hasComputed=function(e,t){var n=this.types[e.getId()];return!!n&&!!n.computeds.get(t)},t.prototype.getOperation=function(e){var t=this.operations.get(e);if(t)return t;var n=zi(e.split(G.Delimiter),1)[0],r=this.types[n];return r?r.operations.get(e):null},t.prototype.getOperationTypes=function(e){var t=this.operations.getTypes(e);if(t)return t;var n=zi(e.split(G.Delimiter),1)[0],r=this.types[n];return r?r.operations.getTypes(e):null},t.prototype.getOperationReturnType=function(e,t,n,r){var o=this.getOperation(e),i=this.getOperationTypes(e);if(!o||!i)return null;var s=i.returnType;if(s instanceof L)return s;if(!F(s))return s.baseType.newInstance();var a=o.resultDependency.length>0?this.getOperationParamTypes(e,t,n,r,i.rawTypes):{};return this.getOperationInputType(i.returnType,a)},t.prototype.getOperationExpectedTypes=function(e,t,n,r,o){var i=this;void 0===o&&(o=!1);var s=this.getOperationTypes(e);if(!s)return{};var a=this.getOperationParamTypes(e,t,n,r,o);return O(a,(function(e,t){return i.getOperationInputType(s.params[t]||s.optional[t]||e,a)}))},t.prototype.getOperationParamTypes=function(e,t,n,r,o){var i,s,a,u,p,c;void 0===o&&(o=!1);var l={},f=this.getOperation(e),y=this.getOperationTypes(e);if(!f||!y)return l;for(var h in t)-1===f.hasScope.indexOf(h)&&(O=t[h].getType(this,r))&&(l[h]=o?O:O.getSimplifiedType());var d=this.getContextWithScope(r),v=d.context,m=d.scope;try{for(var g=Ki(f.scope),T=g.next();!T.done;T=g.next()){var b=T.value,x=this.getOperationInputType(y.scope[b],l);x&&(m[n[b]||b]=o?x:x.getSimplifiedType())}}catch(e){i={error:e}}finally{try{T&&!T.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}for(var h in t){var O;-1!==f.hasScope.indexOf(h)&&(O=t[h].getType(this,v))&&(l[h]=o?O:O.getSimplifiedType())}try{for(var E=Ki(f.params),w=E.next();!w.done;w=E.next())l[h=w.value]||(l[h]=this.getOperationInputType(y.params[h],l))}catch(e){a={error:e}}finally{try{w&&!w.done&&(u=E.return)&&u.call(E)}finally{if(a)throw a.error}}try{for(var S=Ki(f.optional),P=S.next();!P.done;P=S.next())l[h=P.value]||(l[h]=this.getOperationInputType(y.optional[h],l))}catch(e){p={error:e}}finally{try{P&&!P.done&&(c=S.return)&&c.call(S)}finally{if(p)throw p.error}}return l},t.prototype.getOperationScopeContext=function(e,t,n,r){var o,i,s=this.getOperation(e),a=this.getOperationTypes(e),u=this.getContextWithScope(r),p=u.context,c=u.scope;try{for(var l=Ki(s.scope),f=l.next();!f.done;f=l.next()){var y=f.value,h=this.getOperationInputType(a.scope[y],t);h&&(c[n[y]||y]=h.getSimplifiedType())}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return p},t.prototype.getContextWithScope=function(e,t){return void 0===t&&(t={}),{context:e instanceof xt?new xt({props:t=Ji(Ji({},e.options.props),t)}):new Co([new xt({props:t}),e]),scope:t}},t.prototype.getContext=function(e,t){return this.getContextWithScope(e,t).context},t.prototype.getOperationMapping=function(e,t,n){var r,o,i,s,a=this,u=this.getOperation(e),p=this.getOperationTypes(n),c=u.params.concat(u.optional),l=this.getOperation(n),f=this.getOperationTypes(n),y=Object.create(null),h=Object.create(null),d=w(t,(function(e,t){return[t,e,c.indexOf(t)]})).filter((function(e){return zi(e,3)[2]>=0})).sort((function(e,t){return zi(e,3)[2]-zi(t,3)[2]})),v=function(e,t){if(0===d.length)return null;var n=-1;if(F(t))-1===(n=d.findIndex((function(n){var r,o=zi(n,2)[1];return o.acceptsType(gi.parse(t(Ji(Ji({},h),((r={})[e]=o,r)),a)))})))&&(n=d.findIndex((function(n){var r,o=zi(n,2)[1];return gi.parse(t(Ji(Ji({},h),(r={},r[e]=o,r)),a)).acceptsType(o)})));else{var r=gi.parse(t);n=d.findIndex((function(e){var t=zi(e,2)[1];return r.acceptsType(t)}))}if(-1===n)return null;var o=d[n];d.splice(n,1),y[o[0]]=e,h[e]=o[1]};try{for(var m=Ki(l.params),g=m.next();!g.done;g=m.next()){var T=g.value;if(null===v(T,f.params[T]))return null}}catch(e){r={error:e}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var b=Ki(l.optional),x=b.next();!x.done;x=b.next()){var O=x.value;v(O,f.optional[O])}}catch(e){i={error:e}}finally{try{x&&!x.done&&(s=b.return)&&s.call(b)}finally{if(i)throw i.error}}var E=d.map((function(e){return zi(e,1)[0]}));return{from:u,fromTypes:p,to:l,toTypes:f,mapping:y,unmapped:E}},t.prototype.getOperationInputType=function(e,t){return e instanceof L?e:"baseType"in e?e.baseType.clone():t?gi.parse(e(t,this)):null},t.prototype.getOperationsForExpression=function(e,t){var n=e.getType(this,t);return n?this.getOperationsForType(n.getSimplifiedType()):[]},t.prototype.getOperationsWithMapping=function(e,t){var n=this;return this.getOperations().map((function(r){var o=r.op;return n.getOperationMapping(e,t,o.id)})).filter((function(e){return!!e}))},t.prototype.getOperationsForType=function(e,t){var n=this;return void 0===t&&(t=!1),this.getOperations((function(r){var o,i=r.op,s=r.types,a=i.params[0],u=s.params[a];if(u){var p=n.getOperationInputType(u,((o={})[a]=e,o));if(p){if(e.acceptsType(p))return!0;if(t&&i.resultDependency.length>0&&F(s.returnType)&&(p instanceof ye||p instanceof pe))return!0}}return!1}))},t.prototype.getOperationsWithReturnExpression=function(e,t,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var o=e.getType(this,t);return o?this.getOperationsWithReturnType(o.getSimplifiedType(),n,r):[]},t.prototype.getOperationsWithReturnType=function(e,t,n){var r=this;return void 0===t&&(t={}),void 0===n&&(n=!1),this.getOperations((function(o){var i=o.op,s=o.types,a=r.getOperationInputType(s.returnType,t);if(a){if(e.acceptsType(a))return!0;if(n&&i.resultDependency.length>0&&F(s.returnType)&&(a instanceof ye||a instanceof pe))return!0}return!1}))},t.prototype.getOperationsForParamExpressions=function(e,t){var n=this;return this.getOperationsForParamTypes(O(e,(function(e){var r=e.getType(n,t);return r?r.getSimplifiedType():void 0})))},t.prototype.getOperationsForParamTypes=function(e){var t=this,n=Object.keys(e);return this.getOperations((function(r){var o,i,s=r.types;try{for(var a=Ki(n),u=a.next();!u.done;u=a.next()){var p=u.value,c=s.params[p]||s.optional[p];if(!c)return!1;var l=t.getOperationInputType(c,e);if(!l||!e[p].acceptsType(l))return!1}}catch(e){o={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return!0}))},t.prototype.getOperations=function(e){void 0===e&&(e=function(){return!0});var t=[],n=function(n){var r=n.map;for(var o in r){var i={op:r[o],types:n.types[o]};e(i)&&t.push(i)}};return n(this.operations),E(this.types,(function(e){return n(e.operations)})),t},t.prototype.getPathType=function(e,t,n){if(void 0===n&&(n=e.length),0===e.length)return null;var r=e[0].getType(this,t);if(!r)return null;for(var o=r.isOptional(),i=1;i<n;i++){var s=e[i];if(!(r=s.isPathNode()?s.getType(this,t,r):r.getSubType(s,this,t)))return null;o=o||r.isOptional()}return o&&!r.isOptional()?gi.optional(r):r},t.prototype.addExpression=function(e){this.expressions[e.id]=e},t.prototype.getExpression=function(e){if(e instanceof q)return e;if(i(e)){var t=this.expressions[e[0]];if(!t)throw new Error("An expression was not found for: "+JSON.stringify(e));return t.decode(e,this)}return new Ue(e)},t.prototype.isExpression=function(e){return e instanceof q||i(e)&&o(e[0])&&e[0]in this.expressions},t.prototype.getEntityReferences=function(e){var t=e?this.entities.nameOf(e):void 0,n=this.getTypeClassReferences(Et).filter((function(e){return!t||t===e.value.options})),r=this.getExpressionClassReferences(St).filter((function(e){return!t||t===e.value.name}));return n.concat(r)},t.prototype.getDataReferences=function(e){var t=e?this.data.nameOf(e):void 0,n=this.getTypeClassReferences(Vi).filter((function(e){return!t||t===e.value.options})),r=this.getExpressionClassReferences(pt).filter((function(e){return!t||t===e.value.name}));return n.concat(r)},t.prototype.getEntityDataReferences=function(e){var t=e?this.entities.nameOf(e):void 0;return this.getDataTypeClassReferences(Et).filter((function(e){return!t||t===e.type.options}))},t.prototype.getRelationReferences=function(e){var t=e?this.relations.nameOf(e):void 0;return this.getExpressionClassReferences(Mt).filter((function(e){return!t||t===e.value.name}))},t.prototype.getFunctionReferences=function(e,t){var n=e?this.functions.nameOf(e):void 0;return this.getExpressionClassReferences(jt).filter((function(e){return!(n&&n!==e.value.name||t&&!(t in e.value.args))}))},t.prototype.getMethodReferences=function(e,t,n){var r=e?this.entities.nameOf(e):void 0,o=t?this.functions.nameOf(t):void 0;return this.getExpressionClassReferences(At).filter((function(e){return!(r&&r!==e.value.entity||o&&o!==e.value.name||n&&!(n in e.value.args))}))},t.prototype.getTypeClassReferences=function(e){var t=[];return this.getTypeInstances().forEach((function(n){n.type.traverse(new R((function(r){r instanceof e&&t.push({value:r,root:n.type,source:n.source})})))})),t},t.prototype.getDataTypeClassReferences=function(e){var t=[];return this.getDataInstances().forEach((function(n){n.type.traverse(new R((function(r){r instanceof e&&t.push({type:r,data:n.data,root:n.type,source:n.source})})))})),t},t.prototype.getExpressionClassReferences=function(e){var t=[];return this.getExpressionInstances().forEach((function(n){n.expr.traverse(new R((function(r){r instanceof e&&t.push({value:r,root:n.expr,source:n.source})})))})),t},t.prototype.getDataInstances=function(){var e=this,t=[];return this.programs.forEach((function(e){e.datasets.forEach((function(n){t.push({data:n.data,type:e.dataType,source:[e,n]})}))})),this.functions.forEach((function(n){var r=n.getReturnType(e);n.tests.forEach((function(e){t.push({data:e.args,type:n.params,source:[n,e,"args"]}),t.push({data:e.expected,type:r,source:[n,e,"expected"]})}))})),this.data.forEach((function(e){t.push({data:e.data,type:e.dataType,source:e})})),this.entities.forEach((function(n){n.instances&&n.instances.length>0&&t.push({data:n.instances,type:gi.list(n.type),source:n}),E(n.methods,(function(r){var o=r.getReturnType(e);r.tests.forEach((function(e){t.push({data:e.args,type:r.params,source:[n,r,e,"args"]}),t.push({data:e.expected,type:o,source:[n,r,e,"expected"]})}))}))})),t},t.prototype.getTypeInstances=function(e){var t=this;void 0===e&&(e=!1);var n=[];return this.programs.forEach((function(e){n.push({type:e.dataType,source:e})})),this.functions.forEach((function(r){n.push({type:r.params,source:[r,"params"]}),e&&n.push({type:r.getReturnType(t),source:[r,"returnType"]})})),this.data.forEach((function(e){n.push({type:e.dataType,source:e})})),this.entities.forEach((function(r){n.push({type:r.type,source:r}),E(r.methods,(function(o){n.push({type:o.params,source:[r,o,"params"]}),e&&n.push({type:o.getReturnType(t),source:[r,o,"returnType"]})})),e&&(r.key!==le.instance&&n.push({type:r.getKeyContext(),source:[r,"key"]}),r.describe!==le.instance&&n.push({type:r.getDescribeContext(),source:[r,"describe"]})),E(r.transcoders,(function(e,t){n.push({type:e.encodedType,source:[r,t,e]})}))})),e&&this.relations.forEach((function(e){e.morphs&&n.push({type:e.morphs[1],source:e})})),n},t.prototype.getExpressionInstances=function(){var e=this,t=[];return this.programs.forEach((function(e){t.push({context:e.dataType,expr:e.expression,source:e})})),this.functions.forEach((function(e){t.push({context:e.params,expr:e.expression,source:e})})),this.entities.forEach((function(n){E(n.methods,(function(e){t.push({context:e.getParamTypes(),expr:e.expression,source:[n,e]})})),n.canStore(e)&&(t.push({context:n.getKeyContext(),expr:n.key,source:[n,"key"]}),t.push({context:n.getDescribeContext(),expr:n.describe,source:[n,"describe"]}),E(n.transcoders,(function(e,r){t.push({context:n.getEncodeContext(r),expr:e.encode,source:[n,r,e,"encode"]}),t.push({context:n.getDecodeContext(r),expr:e.decode,source:[n,r,e,"decode"]})})))})),t},t.prototype.export=function(){return{entities:this.encodeMap(this.entities),functions:this.encodeMap(this.functions),relations:this.encodeMap(this.relations),programs:this.encodeMap(this.programs),data:this.encodeMap(this.data)}},t.prototype.sync=function(e){var t=this;e.data&&this.data.syncManual(e.data,(function(e,n){return t.addData(n,!1,!0)}),(function(e,n){return t.removeData(n,!1,!0,!0)}),(function(e,n,r){return t.addData(r,!0,!0)})),e.functions&&this.functions.syncManual(e.functions,(function(e,n){return t.addFunction(n,!1,!0)}),(function(e,n){return t.removeFunction(n,!1,!0,!0)}),(function(e,n,r){return t.addFunction(r,!0,!0)})),e.entities&&this.entities.syncManual(e.entities,(function(e,n){return t.addEntity(n,!1,!0)}),(function(e,n){return t.removeEntity(n,!1,!0,!0)}),(function(e,n,r){return t.addEntity(r,!0,!0)})),e.relations&&this.relations.syncManual(e.relations,(function(e,n){return t.addRelation(n,!1,!0)}),(function(e,n){return t.removeRelation(n,!1,!0,!0)}),(function(e,n,r){return t.addRelation(r,!0,!0)})),e.programs&&this.programs.syncManual(e.programs,(function(e,n){return t.addProgram(n,!1,!0)}),(function(e,n){return t.removeProgram(n,!0,!0)}),(function(e,n,r){return t.addProgram(r,!0,!0)}))},t.prototype.import=function(e){var t=this;e.data&&E(e.data,(function(e){return t.addData(e)})),e.functions&&E(e.functions,(function(e){return t.addFunction(e)})),e.entities&&E(e.entities,(function(e){return t.addEntity(e)})),e.relations&&E(e.relations,(function(e){return t.addRelation(e)})),e.programs&&E(e.programs,(function(e){return t.addProgram(e)}))},t}(Oi),$i=function(){function e(t){this.defs=t,this.ops=Object.create(null),this.exprs=Object.create(null),this.returnProperty=e.DEFAULT_RETURN_PROPERTY}return e.prototype.extend=function(t){var n=new e(t||this.defs);return Object.assign(n.ops,this.ops),Object.assign(n.exprs,this.exprs),n.returnProperty=this.returnProperty,n},e.prototype.setOperation=function(e,t){return this.ops[e.id]=t,this},e.prototype.setExpression=function(e,t){return this.exprs[e.id]=t,this},e.prototype.getFunction=function(e){return this.defs.getFunction(e)},e.prototype.getOperation=function(e){return this.ops[e]},e.prototype.getComputed=function(e){return this.defs.getComputed(e)},e.prototype.getOperationScopeDefaults=function(e){var t=this.defs.getOperation(e);return t?t.scopeDefaults:{}},e.prototype.getExpression=function(e){return this.exprs[e]},e.prototype.getCommand=function(e,t){return void 0===t&&(t=this),this.exprs[e.getId()](e,t)},e.prototype.run=function(e,t,n){return void 0===n&&(n=this),this.eval(e,n)(t)},e.prototype.eval=function(e,t){return void 0===t&&(t=this),i(e)?this.getCommand(this.defs.getExpression(e),t):e instanceof q?this.getCommand(e,t):function(){return e}},e.DEFAULT_RETURN_PROPERTY="$$return",e}(),Qi=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},es=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Qi(t,e),t.decode=function(e,t){var n=t.getExpression(e[1]),r=e[2].map((function(e){return t.getExpression(e)}));return t.setLegacy(),tt.createForLegacy(function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Zi(arguments[t]));return e}([n],r))},t.encode=function(e){throw new Error("Sub expression is no longer supported.")},t.prototype.getId=function(){throw new Error("Sub expression is no longer supported.")},t.prototype.getComplexity=function(e,t){throw new Error("Sub expression is no longer supported.")},t.prototype.getScope=function(){throw new Error("Sub expression is no longer supported.")},t.prototype.encode=function(){throw new Error("Sub expression is no longer supported.")},t.prototype.clone=function(){throw new Error("Sub expression is no longer supported.")},t.prototype.getType=function(e,t){throw new Error("Sub expression is no longer supported.")},t.prototype.traverse=function(e){throw new Error("Sub expression is no longer supported.")},t.prototype.getExpressionFromStep=function(e){throw new Error("Sub expression is no longer supported.")},t.prototype.setParent=function(e){throw void 0===e&&(e=null),new Error("Sub expression is no longer supported.")},t.prototype.validate=function(e,t,n){throw new Error("Sub expression is no longer supported.")},t.prototype.mutates=function(e,t,n){throw new Error("Sub expression is no longer supported.")},t.id="sub",t}(q),ts=new Xi({types:[Et,ye,Q,si,Po,He,dn,Co,Ao,qo,pe,_n,xt,Ro,Vi,mi,Re,Tn],expressions:[ne,Ee,Se,rt,Ue,ve,be,at,_e,pt,St,Mt,Ct,jt,At,le,ee,En,Ft,Rt,tt,Yt,Ke,es,Bt,Jt,xn,$e,$t]}),ns=Et.operations,rs=function(e,t){return e.name instanceof Et?e.name:xt.baseType},os=function(e,t){if(e.name instanceof Et)return e.name;var n=t.getEntities().values.map((function(e){return new Et(e.name,t)}));return 0===n.length?pe.baseType:1===n.length?n[0]:gi.many(n)},is=function(e,t){if(!(e.name instanceof Et))return null;var n=t.getRelations(e.name.options);if(e.relation instanceof He){var r=e.relation.options.constants.get("relation");if(r){var o=n.find((function(e){return e.name===r}));if(o)return o}}return n},ss=function(e,t){var n=is(e,t);return null===n?pe.baseType:i(n)?gi.many(n.map((function(e){return gi.enum(Re,Re,[["relation",e.name]])}))):e.relation},as=function(e,t){var n=is(e,t);return null===n||i(n)?pe.baseType:e.related&&n.relationType.acceptsType(e.related)?e.related:n.relationType},us=function(e,t){var n=is(e,t);return null===n||i(n)?pe.baseType:e.related&&n.itemType.acceptsType(e.related)?e.related:n.itemType},ps={newInstance:ns.setTypes(yt.newInstance,rs,{name:os},{initial:function(e,t){if(e.name instanceof Et){var n=e.name.getType();if(n instanceof xt){var r=n;return gi.object(O(r.options.props,(function(e){return gi.optional(e.clone())})))}}return xt.baseType}}),get:ns.setTypes(yt.get,(function(e,t){if(!(e.name instanceof Et))return ye;var n=t.getEntity(e.name.options);return n?gi.list(n.type):ye}),{name:os},{where:Q},{instance:rs}),getKey:ns.setTypes(yt.getKey,(function(e,t){if(!(e.name instanceof Et))return ye;var n=t.getEntity(e.name.options);return n&&n.key?n.keyType:ye}),{name:os,instance:rs}),save:ns.setTypes(yt.save,Q,{name:os,instance:rs}),remove:ns.setTypes(yt.remove,Q,{name:os,instance:rs}),setRelated:ns.setTypes(yt.setRelated,_n,{name:os,instance:rs,relation:ss,related:as}),addRelated:ns.setTypes(yt.addRelated,_n,{name:os,instance:rs,relation:ss,related:us}),removeRelated:ns.setTypes(yt.removeRelated,_n,{name:os,instance:rs,relation:ss,related:us}),clearRelated:ns.setTypes(yt.clearRelated,_n,{name:os,instance:rs,relation:ss}),getRelated:ns.setTypes(yt.getRelated,(function(e,t){return as(e,t)}),{name:os,instance:rs,relation:ss}),isRelated:ns.setTypes(yt.isRelated,_n,{name:os,instance:rs,relation:ss,related:us})};ps.newInstance.rawTypes=!0,ps.get.rawTypes=!0,ps.getKey.rawTypes=!0,ps.save.rawTypes=!0,ps.remove.rawTypes=!0,ps.setRelated.rawTypes=!0,ps.addRelated.rawTypes=!0,ps.removeRelated.rawTypes=!0,ps.clearRelated.rawTypes=!0,ps.getRelated.rawTypes=!0,ps.isRelated.rawTypes=!0;var cs=ye.operations,ls={cmp:cs.setTypes(ae.cmp,_n,{value:ye,test:ye}),copy:cs.setTypes(ae.copy,ye,{value:ye}),isDefined:cs.setTypes(ae.isDefined,Q,{value:ye}),getDefined:cs.setTypes(ae.getDefined,Q,{value:ye,defined:ye},{},{defined:function(e){return e.value instanceof Ro?e.value.options:e.value}}),coalesce:cs.setTypes(ae.coalesce,(function(e){var t=!0,n=[],r=function(e){if(t&&e){var r=e instanceof Ro,o=r?e.options:e;o instanceof Co&&o.options.forEach((function(e){var t=e instanceof Ro,o=t?e.options:e;r=r||t,n.some((function(e){return e.exactType(o)}))||n.push(o)})),t=t&&r,n.some((function(e){return e.exactType(o)}))||n.push(o)}};return r(e.a),r(e.b),r(e.c),r(e.d),r(e.e),n.length>1?t?gi.optional(new Co(n)):new Co(n):1===n.length?t?gi.optional(n[0]):n[0]:pe}),{a:ye,b:ye},{c:ye,d:ye,e:ye}),require:cs.setTypes(ae.require,(function(e){return e.value instanceof Ro?e.value.options:e.value||ye}),{value:function(e){return e.value||ye}}),ternary:cs.setTypes(ae.ternary,(function(e){return e.truthy&&e.falsy?gi.mergeMany([e.truthy,e.falsy]):e.truthy?e.truthy:e.falsy?e.falsy:ye}),{condition:Q,truthy:function(e){return e.truthy||ye},falsy:function(e){return e.falsy||ye}}),isValid:cs.setTypes(ae.isValid,Q,{value:ye}),isEqual:cs.setTypes(ae.isEqual,Q,{value:ye,test:ye}),isNotEqual:cs.setTypes(ae.isNotEqual,Q,{value:ye,test:ye}),isLess:cs.setTypes(ae.isLess,Q,{value:ye,test:ye}),isLessOrEqual:cs.setTypes(ae.isLessOrEqual,Q,{value:ye,test:ye}),isGreater:cs.setTypes(ae.isGreater,Q,{value:ye,test:ye}),isGreaterOrEqual:cs.setTypes(ae.isGreaterOrEqual,Q,{value:ye,test:ye}),asAny:cs.setTypes(ae.asAny,(function(e){return e.value||ye}),{value:ye}),asBoolean:cs.setTypes(ae.asBoolean,Q,{value:ye}),asColor:cs.setTypes(ae.asColor,si,{value:ye}),asDate:cs.setTypes(ae.asDate,Po,{value:ye}),asList:cs.setTypes(ae.asList,(function(e){return dn.forItem(e.value||ye)}),{value:ye}),asMap:cs.setTypes(ae.asMap,(function(e){return Ao.forItem(e.value||ye)}),{value:ye}),asNumber:cs.setTypes(ae.asNumber,_n,{value:ye}),asObject:cs.setTypes(ae.asObject,xt,{value:ye}),asText:cs.setTypes(ae.asText,Re,{value:ye}),asTuple:cs.setTypes(ae.asTuple,(function(e){return Tn.forItem([e.value||ye])}),{value:ye}),asSet:cs.setTypes(ae.asSet,(function(e){return mi.forItem(e.value||ye)}),{value:ye})},fs=Q.operations,ys={create:fs.setTypes(J.create,Q),maybe:fs.setTypes(J.maybe,(function(e){return gi.maybe(e.value,Q)}),{value:ye}),and:fs.setTypes(J.and,Q,{a:Q,b:Q}),or:fs.setTypes(J.or,Q,{a:Q,b:Q}),xor:fs.setTypes(J.xor,Q,{a:Q,b:Q}),not:fs.setTypes(J.not,Q,{a:Q}),cmp:fs.setTypes(J.cmp,_n,{value:Q,test:Q}),isValid:fs.setTypes(J.isValid,Q,{value:ye}),isTrue:fs.setTypes(J.isTrue,Q,{value:Q}),isFalse:fs.setTypes(J.isFalse,Q,{value:Q}),isEqual:fs.setTypes(J.isEqual,Q,{value:Q,test:Q}),isNotEqual:fs.setTypes(J.isNotEqual,Q,{value:Q,test:Q}),asAny:fs.setTypes(J.asAny,ye,{value:Q}),asBoolean:fs.setTypes(J.asBoolean,(function(e){return e.value||Q}),{value:Q}),asColor:fs.setTypes(J.asColor,si,{value:Q}),asDate:fs.setTypes(J.asDate,Po,{value:Q}),asList:fs.setTypes(J.asList,(function(e){return dn.forItem(e.value||Q)}),{value:Q}),asMap:fs.setTypes(J.asMap,(function(e){return Ao.forItem(e.value||Q)}),{value:Q}),asNumber:fs.setTypes(J.asNumber,_n,{value:Q}),asObject:fs.setTypes(J.asObject,xt,{value:Q}),asText:fs.setTypes(J.asText,Re,{value:Q}),asTuple:fs.setTypes(J.asTuple,(function(e){return Tn.forItem([e.value||Q])}),{value:Q}),asSet:fs.setTypes(J.asSet,(function(e){return mi.forItem(e.value||ye)}),{value:Q})},hs=si.operations,ds=new He({key:Re.baseType,value:Re.baseType,constants:new Map([["r","r"],["g","g"],["b","b"],["a","a"]])}),vs=new Co([si.baseType,new _n({})]),ms=new He({key:Re.baseType,value:Re.baseType,constants:new Map([["Best Fit: #rrggbb or rgb()","rgb:bestfit"],["#rgb","rgb:hexShort"],["#rrggbb","rgb:hex"],["#rrggbbaa","rgb:hexLong"],["rgb(r, g, b)","rgb:rgb"],["rgba(r, g, b, a)","rgb:rgba"],["hsl(h, s, l)","hsl:hsl"],["hsla(h, s, l, a)","hsl:hsla"]])}),gs=new He({key:Re.baseType,value:si.baseType,constants:new Map([["Transparent",{r:255,g:255,b:255,a:0}],["Alice Blue",{r:240,g:248,b:255,a:255}],["Antique White",{r:250,g:235,b:215,a:255}],["Aqua",{r:0,g:255,b:255,a:255}],["Aquamarine",{r:127,g:255,b:212,a:255}],["Azure",{r:240,g:255,b:255,a:255}],["Beige",{r:245,g:245,b:220,a:255}],["Bisque",{r:255,g:228,b:196,a:255}],["Black",{r:0,g:0,b:0,a:255}],["Blanched Almond",{r:255,g:235,b:205,a:255}],["Blue",{r:0,g:0,b:255,a:255}],["Blue Violet",{r:138,g:43,b:226,a:255}],["Brown",{r:165,g:42,b:42,a:255}],["Burly Wood",{r:222,g:184,b:135,a:255}],["Cadet Blue",{r:95,g:158,b:160,a:255}],["Chartreuse",{r:127,g:255,b:0,a:255}],["Chocolate",{r:210,g:105,b:30,a:255}],["Coral",{r:255,g:127,b:80,a:255}],["Cornflower Blue",{r:100,g:149,b:237,a:255}],["Cornsilk",{r:255,g:248,b:220,a:255}],["Crimson",{r:220,g:20,b:60,a:255}],["Cyan",{r:0,g:255,b:255,a:255}],["Dark Blue",{r:0,g:0,b:139,a:255}],["Dark Cyan",{r:0,g:139,b:139,a:255}],["Dark Goldenrod",{r:184,g:134,b:11,a:255}],["Dark Gray",{r:169,g:169,b:169,a:255}],["Dark Green",{r:0,g:100,b:0,a:255}],["Dark Khaki",{r:189,g:183,b:107,a:255}],["Dark Magenta",{r:139,g:0,b:139,a:255}],["Dark Olive Green",{r:85,g:107,b:47,a:255}],["Dark Orange",{r:255,g:140,b:0,a:255}],["Dark Orchid",{r:153,g:50,b:204,a:255}],["Dark Red",{r:139,g:0,b:0,a:255}],["Dark Salmon",{r:233,g:150,b:122,a:255}],["Dark Sea Green",{r:143,g:188,b:139,a:255}],["Dark Slate Blue",{r:72,g:61,b:139,a:255}],["Dark Slate Gray",{r:47,g:79,b:79,a:255}],["Dark Turquoise",{r:0,g:206,b:209,a:255}],["Dark Violet",{r:148,g:0,b:211,a:255}],["Deep Pink",{r:255,g:20,b:147,a:255}],["Deep Sky Blue",{r:0,g:191,b:255,a:255}],["Dim Gray",{r:105,g:105,b:105,a:255}],["Dodger Blue",{r:30,g:144,b:255,a:255}],["Firebrick",{r:178,g:34,b:34,a:255}],["Floral White",{r:255,g:250,b:240,a:255}],["Forest Green",{r:34,g:139,b:34,a:255}],["Fuchsia",{r:255,g:0,b:255,a:255}],["Gainsboro",{r:220,g:220,b:220,a:255}],["Ghost White",{r:248,g:248,b:255,a:255}],["Gold",{r:255,g:215,b:0,a:255}],["Goldenrod",{r:218,g:165,b:32,a:255}],["Gray",{r:128,g:128,b:128,a:255}],["Green",{r:0,g:128,b:0,a:255}],["Green Yellow",{r:173,g:255,b:47,a:255}],["Honeydew",{r:240,g:255,b:240,a:255}],["Hot Pink",{r:255,g:105,b:180,a:255}],["Indian Red",{r:205,g:92,b:92,a:255}],["Indigo",{r:75,g:0,b:130,a:255}],["Ivory",{r:255,g:255,b:240,a:255}],["Khaki",{r:240,g:230,b:140,a:255}],["Lavender",{r:230,g:230,b:250,a:255}],["Lavender Blush",{r:255,g:240,b:245,a:255}],["Lawn Green",{r:124,g:252,b:0,a:255}],["Lemon Chiffon",{r:255,g:250,b:205,a:255}],["Light Blue",{r:173,g:216,b:230,a:255}],["Light Coral",{r:240,g:128,b:128,a:255}],["Light Cyan",{r:224,g:255,b:255,a:255}],["Light Goldenrod Yellow",{r:250,g:250,b:210,a:255}],["Light Gray",{r:211,g:211,b:211,a:255}],["Light Green",{r:144,g:238,b:144,a:255}],["Light Pink",{r:255,g:182,b:193,a:255}],["Light Salmon",{r:255,g:160,b:122,a:255}],["Light Sea Green",{r:32,g:178,b:170,a:255}],["Light Sky Blue",{r:135,g:206,b:250,a:255}],["Light Slate Gray",{r:119,g:136,b:153,a:255}],["Light Steel Blue",{r:176,g:196,b:222,a:255}],["Light Yellow",{r:255,g:255,b:224,a:255}],["Lime",{r:0,g:255,b:0,a:255}],["LimeGreen",{r:50,g:205,b:50,a:255}],["Linen",{r:250,g:240,b:230,a:255}],["Magenta",{r:255,g:0,b:255,a:255}],["Maroon",{r:128,g:0,b:0,a:255}],["Medium Aquamarine",{r:102,g:205,b:170,a:255}],["Medium Blue",{r:0,g:0,b:205,a:255}],["Medium Orchid",{r:186,g:85,b:211,a:255}],["Medium Purple",{r:147,g:112,b:219,a:255}],["Medium Sea Green",{r:60,g:179,b:113,a:255}],["Medium Slate Blue",{r:123,g:104,b:238,a:255}],["Medium Spring Green",{r:0,g:250,b:154,a:255}],["Medium Turquoise",{r:72,g:209,b:204,a:255}],["Medium VioletRed",{r:199,g:21,b:133,a:255}],["Midnight Blue",{r:25,g:25,b:112,a:255}],["Mint Cream",{r:245,g:255,b:250,a:255}],["Misty Rose",{r:255,g:228,b:225,a:255}],["Moccasin",{r:255,g:228,b:181,a:255}],["Navajo White",{r:255,g:222,b:173,a:255}],["Navy",{r:0,g:0,b:128,a:255}],["Old Lace",{r:253,g:245,b:230,a:255}],["Olive",{r:128,g:128,b:0,a:255}],["Olive Drab",{r:107,g:142,b:35,a:255}],["Orange",{r:255,g:165,b:0,a:255}],["Orange Red",{r:255,g:69,b:0,a:255}],["Orchid",{r:218,g:112,b:214,a:255}],["Pale Goldenrod",{r:238,g:232,b:170,a:255}],["Pale Green",{r:152,g:251,b:152,a:255}],["Pale Turquoise",{r:175,g:238,b:238,a:255}],["Pale Violet Red",{r:219,g:112,b:147,a:255}],["Papaya Whip",{r:255,g:239,b:213,a:255}],["Peach Puff",{r:255,g:218,b:185,a:255}],["Peru",{r:205,g:133,b:63,a:255}],["Pink",{r:255,g:192,b:203,a:255}],["Plum",{r:221,g:160,b:221,a:255}],["Powder Blue",{r:176,g:224,b:230,a:255}],["Purple",{r:128,g:0,b:128,a:255}],["Red",{r:255,g:0,b:0,a:255}],["Rosy Brown",{r:188,g:143,b:143,a:255}],["Royal Blue",{r:65,g:105,b:225,a:255}],["Saddle Brown",{r:139,g:69,b:19,a:255}],["Salmon",{r:250,g:128,b:114,a:255}],["Sandy Brown",{r:244,g:164,b:96,a:255}],["Sea Green",{r:46,g:139,b:87,a:255}],["Sea Shell",{r:255,g:245,b:238,a:255}],["Sienna",{r:160,g:82,b:45,a:255}],["Silver",{r:192,g:192,b:192,a:255}],["Sky Blue",{r:135,g:206,b:235,a:255}],["Slate Blue",{r:106,g:90,b:205,a:255}],["Slate Gray",{r:112,g:128,b:144,a:255}],["Snow",{r:255,g:250,b:250,a:255}],["Spring Green",{r:0,g:255,b:127,a:255}],["Steel Blue",{r:70,g:130,b:180,a:255}],["Tan",{r:210,g:180,b:140,a:255}],["Teal",{r:0,g:128,b:128,a:255}],["Thistle",{r:216,g:191,b:216,a:255}],["Tomato",{r:255,g:99,b:71,a:255}],["Turquoise",{r:64,g:224,b:208,a:255}],["Violet",{r:238,g:130,b:238,a:255}],["Wheat",{r:245,g:222,b:179,a:255}],["White",{r:255,g:255,b:255,a:255}],["White Smoke",{r:245,g:245,b:245,a:255}],["Yellow",{r:255,g:255,b:0,a:255}],["Yellow Green",{r:154,g:205,b:50,a:255}]])}),Ts=new He({key:Re.baseType,value:Re.baseType,constants:new Map([["Multiply","multiply"],["Screen","screen"],["Overlay","overlay"],["Hard Light","hard"],["Soft Light","soft"],["Dodge","dodge"],["Burn","burn"],["Divide","divide"],["Addition","add"],["Subtract","sub"],["Difference","diff"],["Darken Only","darken"],["Lighten Only","lighten"]])}),bs={create:hs.setTypes(Wo.create,si),maybe:hs.setTypes(Wo.maybe,(function(e){return gi.maybe(e.value,si)}),{value:ye}),cmp:hs.setTypes(Wo.cmp,_n,{value:si,test:si}),copy:hs.setTypes(Wo.copy,si,{value:si}),build:hs.setTypes(Wo.build,si,{r:_n,g:_n,b:_n},{a:_n}),map:hs.setTypes(Wo.map,si,{value:si,r:_n,g:_n,b:_n},{a:_n},{value:_n,component:ds}),op:hs.setTypes(Wo.op,si,{value:si,test:si,r:_n,g:_n,b:_n},{a:_n},{value:_n,test:_n,component:ds}),clamp:hs.setTypes(Wo.clamp,si,{value:si}),add:hs.setTypes(Wo.add,si,{value:si,addend:vs},{alpha:Q}),adds:hs.setTypes(Wo.adds,si,{value:si,addend:vs,addendScale:vs},{alpha:Q}),sub:hs.setTypes(Wo.sub,si,{value:si,subtrahend:vs},{alpha:Q}),mul:hs.setTypes(Wo.mul,si,{value:si,multiplier:vs},{alpha:Q}),div:hs.setTypes(Wo.div,si,{value:si,divisor:vs},{alpha:Q}),mod:hs.setTypes(Wo.mod,si,{value:si,divisor:vs},{alpha:Q}),format:hs.setTypes(Wo.format,Re,{value:si,format:ms}),parse:hs.setTypes(Wo.parse,gi.optional(si),{value:ye}),lerp:hs.setTypes(Wo.lerp,si,{start:si,end:si,delta:_n}),lighten:hs.setTypes(Wo.lighten,si,{value:si,amount:_n}),darken:hs.setTypes(Wo.darken,si,{value:si,amount:_n}),toHSL:hs.setTypes(Wo.toHSL,ei.type,{value:si}),fromHSL:hs.setTypes(Wo.fromHSL,si,{value:ei.type}),luminance:hs.setTypes(Wo.luminance,_n,{value:si}),contrast:hs.setTypes(Wo.contrast,_n,{value:si,test:si}),invert:hs.setTypes(Wo.invert,si,{value:si},{alpha:Q}),opaque:hs.setTypes(Wo.opaque,si,{value:si}),alpha:hs.setTypes(Wo.alpha,si,{value:si,alpha:_n}),distance:hs.setTypes(Wo.distance,_n,{value:si,test:si}),named:hs.setTypes(Wo.named,si,{name:gs}),getName:hs.setTypes(Wo.getName,Re,{value:si}),blend:hs.setTypes(Wo.blend,si,{top:si,bottom:si,mode:Ts}),isValid:hs.setTypes(Wo.isValid,Q,{value:ye}),isEqual:hs.setTypes(Wo.isEqual,Q,{value:si,test:si},{epsilon:_n}),isNotEqual:hs.setTypes(Wo.isNotEqual,Q,{value:si,test:si},{epsilon:_n}),isLess:hs.setTypes(Wo.isLess,Q,{value:si,test:si}),isLessOrEqual:hs.setTypes(Wo.isLessOrEqual,Q,{value:si,test:si}),isGreater:hs.setTypes(Wo.isGreater,Q,{value:si,test:si}),isGreaterOrEqual:hs.setTypes(Wo.isGreaterOrEqual,Q,{value:si,test:si}),asAny:hs.setTypes(Wo.asAny,ye,{value:si}),asBoolean:hs.setTypes(Wo.asBoolean,Q,{value:si}),asColor:hs.setTypes(Wo.asColor,si,{value:si}),asDate:hs.setTypes(Wo.asDate,Po,{value:si}),asList:hs.setTypes(Wo.asList,(function(e){return dn.forItem(e.value||si)}),{value:si}),asMap:hs.setTypes(Wo.asMap,(function(e){return Ao.forItem(e.value||si)}),{value:si}),asNumber:hs.setTypes(Wo.asNumber,_n,{value:si}),asObject:hs.setTypes(Wo.asObject,(function(e){return e.value||si}),{value:si}),asText:hs.setTypes(Wo.asText,Re,{value:si}),asTuple:hs.setTypes(Wo.asTuple,(function(e){return Tn.forItem([e.value||si])}),{value:si}),asSet:hs.setTypes(Wo.asSet,(function(e){return mi.forItem(e.value||ye)}),{value:si})},xs=Po.operations,Os=new He({key:Re.baseType.newInstance(),value:Re.baseType.newInstance(),constants:new Map([["Timestamp","timestamp"],["Timestamp (seconds)","timestampSeconds"],["Millisecond","millis"],["Second","second"],["Minute","minute"],["Hour","hour"],["Day","day"],["Day of Month","dayOfMonth"],["Last Day of Month","lastDayOfMonth"],["Day of Year","dayOfYear"],["Day of Week","dayOfWeek"],["Week","week"],["Week of Month","weekOfMonth"],["Weekspan of Month","weekspanOfMonth"],["Full Week of Month","fullWeekOfMonth"],["Last Weekspan of Month","lastWeekspanOfMonth"],["Last Full Week of Month","lastFullWeekOfMonth"],["Week of Year","weekOfYear"],["Weekspan of Year","weekspanOfYear"],["Full Week of Year","fullWeekOfYear"],["Last Weekspan of Year","lastWeekspanOfYear"],["Last Full Week of Year","lastFullWeekOfYear"],["Month","month"],["Quarter","quarter"],["Year","year"],["Time Identifier","timeIdentifier"],["Day Identifier","dayIdentifier"],["Week Identifier","weekIdentifier"],["Month Identifier","monthIdentifier"],["Quarter Identifier","quarterIdentifier"]])}),Es=new He({key:Re.baseType.newInstance(),value:Re.baseType.newInstance(),constants:new Map([["Millisecond","millis"],["Second","second"],["Minute","minute"],["Hour","hour"],["Day","day"],["Week","week"],["Month","month"],["Quarter","quarter"],["Year","year"]])}),ws=new He({key:Re.baseType.newInstance(),value:Re.baseType.newInstance(),constants:new Map([["None","none"],["Floor","floor"],["Ceil","ceil"],["Round","round"],["Truncate","truncate"],["Up","up"],["Down","down"]])}),Ss={create:xs.setTypes(Eo.create,Po),now:xs.setTypes(Eo.now,Po),today:xs.setTypes(Eo.today,Po),tomorrow:xs.setTypes(Eo.tomorrow,Po),yesterday:xs.setTypes(Eo.yesterday,Po),maybe:xs.setTypes(Eo.maybe,(function(e){return gi.maybe(e.value,Q)}),{value:ye}),parse:xs.setTypes(Eo.parse,gi.optional(Po),{value:new Co([Po.baseType,_n.baseType,Re.baseType])},{parseAsUTC:Q}),fromText:xs.setTypes(Eo.fromText,gi.optional(Po),{value:Re},{parseAsUTC:Q}),fromTimestamp:xs.setTypes(Eo.fromTimestamp,Po,{value:_n}),fromTimestampSeconds:xs.setTypes(Eo.fromTimestampSeconds,Po,{value:_n}),min:xs.setTypes(Eo.min,Po,{value:Po,test:Po}),max:xs.setTypes(Eo.max,Po,{value:Po,test:Po}),get:xs.setTypes(Eo.get,_n,{value:Po,property:Os}),set:xs.setTypes(Eo.set,Po,{value:Po,property:Os,set:_n}),add:xs.setTypes(Eo.add,Po,{value:Po,unit:Es},{amount:_n}),sub:xs.setTypes(Eo.sub,Po,{value:Po,unit:Es},{amount:_n}),startOf:xs.setTypes(Eo.startOf,Po,{value:Po,unit:Es}),endOf:xs.setTypes(Eo.endOf,Po,{value:Po,unit:Es},{inclusive:Q}),daysInMonth:xs.setTypes(Eo.daysInMonth,_n,{value:Po}),daysInYear:xs.setTypes(Eo.daysInYear,_n,{value:Po}),weeksInYear:xs.setTypes(Eo.weeksInYear,_n,{value:Po}),copy:xs.setTypes(Eo.copy,Po,{value:Po}),cmp:xs.setTypes(Eo.cmp,_n,{value:Po,test:Po},{unit:Es}),diff:xs.setTypes(Eo.diff,_n,{value:Po,test:Po},{unit:Es,absolute:Q,adjust:ws}),timezoneOffset:xs.setTypes(Eo.timezoneOffset,_n,{value:Po}),toText:xs.setTypes(Eo.toText,Re,{value:Po,format:Re}),toISOText:xs.setTypes(Eo.toISOText,Re,{value:Po}),isValid:xs.setTypes(Eo.isValid,Q,{value:ye}),isEqual:xs.setTypes(Eo.isEqual,Q,{value:Po,test:Po},{unit:Es}),isBefore:xs.setTypes(Eo.isBefore,Q,{value:Po,test:Po},{unit:Es}),isBeforeOrEqual:xs.setTypes(Eo.isBeforeOrEqual,Q,{value:Po,test:Po},{unit:Es}),isAfter:xs.setTypes(Eo.isAfter,Q,{value:Po,test:Po},{unit:Es}),isAfterOrEqual:xs.setTypes(Eo.isAfterOrEqual,Q,{value:Po,test:Po},{unit:Es}),isBetween:xs.setTypes(Eo.isBetween,Q,{value:Po,start:Po,end:Po},{unit:Es,startInclusive:Q,endInclusive:Q}),isStartOf:xs.setTypes(Eo.isStartOf,Q,{value:Po,unit:Es}),isEndOf:xs.setTypes(Eo.isEndOf,Q,{value:Po,unit:Es},{inclusive:Q}),isDST:xs.setTypes(Eo.isDST,Q,{value:Po}),isLeapYear:xs.setTypes(Eo.isLeapYear,Q,{value:Po}),asAny:xs.setTypes(Eo.asAny,ye,{value:Po}),asBoolean:xs.setTypes(Eo.asBoolean,Q,{value:Po}),asColor:xs.setTypes(Eo.asColor,si,{value:Po}),asDate:xs.setTypes(Eo.asDate,(function(e){return e.value||Po}),{value:Po}),asList:xs.setTypes(Eo.asList,(function(e){return dn.forItem(e.value||Po)}),{value:Po}),asMap:xs.setTypes(Eo.asMap,(function(e){return Ao.forItem(e.value||Po)}),{value:Po}),asNumber:xs.setTypes(Eo.asNumber,_n,{value:Po}),asObject:xs.setTypes(Eo.asObject,xt,{value:Po}),asText:xs.setTypes(Eo.asText,Re,{value:Po}),asTuple:xs.setTypes(Eo.asTuple,(function(e){return Tn.forItem([e.value||Po])}),{value:Po}),asSet:xs.setTypes(Eo.asSet,(function(e){return mi.forItem(e.value||ye)}),{value:Po})};function Ps(e){var t,n,r={};try{for(var o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),i=o.next();!i.done;i=o.next()){var s=Ms(i.value,void 0,Ps);if(s instanceof xt){var a=s.options.props;for(var u in a){var p=a[u];r[u]=u in r&&p instanceof Ro?gi.mergeMany([p,r[u]]):p}}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return new xt({props:r})}function Ms(e,t,n){return e instanceof xt?e:e instanceof Et?e.getType():e instanceof He?Ms(e.options.value,t):e instanceof Co&&e.options.some((function(e){return Ms(e)}))&&n?n(e.options.filter((function(e){return Ms(e)}))):e instanceof Ro?Ms(e.options,t):t}var _s=dn.operations,Is=function(e,t){return e instanceof dn?e:t},Cs=function(e,t){return e instanceof dn?e.options.item:t},Ds=function(e){return Is(e.list,dn)},js=function(e){return Is(e.value,dn)},ks=function(e){return Is(e.list)?e.list.options.item:ye},As=function(e){return gi.optional(ks(e))},Ns=function(e){return Is(e.value)?e.value.options.item:ye},Rs=function(e){return e.reduce||e.initial||ye},Ls={list:Ds,value:ks,test:ks},qs={list:js,value:Ns,test:Ns},Fs={list:Ds,item:ks,index:_n},Vs={create:_s.setTypes(cn.create,dn),createLike:_s.setTypes(cn.createLike,Ds,{list:Ds}),createFor:_s.setTypes(cn.createFor,(function(e){return dn.forItem(e.item||ye)}),{item:function(e){return e.item||ye}}),maybe:_s.setTypes(cn.maybe,(function(e){return gi.maybe(e.value,dn)}),{value:ye}),build:_s.setTypes(cn.build,(function(e){return dn.forItem(e.item||ye)}),{count:_n,item:function(e){return e.item||ye}},{sameItem:Q},{list:function(e){return dn.forItem(e.item||ye)},index:_n,last:function(e){return e.item||ye},count:_n}),get:_s.setTypes(cn.get,As,{list:Ds,index:_n}),set:_s.setTypes(cn.set,As,{list:Ds,index:_n,value:ks}),add:_s.setTypes(cn.add,Ds,{list:Ds,item:ks}),addFirst:_s.setTypes(cn.addFirst,Ds,{list:Ds,item:ks}),addLast:_s.setTypes(cn.addLast,Ds,{list:Ds,item:ks}),insert:_s.setTypes(cn.insert,Ds,{list:Ds,item:ks,index:_n}),remove:_s.setTypes(cn.remove,_n,{list:Ds,item:ks,isEqual:Q},{},Ls),removeFirst:_s.setTypes(cn.removeFirst,As,{list:Ds}),removeLast:_s.setTypes(cn.removeLast,As,{list:Ds}),removeAt:_s.setTypes(cn.removeAt,As,{list:Ds,index:_n}),removeWhere:_s.setTypes(cn.removeWhere,Ds,{list:Ds,where:Q},{},Fs),clear:_s.setTypes(cn.clear,Ds,{list:Ds}),contains:_s.setTypes(cn.contains,Q,{list:Ds,item:ks,isEqual:Q},{},Ls),find:_s.setTypes(cn.find,As,{list:Ds,where:Q},{reverse:Q,start:_n},Fs),copy:_s.setTypes(cn.copy,Ds,{list:Ds},{deepCopy:ks},{copy:ks}),reverse:_s.setTypes(cn.reverse,Ds,{list:Ds}),exclude:_s.setTypes(cn.exclude,Ds,{list:Ds,exclude:Ds,isEqual:Q},{},Ls),overlap:_s.setTypes(cn.overlap,Ds,{list:Ds,overlap:Ds,isEqual:Q},{},Ls),sort:_s.setTypes(cn.sort,Ds,{list:Ds,compare:_n},{},Ls),shuffle:_s.setTypes(cn.shuffle,Ds,{list:Ds},{times:_n}),unique:_s.setTypes(cn.unique,Ds,{list:Ds,isEqual:Q},{},Ls),duplicates:_s.setTypes(cn.duplicates,Ds,{list:Ds,isEqual:Q},{once:Q},Ls),take:_s.setTypes(cn.take,Ds,{list:Ds,count:_n}),skip:_s.setTypes(cn.skip,Ds,{list:Ds,count:_n}),drop:_s.setTypes(cn.drop,Ds,{list:Ds,count:_n}),append:_s.setTypes(cn.append,Ds,{list:Ds,append:Ds}),prepend:_s.setTypes(cn.prepend,Ds,{list:Ds,prepend:Ds}),indexOf:_s.setTypes(cn.indexOf,_n,{list:Ds,item:ks,isEqual:Q},{start:_n},Ls),lastIndexOf:_s.setTypes(cn.lastIndexOf,_n,{list:Ds,item:ks,isEqual:Q},{start:_n},Ls),findIndex:_s.setTypes(cn.findIndex,_n,{list:Ds,where:Q},{reverse:Q,start:_n},Fs),last:_s.setTypes(cn.last,As,{list:Ds}),first:_s.setTypes(cn.first,As,{list:Ds}),count:_s.setTypes(cn.count,_n,{list:Ds}),randomList:_s.setTypes(cn.randomList,Ds,{list:Ds,count:_n}),random:_s.setTypes(cn.random,As,{list:Ds}),flatten:_s.setTypes(cn.flatten,(function(e){return e.list instanceof dn&&Ms(e.list.options.item,void 0,Ps)?Ms(e.list.options.item,void 0,Ps):e.list instanceof Tn&&e.list.options.some((function(e){return Ms(e,void 0,Ps)}))?Ps(e.list.options.filter((function(e){return Ms(e,void 0,Ps)}))):xt}),{list:function(e){return e.list instanceof dn&&Ms(e.list.options.item,void 0,Ps)||e.list instanceof Tn&&e.list.options.some((function(e){return Ms(e,void 0,Ps)}))?e.list:dn}}),join:_s.setTypes(cn.join,Re,{list:Ds},{delimiter:Re,toText:Re,prefix:Re,suffix:Re},Fs),each:_s.setTypes(cn.each,Ds,{list:Ds,each:ye},{reverse:Q},Fs),filter:_s.setTypes(cn.filter,Ds,{list:Ds,filter:Q},{},Fs),not:_s.setTypes(cn.not,Ds,{list:Ds,not:Q},{},Fs),map:_s.setTypes(cn.map,(function(e){return dn.forItem(e.transform||ye)}),{list:Ds,transform:function(e){return e.transform||ye}},{},Fs),split:_s.setTypes(cn.split,(function(e){return gi.object({pass:Ds(e),fail:Ds(e)})}),{list:Ds,pass:Q},{},Fs),reduce:_s.setTypes(cn.reduce,Rs,{list:Ds,reduce:Rs,initial:Rs},{},{list:Ds,item:ks,reduced:Rs,index:_n}),cmp:_s.setTypes(cn.cmp,Q,{value:js,test:js,compare:_n},{},qs),group:_s.setTypes(cn.group,(function(e){return dn.forItem(gi.object({by:e.by||ye,group:dn.forItem(e.getValue||ks(e))}))}),{list:Ds,by:function(e){return e.by||ye}},{getValue:function(e){return e.getValue||ks(e)}},Fs),toListMap:_s.setTypes(cn.toListMap,(function(e){return Ao.forItem(dn.forItem(e.getValue||ks(e)),e.getKey||ye)}),{list:Ds,getKey:function(e){return e.getKey||ye}},{getValue:function(e){return e.getValue||ks(e)}},Fs),toMap:_s.setTypes(cn.toMap,(function(e){return Ao.forItem(e.getValue||ks(e),e.getKey||ye)}),{list:Ds,getKey:function(e){return e.getKey||ye}},{getValue:function(e){return e.getValue||ks(e)}},Fs),joinInner:_s.setTypes(cn.joinInner,(function(e){return dn.forItem(e.join||ye)}),{a:function(e){return Is(e.a,dn)},b:function(e){return Is(e.b,dn)},on:Q,join:ye},{},{onA:function(e){return Cs(e.a,ye)},onB:function(e){return Cs(e.b,ye)},joinA:function(e){return Cs(e.a,ye)},joinB:function(e){return Cs(e.b,ye)}}),joinLeft:_s.setTypes(cn.joinLeft,(function(e){return dn.forItem(e.join||ye)}),{a:function(e){return Is(e.a,dn)},b:function(e){return Is(e.b,dn)},on:Q,join:ye},{},{onA:function(e){return Cs(e.a,ye)},onB:function(e){return Cs(e.b,ye)},joinA:function(e){return Cs(e.a,ye)},joinB:function(e){return gi.optional(Cs(e.b,ye))}}),joinRight:_s.setTypes(cn.joinRight,(function(e){return dn.forItem(e.join||ye)}),{a:function(e){return Is(e.a,dn)},b:function(e){return Is(e.b,dn)},on:Q,join:ye},{},{onA:function(e){return Cs(e.a,ye)},onB:function(e){return Cs(e.b,ye)},joinA:function(e){return gi.optional(Cs(e.a,ye))},joinB:function(e){return Cs(e.b,ye)}}),joinFull:_s.setTypes(cn.joinFull,(function(e){return dn.forItem(e.join||ye)}),{a:function(e){return Is(e.a,dn)},b:function(e){return Is(e.b,dn)},on:Q,join:ye},{},{onA:function(e){return Cs(e.a,ye)},onB:function(e){return Cs(e.b,ye)},joinA:function(e){return gi.optional(Cs(e.a,ye))},joinB:function(e){return gi.optional(Cs(e.b,ye))}}),joinCross:_s.setTypes(cn.joinCross,(function(e){return dn.forItem(e.join||ye)}),{a:function(e){return Is(e.a,dn)},b:function(e){return Is(e.b,dn)},join:ye},{},{joinA:function(e){return Cs(e.a,ye)},joinB:function(e){return Cs(e.b,ye)}}),min:_s.setTypes(cn.min,gi.optional(_n),{list:Ds,value:_n},{},Fs),max:_s.setTypes(cn.max,gi.optional(_n),{list:Ds,value:_n},{},Fs),sum:_s.setTypes(cn.sum,gi.optional(_n),{list:Ds,value:_n},{},Fs),avg:_s.setTypes(cn.avg,gi.optional(_n),{list:Ds,value:_n},{},Fs),std:_s.setTypes(cn.std,gi.optional(_n),{list:Ds,value:_n},{},Fs),variance:_s.setTypes(cn.variance,gi.optional(_n),{list:Ds,value:_n},{},Fs),median:_s.setTypes(cn.median,gi.optional(_n),{list:Ds,value:_n},{},Fs),bitand:_s.setTypes(cn.bitand,_n,{list:Ds,value:_n},{},Fs),bitor:_s.setTypes(cn.bitor,_n,{list:Ds,value:_n},{},Fs),bitxor:_s.setTypes(cn.bitxor,_n,{list:Ds,value:_n},{},Fs),isValid:_s.setTypes(cn.isValid,Q,{value:ye}),isEmpty:_s.setTypes(cn.isEmpty,Q,{list:Ds}),isNotEmpty:_s.setTypes(cn.isNotEmpty,Q,{list:Ds}),isEqual:_s.setTypes(cn.isEqual,Q,{list:Ds,test:Ds,isEqual:Q},{},Ls),isNotEqual:_s.setTypes(cn.isNotEqual,Q,{list:Ds,test:Ds,isEqual:Q},{},Ls),isLess:_s.setTypes(cn.isLess,Q,{value:js,test:js,compare:_n},{},qs),isLessOrEqual:_s.setTypes(cn.isLessOrEqual,Q,{value:js,test:js,compare:_n},{},qs),isGreater:_s.setTypes(cn.isGreater,Q,{value:js,test:js,compare:_n},{},qs),isGreaterOrEqual:_s.setTypes(cn.isGreaterOrEqual,Q,{value:js,test:js,compare:_n},{},qs),asAny:_s.setTypes(cn.asAny,ye,{value:js}),asBoolean:_s.setTypes(cn.asBoolean,Q,{value:js}),asColor:_s.setTypes(cn.asColor,si,{value:js}),asDate:_s.setTypes(cn.asDate,Po,{value:js}),asList:_s.setTypes(cn.asList,js,{value:js}),asMap:_s.setTypes(cn.asMap,(function(e){return Ao.forItem(Ns(e))}),{value:js}),asNumber:_s.setTypes(cn.asNumber,_n,{value:js}),asObject:_s.setTypes(cn.asObject,xt,{value:js}),asText:_s.setTypes(cn.asText,Re,{value:js}),asTuple:_s.setTypes(cn.asTuple,Tn,{value:js}),asSet:_s.setTypes(cn.asSet,(function(e){return mi.forItem(Ns(e))}),{value:js})},Ys=Ao.operations,Ws=function(e){return e instanceof Ao?e:void 0},Gs=function(e){return Ws(e.map)||Ao},Hs=function(e){return Ws(e.map)?e.map.options.value:ye},Bs=function(e){return gi.optional(Hs(e))},Us=function(e){return Ws(e.map)?e.map.options.key:Re},Js={map:Gs,key:Us,value:Hs},Ks=function(e){return Ws(e.value)||Ao},zs=function(e){return Ws(e.value)?e.value.options.value:ye},Xs={key:function(e){return Ws(e.value)?e.value.options.key:Re},value:zs,test:zs},$s={create:Ys.setTypes(Ve.create,Ao),createLike:Ys.setTypes(Ve.createLike,Gs,{map:Gs}),createFor:Ys.setTypes(Ve.createFor,(function(e){return Ao.forItem(e.value||ye,e.key||Re)}),{value:function(e){return e.value||ye}},{key:function(e){return e.key||Re}}),maybe:Ys.setTypes(Ve.maybe,(function(e){return gi.maybe(e.value,Ao)}),{value:ye}),get:Ys.setTypes(Ve.get,Bs,{map:Gs,key:Us}),set:Ys.setTypes(Ve.set,Bs,{map:Gs,key:Us,value:Hs},{},{existingValue:Hs}),has:Ys.setTypes(Ve.has,Q,{map:Gs,key:Us}),delete:Ys.setTypes(Ve.delete,Q,{map:Gs,key:Us}),keys:Ys.setTypes(Ve.keys,(function(e){return dn.forItem(Us(e))}),{map:Gs}),values:Ys.setTypes(Ve.values,(function(e){return dn.forItem(Hs(e))}),{map:Gs}),entries:Ys.setTypes(Ve.entries,(function(e){return gi.object({keys:dn.forItem(Us(e)),values:dn.forItem(Hs(e))})}),{map:Gs}),pairs:Ys.setTypes(Ve.pairs,(function(e){return dn.forItem(gi.object({key:Us(e),value:Hs(e)}))}),{map:Gs}),clear:Ys.setTypes(Ve.clear,Gs,{map:Gs}),count:Ys.setTypes(Ve.count,_n,{map:Gs}),cmp:Ys.setTypes(Ve.cmp,_n,{value:Ks,test:Ks,compare:_n},{},Xs),copy:Ys.setTypes(Ve.copy,Gs,{map:Gs},{deepCopy:Hs,deepCopyKey:Us},Js),map:Ys.setTypes(Ve.map,(function(e){return Ao.forItem(e.transform||Hs(e),e.transformKey||Us(e))}),{map:Gs},{transform:function(e){return e.transform||Hs(e)},transformKey:function(e){return e.transformKey||Us(e)}},Js),toPlainObject:Ys.setTypes(Ve.toPlainObject,xt,{map:Gs}),fromPlainObject:Ys.setTypes(Ve.fromPlainObject,(function(e){if(!(e.object instanceof xt))return Ao;var t=w(e.object.options.props);return Ao.forItem(gi.mergeMany(t,Re.baseType))}),{object:function(e){return e.object||xt}}),isValid:Ys.setTypes(Ve.isValid,Q,{value:ye}),isEqual:Ys.setTypes(Ve.isEqual,Q,{value:Ks,test:Ks,isEqual:Q},{},Xs),isNotEqual:Ys.setTypes(Ve.isNotEqual,Q,{value:Ks,test:Ks,isEqual:Q},{},Xs),isLess:Ys.setTypes(Ve.isLess,Q,{value:Ks,test:Ks,compare:_n},{},Xs),isLessOrEqual:Ys.setTypes(Ve.isLessOrEqual,Q,{value:Ks,test:Ks,compare:_n},{},Xs),isGreater:Ys.setTypes(Ve.isGreater,Q,{value:Ks,test:Ks,compare:_n},{},Xs),isGreaterOrEqual:Ys.setTypes(Ve.isGreaterOrEqual,Q,{value:Ks,test:Ks,compare:_n},{},Xs),asAny:Ys.setTypes(Ve.asAny,ye,{value:Ao}),asBoolean:Ys.setTypes(Ve.asBoolean,Q,{value:Ao}),asColor:Ys.setTypes(Ve.asColor,si,{value:Ao}),asDate:Ys.setTypes(Ve.asDate,Po,{value:Ao}),asList:Ys.setTypes(Ve.asList,(function(e){return dn.forItem(zs(e))}),{value:Ao}),asMap:Ys.setTypes(Ve.asMap,(function(e){return e.value||Ao}),{value:Ao}),asNumber:Ys.setTypes(Ve.asNumber,(function(e){return _n}),{value:Ao}),asObject:Ys.setTypes(Ve.asObject,xt,{value:Ao}),asText:Ys.setTypes(Ve.asText,Re,{value:Ao}),asTuple:Ys.setTypes(Ve.asTuple,(function(e){return Tn.forItem([e.value||Ao])}),{value:Ao}),asSet:Ys.setTypes(Ve.asSet,(function(e){return mi.forItem(zs(e))}),{value:Ao})},Qs=_n.operations,Zs=new He({key:Re.baseType.newInstance(),value:Re.baseType.newInstance(),constants:new Map([["has the bits","contain"],["does not have the bits","notcontain"],["has some of the bits","overlap"],["has none of the bits","none"],["has the same bits","equal"],["does not have the same bits","not"],["has all bits in","subset"]])}),ea={create:Qs.setTypes(sn.create,_n),pi:Qs.setTypes(sn.pi,_n),pi2:Qs.setTypes(sn.pi2,_n),piHalf:Qs.setTypes(sn.piHalf,_n),e:Qs.setTypes(sn.e,_n),sqrt2:Qs.setTypes(sn.sqrt2,_n),sqrt12:Qs.setTypes(sn.sqrt12,_n),ln2:Qs.setTypes(sn.ln2,_n),ln10:Qs.setTypes(sn.ln10,_n),log2e:Qs.setTypes(sn.log2e,_n),log10e:Qs.setTypes(sn.log10e,_n),add:Qs.setTypes(sn.add,_n,{value:_n,addend:_n}),sub:Qs.setTypes(sn.sub,_n,{value:_n,subtrahend:_n}),mul:Qs.setTypes(sn.mul,_n,{value:_n,multiplier:_n}),div:Qs.setTypes(sn.div,_n,{value:_n,divisor:_n}),mod:Qs.setTypes(sn.mod,_n,{value:_n,divisor:_n}),min:Qs.setTypes(sn.min,_n,{a:_n,b:_n}),max:Qs.setTypes(sn.max,_n,{a:_n,b:_n}),pow:Qs.setTypes(sn.pow,_n,{value:_n,exponent:_n}),atan2:Qs.setTypes(sn.atan2,_n,{x:_n,y:_n}),hypot:Qs.setTypes(sn.hypot,_n,{a:_n,b:_n}),choose:Qs.setTypes(sn.choose,_n,{n:_n,k:_n}),gcd:Qs.setTypes(sn.gcd,_n,{a:_n,b:_n}),bitAnd:Qs.setTypes(sn.bitAnd,_n,{a:_n,b:_n}),bitOr:Qs.setTypes(sn.bitOr,_n,{a:_n,b:_n}),bitXor:Qs.setTypes(sn.bitXor,_n,{a:_n,b:_n}),cmp:Qs.setTypes(sn.cmp,_n,{value:_n,test:_n}),maybe:Qs.setTypes(sn.maybe,(function(e){return gi.maybe(e.value,_n)}),{value:ye}),sqrt:Qs.setTypes(sn.sqrt,_n,{value:_n}),sq:Qs.setTypes(sn.sq,_n,{value:_n}),cbrt:Qs.setTypes(sn.cbrt,_n,{value:_n}),floor:Qs.setTypes(sn.floor,_n,{value:_n}),ceil:Qs.setTypes(sn.ceil,_n,{value:_n}),up:Qs.setTypes(sn.up,_n,{value:_n}),down:Qs.setTypes(sn.down,_n,{value:_n}),round:Qs.setTypes(sn.round,_n,{value:_n}),abs:Qs.setTypes(sn.abs,_n,{value:_n}),neg:Qs.setTypes(sn.neg,_n,{value:_n}),sign:Qs.setTypes(sn.sign,_n,{value:_n}),log:Qs.setTypes(sn.log,_n,{value:_n}),sin:Qs.setTypes(sn.sin,_n,{value:_n}),cos:Qs.setTypes(sn.cos,_n,{value:_n}),tan:Qs.setTypes(sn.tan,_n,{value:_n}),sinh:Qs.setTypes(sn.sinh,_n,{value:_n}),cosh:Qs.setTypes(sn.cosh,_n,{value:_n}),asin:Qs.setTypes(sn.asin,_n,{value:_n}),acos:Qs.setTypes(sn.acos,_n,{value:_n}),atan:Qs.setTypes(sn.atan,_n,{value:_n}),factorial:Qs.setTypes(sn.factorial,_n,{value:_n}),bitFlip:Qs.setTypes(sn.bitFlip,_n,{value:_n}),clamp:Qs.setTypes(sn.clamp,_n,{value:_n,min:_n,max:_n}),triangleHeight:Qs.setTypes(sn.triangleHeight,_n,{base:_n,side1:_n,side2:_n}),lerp:Qs.setTypes(sn.lerp,_n,{delta:_n,start:_n,end:_n}),rnd:Qs.setTypes(sn.rnd,_n,{},{min:_n,max:_n,whole:Q,includeMax:Q}),toBaseText:Qs.setTypes(sn.toBaseText,Re,{value:_n},{base:_n,minDigits:_n}),toText:Qs.setTypes(sn.toText,Re,{value:_n},{prefix:Re,suffix:Re,minPlaces:_n,maxPlaces:_n,useExponent:Q,thousandSeparator:Re}),toPercent:Qs.setTypes(sn.toPercent,Re,{value:_n},{minPlaces:_n,maxPlaces:_n,thousandSeparator:Re}),fromPercent:Qs.setTypes(sn.fromPercent,gi.optional(_n),{value:Re}),isValid:Qs.setTypes(sn.isValid,Q,{value:ye}),isZero:Qs.setTypes(sn.isZero,Q,{value:_n},{epsilon:_n}),isEqual:Qs.setTypes(sn.isEqual,Q,{value:_n,test:_n},{epsilon:_n}),isNotEqual:Qs.setTypes(sn.isNotEqual,Q,{value:_n,test:_n},{epsilon:_n}),isLess:Qs.setTypes(sn.isLess,Q,{value:_n,test:_n}),isLessOrEqual:Qs.setTypes(sn.isLessOrEqual,Q,{value:_n,test:_n}),isGreater:Qs.setTypes(sn.isGreater,Q,{value:_n,test:_n}),isGreaterOrEqual:Qs.setTypes(sn.isGreaterOrEqual,Q,{value:_n,test:_n}),isBetween:Qs.setTypes(sn.isBetween,Q,{value:_n,min:_n,max:_n},{minInclusive:Q,maxInclusive:Q}),isWhole:Qs.setTypes(sn.isWhole,Q,{value:_n},{epsilon:_n}),isDecimal:Qs.setTypes(sn.isDecimal,Q,{value:_n},{epsilon:_n}),isPositive:Qs.setTypes(sn.isPositive,Q,{value:_n}),isNegative:Qs.setTypes(sn.isNegative,Q,{value:_n}),isDivisible:Qs.setTypes(sn.isDivisible,Q,{value:_n,by:_n},{epsilon:_n}),bitCompare:Qs.setTypes(sn.bitCompare,Q,{value:_n,method:Zs,test:_n}),asAny:Qs.setTypes(sn.asAny,ye,{value:_n}),asBoolean:Qs.setTypes(sn.asBoolean,Q,{value:_n}),asColor:Qs.setTypes(sn.asColor,si,{value:_n}),asDate:Qs.setTypes(sn.asDate,Po,{value:_n}),asList:Qs.setTypes(sn.asList,(function(e){return dn.forItem(e.value||_n)}),{value:_n}),asMap:Qs.setTypes(sn.asMap,(function(e){return Ao.forItem(e.value||_n)}),{value:_n}),asNumber:Qs.setTypes(sn.asNumber,(function(e){return e.value||_n}),{value:_n}),asObject:Qs.setTypes(sn.asObject,xt,{value:_n}),asText:Qs.setTypes(sn.asText,Re,{value:_n}),asTuple:Qs.setTypes(sn.asTuple,(function(e){return Tn.forItem([e.value||_n])}),{value:_n}),asSet:Qs.setTypes(sn.asSet,(function(e){return mi.forItem(e.value||_n)}),{value:_n})},ta=xt.operations,na=function(e){return e.object||xt},ra={create:ta.setTypes(mt.create,na),maybe:ta.setTypes(mt.maybe,(function(e){return gi.maybe(e.value,xt)}),{value:ye}),has:ta.setTypes(mt.has,Q,{object:na,key:Re}),get:ta.setTypes(mt.get,ye,{object:na,key:Re}),set:ta.setTypes(mt.set,na,{object:na,key:Re,value:ye},{},{existingValue:ye}),delete:ta.setTypes(mt.delete,ye,{object:na,key:Re}),cmp:ta.setTypes(mt.cmp,_n,{value:xt,test:xt}),copy:ta.setTypes(mt.copy,na,{object:na}),merge:ta.setTypes(mt.merge,(function(e){return Ps(["a","b","c","d","e"].map((function(t){return e[t]})))}),{a:xt,b:xt},{c:xt,d:xt,e:xt}),isValid:ta.setTypes(mt.isValid,Q,{value:ye}),isEqual:ta.setTypes(mt.isEqual,Q,{value:xt,test:xt}),isNotEqual:ta.setTypes(mt.isNotEqual,Q,{value:xt,test:xt}),isLess:ta.setTypes(mt.isLess,Q,{value:xt,test:xt}),isLessOrEqual:ta.setTypes(mt.isLessOrEqual,Q,{value:xt,test:xt}),isGreater:ta.setTypes(mt.isGreater,Q,{value:xt,test:xt}),isGreaterOrEqual:ta.setTypes(mt.isGreaterOrEqual,Q,{value:xt,test:xt}),asAny:ta.setTypes(mt.asAny,ye,{value:xt}),asBoolean:ta.setTypes(mt.asBoolean,Q,{value:xt}),asColor:ta.setTypes(mt.asColor,si,{value:xt}),asDate:ta.setTypes(mt.asDate,Po,{value:xt}),asList:ta.setTypes(mt.asList,(function(e){return dn.forItem(e.value||xt)}),{value:xt}),asMap:ta.setTypes(mt.asMap,(function(e){return Ao.forItem(e.value||xt)}),{value:xt}),asNumber:ta.setTypes(mt.asNumber,_n,{value:xt}),asObject:ta.setTypes(mt.asObject,(function(e){return e.value||xt}),{value:xt}),asText:ta.setTypes(mt.asText,Re,{value:xt}),asTuple:ta.setTypes(mt.asTuple,(function(e){return Tn.forItem([e.value||xt])}),{value:xt}),asSet:ta.setTypes(mt.asSet,(function(e){return mi.forItem(e.value||xt)}),{value:xt})},oa=mi.operations,ia=function(e){return e instanceof mi?e:void 0},sa=function(e){return ia(e.set)||mi},aa=function(e){return ia(e.set)?e.set.options.value:ye},ua={set:sa,value:aa},pa=function(e){return ia(e.value)||mi},ca=function(e){return ia(e.value)?e.value.options.value:ye},la={create:oa.setTypes(ci.create,mi),createLike:oa.setTypes(ci.createLike,sa,{set:sa}),createFor:oa.setTypes(ci.createFor,(function(e){return dn.forItem(e.value||ye)}),{value:function(e){return e.value||ye}}),maybe:oa.setTypes(ci.maybe,(function(e){return gi.maybe(e.value,mi)}),{value:ye}),add:oa.setTypes(ci.add,sa,{set:sa,value:aa}),has:oa.setTypes(ci.has,Q,{set:sa,value:aa}),delete:oa.setTypes(ci.delete,Q,{set:sa,value:aa}),values:oa.setTypes(ci.values,(function(e){return dn.forItem(aa(e))}),{set:sa}),clear:oa.setTypes(ci.clear,sa,{set:sa}),count:oa.setTypes(ci.count,_n,{set:sa}),cmp:oa.setTypes(ci.cmp,_n,{value:pa,test:pa}),copy:oa.setTypes(ci.copy,sa,{set:sa},{deepCopy:aa},ua),map:oa.setTypes(ci.map,(function(e){return mi.forItem(e.transform||aa(e))}),{set:sa},{transform:function(e){return e.transform||aa(e)}},ua),isValid:oa.setTypes(ci.isValid,Q,{value:ye}),isEqual:oa.setTypes(ci.isEqual,Q,{value:pa,test:pa}),isNotEqual:oa.setTypes(ci.isNotEqual,Q,{value:pa,test:pa}),isLess:oa.setTypes(ci.isLess,Q,{value:pa,test:pa}),isLessOrEqual:oa.setTypes(ci.isLessOrEqual,Q,{value:pa,test:pa}),isGreater:oa.setTypes(ci.isGreater,Q,{value:pa,test:pa}),isGreaterOrEqual:oa.setTypes(ci.isGreaterOrEqual,Q,{value:pa,test:pa}),asAny:oa.setTypes(ci.asAny,ye,{value:mi}),asBoolean:oa.setTypes(ci.asBoolean,Q,{value:mi}),asColor:oa.setTypes(ci.asColor,si,{value:mi}),asDate:oa.setTypes(ci.asDate,Po,{value:mi}),asList:oa.setTypes(ci.asList,(function(e){return dn.forItem(ca(e))}),{value:mi}),asMap:oa.setTypes(ci.asMap,(function(e){return Ao.forItem(ca(e),ca(e))}),{value:mi}),asNumber:oa.setTypes(ci.asNumber,(function(e){return _n}),{value:mi}),asObject:oa.setTypes(ci.asObject,xt,{value:mi}),asText:oa.setTypes(ci.asText,Re,{value:mi}),asTuple:oa.setTypes(ci.asTuple,(function(e){return Tn.forItem([e.value||mi])}),{value:mi}),asSet:oa.setTypes(ci.asSet,(function(e){return e.value||mi}),{value:mi})},fa=Re.operations,ya=dn.forItem(Re),ha=gi.object({index:_n,lastIndex:_n,input:Re,groups:ya}),da={create:fa.setTypes(je.create,Re),uuid:fa.setTypes(je.uuid,Re),maybe:fa.setTypes(je.maybe,(function(e){return gi.maybe(e.value,Re)}),{value:ye}),append:fa.setTypes(je.append,Re,{value:Re,append:Re}),prepend:fa.setTypes(je.prepend,Re,{value:Re,prepend:Re}),lower:fa.setTypes(je.lower,Re,{value:Re}),upper:fa.setTypes(je.upper,Re,{value:Re}),char:fa.setTypes(je.char,Re,{value:Re,index:_n},{outside:Re}),replace:fa.setTypes(je.replace,Re,{value:Re,find:Re,replace:Re}),repeat:fa.setTypes(je.repeat,Re,{value:Re,times:_n}),split:fa.setTypes(je.split,ya,{value:Re,by:Re},{limit:_n}),chars:fa.setTypes(je.chars,ya,{value:Re}),sub:fa.setTypes(je.sub,Re,{value:Re},{start:_n,end:_n}),indexOf:fa.setTypes(je.indexOf,_n,{value:Re,search:Re},{start:_n}),lastIndexOf:fa.setTypes(je.lastIndexOf,_n,{value:Re,search:Re},{start:_n}),trim:fa.setTypes(je.trim,Re,{value:Re},{start:Q,end:Q}),startsWith:fa.setTypes(je.startsWith,Q,{value:Re,test:Re}),endsWith:fa.setTypes(je.endsWith,Q,{value:Re,test:Re}),soundex:fa.setTypes(je.soundex,Re,{value:Re},{max:_n,min:_n}),metaphone:fa.setTypes(je.metaphone,Re,{value:Re}),distance:fa.setTypes(je.distance,_n,{value:Re,test:Re}),length:fa.setTypes(je.length,_n,{value:Re}),compare:fa.setTypes(je.compare,_n,{value:Re,test:Re},{ignoreCase:Q}),like:fa.setTypes(je.like,Q,{value:Re,pattern:Re},{ignoreCase:Q}),pad:fa.setTypes(je.pad,Re,{value:Re,padding:Re,min:_n},{max:_n,append:Q}),regexTest:fa.setTypes(je.regexTest,Q,{value:Re,regex:Re},{ignoreCase:Q,multiline:Q}),regexSplit:fa.setTypes(je.regexSplit,ya,{value:Re,regex:Re},{limit:_n,ignoreCase:Q,multiline:Q}),regexMatch:fa.setTypes(je.regexMatch,ya,{value:Re,regex:Re},{ignoreCase:Q,multiline:Q}),regexMatchAll:fa.setTypes(je.regexMatchAll,dn.forItem(ha),{value:Re,regex:Re},{ignoreCase:Q,multiline:Q}),regexReplace:fa.setTypes(je.regexReplace,Re,{value:Re,regex:Re,replacement:Re},{all:Q,ignoreCase:Q,multiline:Q}),regexReplaceDynamic:fa.setTypes(je.regexReplaceDynamic,Re,{value:Re,regex:Re,replace:Re},{all:Q,ignoreCase:Q,multiline:Q},{match:ha}),regexIndexOf:fa.setTypes(je.regexIndexOf,_n,{value:Re,regex:Re},{ignoreCase:Q,multiline:Q}),base64:fa.setTypes(je.base64,Re,{value:Re}),unbase64:fa.setTypes(je.unbase64,Re,{value:Re}),encodeURI:fa.setTypes(je.encodeURI,Re,{value:Re}),decodeURI:fa.setTypes(je.decodeURI,Re,{value:Re}),encodeURIComponent:fa.setTypes(je.encodeURIComponent,Re,{value:Re}),decodeURIComponent:fa.setTypes(je.decodeURIComponent,Re,{value:Re}),md5:fa.setTypes(je.md5,Re,{value:Re}),encrypt:fa.setTypes(je.encrypt,Re,{value:Re,secret:Re}),decrypt:fa.setTypes(je.decrypt,Re,{value:Re,secret:Re}),toNumber:fa.setTypes(je.toNumber,_n,{value:Re},{invalidValue:_n}),isValid:fa.setTypes(je.isValid,Q,{value:ye}),isEmpty:fa.setTypes(je.isEmpty,Q,{value:Re}),isNotEmpty:fa.setTypes(je.isNotEmpty,Q,{value:Re}),isEqual:fa.setTypes(je.isEqual,Q,{a:Re,b:Re},{ignoreCase:Q}),isNotEqual:fa.setTypes(je.isNotEqual,Q,{a:Re,b:Re},{ignoreCase:Q}),isLess:fa.setTypes(je.isLess,Q,{value:Re,test:Re},{ignoreCase:Q}),isLessOrEqual:fa.setTypes(je.isLessOrEqual,Q,{value:Re,test:Re},{ignoreCase:Q}),isGreater:fa.setTypes(je.isGreater,Q,{value:Re,test:Re},{ignoreCase:Q}),isGreaterOrEqual:fa.setTypes(je.isGreaterOrEqual,Q,{value:Re,test:Re},{ignoreCase:Q}),isLower:fa.setTypes(je.isLower,Q,{value:Re}),isUpper:fa.setTypes(je.isUpper,Q,{value:Re}),isUuid:fa.setTypes(je.isUuid,Q,{value:Re}),asAny:fa.setTypes(je.asAny,ye,{value:Re}),asBoolean:fa.setTypes(je.asBoolean,Q,{value:Re}),asColor:fa.setTypes(je.asColor,si,{value:Re}),asDate:fa.setTypes(je.asDate,Po,{value:Re}),asList:fa.setTypes(je.asList,(function(e){return dn.forItem(e.value||Re)}),{value:Re}),asMap:fa.setTypes(je.asMap,(function(e){return Ao.forItem(e.value||Re)}),{value:Re}),asNumber:fa.setTypes(je.asNumber,_n,{value:Re}),asObject:fa.setTypes(je.asObject,xt,{value:Re}),asText:fa.setTypes(je.asText,(function(e){return e.value||Re}),{value:Re}),asTuple:fa.setTypes(je.asTuple,(function(e){return Tn.forItem([e.value||Re])}),{value:Re}),asSet:fa.setTypes(je.asSet,(function(e){return mi.forItem(e.value||Re)}),{value:Re})},va=Tn.operations,ma={create:va.setTypes(tn.create,Tn),maybe:va.setTypes(tn.maybe,(function(e){return gi.maybe(e.value,Tn)}),{value:ye}),cmp:va.setTypes(tn.cmp,_n,{value:Tn,test:Tn}),copy:va.setTypes(tn.copy,Tn,{value:Tn}),build:va.setTypes(tn.build,(function(e){var t,n,r=[],o=!1;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(["a","b","c","d","e"]),s=i.next();!s.done;s=i.next()){var a=e[s.value];a&&(a instanceof Tn?r=r.concat(a.options):a instanceof dn?(o=!0,r.push(a.options.item)):r.push(a))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o?dn.forItem(gi.mergeMany(r,pe.baseType)):new Tn(r)}),{a:ye,b:ye},{c:ye,d:ye,e:ye}),get:va.setTypes(tn.get,ye,{value:Tn,index:_n}),set:va.setTypes(tn.set,ye,{value:Tn,index:_n,element:ye}),isValid:va.setTypes(tn.isValid,Q,{value:ye}),isEqual:va.setTypes(tn.isEqual,Q,{value:Tn,test:Tn}),isNotEqual:va.setTypes(tn.isNotEqual,Q,{value:Tn,test:Tn}),isLess:va.setTypes(tn.isLess,Q,{value:Tn,test:Tn}),isLessOrEqual:va.setTypes(tn.isLessOrEqual,Q,{value:Tn,test:Tn}),isGreater:va.setTypes(tn.isGreater,Q,{value:Tn,test:Tn}),isGreaterOrEqual:va.setTypes(tn.isGreaterOrEqual,Q,{value:Tn,test:Tn}),asAny:va.setTypes(tn.asAny,ye,{value:Tn}),asBoolean:va.setTypes(tn.asBoolean,Q,{value:Tn}),asColor:va.setTypes(tn.asColor,si,{value:Tn}),asDate:va.setTypes(tn.asDate,Po,{value:Tn}),asList:va.setTypes(tn.asList,(function(e){return dn.forItem(e.value||Tn)}),{value:Tn}),asMap:va.setTypes(tn.asMap,(function(e){return Ao.forItem(e.value||Tn)}),{value:Tn}),asNumber:va.setTypes(tn.asNumber,_n,{value:Tn}),asObject:va.setTypes(tn.asObject,xt,{value:Tn}),asText:va.setTypes(tn.asText,Re,{value:Tn}),asTuple:va.setTypes(tn.asTuple,(function(e){return e.value||Tn}),{value:Tn}),asSet:va.setTypes(tn.asSet,(function(e){return mi.forItem(e.value||Tn)}),{value:Tn})},ga=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ta=function(){function e(e,t){void 0===t&&(t={}),this.cached={},this.sections=[],this.add(e),this.escapes=t}return e.prototype.add=function(e,t){if(o(e))t&&(this.getSection(e.length).formats[e]=t);else for(var n in e)this.getSection(n.length).formats[n]=e[n];return this},e.prototype.getSection=function(e){var t,n,r=this.sections.length-e,o=this.sections[r];if(o&&o.size===e)return o;try{for(var i=ga(this.sections),s=i.next();!s.done;s=i.next()){var a=s.value;if(a.size===e)return a}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}var u={size:e,formats:{}};return this.sections.push(u),this.sortBySize(),u},e.prototype.getFormatter=function(e,t){if(void 0===t&&(t=!1),e in this.cached)return this.cached[e];for(var n,r=this.sections,o=[],i="",s=function(t){var s=a.getEscaped(e,t);if(!1!==s){var u=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(s,2),p=u[0],c=u[1];return i+=p,n=t=c-1,"continue"}for(var l=!1,f=0;f<r.length&&!l;f++){var y=r[f],h=e.substring(t,t+y.size);if(h.length===y.size){var d=y.formats[h];d&&(o.push(d),t+=y.size-1,l=!0)}}if(l){if(i){var v=i;o.splice(o.length-1,0,(function(){return v})),i=""}}else i+=e.charAt(t);n=t},a=this,u=0;u<e.length;u++)s(u),u=n;i&&o.push((function(){return i}));var p=function(e){var t,n,r="";try{for(var i=ga(o),s=i.next();!s.done;s=i.next())r+=(0,s.value)(e)}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r};return t&&(this.cached[e]=p),p},e.prototype.format=function(e,t,n){return void 0===n&&(n=!1),this.getFormatter(e,n)(t)},e.prototype.sortBySize=function(){this.sections.sort((function(e,t){return t.size-e.size}))},e.prototype.getEscaped=function(e,t){var n=e.charAt(t),r=this.escapes[n];if(!r)return!1;var o=r.start,i=r.end,s=r.startEscape,a=r.endEscape;if(e.substring(t,t+o.length)!==o)return!1;var u=t-s.indexOf(o);if(e.substring(u,u+s.length)===s)return!1;t+=o.length;var p=a.indexOf(i),c=e.indexOf(i,t),l=e.substring(t,c);for(t=c-p;-1!==c&&e.substring(t,t+a.length)===a;)l=l.substring(0,l.length-p),l+=i,t+=a.length,c=e.indexOf(i,t),l+=e.substring(t,c),t=c-p;return-1!==c&&[l,c+i.length]},e}(),ba=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},xa=new Ta({M:function(e){return ba(e,1)[0].getMonth()+1+""},Mo:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(n.getMonth()+1)},MM:function(e){return I(ba(e,1)[0].getMonth()+1,2)},MMm:function(e){var t=ba(e,2),n=t[0];return t[1].months[3][n.getMonth()]},MMM:function(e){var t=ba(e,2),n=t[0];return t[1].months[2][n.getMonth()]},MMMm:function(e){var t=ba(e,2),n=t[0];return t[1].months[1][n.getMonth()]},MMMM:function(e){var t=ba(e,2),n=t[0];return t[1].months[0][n.getMonth()]},Q:function(e){return qr(ba(e,1)[0])+1+""},Qo:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(qr(n)+1)},D:function(e){return ba(e,1)[0].getDate()+""},Do:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(n.getDate())},DD:function(e){return I(ba(e,1)[0].getDate(),2)},DDD:function(e){return Ir(ba(e,1)[0])+""},DDDo:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(Ir(n))},DDDD:function(e){return I(Ir(ba(e,1)[0]),3)},d:function(e){return ba(e,1)[0].getDay()+""},do:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(n.getDay())},dd:function(e){var t=ba(e,2),n=t[0];return t[1].weekdays[3][n.getDay()]},ddd:function(e){var t=ba(e,2),n=t[0];return t[1].weekdays[2][n.getDay()]},dddd:function(e){var t=ba(e,2),n=t[0];return t[1].weekdays[0][n.getDay()]},e:function(e){return _r(ba(e,1)[0])+""},E:function(e){return _r(ba(e,1)[0])+1+""},eo:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(_r(n))},Eo:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(_r(n)+1)},w:function(e){return hr(ba(e,1)[0])+""},wo:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(hr(n))},ww:function(e){return I(hr(ba(e,1)[0]),2)},W:function(e){return yr(ba(e,1)[0])+""},Wo:function(e){var t=ba(e,2),n=t[0];return t[1].suffix(yr(n))},WW:function(e){return I(yr(ba(e,1)[0]),2)},Y:function(e){return ba(e,1)[0].getFullYear()+""},YY:function(e){return I(ba(e,1)[0].getFullYear()%100,2)},YYYY:function(e){return I(ba(e,1)[0].getFullYear(),4,10)},gg:function(e){return I(ba(e,1)[0].getFullYear()%100,2)},gggg:function(e){return I(ba(e,1)[0].getFullYear(),4,10)},GG:function(e){return I(ba(e,1)[0].getFullYear()%100,2)},GGGG:function(e){return I(ba(e,1)[0].getFullYear(),4,10)},a:function(e){var t=ba(e,2),n=t[0],r=t[1];return n.getHours()<12?r.am:r.pm},A:function(e){var t=ba(e,2),n=t[0],r=t[1];return n.getHours()<12?r.am.toUpperCase():r.pm.toUpperCase()},H:function(e){return ba(e,1)[0].getHours()+""},HH:function(e){return I(ba(e,1)[0].getHours(),2)},h:function(e){return(ba(e,1)[0].getHours()%12||12)+""},hh:function(e){return I(ba(e,1)[0].getHours()%12||12,2)},k:function(e){return ba(e,1)[0].getHours()+1+""},kk:function(e){return I(ba(e,1)[0].getHours()+1,2)},m:function(e){return ba(e,1)[0].getMinutes()+""},mm:function(e){return I(ba(e,1)[0].getMinutes(),2)},s:function(e){return ba(e,1)[0].getSeconds()+""},ss:function(e){return I(ba(e,1)[0].getSeconds(),2)},S:function(e){return I(ba(e,1)[0].getMilliseconds(),3,1)},SS:function(e){return I(ba(e,1)[0].getMilliseconds(),3,2)},SSS:function(e){return I(ba(e,1)[0].getMilliseconds(),3)},SSSS:function(e){return I(ba(e,1)[0].getMilliseconds(),3)+"0"},SSSSS:function(e){return I(ba(e,1)[0].getMilliseconds(),3)+"00"},SSSSSS:function(e){return I(ba(e,1)[0].getMilliseconds(),3)+"000"},SSSSSSS:function(e){return I(ba(e,1)[0].getMilliseconds(),3)+"0000"},SSSSSSSS:function(e){return I(ba(e,1)[0].getMilliseconds(),3)+"00000"},SSSSSSSSS:function(e){return I(ba(e,1)[0].getMilliseconds(),3)+"000000"},z:function(e){return ba(e,1)[0].toLocaleTimeString("en-us",{timeZoneName:"short"}).split(" ")[2]},zz:function(e){return ba(e,1)[0].toLocaleTimeString("en-us",{timeZoneName:"long"}).split(" ")[2]},Z:function(e){return Ea(ba(e,1)[0],":")},ZZ:function(e){return Ea(ba(e,1)[0],"")},X:function(e){var t=ba(e,1)[0];return Math.floor(t.valueOf()/1e3)+""},x:function(e){return ba(e,1)[0].valueOf()+""},LT:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatLT,[n,r])},LTS:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatLTS,[n,r])},L:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatL,[n,r])},l:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatl,[n,r])},LL:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatLL,[n,r])},ll:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatll,[n,r])},LLL:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatLLL,[n,r])},lll:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatlll,[n,r])},LLLL:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatLLLL,[n,r])},llll:function(e){var t=ba(e,2),n=t[0],r=t[1];return Oa.format(r.formatllll,[n,r])}},{"[":{start:"[",startEscape:"\\[",end:"]",endEscape:"\\]"},"'":{start:"'",startEscape:"''",end:"'",endEscape:"''"}}),Oa=xa;function Ea(e,t){var n=Cr(e),r=Math.floor(Math.abs(n)/100),o=Math.abs(n)%100;return(n<0?"-":"+")+I(r,2)+t+I(o,2)}}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(16)})()}));
//# sourceMappingURL=expangine-runtime.js.map