!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("expangine-runtime",[],n):"object"==typeof exports?exports["expangine-runtime"]=n():t["expangine-runtime"]=n()}(this,function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";e.r(n);var r=function(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}};function o(t){return"number"==typeof t&&isFinite(t)}function i(t){return"string"==typeof t}function u(t){return Array.isArray(t)}function p(t){return t instanceof Date}function c(t){return t instanceof Map}function s(t){return"boolean"==typeof t}function a(t){return"function"==typeof t}function f(t){return"object"==typeof t&&!Array.isArray(t)}function y(t){return void 0===t}function l(t,n){return t.constructor===n.constructor}function d(t){if(u(t))return 0===t.length;if(f(t)){for(var n in t)return!1;return!0}return null==t}function h(t,n,e){void 0===e&&(e=function(t){return t});var r={};for(var o in t){var i=t[o];r[e(o,i)]=n(i,o)}return r}function v(t){var n,e,o=[];try{for(var i=r(t),u=i.next();!u.done;u=i.next()){var p=u.value;o.push(p)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(e=i.return)&&e.call(i)}finally{if(n)throw n.error}}return o}function m(t,n){return 0===t&&0===n?0:t<n?1:-1}var b={boolean:0,number:1,bigint:2,string:3,symbol:4,object:5,undefined:6,function:7};function _(t,n){if(t===n)return 0;var e=typeof t,r=typeof n;if(e!==r)return b[e]-b[r];var o=u(t),i=u(n);if(o!==i)return(o?1:0)-(i?1:0);if(o)return t.length-n.length;switch(e){case"object":var p=t instanceof Date,c=n instanceof Date;if(p!==c)return(p?1:0)-(c?1:0);if(p)return t.getTime()-n.getTime();var s=0,a=0;for(var f in t)f in n||s++;for(var f in n)f in t||a++;for(var f in t)if(f in n){var y=_(t[f],n[f]);y<0&&s++,y>0&&a++}return m(s,a);case"bigint":case"number":return t-n;case"boolean":return(t?1:0)-(n?1:0);case"string":return t.localeCompare(n)}return 0}function g(t,n,e){var o,i;if(void 0===n&&(n=[]),void 0===e&&(e=[]),!t)return t;if(p(t))return new Date(t.getTime());if("object"==typeof t){var c=n.indexOf(t);if(-1!==c)return e[c];if(u(t)){var s=[];n.push(t),e.push(s);try{for(var a=r(t),f=a.next();!f.done;f=a.next()){var y=f.value;s.push(g(y,n,e))}}catch(t){o={error:t}}finally{try{f&&!f.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return s}var l={};for(var d in n.push(t),e.push(l),t)l[d]=g(t[d],n,e);return l}return t}function x(t,n,e){return void 0===e&&(e=n),w(t+"",n,"0",!0).substring(0,e)}function w(t,n,e,r){for(;t.length<n;)r?t=e+t:t+=e;return t}var O,T=function(){function t(t){this.options=t}return t.fromInput=function(n){return n instanceof t?n:n.baseType},t.prototype.getOperations=function(t){var n=this;return this.operations||(this.operations=h(t.operations.map,function(t){return t(n)})),this.operations},t}(),C=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u},j=function(){function t(t){this.prefix=t,this.map=Object.create(null)}return t.prototype.getBuilder=function(t){return this.map[t]||this.map[this.prefix+t]},t.prototype.get=function(t,n){return this.getBuilder(t)(n)},t.prototype.set=function(t,n,e,r,o,i){void 0===n&&(n={});var u=this.prefix+t,p=n.mutates||[],c=n.complexity||0,s={id:u,mutates:p,complexity:c,returnType:e,params:r,optional:o,scope:i},a=i?h(i,function(t,n){return n}):void 0;return this.put(u,c,a,function(){return s})},t.prototype.build=function(t,n,e,r,o){void 0===n&&(n={});var i=this.prefix+t,u=n.mutates||[],p=n.complexity||0;return this.put(i,p,r,function(t){var n=C(e(t,o),4),r=n[0],c=n[1],s=n[2],a=n[3];return{id:i,mutates:u,complexity:p,returnType:r,params:c,optional:s,scope:a,generics:o}})},t.prototype.put=function(t,n,e,r){var o=r;return o.id=t,o.complexity=n,o.scopeDefaults=e,this.map[t]=o,o},t}(),E=function(){function t(t){this.id=t}return t.hasConstant=function(t,n){return t instanceof S&&t.value===n},t.isConstant=function(t){return t instanceof S},t}(),P=(O=function(t,n){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}O(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),S=function(t){function n(e){var r=t.call(this,n.id)||this;return r.value=e,r}return P(n,t),n.decode=function(t,e){return new n(t[1])},n.encode=function(t){return u(t.value)?[this.id,t.value]:t.value},n.prototype.getComplexity=function(){return 0},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="constant",n}(E),A=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),M=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return A(n,t),n.decode=function(t,n){return this.baseType},n.encode=function(t){return this.id},n.describe=function(t,n){return this.baseType},n.prototype.merge=function(t,n){},n.prototype.getSubTypes=function(){return null},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return!0},n.prototype.isValid=function(t){return!0},n.prototype.normalize=function(t){return t},n.prototype.encode=function(){return n.encode(this)},n.id="any",n.operations=new j("any:"),n.baseType=new n({}),n.describePriority=0,n}(T),k=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),I=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return k(n,t),n.decode=function(t,e){return new n(e.getType(t[1]))},n.encode=function(t){return[this.id,t.options.encode()]},n.describe=function(t,n){return null},n.prototype.getOperations=function(t){return this.operations||(this.operations=this.options.getOperations(t)),this.operations},n.prototype.merge=function(t,n){},n.prototype.getSubTypes=function(){return this.options.getSubTypes()},n.prototype.getExactType=function(t){return this.options.getExactType(t)},n.prototype.isCompatible=function(t){return t instanceof n?this.options.isCompatible(t.options):this.options.isCompatible(t)},n.prototype.isValid=function(t){return null==t||this.options.isCompatible(t)},n.prototype.normalize=function(t){return null==t?t:this.options.normalize(t)},n.prototype.encode=function(){return n.encode(this)},n.id="?",n.operations=new j("?:"),n.baseType=new n(M.baseType),n.describePriority=-1,n}(T),V=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),D=function(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}},U=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return V(n,t),n.decode=function(t,e){return new n(t[1].map(function(t){return e.getType(t)}))},n.encode=function(t){var n=t.options.map(function(t){return t.encode()});return[this.id,n]},n.describe=function(t,n){return null},n.prototype.getOperations=function(t){var n=this;return this.operations||(this.operations={},this.options.forEach(function(t){var e=t.getOperations(t.constructor);for(var r in e)n.operations[r]=e[r]})),this.operations},n.prototype.forMany=function(t,n){var e,r,o=this.options;try{for(var i=D(o),u=i.next();!u.done;u=i.next()){var p=n(u.value);if(void 0!==p)return p}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return t},n.prototype.merge=function(t,n){},n.prototype.getSubTypes=function(){var t=this;return this.subs||(this.subs={},this.options.forEach(function(n){var e=n.getSubTypes();e&&Object.assign(t.subs,e)})),this.subs},n.prototype.getExactType=function(t){return this.forMany(this,function(n){return n.isValid(t)?n:void 0})},n.prototype.isCompatible=function(t){return this.forMany(!1,function(n){return!!n.isCompatible(t)||void 0})},n.prototype.isValid=function(t){return this.forMany(!1,function(n){return!!n.isValid(t)||void 0})},n.prototype.normalize=function(t){return this.forMany(t,function(n){return n.isValid(t)?n.normalize(t):void 0})},n.prototype.encode=function(){return n.encode(this)},n.id="many",n.operations=new j("many:"),n.baseType=new n([M.baseType]),n.describePriority=-1,n}(T),z=function(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}},R=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u},N=function(){function t(t){var n=this;this.types=Object.create(null),this.expressions=Object.create(null),this.parsers=Object.create(null),this.describers=[],this.operations=new j(""),t&&(t.types&&t.types.forEach(function(t){return n.addType(t)}),t.expressions&&t.expressions.forEach(function(t){return n.addExpression(t)}),t.aliases&&h(t.aliases,function(t,e){return n.addAlias(e,t)}))}return t.prototype.describe=function(t){var n,e;try{for(var r=z(this.describers),o=r.next();!o.done;o=r.next()){var i=o.value.describe(t,this);if(i)return i}}catch(t){n={error:t}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(n)throw n.error}}return M.baseType},t.prototype.merge=function(t,n){return this.mergeType(t,this.describe(n))},t.prototype.mergeType=function(t,n){var e,r;if(t instanceof M)return n;var o=t instanceof I||n instanceof I,i=this.requiredType(t),u=this.requiredType(n);if(l(i,u))return i.merge(u,this),o?new I(i):i;if(i instanceof U||u instanceof U){var p=this.getTypes(i),c=this.getTypes(u),s=p.length;try{for(var a=z(c),f=a.next();!f.done;f=a.next()){for(var y=f.value,d=!1,h=y instanceof I,v=h?y.options:y,m=0;m<s;m++){var b=p[m],_=b instanceof I,g=_?b.options:b;l(g,v)&&(d=!0,g.merge(v,this),h&&!_&&(p[m]=new I(g)))}d||p.push(y)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return o?new I(this.getReducedType(p)):this.getReducedType(p)}return new U([t,n])},t.prototype.optionalType=function(t){var n=this;return t instanceof I?t:(t instanceof U&&(t.options=t.options.map(function(t){return n.requiredType(t)})),new I(t))},t.prototype.requiredType=function(t){return t instanceof I?t.options:t},t.prototype.getTypes=function(t){return t instanceof U?t.options:[t]},t.prototype.getReducedType=function(t){return 1===t.length?t[0]:new U(t)},t.prototype.sortDescribers=function(){this.describers.sort(function(t,n){return n.describePriority-t.describePriority})},t.prototype.addType=function(t){this.types[t.id]=t,this.parsers[t.id]=function(n,e){return t.decode(n,e)},this.describers.push(t),this.sortDescribers()},t.prototype.addAlias=function(t,n){var e=n instanceof T?n:this.getType(n);this.parsers[t]=function(){return e}},t.prototype.getType=function(t){var n=u(t)?t[0]:t,e=u(t)?t:[];return this.parsers[n](e,this)},t.prototype.getOperationBuilder=function(t){var n=this.operations.getBuilder(t);if(n)return n;var e=R(t.split(":"),1)[0],r=this.types[e];return r?r.operations.getBuilder(t):null},t.prototype.addExpression=function(t){this.expressions[t.id]=t},t.prototype.getExpression=function(t){if(u(t)){var n=this.expressions[t[0]];if(!n)throw new Error("An expression was not found for: "+JSON.stringify(t));return n.decode(t,this)}return new S(t)},t}(),L=function(){function t(t){this.defs=t,this.ops=Object.create(null),this.exprs=Object.create(null)}return t.prototype.setOperation=function(t,n){this.ops[t.id]=n},t.prototype.setExpression=function(t,n){this.exprs[t.id]=n},t.prototype.getOperation=function(t){return this.ops[t]},t.prototype.getOperationScopeDefaults=function(t){var n=this.defs.getOperationBuilder(t);return n?n.scopeDefaults:{}},t.prototype.getExpression=function(t){return this.exprs[t]},t.prototype.getCommand=function(t){return this.exprs[t.id](t,this)},t.prototype.eval=function(t){return u(t)?this.getCommand(this.defs.getExpression(t)):function(){return t}},t}(),q=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),B=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return q(n,t),n.decode=function(t){return new n(t[1]||{})},n.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},n.describe=function(t,e){return o(t)?new n({min:t,max:t,whole:Math.abs(Math.floor(t)-t)<=n.WHOLE_EPSILON}):null},n.prototype.merge=function(t,n){var e=this.options,r=t.options;e.max=Math.max(e.max,r.max),e.min=Math.min(e.min,r.min),e.whole=e.whole&&r.whole},n.prototype.getSubTypes=function(){return null},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n},n.prototype.isValid=function(t){return o(t)},n.prototype.normalize=function(t){return t},n.prototype.encode=function(){return n.encode(this)},n.WHOLE_EPSILON=1e-6,n.id="num",n.operations=new j("num:"),n.baseType=new n({}),n.describePriority=4,n}(T),X=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),F=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return X(n,t),n.decode=function(t,e){return new n(t[1]||{})},n.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},n.describe=function(t,n){return s(t)?this.baseType:null},n.prototype.merge=function(t,n){},n.prototype.getSubTypes=function(){return null},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n||t instanceof B},n.prototype.isValid=function(t){if(s(t))return!0;var n=t+"";return!(!this.options.true||!this.options.true[n])||!(!this.options.false||!this.options.false[n])},n.prototype.normalize=function(t){if(!s(t)){var n=t+"";if(this.options.true&&this.options.true[n])return!0;if(this.options.false&&this.options.false[n])return!1}return t},n.prototype.encode=function(){return n.encode(this)},n.id="bool",n.operations=new j("bool:"),n.baseType=new n({}),n.describePriority=4,n}(T),W=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),H=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return W(n,t),n.decode=function(t,e){return new n({props:h(t[1],function(t){return e.getType(t)})})},n.encode=function(t){var n=h(t.options.props,function(t){return t.encode()});return[this.id,n]},n.describe=function(t,e){if(!f(t)||null===t)return null;var r=Object.create(null);for(var o in t)r[o]=e.describe(t[o]);return new n({props:r})},n.prototype.merge=function(t,n){var e=this.options.props,r=t.options.props;for(var o in e)e[o]=o in r?n.mergeType(e[o],r[o]):n.optionalType(e[o]);for(var o in r)o in e||(e[o]=n.optionalType(r[o]))},n.prototype.getSubTypes=function(){return this.options.props},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){if(!(t instanceof n))return!1;var e=this.options.props;for(var r in e)if(!t.options.props[r])return!1;return!0},n.prototype.isValid=function(t){if(!f(t))return!1;var n=this.options.props;for(var e in n)if(!n[e].isValid(t[e]))return!1;return!0},n.prototype.normalize=function(t){return t},n.prototype.encode=function(){return n.encode(this)},n.id="obj",n.operations=new j("obj:"),n.baseType=new n({props:{}}),n.describePriority=5,n}(T),K=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),G=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return K(n,t),n.decode=function(t,e){return new n({returnType:e.getType(t[1]),params:e.getType([H.id,t[2]])})},n.encode=function(t){var n=t.options;return n.true||n.false||(n=void 0),n?[this.id,n]:this.id},n.describe=function(t,n){return null},n.prototype.merge=function(t,n){},n.prototype.getSubTypes=function(){var t=this.options;return{returnType:t.returnType,params:t.params}},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n},n.prototype.isValid=function(t){return a(t)},n.prototype.normalize=function(t){return t},n.prototype.encode=function(){return n.encode(this)},n.id="func",n.operations=new j("func:"),n.baseType=new n({returnType:M.baseType,params:H.baseType}),n.describePriority=-1,n}(T),J=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Y=function(){return(Y=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},Q=function(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}},Z=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return J(n,t),n.decode=function(t,e){var r=e.getType(t[1]),o=t[2]||{};return new n(Y({item:r},o))},n.encode=function(t){var n=Y({},t.options),e=n.item;return delete n.item,d(n)?[this.id,e.encode()]:[this.id,e.encode(),n]},n.describe=function(t,e){if(!u(t))return null;for(var r=e.describe(t[0]),o=1;o<t.length;o++)r=e.merge(r,t[o]);return new n({item:r,min:t.length,max:t.length})},n.forItem=function(t){return new n({item:T.fromInput(t)})},n.prototype.merge=function(t,n){var e=this.options,r=t.options;e.item=n.mergeType(e.item,r.item),e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max)},n.prototype.getSubTypes=function(){return{length:n.lengthType,item:this.options.item}},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n&&this.options.item.isCompatible(t.options.item)},n.prototype.isValid=function(t){var n,e;if(!Array.isArray(t))return!1;var r=this.options,i=r.item,u=r.min,p=r.max;if(o(u)&&t.length<u)return!1;if(o(p)&&t.length>p)return!1;try{for(var c=Q(t),s=c.next();!s.done;s=c.next()){var a=s.value;if(!i.isValid(a))return!1}}catch(t){n={error:t}}finally{try{s&&!s.done&&(e=c.return)&&e.call(c)}finally{if(n)throw n.error}}return!0},n.prototype.normalize=function(t){if(u(t))for(var n=this.options.item,e=0;e<t.length;e++)t[e]=n.normalize(t[e]);return t},n.prototype.encode=function(){return n.encode(this)},n.prototype.getSplitResultType=function(){return new H({props:{pass:this,fail:this}})},n.prototype.getIterationScope=function(){return{list:this,item:this.options.item,index:n.lengthType}},n.prototype.getCompareScope=function(){return{list:this,value:this.options.item,test:this.options.item}},n.lengthType=new B({min:0,whole:!0}),n.id="list",n.operations=new j("list:"),n.baseType=new n({item:M.baseType}),n.describePriority=6,n.IterationScopeDefaults={list:"list",item:"item",index:"index"},n.CompareScopeDefaults={list:"list",value:"value",test:"test"},n}(T),$=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),tt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return $(n,t),n.decode=function(t){return new n(t[1]||{})},n.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},n.describe=function(t,e){return i(t)?new n({min:t.length,max:t.length,requireLower:t.toLowerCase()===t,requireUpper:t.toUpperCase()===t}):null},n.prototype.merge=function(t,n){var e=this.options,r=t.options;e.max=Math.max(e.max,r.max),e.min=Math.min(e.min,r.min),e.requireLower=e.requireLower&&r.requireLower,e.requireUpper=e.requireUpper&&r.requireUpper},n.prototype.getSubTypes=function(){return null},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n},n.prototype.isValid=function(t){if(!i(t))return!1;var n=this.options,e=n.min,r=n.max,u=n.requireLower,p=n.requireUpper,c=n.matches,s=n.forceLower,a=n.forceUpper;return!(o(e)&&t.length<e)&&(!(o(r)&&t.length>r)&&(!(u&&t!==t.toLowerCase()&&!s)&&(!(p&&t!==t.toUpperCase()&&!a)&&!(c&&c instanceof RegExp&&!c.test(t)))))},n.prototype.normalize=function(t){return i(t)&&(this.options.forceLower&&(t=t.toLowerCase()),this.options.forceUpper&&(t=t.toUpperCase())),t},n.prototype.encode=function(){return n.encode(this)},n.id="text",n.operations=new j("text:"),n.baseType=new n({}),n.describePriority=3,n}(T),nt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),et=function(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}},rt=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u},ot=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return nt(n,t),n.decode=function(t,e){var r=e.getType(t[1]);return new n({key:t[2]?e.getType(t[2]):tt.baseType,value:r})},n.encode=function(t){var n=t.options,e=n.key,r=n.value;return e!==tt.baseType?[this.id,r.encode()]:[this.id,r.encode(),e.encode()]},n.describe=function(t,e){var r,o;if(!c(t))return null;var i=new M({}),u=new M({});try{for(var p=et(t.entries()),s=p.next();!s.done;s=p.next()){var a=rt(s.value,2),f=a[0],y=a[1];i=e.merge(i,f),u=e.merge(u,y)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}return new n({key:i,value:u})},n.forItem=function(t,e){void 0===e&&(e=tt);var r=T.fromInput(t);return new n({key:T.fromInput(e),value:r})},n.prototype.merge=function(t,n){var e=this.options,r=t.options;e.key=n.mergeType(e.key,r.key),e.value=n.mergeType(e.value,r.value)},n.prototype.getSubTypes=function(){var t=this.options;return{key:t.key,value:t.value}},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n&&this.options.key.isCompatible(t.options.key)&&this.options.value.isCompatible(t.options.value)},n.prototype.isValid=function(t){if(t instanceof Map&&f(t)){var n=this.options,e=n.key,r=n.value;return this.iterate(t,!0,function(t,n){if(!e.isValid(t)||!r.isValid(n))return!1})}return!1},n.prototype.normalize=function(t){var n=this.options,e=n.key,r=n.value,o=[];return this.iterate(t,void 0,function(t,n){o.push([e.normalize(t),r.normalize(n)])}),new Map(o)},n.prototype.iterate=function(t,n,e){var r,o,i,u;if(t instanceof Map)try{for(var p=et(t.entries()),c=p.next();!c.done;c=p.next()){var s=rt(c.value,2);if(void 0!==(l=e(s[0],s[1])))return l}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}else if(f(t))try{for(var a=et(t),y=a.next();!y.done;y=a.next()){var l,d=y.value;if(void 0!==(l=e(d,t[d])))return l}}catch(t){i={error:t}}finally{try{y&&!y.done&&(u=a.return)&&u.call(a)}finally{if(i)throw i.error}}return n},n.prototype.encode=function(){return n.encode(this)},n.prototype.getValuesType=function(){return Z.forItem(this.options.value)},n.prototype.getKeysType=function(){return Z.forItem(this.options.key)},n.prototype.getEntriesType=function(){return new H({props:{keys:this.getKeysType(),values:this.getValuesType()}})},n.prototype.getIterationScope=function(){return{map:this,key:this.options.key,value:this.options.value}},n.prototype.getCompareScope=function(){return{key:this.options.key,value:this.options.value,test:this.options.value}},n.id="map",n.operations=new j("map:"),n.baseType=new n({key:tt.baseType,value:M.baseType}),n.describePriority=7,n.IterationScopeDefaults={map:"map",key:"key",value:"value"},n.CompareScopeDefaults={key:"key",value:"value",test:"test"},n}(T),it=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ut=function(t){function n(e){var r=t.call(this,n.id)||this;return r.expressions=e,r}return it(n,t),n.decode=function(t,e){return new n(t[1].map(function(t){return e.getExpression(t)}))},n.encode=function(t){var n=t.expressions.map(function(t){return t.encode()});return[this.id,n]},n.prototype.getComplexity=function(t){return this.expressions.reduce(function(n,e){return Math.max(n,e.getComplexity(t))},0)},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="and",n}(E),pt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ct=function(t){function n(e){var r=t.call(this,n.id)||this;return r.chain=e,r}return pt(n,t),n.decode=function(t,e){return new n(t[1].map(function(t){return e.getExpression(t)}))},n.encode=function(t){var n=t.chain.map(function(t){return t.encode()});return[this.id,n]},n.prototype.getComplexity=function(t){return this.chain.reduce(function(n,e){return Math.max(n,e.getComplexity(t))},0)},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="chain",n}(E),st=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),at=function(t){function n(e,r){var o=t.call(this,n.id)||this;return o.define=e,o.body=r,o}return st(n,t),n.decode=function(t,e){return new n(h(t[1],function(t){return e.getExpression(t)}),e.getExpression(t[2]))},n.encode=function(t){var n=h(t.define,function(t){return t.encode()});return[this.id,n,t.body.encode()]},n.prototype.getComplexity=function(t){var n=this.body.getComplexity(t);for(var e in this.define)n=Math.max(n,this.define[e].getComplexity(t));return n},n.prototype.getScope=function(){return h(this.define,function(){return M.baseType})},n.prototype.encode=function(){return n.encode(this)},n.id="def",n}(E),ft=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),yt=function(t){function n(e,r,o,i,u,p){var c=t.call(this,n.id)||this;return c.variable=e,c.start=r,c.end=o,c.body=i,c.breakVariable=u,c.maxIterations=p,c}return ft(n,t),n.decode=function(t,e){return new n(t[1],e.getExpression(t[2]),e.getExpression(t[3]),e.getExpression(t[4]),t[5]||"break",parseInt(t[6])||this.MAX_ITERATIONS)},n.encode=function(t){var n=[this.id,t.variable,t.start.encode(),t.end.encode(),t.body.encode()],e=t.maxIterations!==this.MAX_ITERATIONS;return("break"!==t.breakVariable||e)&&n.push(t.breakVariable),e&&n.push(t.maxIterations),n},n.prototype.getComplexity=function(t){return Math.max(this.start.getComplexity(t),this.end.getComplexity(t),this.body.getComplexity(t))+1},n.prototype.getScope=function(){var t;return(t={})[this.variable]=B.baseType,t[this.breakVariable]=F.baseType,t},n.prototype.encode=function(){return n.encode(this)},n.MAX_ITERATIONS=1e5,n.id="for",n}(E),lt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),dt=function(t){function n(e){var r=t.call(this,n.id)||this;return r.path=e,r}return lt(n,t),n.decode=function(t,e){return new n(t[1].map(function(t){return e.getExpression(t)}))},n.encode=function(t){var n=t.path.map(function(t){return t.encode()});return[this.id,n]},n.prototype.getComplexity=function(t){return this.path.reduce(function(n,e){return Math.max(n,e.getComplexity(t))},0)},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="get",n}(E),ht=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vt=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u},mt=function(t){function n(e,r){var o=t.call(this,n.id)||this;return o.cases=e,o.otherwise=r,o}return ht(n,t),n.decode=function(t,e){return new n(t[1].map(function(t){var n=vt(t,2),r=n[0],o=n[1];return[e.getExpression(r),e.getExpression(o)]}),e.getExpression(t[2]))},n.encode=function(t){var n=t.cases.map(function(t){var n=vt(t,2),e=n[0],r=n[1];return[e.encode(),r.encode()]});return E.hasConstant(t.otherwise,void 0)?[this.id,n]:[this.id,n,t.otherwise.encode()]},n.prototype.getComplexity=function(t){return this.cases.reduce(function(n,e){var r=vt(e,2),o=r[0],i=r[1];return Math.max(n,o.getComplexity(t),i.getComplexity(t))},this.otherwise.getComplexity(t))},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="if",n}(E),bt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_t=function(t){function n(e){var r=t.call(this,n.id)||this;return r.expression=e,r}return bt(n,t),n.decode=function(t,e){return new n(e.getExpression(t[1]))},n.encode=function(t){var n=t.expression.encode();return[this.id,n]},n.prototype.getComplexity=function(t){return this.expression.getComplexity(t)},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="not",n}(E),gt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),xt=function(t){function n(e,r,o){var i=t.call(this,n.id)||this;return i.name=e,i.params=r,i.scopeAlias=o,i}return gt(n,t),n.decode=function(t,e){return new n(t[1],h(t[2],function(t){return e.getExpression(t)}),t[3]||{})},n.encode=function(t){var n=h(t.params,function(t){return t.encode()});return d(t.scopeAlias)?[this.id,t.name,n]:[this.id,t.name,n,t.scopeAlias]},n.prototype.getComplexity=function(t){var n=t.getOperationBuilder(this.name),e=n?n.complexity:0;for(var r in this.params)e=Math.max(e,this.params[r].getComplexity(t));return e},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="op",n}(E),wt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ot=function(t){function n(e){var r=t.call(this,n.id)||this;return r.expressions=e,r}return wt(n,t),n.decode=function(t,e){return new n(t[1].map(function(t){return e.getExpression(t)}))},n.encode=function(t){var n=t.expressions.map(function(t){return t.encode()});return[this.id,n]},n.prototype.getComplexity=function(t){return this.expressions.reduce(function(n,e){return Math.max(n,e.getComplexity(t))},0)},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="or",n}(E),Tt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ct=function(t){function n(e,r){var o=t.call(this,n.id)||this;return o.path=e,o.value=r,o}return Tt(n,t),n.decode=function(t,e){return new n(t[1].map(function(t){return e.getExpression(t)}),e.getExpression(t[2]))},n.encode=function(t){var n=t.path.map(function(t){return t.encode()});return[this.id,n,t.value.encode()]},n.prototype.getComplexity=function(t){return this.path.reduce(function(n,e){return Math.max(n,e.getComplexity(t))},this.value.getComplexity(t))},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="set",n}(E),jt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Et=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),u=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return u},Pt=function(t){function n(e,r,o,i){var u=t.call(this,n.id)||this;return u.value=e,u.op=r,u.cases=o,u.defaultCase=i,u}return jt(n,t),n.decode=function(t,e){return new n(e.getExpression(t[1]),t[2],t[3].map(function(t){var n=Et(t,2),r=n[0],o=n[1];return[r.map(function(t){return e.getExpression(t)}),e.getExpression(o)]}),e.getExpression(t[4]))},n.encode=function(t){var n=t.value.encode(),e=t.cases.map(function(t){var n=Et(t,2),e=n[0],r=n[1];return[e.map(function(t){return t.encode()}),r.encode()]});return E.hasConstant(t.defaultCase,void 0)?[this.id,n,t.op,e]:[this.id,n,t.op,e,t.defaultCase.encode()]},n.prototype.getComplexity=function(t){return this.cases.reduce(function(n,e){var r=Et(e,2),o=r[0],i=r[1];return Math.max(n,i.getComplexity(t),o.reduce(function(n,e){return Math.max(n,e.getComplexity(t))},0))},Math.max(this.value.getComplexity(t),this.defaultCase.getComplexity(t)))},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="switch",n}(E),St=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),At=function(t){function n(e,r){var o=t.call(this,n.id)||this;return o.template=e,o.params=r,o}return St(n,t),n.decode=function(t,e){return new n(t[1],h(t[2],function(t){return e.getExpression(t)}))},n.encode=function(t){var n=h(t.params,function(t){return t.encode()});return[this.id,t.template,n]},n.prototype.getComplexity=function(t){var n=0;for(var e in this.params)n=Math.max(n,this.params[e].getComplexity(t));return n},n.prototype.getScope=function(){return null},n.prototype.encode=function(){return n.encode(this)},n.id="tmpl",n}(E),Mt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kt=function(t){function n(e,r,o,i){var u=t.call(this,n.id)||this;return u.condition=e,u.body=r,u.breakVariable=o,u.maxIterations=i,u}return Mt(n,t),n.decode=function(t,e){return new n(e.getExpression(t[1]),e.getExpression(t[2]),t[3]||"break",parseInt(t[4])||this.MAX_ITERATIONS)},n.encode=function(t){var n=[this.id,t.condition.encode(),t.body.encode()],e=t.maxIterations!==this.MAX_ITERATIONS;return("break"!==t.breakVariable||e)&&n.push(t.breakVariable),e&&n.push(t.maxIterations),n},n.prototype.getComplexity=function(t){return Math.max(this.condition.getComplexity(t),this.body.getComplexity(t))+1},n.prototype.getScope=function(){var t;return(t={})[this.breakVariable]=F.baseType,t},n.prototype.encode=function(){return n.encode(this)},n.MAX_ITERATIONS=1e5,n.id="while",n}(E),It=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Vt=function(t){function n(e,r,o,i){var u=t.call(this,n.id)||this;return u.condition=e,u.body=r,u.breakVariable=o,u.maxIterations=i,u}return It(n,t),n.decode=function(t,e){return new n(e.getExpression(t[1]),e.getExpression(t[2]),t[3]||"break",parseInt(t[4])||this.MAX_ITERATIONS)},n.encode=function(t){var n=[this.id,t.condition.encode(),t.body.encode()],e=t.maxIterations!==this.MAX_ITERATIONS;return("break"!==t.breakVariable||e)&&n.push(t.breakVariable),e&&n.push(t.maxIterations),n},n.prototype.getComplexity=function(t){return Math.max(this.condition.getComplexity(t),this.body.getComplexity(t))+1},n.prototype.getScope=function(){var t;return(t={})[this.breakVariable]=F.baseType,t},n.prototype.encode=function(){return n.encode(this)},n.MAX_ITERATIONS=1e5,n.id="do",n}(E),Dt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ut=function(t){function n(e,r,o){var i=t.call(this,n.id)||this;return i.path=e,i.value=r,i.currentVariable=o,i}return Dt(n,t),n.decode=function(t,e){return new n(t[1].map(function(t){return e.getExpression(t)}),e.getExpression(t[2]),t[3]||"current")},n.encode=function(t){var n=t.path.map(function(t){return t.encode()}),e=t.value.encode();return"current"===t.currentVariable?[this.id,n,e]:[this.id,n,e,t.currentVariable]},n.prototype.getComplexity=function(t){return this.path.reduce(function(n,e){return Math.max(n,e.getComplexity(t))},this.value.getComplexity(t))},n.prototype.getScope=function(){var t;return(t={})[this.currentVariable]=M.baseType,t},n.prototype.encode=function(){return n.encode(this)},n.id="up",n}(E),zt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Rt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return zt(n,t),n.decode=function(t,e){return new n({key:e.getType(t[1]),value:e.getType(t[2]),constants:new Map(t[3])})},n.encode=function(t){var n=t.options,e=n.key,r=n.value,o=n.constants;return[this.id,e.encode(),r.encode(),v(o.entries())]},n.describe=function(){return null},n.prototype.merge=function(t,n){},n.prototype.getSubTypes=function(){var t=this.options;return{key:t.key,value:t.value}},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n},n.prototype.isValid=function(t){return this.options.constants.has(t)},n.prototype.normalize=function(t){return t},n.prototype.encode=function(){return n.encode(this)},n.id="enum",n.operations=new j("enum:"),n.baseType=new n({key:tt.baseType,value:tt.baseType,constants:new Map}),n.describePriority=-1,n}(T),Nt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Lt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Nt(n,t),n.decode=function(t,e){return new n(t[1]||{})},n.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},n.describe=function(t,n){return p(t)?this.baseType:null},n.prototype.merge=function(t,n){var e=this.options,r=t.options;e.parseAsUTC=e.parseAsUTC&&r.parseAsUTC},n.prototype.getSubTypes=function(){return null},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n},n.prototype.isValid=function(t){return p(this.normalize(t))},n.prototype.normalize=function(t){if(p(t))return t;if(o(t)&&t>0)return new Date(t);if(i(t)){if(this.options.parseAsUTC){var n=t+" UTC",e=Date.parse(n);if(isFinite(e))return new Date(e)}var r=Date.parse(t);if(isFinite(r))return new Date(r)}return t},n.prototype.encode=function(){return n.encode(this)},n.id="date",n.operations=new j("date:"),n.baseType=new n({}),n.describePriority=6,n}(T),qt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qt(n,t),n.decode=function(t){return new n(t[1]||{})},n.encode=function(t){return d(t.options)?this.id:[this.id,t.options]},n.describe=function(t){return null===t?this.baseType:null},n.prototype.merge=function(t,n){var e=this.options,r=t.options;e.includeUndefined=e.includeUndefined||r.includeUndefined},n.prototype.getSubTypes=function(){return null},n.prototype.getExactType=function(t){return this},n.prototype.isCompatible=function(t){return t instanceof n},n.prototype.isValid=function(t){return null===t||this.options.includeUndefined&&void 0===t},n.prototype.normalize=function(t){return t},n.prototype.encode=function(){return n.encode(this)},n.id="null",n.operations=new j("null:"),n.baseType=new n({}),n.describePriority=6,n}(T),Xt=new N({types:[Z,B,tt,F,H,G,M,U,I,ot,Rt,Lt,Bt],expressions:[S,dt,Ct,xt,ct,mt,Pt,_t,ut,Ot,yt,kt,Vt,at,At,Ut]});e.d(n,"isNumber",function(){return o}),e.d(n,"isString",function(){return i}),e.d(n,"isArray",function(){return u}),e.d(n,"isDate",function(){return p}),e.d(n,"isMap",function(){return c}),e.d(n,"isBoolean",function(){return s}),e.d(n,"isFunction",function(){return a}),e.d(n,"isObject",function(){return f}),e.d(n,"isUndefined",function(){return y}),e.d(n,"isSameClass",function(){return l}),e.d(n,"isEmpty",function(){return d}),e.d(n,"mapObject",function(){return h}),e.d(n,"toArray",function(){return v}),e.d(n,"getCompare",function(){return m}),e.d(n,"COMPARE_TYPE_ORDER",function(){return b}),e.d(n,"compare",function(){return _}),e.d(n,"copy",function(){return g}),e.d(n,"padNumber",function(){return x}),e.d(n,"pad",function(){return w}),e.d(n,"Definitions",function(){return N}),e.d(n,"Expression",function(){return E}),e.d(n,"Operations",function(){return j}),e.d(n,"Runtime",function(){return L}),e.d(n,"Type",function(){return T}),e.d(n,"AnyType",function(){return M}),e.d(n,"BooleanType",function(){return F}),e.d(n,"FunctionType",function(){return G}),e.d(n,"ListType",function(){return Z}),e.d(n,"ManyType",function(){return U}),e.d(n,"NumberType",function(){return B}),e.d(n,"ObjectType",function(){return H}),e.d(n,"OptionalType",function(){return I}),e.d(n,"TextType",function(){return tt}),e.d(n,"MapType",function(){return ot}),e.d(n,"AndExpression",function(){return ut}),e.d(n,"ChainExpression",function(){return ct}),e.d(n,"ConstantExpression",function(){return S}),e.d(n,"DefineExpression",function(){return at}),e.d(n,"ForExpression",function(){return yt}),e.d(n,"GetExpression",function(){return dt}),e.d(n,"IfExpression",function(){return mt}),e.d(n,"NotExpression",function(){return _t}),e.d(n,"OperationExpression",function(){return xt}),e.d(n,"OrExpression",function(){return Ot}),e.d(n,"SetExpression",function(){return Ct}),e.d(n,"SwitchExpression",function(){return Pt}),e.d(n,"TemplateExpression",function(){return At}),e.d(n,"WhileExpression",function(){return kt}),e.d(n,"defs",function(){return Xt})}])});
//# sourceMappingURL=expangine-runtime.js.map