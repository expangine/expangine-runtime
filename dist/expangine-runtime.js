!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["expangine-runtime"]=t():e["expangine-runtime"]=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},o=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}};function i(e){return"number"==typeof e&&isFinite(e)}function s(e){return"string"==typeof e}function a(e){return Array.isArray(e)}function u(e){return e instanceof Date}function p(e){return e instanceof Map}function c(e){return e instanceof Set}function l(e){return"boolean"==typeof e}function f(e){return"function"==typeof e}function y(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function d(e){return void 0===e}function h(e,t){return e.constructor===t.constructor}function v(e,t){return void 0===t&&(t=1e-6),Math.abs(e-Math.round(e))<=t}function m(e){if(a(e))return 0===e.length;if(y(e)){for(var t in e)return!1;return!0}return null==e}function g(e,t,n){return e<t?t:e>n?n:e}function T(e){return a(e)?new Map(e):p(e)?e:y(e)?new Map(P(e,function(e,t){return[t,e]})):new Map}function b(e){return new Map(Array.from(e.entries()).map(function(e){var t=r(e,2),n=t[0];return[t[1],n]}))}function x(e,t,n){return void 0===n&&(n=function(e){return e}),S(e,function(e,r,o){return o[n(r,e)]=t(e,r),o},Object.create(null))}function O(e,t){return S(e,function(n,r){return t(n,r,e)},void 0)}function E(e,t){return void 0===t&&(t=function(e){return e}),S(e,function(e,n,r){return r.push(t(e,n)),r},[])}function S(e,t,n){for(var r in e)n=t(e[r],r,n);return n}function w(e,t){for(var n=Object.create(null),r=0;r<e.length;r++){var o=e[r];n[o]=t(o,r)}return n}function P(e,t){var n=[];for(var r in e)n.push(t(e[r],r));return n}function _(e,t){return 0===e&&0===t?0:e<t?1:-1}function M(e,t){return void 0===e?t:e}var I={boolean:0,number:1,bigint:2,string:3,symbol:4,object:5,undefined:6,function:7};function C(e,t){if(e===t)return 0;var n=typeof e,r=typeof t;if(n!==r)return I[n]-I[r];var o=a(e),i=a(t);if(o!==i)return(o?1:0)-(i?1:0);if(o){var s=e.length-t.length;if(0===s){for(var u=0,p=0,c=0;c<e.length;c++){(d=C(e[c],t[c]))<0&&u++,d>0&&p++}s=_(u,p)}return s}switch(n){case"object":var l=e instanceof Date,f=t instanceof Date;if(l!==f)return(l?1:0)-(f?1:0);if(l)return e.getTime()-t.getTime();u=0,p=0;for(var y in e)y in t||u++;for(var y in t)y in e||p++;for(var y in e){var d;if(y in t)(d=C(e[y],t[y]))<0&&u++,d>0&&p++}return _(u,p);case"bigint":case"number":return e-t;case"boolean":return(e?1:0)-(t?1:0);case"string":return e.localeCompare(t)}return 0}var D=[];function k(e,t){D.push({priority:e,tryCopy:t}),D.sort(function(e,t){return t.priority-e.priority})}function j(e,t){var n,r;if(void 0===t&&(t=new Map),!e)return e;if("object"==typeof e){var i=t.get(e);if(void 0!==i)return i;try{for(var s=o(D),a=s.next();!a.done;a=s.next()){var u=a.value.tryCopy(e,j,t);if(void 0!==u)return u}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}return e}function N(e,t,n){return void 0===n&&(n=t),A(e+"",t,"0",!0).substring(0,n)}function A(e,t,n,r){for(;e.length<t;)r?e=n+e:e+=n;return e}function L(e){return a(e)||y(e)?JSON.stringify(e):e+""}var R,q,V=function(){},F=function(){},Y=function(){function e(e,t){this.remove=V,this.replace=F,this.callback=e,this.stack=[],this.path=[],this.stopped=!1,this.result=t}return e.isTraversable=function(e){return e&&f(e.traverse)},e.prototype.enter=function(e,t){return this.stopped?this.result:(this.callback(e,this.stack,this.path,this),this.remove=V,this.replace=F,t&&!this.stopped&&(this.stack.push(e),t(),this.stack.pop()),this.result)},e.prototype.step=function(t,n,r,o){return void 0===r&&(r=F),void 0===o&&(o=V),this.stopped?this:(this.path.push(t),this.remove=o,this.replace=r,e.isTraversable(n)?n.traverse(this):n(),this.path.pop(),this)},e.prototype.modify=function(e){var t=e(this.result);return void 0!==t&&(this.result=t),this},e.prototype.stop=function(e){return this.result=e,this},e.prototype.getResult=function(){return this.result},e.prototype.removeOrReplace=function(e){var t=this.canRemove(),n=this.canReplace();return!(!t&&!n)&&(t?this.remove():this.replace(f(e)?e():e),!0)},e.prototype.canRemove=function(){return this.remove!==V},e.prototype.canReplace=function(){return this.replace!==F},e.prototype.filterClass=function(e,t){return void 0===t&&(t=this.result),this.filter(function(t){return t.constructor===e},t)},e.prototype.filter=function(t,n){var r=this;void 0===n&&(n=this.result);return new e(function(e,n,o,i){t(e,n,o)&&r.callback(e,n,o,i)},n)},e.list=function(){var t=[];return new e(function(e,n,r){t.push({value:e,stack:n.slice(),path:r.slice()})},t)},e.count=function(){return new e(function(e,t,n,r){return r.result++},0)},e}(),B=function(){function e(e){this.parent=null,this.options=e}return e.prototype.getRequired=function(){return this},e.prototype.isWrapper=function(){return!1},e.prototype.isCompatible=function(e,t){return void 0===t&&(t={}),e===this||(!(t.exact||!e.isWrapper()||!this.isCompatible(e.getSimplifiedType(),t))||!(t.strict&&!h(this,e)&&!this.acceptsOtherTypes())&&this.isDeepCompatible(e,t))},e.prototype.acceptsOtherTypes=function(){return!1},e.prototype.acceptsType=function(e){return this.isCompatible(e,{strict:!0})},e.prototype.acceptsData=function(e){return this.isCompatible(e,{strict:!0,value:!0})},e.prototype.exactType=function(e){return this.isCompatible(e,{exact:!0,strict:!0})},e.prototype.exactData=function(e){return this.isCompatible(e,{exact:!0,strict:!0,value:!0})},e.prototype.getValueChangeExpression=function(e,t,n){return e},e.prototype.getValueChangeAt=function(e){for(var t=this.parent,n=this.getPath();t;){var r=n.pop();e=t.getValueChangeExpression(e,r,r),t=t.parent}return e},e.prototype.getPath=function(){var e=this;return this.getRootType().traverse(new Y(function(t,n,r,o){t===e&&o.stop(r.slice())}))},e.prototype.getTypeFromPath=function(e){if(0===e.length)return this;var t=this.getTypeFromStep(e[0]);return t?t.getTypeFromPath(e.slice(1)):null},e.prototype.getTypeFromStep=function(e){return null},e.prototype.getRootType=function(){for(var e=this;e.parent;)e=e.parent;return e},e}();!function(e){e[e.LOW=1]="LOW",e[e.MEDIUM=2]="MEDIUM",e[e.HIGH=3]="HIGH"}(R||(R={})),function(e){e[e.UNSAFE_OPERATION=1]="UNSAFE_OPERATION",e[e.POSSIBLY_NULL=2]="POSSIBLY_NULL",e[e.INCOMPATIBLE_TYPES=3]="INCOMPATIBLE_TYPES",e[e.INVALID_EXPRESSION=4]="INVALID_EXPRESSION",e[e.MISSING_FUNCTION=5]="MISSING_FUNCTION",e[e.MISSING_EXPRESSION=6]="MISSING_EXPRESSION",e[e.MISSING_OPERATION=7]="MISSING_OPERATION",e[e.MISSING_TYPE_NAME=8]="MISSING_TYPE_NAME",e[e.MISSING_TYPE=9]="MISSING_TYPE",e[e.MISSING_RELATION_NAME=10]="MISSING_RELATION_NAME",e[e.MISSING_RELATION=11]="MISSING_RELATION"}(q||(q={}));var G=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},W=function(){function e(){this.parent=null}return e.prototype.getPath=function(){var e=this;return this.getRootExpression().traverse(new Y(function(t,n,r,o){t===e&&o.stop(r.slice())}))},e.prototype.getExpressionFromPath=function(e){if(0===e.length)return this;var t=this.getExpressionFromStep(e);if(!t||!t[1])return null;var n=G(t,2),r=n[0];return n[1].getExpressionFromPath(e.slice(r))},e.prototype.getExpressionFromStep=function(e){return null},e.prototype.getRootExpression=function(){for(var e=this;e.parent;)e=e.parent;return e},e.prototype.validations=function(e,t){var n=[];return this.validate(e,t,function(e){return n.push(e)}),n},e.prototype.validateType=function(e,t,n,r,o,i){void 0===i&&(i=this);var s=n?n.getSimplifiedType():null,a=r?r.getType(e,t):null,u=a?a.getSimplifiedType():null,p=u;u?(u.isOptional()&&!s.isOptional()&&(p=p.getRequired()),s.acceptsType(p)?p!==u&&o({type:q.POSSIBLY_NULL,severity:R.MEDIUM,context:t,subject:r,parent:i,expected:s,actual:u}):o({type:q.INCOMPATIBLE_TYPES,severity:s.isCompatible(u)?R.MEDIUM:R.HIGH,context:t,subject:r,parent:i,expected:s,actual:u})):s&&!s.isOptional()&&o({type:q.INCOMPATIBLE_TYPES,severity:R.HIGH,context:t,subject:r,parent:i,expected:s}),r&&r.validate(e,t,o)},e.prototype.validatePath=function(e,t,n,r,o,i){void 0===i&&(i=this);var s=n;r.forEach(function(n){s&&(s=s.getSubType(n,e,t)),s||o({type:q.INVALID_EXPRESSION,severity:R.HIGH,subject:n,context:t,parent:i}),n.validate(e,t,o)})},e}();function U(e){return!("baseType"in e)&&f(e)}var H,J=function(){function e(e){this.prefix=e,this.map=Object.create(null),this.types=Object.create(null)}return e.prototype.get=function(e){return this.map[e]||this.map[this.prefix+e]},e.prototype.getTypes=function(e){return this.types[e]||this.types[this.prefix+e]},e.prototype.set=function(e,t,n,r,o,i,s){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===o&&(o=[]),void 0===i&&(i=[]),void 0===s&&(s=[]);var a=this.prefix+e,u=t.mutates||[],p=t.complexity||0,c=Object.create(null);o.forEach(function(e){return c[e]=e});var l={id:a,mutates:u,complexity:p,params:n,optional:r,scope:o,scopeDefaults:c,hasScope:i,resultDependency:s};return this.map[a]=l,l},e.prototype.setTypes=function(e,t,n,r,o){void 0===n&&(n=Object.create(null)),void 0===r&&(r=Object.create(null)),void 0===o&&(o=Object.create(null));var i={returnType:t,params:n,optional:r,scope:o};return this.types[e.id]=i,i},e}(),K=function(){function e(e){this.prefix=e,this.map=Object.create(null),this.list=[]}return e.prototype.set=function(e,t,n,r){var o=this.prefix+e,i={id:o,op:t.id,value:n||t.params[0],params:r||{}};return this.map[o]=i,this.list.push(i),i},e.prototype.get=function(e){return this.map[e]||this.map[this.prefix+e]},e}(),z={Entity:"@",Any:"any",Boolean:"bool",Color:"color",Date:"date",Enum:"enum",Function:"func",List:"list",Many:"many",Not:"not",Map:"map",Null:"null",Number:"num",Object:"obj",Optional:"?",Relation:"rel",Set:"set",Text:"text",Tuple:"tuple",Delimiter:":"},X=new J(z.Boolean+z.Delimiter),$=new K(z.Boolean+z.Delimiter),Q=X,Z={create:Q.set("create"),maybe:Q.set("maybe",{},["value"]),and:Q.set("&",{},["a","b"]),or:Q.set("|",{},["a","b"]),xor:Q.set("^",{},["a","b"]),not:Q.set("!",{},["a"]),cmp:Q.set("cmp",{},["value","test"]),isValid:Q.set("?",{},["value"]),isTrue:Q.set("t?",{},["value"]),isFalse:Q.set("f?",{},["value"]),isEqual:Q.set("=",{},["value","test"]),isNotEqual:Q.set("!=",{},["value","test"]),asAny:Q.set("~"+z.Any,{},["value"]),asBoolean:Q.set("~"+z.Boolean,{},["value"]),asColor:Q.set("~"+z.Color,{},["value"]),asDate:Q.set("~"+z.Date,{},["value"]),asList:Q.set("~"+z.List,{},["value"]),asMap:Q.set("~"+z.Map,{},["value"]),asNumber:Q.set("~"+z.Number,{},["value"]),asObject:Q.set("~"+z.Object,{},["value"]),asText:Q.set("~"+z.Text,{},["value"]),asTuple:Q.set("~"+z.Tuple,{},["value"]),asSet:Q.set("~"+z.Set,{},["value"])},ee=(H=function(e,t){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}H(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ee(t,e),t.decode=function(e,n){return new t(e[1]||{})},t.encode=function(e){return m(e.options)?this.id:[this.id,e.options]},t.describe=function(e,t){return l(e)?this.baseType:null},t.register=function(){},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){return!n.exact&&!n.strict||e instanceof t},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return Tn.op(Z.create,{})},t.prototype.getValidateExpression=function(){return Tn.op(Z.isValid,{value:Tn.get("value")})},t.prototype.getCompareExpression=function(){return Tn.op(Z.cmp,{value:Tn.get("value"),test:Tn.get("test")})},t.prototype.isValid=function(e){if(l(e))return!0;var t=e+"";return!(!this.options.true||!this.options.true[t])||!(!this.options.false||!this.options.false[t])},t.prototype.normalize=function(e){if(!l(e)){var t=e+"";if(this.options.true&&this.options.true[t])return!0;if(this.options.false&&this.options.false[t])return!1}return e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t(j(this.options))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return!1},t.prototype.random=function(e){return e(0,1,!1)<.5},t.prototype.fromJson=function(e){return e},t.prototype.toJson=function(e){return e},t.id=z.Boolean,t.operations=X,t.computeds=$,t.baseType=new t({}),t.describePriority=4,t.registered=!1,t}(B),ne=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(e){function t(t){var n=e.call(this)||this;return n.expression=t,n}return ne(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]))},t.encode=function(e){var t=e.expression.encode();return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.expression.getComplexity(e)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expression.clone())},t.prototype.getType=function(e,t){return te.baseType},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){return e.step(t.STEP_NOT,n.expression,function(e){return n.expression=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_NOT?[1,this.expression]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.expression.setParent(this)},t.prototype.validate=function(e,t,n){this.validateType(e,t,te.baseType,this.expression,n)},t.STEP_NOT="not",t.id="not",t}(W),oe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ie=function(e){function t(t){var n=e.call(this)||this;return n.expressions=t,n}return oe(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getExpression(e)}))},t.encode=function(e){var t=e.expressions.map(function(e){return e.encode()});return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.expressions.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},0)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expressions.map(function(e){return e.clone()}))},t.prototype.getType=function(e,t){return te.baseType},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return t.expressions.forEach(function(n,r){return e.step(r,n,function(e){return t.expressions.splice(r,1,e)},function(){return t.expressions.splice(r,1)})})})},t.prototype.getExpressionFromStep=function(e){return i(e[0])&&e[0]<this.expressions.length?[1,this.expressions[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.expressions.forEach(function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){var r=this,o=te.baseType;this.expressions.forEach(function(i){r.validateType(e,t,o,i,n)})},t.id="and",t}(W),se=new J(z.Any+z.Delimiter),ae=new K(z.Any+z.Delimiter),ue=se,pe={complexity:2},ce={cmp:ue.set("cmp",pe,["value","test"]),copy:ue.set("copy",pe,["value"]),isDefined:ue.set("isDefined",{},["value"]),getDefined:ue.set("getDefined",{},["value","defined"],[],["defined"],["defined"],["value"]),coalesce:ue.set("coalesce",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),require:ue.set("require",{},["value"],[],[],[],["value"]),ternary:ue.set("ternary",{},["condition","truthy","falsy"],[],[],[],["truthy","falsy"]),isValid:ue.set("?",{},["value"]),isEqual:ue.set("=",pe,["value","test"]),isNotEqual:ue.set("!=",pe,["value","test"]),isLess:ue.set("<",pe,["value","test"]),isLessOrEqual:ue.set("<=",pe,["value","test"]),isGreater:ue.set(">",pe,["value","test"]),isGreaterOrEqual:ue.set(">=",pe,["value","test"]),asAny:ue.set("~"+z.Any,{},["value"]),asBoolean:ue.set("~"+z.Boolean,{},["value"]),asColor:ue.set("~"+z.Color,{},["value"]),asDate:ue.set("~"+z.Date,{},["value"]),asList:ue.set("~"+z.List,{},["value"]),asMap:ue.set("~"+z.Map,{},["value"]),asNumber:ue.set("~"+z.Number,{},["value"]),asObject:ue.set("~"+z.Object,{},["value"]),asText:ue.set("~"+z.Text,{},["value"]),asTuple:ue.set("~"+z.Tuple,{},["value"]),asSet:ue.set("~"+z.Set,{},["value"])},le=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return le(t,e),t.decode=function(e){return t.baseType},t.encode=function(e){return this.id},t.describe=function(e){return null===e?this.baseType:null},t.register=function(){},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){return e instanceof t},t.prototype.isOptional=function(){return!0},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null)},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return Tn.null()},t.prototype.getValidateExpression=function(){return Tn.op(ce.isEqual,{value:Tn.get("value"),test:Tn.null()})},t.prototype.getCompareExpression=function(){return Tn.op(ce.cmp,{value:Tn.get("value"),test:Tn.get("test")})},t.prototype.isValid=function(e){return null==e},t.prototype.normalize=function(e){return e},t.prototype.newInstance=function(){return this},t.prototype.clone=function(){return this},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return null},t.prototype.random=function(e){return null},t.prototype.fromJson=function(e){return null},t.prototype.toJson=function(e){return null},t.id=z.Null,t.operations=new J(z.Null+z.Delimiter),t.computeds=new K(z.Null+z.Delimiter),t.baseType=new t(null),t.describePriority=6,t.registered=!1,t}(B),ye=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ye(t,e),t.decode=function(e,t){return this.instance},t.encode=function(e){return[this.id]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return this},t.prototype.getType=function(e,t){return fe.baseType},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null)},t.prototype.validate=function(e,t,n){},t.id="noop",t.instance=new t,t}(W),he=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ve=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return he(t,e),t.decode=function(e,t){return this.baseType},t.encode=function(e){return this.id},t.describe=function(e,n){return y(e)&&s(e.$any)?new t({}):null},t.register=function(){},t.addJsonReader=function(e,t){this.jsonReaders.push({priority:e,reader:t}),this.jsonReaders.sort(function(e,t){return t.priority-e.priority})},t.addJsonWriter=function(e,t){this.jsonWriters.push({priority:e,writer:t}),this.jsonWriters.sort(function(e,t){return t.priority-e.priority})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isCompatible=function(e){return!0},t.prototype.isDeepCompatible=function(e,t){return!0},t.prototype.isOptional=function(){return!0},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return Tn.string()},t.prototype.getValidateExpression=function(){return Tn.true()},t.prototype.getCompareExpression=function(){return Tn.op(ce.cmp,{value:Tn.get("value"),test:Tn.get("test")})},t.prototype.isValid=function(e){return!0},t.prototype.normalize=function(e){return e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t({})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return""},t.prototype.random=function(e){return null},t.prototype.fromJson=function(e){var n,r,o=this,i=function(e){return o.fromJson(e)};try{for(var s=ve(t.jsonReaders),a=s.next();!a.done;a=s.next()){var u=a.value.reader(e,i);if(void 0!==u)return u}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return e},t.prototype.toJson=function(e){var n,r,o=this,i=function(e){return o.toJson(e)};try{for(var s=ve(t.jsonWriters),a=s.next();!a.done;a=s.next()){var u=a.value.writer(e,i);if(void 0!==u)return u}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return e},t.id=z.Any,t.operations=se,t.computeds=ae,t.baseType=new t({}),t.describePriority=8,t.registered=!1,t.jsonReaders=[],t.jsonWriters=[],t}(B),ge=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Te=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},be=function(e){function t(t,n){var r=e.call(this)||this;return r.define=t,r.body=n,r}return ge(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){var t=Te(e,2),r=t[0],o=t[1];return[r,n.getExpression(o)]}),n.getExpression(e[2]))},t.encode=function(e){var t=e.define.map(function(e){var t=Te(e,2);return[t[0],t[1].encode()]});return[this.id,t,e.body.encode()]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.define.reduce(function(t,n){var r=Te(n,2),o=(r[0],r[1]);return Math.max(t,o.getComplexity(e))},this.body.getComplexity(e))},t.prototype.getScope=function(){var e={};return this.define.forEach(function(t){var n=Te(t,2),r=n[0];n[1];return e[r]=me.baseType}),e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.define.map(function(e){var t=Te(e,2);return[t[0],t[1].clone()]}),this.body.clone())},t.prototype.getType=function(e,t){var n=e.getContextWithScope(t),r=n.scope,o=n.context;return this.define.forEach(function(t){var n=Te(t,2),i=n[0],s=n[1];return r[i]=s.getType(e,o)}),this.body.getType(e,o)},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_DEFINE,function(){return n.define.forEach(function(t,r){var o=Te(t,2),i=o[0],s=o[1];return e.step(i,s,function(e){return n.define[r].splice(1,1,e)},function(){return n.define.splice(r,1)})})}),e.step(t.STEP_BODY,n.body,function(e){return n.body=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_BODY?[1,this.body]:e[0]===t.STEP_DEFINE?[2,this.define.filter(function(t){return Te(t,1)[0]===e[1]}).map(function(e){var t=Te(e,2);t[0];return t[1]})[0]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.define.forEach(function(e){var n=Te(e,2);n[0];return n[1].setParent(t)}),this.body.setParent(this)},t.prototype.validate=function(e,t,n){var r=e.getContextWithScope(t);this.define.forEach(function(t){var o=Te(t,2),i=o[0],s=o[1];s.validate(e,r.context,n),r.scope[i]=s.getType(e,r.context)}),this.body.validate(e,r.context,n)},t.prototype.with=function(e,t){var n,r=s(e)?((n={})[e]=t,n):e,o=function(e){var t=Tn.parse(r[e]),n=i.define.find(function(t){return Te(t,1)[0]===e});n?n[1]=t:i.define.push([e,t]),t.setParent(i)},i=this;for(var a in r)o(a);return this},t.prototype.run=function(e){return this.body=e,this.body.setParent(this),this},t.STEP_DEFINE="define",t.STEP_BODY="body",t.id="def",t}(W),xe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oe=1e5,Ee="break",Se=function(e){function t(t,n,r,o){void 0===r&&(r=Ee),void 0===o&&(o=Oe);var i=e.call(this)||this;return i.condition=t,i.body=n,i.breakVariable=r,i.maxIterations=o,i}return xe(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]),n.getExpression(e[2]),e[3]||Ee,parseInt(e[4])||this.MAX_ITERATIONS)},t.encode=function(e){var t=[this.id,e.condition.encode(),e.body.encode()],n=e.maxIterations!==this.MAX_ITERATIONS;return(e.breakVariable!==Ee||n)&&t.push(e.breakVariable),n&&t.push(e.maxIterations),t},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return Math.max(this.condition.getComplexity(e),this.body.getComplexity(e))+1},t.prototype.getScope=function(){var e;return(e={})[this.breakVariable]=te.baseType,e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.condition.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},t.prototype.getType=function(e,t){var n=e.getContextWithScope(t,this.getScope()).context,r=this.body.getType(e,n);return r?di.optional(r):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_CONDITION,n.condition,function(e){return n.condition=e}),e.step(t.STEP_BODY,n.body,function(e){return n.body=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_CONDITION?[1,this.condition]:e[0]===t.STEP_BODY?[1,this.body]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.condition.setParent(this),this.body.setParent(this)},t.prototype.validate=function(e,t,n){this.validateType(e,t,te.baseType,this.condition,n);var r=e.getContext(t,this.getScope());this.body.validate(e,r,n)},t.prototype.do=function(e,t){return this.body=e,this.body.setParent(this),t&&(this.condition=t,this.condition.setParent(this)),this},t.prototype.while=function(e){return this.condition=e,this.condition.setParent(this),this},t.prototype.withBreak=function(e){return this.breakVariable=e,this},t.prototype.withMax=function(e){return this.maxIterations=e,this},t.STEP_CONDITION="condition",t.STEP_BODY="body",t.MAX_ITERATIONS=Oe,t.id="do",t}(W),we=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pe=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},_e=function(e){function t(t){var n=e.call(this)||this;return n.chain=t,n}return we(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getExpression(e)}))},t.encode=function(e){var t=e.chain.map(function(e){return e.encode()});return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.chain.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},0)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.chain.map(function(e){return e.clone()}))},t.prototype.getType=function(e,t){return this.chain[this.chain.length-1].getType(e,t)},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return t.chain.forEach(function(n,r){return e.step(r,n,function(e){return t.chain.splice(r,1,e)},function(){return t.chain.splice(r,1)})})})},t.prototype.getExpressionFromStep=function(e){return i(e[0])&&e[0]<this.chain.length?[1,this.chain[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.chain.forEach(function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){this.chain.forEach(function(r){r.validate(e,t,n)})},t.prototype.add=function(e){var t,n,r=a(e)?e:[e];try{for(var o=Pe(r),i=o.next();!i.done;i=o.next()){var s=i.value;this.chain.push(s),s.setParent(this)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this},t.id="chain",t}(W),Me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ie=function(e){function t(t){var n=e.call(this)||this;return n.comment=t,n}return Me(t,e),t.decode=function(e,n){return new t(e[1])},t.encode=function(e){return[this.id,e.comment]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.comment)},t.prototype.getType=function(e,t){return fe.baseType},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){},t.id="comment",t.instance=new t(""),t}(W),Ce=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),De=function(e){function t(t,n){var r=e.call(this)||this;return r.expression=t,r.name=n,r}return Ce(t,e),t.decode=function(e,n){var r=e[1];return new t(n.getExpression(e[2]),r)},t.encode=function(e){return[this.id,e.name,e.expression.encode()]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){var t=e.getComputed(this.name);if(!t)return 0;var n=e.getOperation(t.op);return Math.max(n?n.complexity:0,this.expression.getComplexity(e))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expression.encode(),this.name)},t.prototype.getType=function(e,t){return e.getComputedReturnType(this.name,this.expression.getType(e,t))},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){return e.step(t.STEP_EXPRESSION,n.expression,function(e){return n.expression=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_EXPRESSION?[1,this.expression]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.expression.setParent(this)},t.prototype.validate=function(e,t,n){var r=this.expression.getType(e,t);r&&e.hasComputed(r,this.name)||n({type:q.INVALID_EXPRESSION,severity:R.HIGH,context:t,subject:this.expression,parent:this}),this.expression.validate(e,t,n)},t.STEP_EXPRESSION="expression",t.id="comp",t}(W),ke=new J(z.Text+z.Delimiter),je=new K(z.Text+z.Delimiter),Ne=ke,Ae={create:Ne.set("create"),uuid:Ne.set("uuid"),maybe:Ne.set("maybe",{},["value"]),append:Ne.set("+",{},["value","append"]),prepend:Ne.set("pre",{},["value","prepend"]),lower:Ne.set("lo",{},["value"]),upper:Ne.set("up",{},["value"]),char:Ne.set("@",{},["value","index"],["outside"]),replace:Ne.set("replace",{},["value","find","replace"]),repeat:Ne.set("repeat",{},["value","times"]),split:Ne.set("split",{},["value","by"],["limit"]),chars:Ne.set("chars",{},["value"]),sub:Ne.set("sub",{},["value"],["start","end"]),indexOf:Ne.set("i?",{},["value","search"],["start"]),lastIndexOf:Ne.set("li?",{},["value","search"],["start"]),trim:Ne.set("trim",{},["value"],["start","end"]),startsWith:Ne.set("starts",{},["value","test"]),endsWith:Ne.set("ends",{},["value","test"]),soundex:Ne.set("soundex",{complexity:1},["value"],["max","min"]),metaphone:Ne.set("metaphone",{complexity:1},["value"]),distance:Ne.set("dist",{complexity:1},["value","test"]),length:Ne.set("len",{},["value"]),compare:Ne.set("cmp",{},["value","test"],["ignoreCase"]),like:Ne.set("like",{},["value","pattern"],["ignoreCase"]),pad:Ne.set("pad",{},["value","padding","min"],["max","append"]),regexTest:Ne.set("regexTest",{},["value","regex"],["ignoreCase","multiline"]),regexSplit:Ne.set("regexSplit",{},["value","regex"],["limit","ignoreCase","multiline"]),regexMatch:Ne.set("regexMatch",{},["value","regex"],["ignoreCase","multiline"]),regexMatchAll:Ne.set("regexMatchAll",{},["value","regex"],["ignoreCase","multiline"]),regexReplace:Ne.set("regexReplace",{},["value","regex","replacement"],["all","ignoreCase","multiline"]),regexReplaceDynamic:Ne.set("regexReplaceDynamic",{},["value","regex","replace"],["all","ignoreCase","multiline"],["match"],["replace"]),regexIndexOf:Ne.set("regexIndexOf",{},["value","regex"],["ignoreCase","multiline"]),base64:Ne.set("base64",{},["value"]),unbase64:Ne.set("unbase64",{},["value"]),encodeURI:Ne.set("encodeURI",{},["value"]),decodeURI:Ne.set("decodeURI",{},["value"]),encodeURIComponent:Ne.set("encodeURIComponent",{},["value"]),decodeURIComponent:Ne.set("decodeURIComponent",{},["value"]),md5:Ne.set("md5",{},["value"]),encrypt:Ne.set("encrypt",{},["value","secret"]),decrypt:Ne.set("decrypt",{},["value","secret"]),toNumber:Ne.set("toNumber",{},["value"],["invalidValue"]),isValid:Ne.set("?",{},["value"]),isEmpty:Ne.set("0?",{},["value"]),isNotEmpty:Ne.set("n?",{},["value"]),isEqual:Ne.set("=",{},["a","b"],["ignoreCase"]),isNotEqual:Ne.set("!=",{},["a","b"],["ignoreCase"]),isLess:Ne.set("<",{},["value","test"],["ignoreCase"]),isLessOrEqual:Ne.set("<=",{},["value","test"],["ignoreCase"]),isGreater:Ne.set(">",{},["value","test"],["ignoreCase"]),isGreaterOrEqual:Ne.set(">=",{},["value","test"],["ignoreCase"]),isLower:Ne.set("lo?",{},["value"]),isUpper:Ne.set("up?",{},["value"]),isUuid:Ne.set("uuid?",{},["value"]),asAny:Ne.set("~"+z.Any,{},["value"]),asBoolean:Ne.set("~"+z.Boolean,{},["value"]),asColor:Ne.set("~"+z.Color,{},["value"]),asDate:Ne.set("~"+z.Date,{},["value"]),asList:Ne.set("~"+z.List,{},["value"]),asMap:Ne.set("~"+z.Map,{},["value"]),asNumber:Ne.set("~"+z.Number,{},["value"]),asObject:Ne.set("~"+z.Object,{},["value"]),asText:Ne.set("~"+z.Text,{},["value"]),asTuple:Ne.set("~"+z.Tuple,{},["value"]),asSet:Ne.set("~"+z.Set,{},["value"])};je.set("toUpper",Ae.upper),je.set("toLower",Ae.lower),je.set("chars",Ae.chars),je.set("trim",Ae.trim),je.set("soundex",Ae.soundex),je.set("metaphone",Ae.metaphone),je.set("base64",Ae.base64),je.set("unbase64",Ae.unbase64),je.set("encodeURI",Ae.encodeURI),je.set("decodeURI",Ae.decodeURI),je.set("encodeURIComponent",Ae.encodeURIComponent),je.set("decodeURIComponent",Ae.decodeURIComponent),je.set("md5",Ae.md5),je.set("toNumber",Ae.toNumber),je.set("isEmpty",Ae.isEmpty),je.set("isNotEmpty",Ae.isNotEmpty),je.set("isLower",Ae.isLower),je.set("isUpper",Ae.isUpper);var Le=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Re=function(){return(Re=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},qe="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-+=:.",Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Le(t,e),t.decode=function(e){return new t(this.decodeOptions(e[1]||{}))},t.encode=function(e){return m(e.options)?this.id:[this.id,this.encodeOptions(e.options)]},t.decodeOptions=function(e){var t=e.matches;return t&&(e.matches=new RegExp(t[0],t[1])),e},t.encodeOptions=function(e){var t=Re({},e),n=t.matches;return n&&(t.matches=[n.source,n.flags]),t},t.describe=function(e){return s(e)?new t({min:e.length,max:e.length,requireLower:e.toLowerCase()===e,requireUpper:e.toUpperCase()===e}):null},t.register=function(){},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.max=Math.max(t.max,n.max),t.min=Math.min(t.min,n.min),t.requireLower=t.requireLower&&n.requireLower,t.requireUpper=t.requireUpper&&n.requireUpper},t.prototype.getSubType=function(e,n,r){if(ze.is(e)){if("length"===e.value)return di.LENGTH;if(i(e.value))return di.CHAR}var o=e.getType(n,r);if(o){if((o=o.getRequired())instanceof xn)return di.CHAR;if(o instanceof Je){if(o.options.value instanceof xn)return di.CHAR;if(o.options.value instanceof t){var s=Array.from(o.options.constants.values());if(1===s.length&&"length"===s[0])return di.LENGTH}}}},t.prototype.getSubTypes=function(e){return[{key:"length",value:di.LENGTH},{key:di.INDEX,value:di.optional(di.CHAR)}]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){if(!(e instanceof t))return!1;if(n.value){var r=this.options.min,o=e.options.min;if(r&&(!o||o<r))return!1;var i=this.options.max,s=e.options.max;if(i&&(!s||s>i))return!1;var a=this.options.forceLower||this.options.requireUpper,u=e.options.forceLower||e.options.requireLower;if(a&&!u)return!1;var p=this.options.forceUpper||this.options.requireUpper,c=e.options.forceUpper||e.options.requireUpper;if(p&&!c)return!1;var l=this.options.matches,f=e.options.matches;if(l&&(!f||f.source!==l.source))return!1}return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){this.options={}},t.prototype.getCreateExpression=function(){return Tn.op(Ae.create,{})},t.prototype.getValidateExpression=function(){return Tn.op(Ae.isValid,{value:Tn.get("value")})},t.prototype.getCompareExpression=function(){return Tn.op(Ae.compare,{value:Tn.get("value"),test:Tn.get("test"),ignoreCase:Tn.true()})},t.prototype.isValid=function(e){if(!s(e))return!1;var t=this.options,n=t.min,r=t.max,o=t.requireLower,a=t.requireUpper,u=t.matches,p=t.forceLower,c=t.forceUpper;return!(i(n)&&e.length<n)&&(!(i(r)&&e.length>r)&&(!(o&&e!==e.toLowerCase()&&!p)&&(!(a&&e!==e.toUpperCase()&&!c)&&!(u&&u instanceof RegExp&&!u.test(e)))))},t.prototype.normalize=function(e){return s(e)&&(this.options.forceLower&&(e=e.toLowerCase()),this.options.forceUpper&&(e=e.toUpperCase())),e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t(j(this.options))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return""},t.prototype.random=function(e){for(var t=this.options,n=t.min,r=t.max,o=t.requireLower,i=t.forceLower,s=t.requireUpper,a=t.forceUpper,u=o||i,p=s||a,c=e(M(n,1),M(r,16)+1,!0),l="",f=0;f<c;f++)l+=qe.charAt(e(0,qe.length,!0));return u&&(l=l.toLowerCase()),p&&(l=l.toUpperCase()),l},t.prototype.fromJson=function(e){return e},t.prototype.toJson=function(e){return e},t.id=z.Text,t.operations=ke,t.computeds=je,t.baseType=new t({}),t.describePriority=3,t.registered=!1,t}(B),Fe=new J(z.Map+z.Delimiter),Ye=new K(z.Map+z.Delimiter),Be=Fe,Ge={create:Be.set("create"),createLike:Be.set("createLike",{},["map"],[],[],[],["map"]),createFor:Be.set("createFor",{},["value"],["key"],[],[],["value","key"]),maybe:Be.set("maybe",{},["value"]),get:Be.set("get",{},["map","key"],[],[],[],["map"]),set:Be.set("set",{mutates:["map"]},["map","key","value"],[],["existingValue"],["value"],["map"]),has:Be.set("has",{},["map","key"]),delete:Be.set("delete",{mutates:["map"]},["map","key"]),keys:Be.set("keys",{complexity:1},["map"],[],[],[],["map"]),values:Be.set("values",{complexity:1},["map"],[],[],[],["map"]),entries:Be.set("entries",{complexity:1},["map"],[],[],[],["map"]),pairs:Be.set("pairs",{complexity:1},["map"],[],[],[],["map"]),clear:Be.set("clear",{mutates:["map"]},["map"],[],[],[],["map"]),count:Be.set("count",{},["map"]),cmp:Be.set("cmp",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),copy:Be.set("copy",{complexity:1},["map"],["deepCopy","deepCopyKey"],["map","key","value"],["deepCopy","deepCopyKey"],["map"]),map:Be.set("map",{complexity:1},["map"],["transform","transformKey"],["map","key","value"],["transform","transformKey"],["map"]),toPlainObject:Be.set("plain",{complexity:1},["map"]),fromPlainObject:Be.set("fromPlain",{complexity:1},["object"],[],[],[],["object"]),isValid:Be.set("?",{},["value"]),isEqual:Be.set("=",{complexity:1},["value","test","isEqual"],[],["key","value","test"],["isEqual"]),isNotEqual:Be.set("!=",{complexity:1},["value","test","isEqual"],[],["key","value","test"],["isEqual"]),isLess:Be.set("<",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isLessOrEqual:Be.set("<=",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isGreater:Be.set(">",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),isGreaterOrEqual:Be.set(">=",{complexity:1},["value","test","compare"],[],["key","value","test"],["compare"]),asAny:Be.set("~"+z.Any,{},["value"]),asBoolean:Be.set("~"+z.Boolean,{},["value"]),asColor:Be.set("~"+z.Color,{},["value"]),asDate:Be.set("~"+z.Date,{},["value"]),asList:Be.set("~"+z.List,{},["value"]),asMap:Be.set("~"+z.Map,{},["value"]),asNumber:Be.set("~"+z.Number,{},["value"]),asObject:Be.set("~"+z.Object,{},["value"]),asText:Be.set("~"+z.Text,{},["value"]),asTuple:Be.set("~"+z.Tuple,{},["value"]),asSet:Be.set("~"+z.Set,{},["value"])};Ye.set("copy",Ge.copy),Ye.set("keys",Ge.keys),Ye.set("values",Ge.values),Ye.set("entries",Ge.entries),Ye.set("pairs",Ge.pairs),Ye.set("count",Ge.count);var We=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},He=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return We(t,e),t.decode=function(e,n){var r=n.getType(e[1]),o=n.getType(e[2]),i=new Map(e[3].map(function(e){var t=Ue(e,2),n=t[0],i=t[1];return[r.fromJson(n),o.fromJson(i)]}));return new t({key:r,value:o,constants:i})},t.encode=function(e){var t=e.options,n=t.key,r=t.value,o=t.constants;return[this.id,n.encode(),r.encode(),Array.from(o.entries()).map(function(e){var t=Ue(e,2),o=t[0],i=t[1];return[n.toJson(o),r.toJson(i)]})]},t.describe=function(){return null},t.register=function(){},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return this.options.value.getOperations()},t.prototype.merge=function(e){var t,n,r=this.options.constants,o=e.options.constants;this.options.key=di.merge(this.options.key,e.options.key),this.options.value=di.merge(this.options.value,e.options.value);try{for(var i=He(o.entries()),s=i.next();!s.done;s=i.next()){var a=Ue(s.value,2),u=a[0],p=a[1];r.set(u,p)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.getSubType=function(e,t,n){return this.options.value.getSubType(e,t,n)},t.prototype.getSubTypes=function(e){return this.options.value.getSubTypes(e)},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this.options.value},t.prototype.isWrapper=function(){return!0},t.prototype.isDeepCompatible=function(e,n){if(void 0===n&&(n={}),!(e instanceof t))return!1;var r=this.options,o=r.key,i=r.value;return!(n.exact&&!o.isCompatible(e.options.key,n))&&i.isCompatible(e.options.value)},t.prototype.isOptional=function(){return this.options.value.isOptional()},t.prototype.isSimple=function(){return this.options.value.isSimple()},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_KEY,n.options.key,function(e){return n.options.key=e}),e.step(t.STEP_VALUE,n.options.value,function(e){return n.options.value=e})})},t.prototype.getTypeFromStep=function(e){return e===t.STEP_KEY?this.options.key:e===t.STEP_VALUE?this.options.value:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.key.setParent(this),this.options.value.setParent(this)},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return this.options.value.getCreateExpression()},t.prototype.getValidateExpression=function(){return this.options.value.getValidateExpression()},t.prototype.getCompareExpression=function(){return this.options.value.getCompareExpression()},t.prototype.getValueChangeExpression=function(e,n,r){return n===t.STEP_KEY?Tn.op(Ge.map,{map:Tn.get("value"),transformKey:e},{key:"value",value:"actualValue"}):Tn.op(Ge.map,{map:Tn.get("value"),transform:e})},t.prototype.isValid=function(e){var t,n,r=this.options,o=r.constants;if(!r.value.isValid(e))return!1;try{for(var i=He(o.values()),s=i.next();!s.done;s=i.next()){if(0===C(s.value,e))return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!1},t.prototype.normalize=function(e){return this.options.value.normalize(e)},t.prototype.newInstance=function(){var e=this.options,n=e.key,r=e.value;return new t({key:n.newInstance(),value:r.newInstance(),constants:new Map})},t.prototype.clone=function(){var e=this.options,n=e.key,r=e.value,o=e.constants;return new t({key:n.clone(),value:r.clone(),constants:new Map(o.entries())})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){var e=this.options,t=e.value,n=e.constants,r=n.keys().next();return r?n.get(r):t.create()},t.prototype.random=function(e){var t=Array.from(this.options.constants.values());return t[e(0,t.length,!0)]},t.prototype.fromJson=function(e){return this.options.value.fromJson(e)},t.prototype.toJson=function(e){return this.options.value.toJson(e)},t.STEP_KEY="key",t.STEP_VALUE="value",t.id=z.Enum,t.operations=new J(z.Enum+z.Delimiter),t.computeds=new K(z.Enum+z.Delimiter),t.baseType=new t({key:Ve.baseType,value:Ve.baseType,constants:new Map}),t.describePriority=-1,t.registered=!1,t}(B),Ke=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ze=function(e){function t(t){var n=e.call(this)||this;return n.value=t,n}return Ke(t,e),t.has=function(e,n){return e instanceof t&&e.value===n},t.is=function(e){return e instanceof t},t.decode=function(e,n){return new t(me.baseType.fromJson(e[1]))},t.encode=function(e){var t=me.baseType.toJson(e.value);return a(t)?[this.id,t]:t},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(j(this.value))},t.prototype.getType=function(e,t){var n=this.value;if(s(n))return new Je({key:Ve.baseType.newInstance(),value:Ve.baseType.newInstance(),constants:new Map([[n,n]])});if(i(n))return new Je({key:xn.baseType.newInstance(),value:xn.baseType.newInstance(),constants:new Map([[n,n]])});var r=e.describe(this.value);return r&&r.removeDescribedRestrictions(),r},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){},t.id="constant",t}(W),Xe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$e=1e5,Qe="break",Ze=function(e){function t(t,n,r,o,i,s){void 0===i&&(i=Qe),void 0===s&&(s=$e);var a=e.call(this)||this;return a.variable=t,a.start=n,a.end=r,a.body=o,a.breakVariable=i,a.maxIterations=s,a}return Xe(t,e),t.decode=function(e,n){return new t(e[1],n.getExpression(e[2]),n.getExpression(e[3]),n.getExpression(e[4]),e[5]||Qe,parseInt(e[6])||this.MAX_ITERATIONS)},t.encode=function(e){var t=[this.id,e.variable,e.start.encode(),e.end.encode(),e.body.encode()],n=e.maxIterations!==this.MAX_ITERATIONS;return(e.breakVariable!==Qe||n)&&t.push(e.breakVariable),n&&t.push(e.maxIterations),t},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return Math.max(this.start.getComplexity(e),this.end.getComplexity(e),this.body.getComplexity(e))+1},t.prototype.getScope=function(){var e;return(e={})[this.variable]=xn.baseType.newInstance(),e[this.breakVariable]=te.baseType,e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.variable,this.start.clone(),this.end.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},t.prototype.getType=function(e,t){var n=e.getContextWithScope(t,this.getScope()).context,r=this.body.getType(e,n);return r?di.optional(r):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_START,n.start,function(e){return n.start=e}),e.step(t.STEP_END,n.end,function(e){return n.end=e}),e.step(t.STEP_BODY,n.body,function(e){return n.body=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_START?[1,this.start]:e[0]===t.STEP_END?[1,this.end]:e[0]===t.STEP_BODY?[1,this.body]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.start.setParent(this),this.end.setParent(this),this.body.setParent(this)},t.prototype.validate=function(e,t,n){this.validateType(e,t,xn.baseType,this.start,n),this.validateType(e,t,xn.baseType,this.end,n);var r=e.getContext(t,this.getScope());this.body.validate(e,r,n)},t.prototype.loop=function(e,t,n,r,o,s){return this.variable=e,this.start=Tn.parse(t),this.start.setParent(this),this.end=Tn.parse(n),this.end.setParent(this),r&&(this.body=r,this.body.setParent(this)),o&&(this.breakVariable=o),i(s)&&(this.maxIterations=s),this},t.prototype.startAt=function(e){return this.start=Tn.parse(e),this.start.setParent(this),this},t.prototype.endAt=function(e){return this.end=Tn.parse(e),this.end.setParent(this),this},t.prototype.run=function(e){return this.body=e,this.body.setParent(this),this},t.prototype.withVariable=function(e){return this.variable=e,this},t.prototype.withBreak=function(e){return this.breakVariable=e,this},t.prototype.withMax=function(e){return this.maxIterations=e,this},t.STEP_START="start",t.STEP_END="end",t.STEP_BODY="body",t.MAX_ITERATIONS=$e,t.id="for",t}(W),et=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tt=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},nt=function(e){function t(t){var n=e.call(this)||this;return n.path=t,n}return et(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getExpression(e)}))},t.encode=function(e){var t=e.path.map(function(e){return e.encode()});return[this.id,t]},t.create=function(e){return new t(Tn.parse(e))},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.path.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},0)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.path.map(function(e){return e.clone()}))},t.prototype.getType=function(e,t){return e.getPathType(this.path,t)},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return t.path.forEach(function(n,r){return e.step(r,n,function(e){return t.path.splice(r,1,e)},function(){return t.path.splice(r,1)})})})},t.prototype.getExpressionFromStep=function(e){return i(e[0])&&e[0]<this.path.length?[1,this.path[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.path.forEach(function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){this.validatePath(e,t,t,this.path,n)},t.prototype.add=function(e){var t,n,r=a(e)?e:[e];try{for(var o=tt(r),i=o.next();!i.done;i=o.next()){var s=i.value,u=Tn.parse(s);this.path.push(u),u.setParent(this)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this},t.id="get",t}(W),rt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ot=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n}return rt(t,e),t.decode=function(e,n){return new t(e[1])},t.encode=function(e){return[this.id,e.name]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name)},t.prototype.getType=function(e,t){return e.getType(this.name,fe.baseType)},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){this.name?e.getEntity(this.name)||n({type:q.MISSING_TYPE,severity:R.HIGH,context:t,parent:this}):n({type:q.MISSING_TYPE_NAME,severity:R.HIGH,context:t,parent:this})},t.id="type",t.instance=new t(""),t}(W),it=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),st=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n}return it(t,e),t.decode=function(e,n){return new t(e[1])},t.encode=function(e){return[this.id,e.name]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return 0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name)},t.prototype.getType=function(e,t){return new Je({key:Ve.baseType,value:Ve.baseType,constants:new Map([["relation",this.name]])})},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.validate=function(e,t,n){this.name?e.getRelation(this.name)||n({type:q.MISSING_RELATION,severity:R.HIGH,context:t,parent:this}):n({type:q.MISSING_RELATION_NAME,severity:R.HIGH,context:t,parent:this})},t.id="relation",t.instance=new t(""),t}(W),at=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ut=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},pt=function(e){function t(t,n){var r=e.call(this)||this;return r.cases=t,r.otherwise=n,r}return at(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){var t=ut(e,2),r=t[0],o=t[1];return[n.getExpression(r),n.getExpression(o)]}),n.getExpression(e[2]))},t.encode=function(e){var t=e.cases.map(function(e){var t=ut(e,2),n=t[0],r=t[1];return[n.encode(),r.encode()]});return ze.has(e.otherwise,void 0)?[this.id,t]:[this.id,t,e.otherwise.encode()]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.cases.reduce(function(t,n){var r=ut(n,2),o=r[0],i=r[1];return Math.max(t,o.getComplexity(e),i.getComplexity(e))},this.otherwise.getComplexity(e))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.cases.map(function(e){var t=ut(e,2),n=t[0],r=t[1];return[n.clone(),r.clone()]}),this.otherwise.clone())},t.prototype.getType=function(e,t){var n=this.cases.map(function(e){var t=ut(e,2);t[0];return t[1]}).concat(this.otherwise).filter(function(e){return!!e}).map(function(n){return n.getType(e,t)}).filter(function(e){return!!e});return di.mergeMany(n)},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_CASES,function(){return n.cases.forEach(function(r,o){var i=ut(r,2),s=i[0],a=i[1];return e.step(o,function(){e.step(t.STEP_IF,s,function(e){return n.cases[o].splice(0,1,e)}),e.step(t.STEP_THEN,a,function(e){return n.cases[o].splice(1,1,e)})})})}),n.otherwise!==de.instance&&e.step(t.STEP_ELSE,n.otherwise,function(e){return n.otherwise=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_CASES?i(e[1])&&e[1]<this.cases.length?e[2]===t.STEP_IF?[3,this.cases[e[1]][0]]:e[2]===t.STEP_THEN?[3,this.cases[e[1]][1]]:null:null:e[0]===t.STEP_ELSE?[1,this.otherwise]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.cases.forEach(function(e){var n=ut(e,2),r=n[0],o=n[1];r.setParent(t),o.setParent(t)}),this.otherwise.setParent(this)},t.prototype.validate=function(e,t,n){var r=this,o=te.baseType;this.cases.forEach(function(i){var s=ut(i,2),a=s[0],u=s[1];r.validateType(e,t,o,a,n),u.validate(e,t,n)}),this.otherwise.validate(e,t,n)},t.prototype.if=function(e,t){return this.cases.push([e,t||de.instance]),e.setParent(this),t&&t.setParent(this),this},t.prototype.than=function(e){return this.cases[this.cases.length-1][1]=e,e.setParent(this),this},t.prototype.elseif=function(e,t){return this.cases.push([e,t||de.instance]),e.setParent(this),t&&t.setParent(this),this},t.prototype.else=function(e){return this.otherwise=e,this.otherwise.setParent(this),this},t.STEP_CASES="cases",t.STEP_IF="if",t.STEP_THEN="then",t.STEP_ELSE="else",t.id="if",t}(W),ct=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lt=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t,r.args=n,r}return ct(t,e),t.decode=function(e,n){return new t(e[1],x(e[2],function(e){return n.getExpression(e)}))},t.encode=function(e){var t=x(e.args,function(e){return e.encode()});return[this.id,e.name,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){var t=e.getFunction(this.name);return t?t.expression.getComplexity(e):0},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name,x(this.args,function(e){return e.clone()}))},t.prototype.getType=function(e,t){var n=e.getFunction(this.name),r=x(this.args,function(n){return n.getType(e,t)});return n?n.getReturnType(e,r):null},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return O(t.args,function(n,r){return e.step(r,n,function(e){return t.args[r]=e},function(){return delete t.args[r]})})})},t.prototype.getExpressionFromStep=function(e){return e[0]in this.args?[1,this.args[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,O(this.args,function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){var r=this,o=e.getFunction(this.name);if(o){var i={};O(o.params.options.props,function(o,s){var a=r.args[s];r.validateType(e,t,o,a,n),a&&(i[s]=a.getType(e,t))})}else n({type:q.MISSING_FUNCTION,severity:R.HIGH,context:t,subject:this})},t.prototype.named=function(e){return this.name=e,this},t.prototype.arg=function(e,t){var n,r=s(e)?((n={})[e]=t,n):e;for(var o in r){var i=Tn.parse(r[o]);this.args[o]=i,i.setParent(this)}return this},t.id="invoke",t}(W),ft=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yt=function(e){function t(t){var n=e.call(this)||this;return n.expressions=t,n}return ft(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getExpression(e)}))},t.encode=function(e){var t=e.expressions.map(function(e){return e.encode()});return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.expressions.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},0)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expressions.map(function(e){return e.clone()}))},t.prototype.getType=function(e,t){var n=this.expressions.map(function(n){return n.getType(e,t)}).concat(te.baseType).filter(function(e){return!!e});return di.mergeMany(n)},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return t.expressions.forEach(function(n,r){return e.step(r,n,function(e){return t.expressions.splice(r,1,e)},function(){return t.expressions.splice(r,1)})})})},t.prototype.getExpressionFromStep=function(e){return i(e[0])&&e[0]<this.expressions.length?[1,this.expressions[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.expressions.forEach(function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){var r=this,o=te.baseType;this.expressions.forEach(function(i){r.validateType(e,t,o,i,n)})},t.id="or",t}(W),dt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ht=function(){return(ht=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},vt=function(e){function t(t,n,r){void 0===r&&(r={});var o=e.call(this)||this;return o.name=t,o.params=n,o.scopeAlias=r,o}return dt(t,e),t.decode=function(e,n){return new t(e[1],x(e[2],function(e){return n.getExpression(e)}),e[3]||{})},t.encode=function(e){var t=x(e.params,function(e){return e.encode()});return m(e.scopeAlias)?[this.id,e.name,t]:[this.id,e.name,t,e.scopeAlias]},t.create=function(e,n,r){return void 0===r&&(r=Object.create(null)),new t(e.id,n,r)},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){var t=e.getOperation(this.name),n=t?t.complexity:0;for(var r in this.params)n=Math.max(n,this.params[r].getComplexity(e));return n},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.name,x(this.params,function(e){return e.clone()}),ht({},this.scopeAlias))},t.prototype.getType=function(e,t){return e.getOperationReturnType(this.name,this.params,this.scopeAlias,t)},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return O(t.params,function(n,r){return e.step(r,n,function(e){return t.params[r]=e},function(){return delete t.params[r]})})})},t.prototype.getExpressionFromStep=function(e){return e[0]in this.params?[1,this.params[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,O(this.params,function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){var r=this.name,o=this.params,i=this.scopeAlias,s=e.getOperation(r),a=e.getOperationTypes(r);if(s){var u=e.getOperationExpectedTypes(r,o,i,t),p=s.hasScope.length>0?e.getOperationScopeContext(r,u,i,t):t;for(var c in u){var l=-1!==s.optional.indexOf(c),f=u[c],y=l?di.optional(f):f,d=o[c],h=-1!==s.hasScope.indexOf(c)?p:t;this.validateType(e,h,y,d,n)}for(var c in o){d=o[c];var v=a.params[c];if(!(c in u)&&v){h=-1!==s.hasScope.indexOf(c)?p:t;n({type:q.MISSING_EXPRESSION,severity:R.HIGH,context:h,subject:d,parent:this}),o[c].validate(e,h,n)}}}else n({type:q.MISSING_OPERATION,severity:R.HIGH,context:t,subject:this})},t.prototype.param=function(e,t){var n=Tn.parse(t);return this.params[e]=n,n.setParent(this),this},t.prototype.alias=function(e,t){return this.scopeAlias[e]=t,this},t.prototype.and=function(e){var t=a(e)?e:[e];return new ie([this].concat(t))},t.prototype.or=function(e){var t=a(e)?e:[e];return new yt([this].concat(t))},t.prototype.not=function(){return new re(this)},t.id="op",t}(W),mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(e){function t(t){var n=e.call(this)||this;return n.value=t,n}return mt(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]))},t.encode=function(e){var t=e.value.encode();return void 0!==t?[this.id,t]:[this.id]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.value.getComplexity(e)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.value.encode())},t.prototype.getType=function(e,t){return this.value?this.value.getType(e,t):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){return e.step(t.STEP_VALUE,n.value,function(e){return n.value=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_VALUE?[1,this.value]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.value.setParent(this)},t.prototype.validate=function(e,t,n){this.value.validate(e,t,n)},t.STEP_VALUE="value",t.id="return",t}(W),Tt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bt=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},xt=function(e){function t(t,n){var r=e.call(this)||this;return r.path=t,r.value=n,r}return Tt(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getExpression(e)}),n.getExpression(e[2]))},t.encode=function(e){var t=e.path.map(function(e){return e.encode()});return[this.id,t,e.value.encode()]},t.create=function(e,n){return new t(Tn.parse(e),Tn.parse(n))},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.path.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},this.value.getComplexity(e))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.path.map(function(e){return e.clone()}),this.value.clone())},t.prototype.getType=function(e,t){return te.baseType},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_PATH,function(){return n.path.forEach(function(t,r){return e.step(r,t,function(e){return n.path.splice(r,1,e)},function(){return n.path.splice(r,1)})})}),e.step(t.STEP_VALUE,n.value,function(e){return n.value=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_PATH?i(e[1])&&e[1]<this.path.length?[2,this.path[e[1]]]:null:e[0]===t.STEP_VALUE?[1,this.value]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.path.forEach(function(e){return e.setParent(t)}),this.value.setParent(this)},t.prototype.validate=function(e,t,n){this.validatePath(e,t,t,this.path,n);var r=e.getPathType(this.path,t);r&&this.validateType(e,t,r,this.value,n)},t.prototype.add=function(e){var t,n,r=a(e)?e:[e];try{for(var o=bt(r),i=o.next();!i.done;i=o.next()){var s=i.value,u=Tn.parse(s);this.path.push(u),u.setParent(this)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this},t.prototype.to=function(e){return this.value=Tn.parse(e),this.value.setParent(this),this},t.STEP_PATH="path",t.STEP_VALUE="value",t.id="set",t}(W),Ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Et=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},St=function(e){function t(t,n){var r=e.call(this)||this;return r.value=t,r.path=n,r}return Ot(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]),e[2].map(function(e){return n.getExpression(e)}))},t.encode=function(e){var t=e.value.encode(),n=e.path.map(function(e){return e.encode()});return[this.id,t,n]},t.create=function(e,n){return new t(Tn.parse(e),Tn.parse(n))},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.path.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},this.value.getComplexity(e))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.value.clone(),this.path.map(function(e){return e.clone()}))},t.prototype.getType=function(e,t){var n=this.value.getType(e,t);return n?e.getPathType(this.path,n):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_VALUE,n.value,function(e){return n.value=e}),e.step(t.STEP_PATH,function(){n.path.forEach(function(t,r){return e.step(r,t,function(e){return n.path.splice(r,1,e)},function(){return n.path.splice(r,1)})})})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_PATH?i(e[1])&&e[1]<this.path.length?[2,this.path[e[1]]]:null:e[0]===t.STEP_VALUE?[1,this.value]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.value.setParent(this),this.path.forEach(function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){var r=this.value.getType(e,t);this.validatePath(e,t,r,this.path,n),this.value.validate(e,t,n)},t.prototype.with=function(e){return this.value=Tn.parse(e),this.value.setParent(this),this},t.prototype.sub=function(e){var t,n,r=a(e)?e:[e];try{for(var o=Et(r),i=o.next();!i.done;i=o.next()){var s=i.value,u=Tn.parse(s);this.path.push(u),u.setParent(this)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this},t.STEP_PATH="path",t.STEP_VALUE="value",t.id="sub",t}(W),wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},_t=function(e){function t(t,n,r,o){var i=e.call(this)||this;return i.value=t,i.op=n,i.cases=r,i.defaultCase=o,i}return wt(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]),e[2],e[3].map(function(e){var t=Pt(e,2),r=t[0],o=t[1];return[r.map(function(e){return n.getExpression(e)}),n.getExpression(o)]}),n.getExpression(e[4]))},t.encode=function(e){var t=e.value.encode(),n=e.cases.map(function(e){var t=Pt(e,2),n=t[0],r=t[1];return[n.map(function(e){return e.encode()}),r.encode()]});return ze.has(e.defaultCase,void 0)?[this.id,t,e.op,n]:[this.id,t,e.op,n,e.defaultCase.encode()]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.cases.reduce(function(t,n){var r=Pt(n,2),o=r[0],i=r[1];return Math.max(t,i.getComplexity(e),o.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},0))},Math.max(this.value.getComplexity(e),this.defaultCase.getComplexity(e)))},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.value.clone(),this.op,this.cases.map(function(e){var t=Pt(e,2),n=t[0],r=t[1];return[n.map(function(e){return e.clone()}),r.clone()]}),this.defaultCase.clone())},t.prototype.getType=function(e,t){var n=this.cases.map(function(e){var t=Pt(e,2);t[0];return t[1]}).concat(this.defaultCase).filter(function(e){return!!e}).map(function(n){return n.getType(e,t)}).filter(function(e){return!!e});return di.mergeMany(n)},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_VALUE,n.value,function(e){return n.value=e}),e.step(t.STEP_CASES,function(){return n.cases.forEach(function(r,o){var i=Pt(r,2),s=i[0],a=i[1];return e.step(o,function(){e.step(t.STEP_CASE,function(){return s.forEach(function(t,n){return e.step(n,t,function(e){return s.splice(n,1,e)},function(){return s.splice(n,1)})})}),e.step(t.STEP_RESULT,a,function(e){return n.cases[o].splice(1,1,e)})})})}),e.step(t.STEP_DEFAULT,n.defaultCase,function(e){return n.defaultCase=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_VALUE?[1,this.value]:e[0]===t.STEP_CASES?i(e[1])&&e[1]<this.cases.length?e[2]===t.STEP_CASE?i(e[3])&&e[3]<this.cases[e[1]][0].length?[4,this.cases[e[1]][0][e[3]]]:null:e[2]===t.STEP_RESULT?[3,this.cases[e[1]][1]]:null:null:e[0]===t.STEP_DEFAULT?[1,this.defaultCase]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.value.setParent(this),this.cases.forEach(function(e){var n=Pt(e,2),r=n[0],o=n[1];r.forEach(function(e){return e.setParent(t)}),o.setParent(t)}),this.defaultCase.setParent(this)},t.prototype.validate=function(e,t,n){this.value.validate(e,t,n),this.cases.forEach(function(r){var o=Pt(r,2),i=o[0],s=o[1];i.forEach(function(r){return r.validate(e,t,n)}),s.validate(e,t,n)}),this.defaultCase.validate(e,t,n)},t.prototype.val=function(e,t){return this.value=Tn.parse(e),this.value.setParent(this),this.op=t?t.id:this.op,this},t.prototype.case=function(e){var t=this.cases.length-1,n=Tn.parse(e);return n.setParent(this),t>=0&&this.cases[t][1]===de.instance?this.cases[t][0].push(n):this.cases.push([[n],de.instance]),this},t.prototype.than=function(e){var t=Tn.parse(e);return this.cases[this.cases.length-1][1]=t,t.setParent(this),this},t.prototype.default=function(e){return this.defaultCase=Tn.parse(e),this.defaultCase.setParent(this),this},t.STEP_VALUE="value",t.STEP_CASES="cases",t.STEP_CASE="case",t.STEP_RESULT="result",t.STEP_DEFAULT="default",t.id="switch",t}(W),Mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),It=function(e){function t(t,n){var r=e.call(this)||this;return r.template=t,r.params=n,r}return Mt(t,e),t.decode=function(e,n){return new t(e[1],x(e[2],function(e){return n.getExpression(e)}))},t.encode=function(e){var t=x(e.params,function(e){return e.encode()});return[this.id,e.template,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){var t=0;for(var n in this.params)t=Math.max(t,this.params[n].getComplexity(e));return t},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.template,x(this.params,function(e){return e.clone()}))},t.prototype.getType=function(e,t){return Ve.baseType.newInstance()},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return O(t.params,function(n,r){return e.step(r,n,function(e){return t.params[r]=e},function(){return delete t.params[r]})})})},t.prototype.getExpressionFromStep=function(e){return e[0]in this.params?[1,this.params[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,O(this.params,function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){var r=this;O(this.params,function(o){r.validateType(e,t,Ve.baseType,o,n)})},t.prototype.param=function(e,t){var n,r=s(e)?((n={})[e]=t,n):e;for(var o in r){var i=Tn.parse(r[o]);this.params[o]=i,i.setParent(this)}return this},t.id="tmpl",t}(W),Ct=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},kt="current",jt=function(e){function t(t,n,r){void 0===r&&(r=kt);var o=e.call(this)||this;return o.path=t,o.value=n,o.currentVariable=r,o}return Ct(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getExpression(e)}),n.getExpression(e[2]),e[3]||kt)},t.encode=function(e){var t=e.path.map(function(e){return e.encode()}),n=e.value.encode();return e.currentVariable===kt?[this.id,t,n]:[this.id,t,n,e.currentVariable]},t.create=function(e,n,r){return void 0===r&&(r=kt),new t(Tn.parse(e),Tn.parse(n),r)},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.path.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},this.value.getComplexity(e))},t.prototype.getScope=function(){var e;return(e={})[this.currentVariable]=me.baseType,e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.path.map(function(e){return e.clone()}),this.value.clone(),this.currentVariable)},t.prototype.getType=function(e,t){return te.baseType},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_PATH,function(){return n.path.forEach(function(t,r){return e.step(r,t,function(e){return n.path.splice(r,1,e)},function(){return n.path.splice(r,1)})})}),e.step(t.STEP_VALUE,n.value,function(e){return n.value=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_PATH?i(e[1])&&e[1]<this.path.length?[2,this.path[e[1]]]:null:e[0]===t.STEP_VALUE?[1,this.value]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.path.forEach(function(e){return e.setParent(t)}),this.value.setParent(this)},t.prototype.validate=function(e,t,n){var r;this.validatePath(e,t,t,this.path,n);var o=e.getPathType(this.path,t);if(o){var i=e.getContext(t,((r={})[this.currentVariable]=o,r));this.validateType(e,i,o,this.value,n)}},t.prototype.add=function(e){var t,n,r=a(e)?e:[e];try{for(var o=Dt(r),i=o.next();!i.done;i=o.next()){var s=i.value,u=Tn.parse(s);this.path.push(u),u.setParent(this)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this},t.prototype.to=function(e,t){return this.value=Tn.parse(e),this.value.setParent(this),this.currentVariable=t||this.currentVariable,this},t.prototype.withVariable=function(e){return this.currentVariable=e,this},t.STEP_PATH="path",t.STEP_VALUE="value",t.id="up",t}(W),Nt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=1e5,Lt="break",Rt=function(e){function t(t,n,r,o){void 0===r&&(r=Lt),void 0===o&&(o=At);var i=e.call(this)||this;return i.condition=t,i.body=n,i.breakVariable=r,i.maxIterations=o,i}return Nt(t,e),t.decode=function(e,n){return new t(n.getExpression(e[1]),n.getExpression(e[2]),e[3]||Lt,parseInt(e[4])||this.MAX_ITERATIONS)},t.encode=function(e){var t=[this.id,e.condition.encode(),e.body.encode()],n=e.maxIterations!==this.MAX_ITERATIONS;return(e.breakVariable!==Lt||n)&&t.push(e.breakVariable),n&&t.push(e.maxIterations),t},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return Math.max(this.condition.getComplexity(e),this.body.getComplexity(e))+1},t.prototype.getScope=function(){var e;return(e={})[this.breakVariable]=te.baseType,e},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.condition.clone(),this.body.clone(),this.breakVariable,this.maxIterations)},t.prototype.getType=function(e,t){var n=e.getContextWithScope(t,this.getScope()).context,r=this.body.getType(e,n);return r?di.optional(r):null},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_CONDITION,n.condition,function(e){return n.condition=e}),e.step(t.STEP_BODY,n.body,function(e){return n.body=e})})},t.prototype.getExpressionFromStep=function(e){return e[0]===t.STEP_CONDITION?[1,this.condition]:e[0]===t.STEP_BODY?[1,this.body]:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.condition.setParent(this),this.body.setParent(this)},t.prototype.validate=function(e,t,n){this.validateType(e,t,te.baseType,this.condition,n);var r=e.getContext(t,this.getScope());this.body.validate(e,r,n)},t.prototype.while=function(e){return this.condition=e,this.condition.setParent(this),this},t.prototype.do=function(e){return this.body=e,this.body.setParent(this),this},t.prototype.withBreak=function(e){return this.breakVariable=e,this},t.prototype.withMax=function(e){return this.maxIterations=e,this},t.STEP_CONDITION="condition",t.STEP_BODY="body",t.MAX_ITERATIONS=At,t.id="while",t}(W),qt=new J(z.Tuple+z.Delimiter),Vt=new K(z.Tuple+z.Delimiter),Ft=qt,Yt={create:Ft.set("create"),maybe:Ft.set("maybe",{},["value"]),cmp:Ft.set("cmp",{},["value","test"]),copy:Ft.set("copy",{},["value"]),build:Ft.set("build",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),get:Ft.set("get",{},["value","index"]),set:Ft.set("set",{mutates:["value"]},["value","index","element"]),isValid:Ft.set("?",{},["value"]),isEqual:Ft.set("=",{},["value","test"]),isNotEqual:Ft.set("!=",{},["value","test"]),isLess:Ft.set("<",{},["value","test"]),isLessOrEqual:Ft.set("<=",{},["value","test"]),isGreater:Ft.set(">",{},["value","test"]),isGreaterOrEqual:Ft.set(">=",{},["value","test"]),asAny:Ft.set("~"+z.Any,{},["value"]),asBoolean:Ft.set("~"+z.Boolean,{},["value"]),asColor:Ft.set("~"+z.Color,{},["value"]),asDate:Ft.set("~"+z.Date,{},["value"]),asList:Ft.set("~"+z.List,{},["value"]),asMap:Ft.set("~"+z.Map,{},["value"]),asNumber:Ft.set("~"+z.Number,{},["value"]),asObject:Ft.set("~"+z.Object,{},["value"]),asText:Ft.set("~"+z.Text,{},["value"]),asTuple:Ft.set("~"+z.Tuple,{},["value"]),asSet:Ft.set("~"+z.Set,{},["value"])};Vt.set("copy",Yt.copy);var Bt=new J(z.Number+z.Delimiter),Gt=new K(z.Number+z.Delimiter),Wt=Bt,Ut={create:Wt.set("create"),pi:Wt.set("pi"),pi2:Wt.set("2pi"),piHalf:Wt.set("hpi"),e:Wt.set("e"),sqrt2:Wt.set("sqrt2"),sqrt12:Wt.set("sqrt1/2"),ln2:Wt.set("ln2"),ln10:Wt.set("ln10"),log2e:Wt.set("log2e"),log10e:Wt.set("log10e"),add:Wt.set("+",{},["value","addend"]),sub:Wt.set("-",{},["value","subtrahend"]),mul:Wt.set("*",{},["value","multiplier"]),div:Wt.set("/",{},["value","divisor"]),mod:Wt.set("%",{},["value","divisor"]),min:Wt.set("min",{},["a","b"]),max:Wt.set("max",{},["a","b"]),pow:Wt.set("^^",{},["value","exponent"]),atan2:Wt.set("atan2",{},["x","y"]),hypot:Wt.set("hyp",{},["a","b"]),choose:Wt.set("choose",{complexity:1},["n","k"]),gcd:Wt.set("gcd",{complexity:1},["a","b"]),bitAnd:Wt.set("&",{},["a","b"]),bitOr:Wt.set("|",{},["a","b"]),bitXor:Wt.set("^",{},["a","b"]),cmp:Wt.set("cmp",{},["value","test"]),maybe:Wt.set("maybe",{},["value"]),sqrt:Wt.set("sqrt",{},["value"]),sq:Wt.set("^2",{},["value"]),cbrt:Wt.set("cbrt",{},["value"]),floor:Wt.set("floor",{},["value"]),ceil:Wt.set("ceil",{},["value"]),up:Wt.set("up",{},["value"]),down:Wt.set("down",{},["value"]),round:Wt.set("round",{},["value"]),abs:Wt.set("abs",{},["value"]),neg:Wt.set("neg",{},["value"]),sign:Wt.set("sign",{},["value"]),log:Wt.set("log",{},["value"]),sin:Wt.set("sin",{},["value"]),cos:Wt.set("cos",{},["value"]),tan:Wt.set("tan",{},["value"]),sinh:Wt.set("sinh",{},["value"]),cosh:Wt.set("cosh",{},["value"]),asin:Wt.set("asin",{},["value"]),acos:Wt.set("acos",{},["value"]),atan:Wt.set("atan",{},["value"]),factorial:Wt.set("!",{},["value"]),bitFlip:Wt.set("~",{},["value"]),clamp:Wt.set("clamp",{},["value","min","max"]),triangleHeight:Wt.set("triangleHeight",{},["base","side1","side2"]),lerp:Wt.set("lerp",{},["delta","start","end"]),rnd:Wt.set("rnd",{},[],["min","max","whole","includeMax"]),toBaseText:Wt.set("toBaseText",{},["value"],["base","minDigits"]),toText:Wt.set("toText",{},["value"],["prefix","suffix","minPlaces","maxPlaces","useExponent","thousandSeparator"]),toPercent:Wt.set("toPercent",{},["value"],["minPlaces","maxPlaces","thousandSeparator"]),fromPercent:Wt.set("fromPercent",{},["value"]),isValid:Wt.set("?",{},["value"]),isZero:Wt.set("0?",{},["value"],["epsilon"]),isEqual:Wt.set("=",{},["value","test"],["epsilon"]),isNotEqual:Wt.set("!=",{},["value","test"],["epsilon"]),isLess:Wt.set("<",{},["value","test"]),isLessOrEqual:Wt.set("<=",{},["value","test"]),isGreater:Wt.set(">",{},["value","test"]),isGreaterOrEqual:Wt.set(">=",{},["value","test"]),isBetween:Wt.set("><",{},["value","min","max"],["minInclusive","maxInclusive"]),isWhole:Wt.set("w?",{},["value"],["epsilon"]),isDecimal:Wt.set("d?",{},["value"],["epsilon"]),isPositive:Wt.set("+?",{},["value"]),isNegative:Wt.set("-?",{},["value"]),isDivisible:Wt.set("%?",{},["value","by"],["epsilon"]),bitCompare:Wt.set("bit",{},["value","method","test"]),asAny:Wt.set("~"+z.Any,{},["value"]),asBoolean:Wt.set("~"+z.Boolean,{},["value"]),asColor:Wt.set("~"+z.Color,{},["value"]),asDate:Wt.set("~"+z.Date,{},["value"]),asList:Wt.set("~"+z.List,{},["value"]),asMap:Wt.set("~"+z.Map,{},["value"]),asNumber:Wt.set("~"+z.Number,{},["value"]),asObject:Wt.set("~"+z.Object,{},["value"]),asText:Wt.set("~"+z.Text,{},["value"]),asTuple:Wt.set("~"+z.Tuple,{},["value"]),asSet:Wt.set("~"+z.Set,{},["value"])};Gt.set("floor",Ut.floor),Gt.set("ceil",Ut.ceil),Gt.set("up",Ut.up),Gt.set("down",Ut.down),Gt.set("round",Ut.round),Gt.set("abs",Ut.abs),Gt.set("negate",Ut.neg),Gt.set("sign",Ut.sign),Gt.set("isZero",Ut.isZero),Gt.set("isWhole",Ut.isWhole),Gt.set("isDecimal",Ut.isDecimal),Gt.set("isPositive",Ut.isPositive),Gt.set("isNegative",Ut.isNegative),Gt.set("toText",Ut.toText);var Ht=new J(z.List+z.Delimiter),Jt=new K(z.List+z.Delimiter),Kt=Ht,zt={create:Kt.set("create"),createLike:Kt.set("createLike",{},["list"],[],[],[],["list"]),createFor:Kt.set("createFor",{},["item"],[],[],[],["item"]),maybe:Kt.set("maybe",{},["value"]),build:Kt.set("new",{},["count","item"],["sameItem"],["list","index","last","count"],["item"],["item"]),get:Kt.set("get",{},["list","index"],[],[],[],["list"]),set:Kt.set("set",{},["list","index","value"],[],[],[],["list"]),add:Kt.set("+",{mutates:["list"]},["list","item"],[],[],[],["list"]),addFirst:Kt.set("+f",{mutates:["list"]},["list","item"],[],[],[],["list"]),addLast:Kt.set("+l",{mutates:["list"]},["list","item"],[],[],[],["list"]),insert:Kt.set("+@",{mutates:["list"]},["list","item","index"],[],[],[],["list"]),remove:Kt.set("-",{mutates:["list"],complexity:1},["list","item","isEqual"],[],["list","value","test"],["isEqual"],["list"]),removeFirst:Kt.set("-f",{mutates:["list"]},["list"],[],[],[],["list"]),removeLast:Kt.set("-l",{mutates:["list"]},["list"],[],[],[],["list"]),removeAt:Kt.set("-@",{mutates:["list"]},["list","index"],[],[],[],["list"]),removeWhere:Kt.set("-?",{mutates:["list"]},["list","where"],[],["list","item","index"],["where"],["list"]),clear:Kt.set("clear",{mutates:["list"]},["list"],[],[],[],["list"]),contains:Kt.set("contains",{complexity:1},["list","item","isEqual"],[],["list","value","test"],["isEqual"]),find:Kt.set("find",{complexity:1},["list","where"],["start","reverse"],["list","item","index"],["where"],["list"]),copy:Kt.set("copy",{complexity:1},["list"],["deepCopy"],["copy"],["deepCopy"],["list"]),reverse:Kt.set("reverse",{complexity:.5},["list"],[],[],[],["list"]),exclude:Kt.set("exclude",{mutates:["list"],complexity:2},["list","exclude","isEqual"],[],["list","value","test"],["isEqual"],["list"]),overlap:Kt.set("overlap",{complexity:2},["list","overlap","isEqual"],[],["list","value","test"],["isEqual"],["list"]),sort:Kt.set("sort",{mutates:["list"],complexity:1},["list","compare"],[],["list","value","test"],["compare"],["list"]),shuffle:Kt.set("shuffle",{mutates:["list"],complexity:1},["list"],["times"],[],[],["list"]),unique:Kt.set("unique",{complexity:2},["list","isEqual"],[],["list","value","test"],["isEqual"],["list"]),duplicates:Kt.set("dupes",{complexity:2},["list","isEqual"],["once"],["list","value","test"],["isEqual"],["list"]),take:Kt.set("take",{},["list","count"],[],[],[],["list"]),skip:Kt.set("skip",{},["list","count"],[],[],[],["list"]),drop:Kt.set("drop",{},["list","count"],[],[],[],["list"]),append:Kt.set("append",{},["list","append"],[],[],[],["list"]),prepend:Kt.set("prepend",{},["list","prepend"],[],[],[],["list"]),indexOf:Kt.set("indexOf",{complexity:1},["list","item","isEqual"],["start"],["list","value","test"],["isEqual"],["list"]),lastIndexOf:Kt.set("lastIndexOf",{complexity:1},["list","item","isEqual"],["start"],["list","value","test"],["isEqual"],["list"]),findIndex:Kt.set("findIndex",{complexity:1},["list","where"],["reverse","start"],["list","item","index"],["where"]),last:Kt.set("last",{},["list"],[],[],[],["list"]),first:Kt.set("first",{},["list"],[],[],[],["list"]),count:Kt.set("count",{},["list"]),randomList:Kt.set("randomList",{},["list","count"],[],[],[],["list"]),random:Kt.set("random",{},["list"],[],[],[],["list"]),join:Kt.set("join",{complexity:1},["list"],["delimiter","toText","prefix","suffix"],["list","item","index"],["toText"]),each:Kt.set("each",{complexity:1},["list","each"],["reverse"],["list","item","index"],["each"],["list"]),filter:Kt.set("filter",{complexity:1},["list","filter"],[],["list","item","index"],["filter"],["list"]),not:Kt.set("not",{complexity:1},["list","not"],[],["list","item","index"],["not"],["list"]),map:Kt.set("map",{complexity:1},["list","transform"],[],["list","item","index"],["transform"],["list"]),split:Kt.set("split",{complexity:1},["list","pass"],[],["list","item","index"],["pass"],["list"]),reduce:Kt.set("reduce",{complexity:1},["list","reduce","initial"],[],["list","item","index","reduced"],["reduce"],["reduce"]),cmp:Kt.set("cmp",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),group:Kt.set("group",{complexity:1},["list","by"],["getValue"],["list","item","index"],["by","getValue"],["list","by","getValue"]),toListMap:Kt.set("toListMap",{complexity:1},["list","getKey"],["getValue"],["list","item","index"],["getKey","getValue"],["list","getKey","getValue"]),toMap:Kt.set("toMap",{complexity:1},["list","getKey"],["getValue"],["list","item","index"],["getKey","getValue"],["list","getKey","getValue"]),joinInner:Kt.set("joinInner",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinLeft:Kt.set("joinLeft",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinRight:Kt.set("joinRight",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinFull:Kt.set("joinFull",{complexity:2},["a","b","on","join"],[],["onA","onB","joinA","joinB"],["on","join"],["join"]),joinCross:Kt.set("joinCross",{complexity:2},["a","b","join"],[],["joinA","joinB"],["join"],["join"]),min:Kt.set("min",{complexity:1},["list","value"],[],["list","item","index"],["value"]),max:Kt.set("max",{complexity:1},["list","value"],[],["list","item","index"],["value"]),sum:Kt.set("sum",{complexity:1},["list","value"],[],["list","item","index"],["value"]),avg:Kt.set("avg",{complexity:1},["list","value"],[],["list","item","index"],["value"]),std:Kt.set("std",{complexity:1},["list","value"],[],["list","item","index"],["value"]),variance:Kt.set("variance",{complexity:1},["list","value"],[],["list","item","index"],["value"]),median:Kt.set("median",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitand:Kt.set("band",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitor:Kt.set("bor",{complexity:1},["list","value"],[],["list","item","index"],["value"]),bitxor:Kt.set("bxor",{complexity:1},["list","value"],[],["list","item","index"],["value"]),isValid:Kt.set("?",{},["value"]),isEmpty:Kt.set("0?",{},["list"]),isNotEmpty:Kt.set("!0",{},["list"]),isEqual:Kt.set("=",{complexity:1},["list","test","isEqual"],[],["list","value","test"],["isEqual"]),isNotEqual:Kt.set("!=",{complexity:1},["list","test","isEqual"],[],["list","value","test"],["isEqual"]),isLess:Kt.set("<",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isLessOrEqual:Kt.set("<=",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isGreater:Kt.set(">",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),isGreaterOrEqual:Kt.set(">=",{complexity:1},["value","test","compare"],[],["list","value","test"],["compare"]),asAny:Kt.set("~"+z.Any,{},["value"]),asBoolean:Kt.set("~"+z.Boolean,{},["value"]),asColor:Kt.set("~"+z.Color,{},["value"]),asDate:Kt.set("~"+z.Date,{},["value"]),asList:Kt.set("~"+z.List,{},["value"]),asMap:Kt.set("~"+z.Map,{},["value"]),asNumber:Kt.set("~"+z.Number,{},["value"]),asObject:Kt.set("~"+z.Object,{},["value"]),asText:Kt.set("~"+z.Text,{},["value"]),asTuple:Kt.set("~"+z.Tuple,{},["value"]),asSet:Kt.set("~"+z.Set,{},["value"])};Jt.set("copy",zt.copy),Jt.set("reversed",zt.reverse),Jt.set("shuffled",zt.shuffle),Jt.set("first",zt.first),Jt.set("last",zt.last),Jt.set("random",zt.random),Jt.set("isEmpty",zt.isEmpty),Jt.set("isNotEmpty",zt.isNotEmpty);var Xt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$t=function(){return($t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Qt=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},Zt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},en=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Zt(arguments[t]));return e},tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Xt(t,e),t.decode=function(e,n){var r=n.getType(e[1]),o=e[2]||{};return new t($t({item:r},o))},t.encode=function(e){var t=$t({},e.options),n=t.item;return delete t.item,m(t)?[this.id,n.encode()]:[this.id,n.encode(),t]},t.describe=function(e,n){if(!a(e))return null;for(var r=n.describe(e[0]),o=1;o<e.length;o++)r=n.merge(r,e[o]);return new t({item:r,min:e.length,max:e.length})},t.register=function(){me.addJsonReader(8,function(e,t){if(a(e))return e.map(function(e){return t(e)})}),me.addJsonWriter(8,function(e,t){if(a(e))return e.map(function(e){return t(e)})}),k(8,function(e,t,n){var r,o;if(a(e)){var i=[];n.set(e,i);try{for(var s=Qt(e),u=s.next();!u.done;u=s.next()){var p=u.value;i.push(t(p,n))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}})},t.forItem=function(e){return new t({item:di.parse(e)})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.item=di.merge(t.item,n.item),t.min=Math.min(t.min,n.min),t.max=Math.max(t.max,n.max)},t.prototype.getSubType=function(e,t,n){var r=this;if(ze.is(e)){if("length"===e.value)return di.LENGTH;if(i(e.value))return i(this.options.min)&&e.value<this.options.min?this.options.item:di.optional(this.options.item)}var o=e.getType(t,n);if(o){if((o=o.getRequired())instanceof xn)return di.optional(this.options.item);if(o instanceof Je){var s=Array.from(o.options.constants.values());if(o.options.value instanceof xn)return i(this.options.min)&&!s.some(function(e){return e>=r.options.min})?this.options.item:di.optional(this.options.item);if(o.options.value instanceof Ve&&1===s.length&&"length"===s[0])return di.LENGTH}}return null},t.prototype.getSubTypes=function(e){for(var t=this.options,n=t.min,r=t.item,o=i(n)&&n>0&&n<=10?n:0,s=[],a=0;a<o;a++)s.push({key:a,value:r});return en(s,[{key:"length",value:di.LENGTH},{key:di.INDEX,value:di.optional(r)}])},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){var r=this.options,o=r.item,i=r.min,s=r.max;if(!n.strict&&!n.exact&&e instanceof sn&&!e.options.some(function(e){return!o.isCompatible(e,n)}))return!0;if(!(e instanceof t))return!1;if(!o.isCompatible(e.options.item,n))return!1;if(n.value){var a=e.options.min;if(i&&(!a||a<i))return!1;var u=e.options.max;if(s&&(!u||u<s))return!1}return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){return e.step(t.STEP_ITEM,n.options.item,function(e){return n.options.item=e})})},t.prototype.getTypeFromStep=function(e){return e===t.STEP_ITEM?this.options.item:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.item.setParent(this)},t.prototype.removeDescribedRestrictions=function(){var e=this.options.item;e.removeDescribedRestrictions(),this.options={item:e}},t.prototype.getCreateExpression=function(){return Tn.op(zt.create,{})},t.prototype.getValidateExpression=function(){return Tn.and(Tn.op(zt.isValid,{value:Tn.get("value")}),Tn.not(Tn.op(zt.contains,{list:Tn.get("value"),item:Tn.null(),isEqual:Tn.not(this.options.item.getValidateExpression())},{value:"ignore",test:"value"})))},t.prototype.getCompareExpression=function(){return Tn.op(zt.cmp,{value:Tn.get("value"),test:Tn.get("test"),compare:this.options.item.getCompareExpression()})},t.prototype.getValueChangeExpression=function(e,t,n){return Tn.op(zt.map,{list:Tn.get("value"),transform:e},{item:"value"})},t.prototype.isValid=function(e){var t,n;if(!Array.isArray(e))return!1;var r=this.options,o=r.item,s=r.min,a=r.max;if(i(s)&&e.length<s)return!1;if(i(a)&&e.length>a)return!1;try{for(var u=Qt(e),p=u.next();!p.done;p=u.next()){var c=p.value;if(!o.isValid(c))return!1}}catch(e){t={error:e}}finally{try{p&&!p.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return!0},t.prototype.normalize=function(e){if(a(e))for(var t=this.options.item,n=0;n<e.length;n++)e[n]=t.normalize(e[n]);return e},t.prototype.newInstance=function(){return new t({item:this.options.item.newInstance()})},t.prototype.clone=function(){var e=this.options,n=e.item,r=e.min,o=e.max;return new t({item:n.clone(),min:r,max:o})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return[]},t.prototype.random=function(e){for(var t=this.options,n=t.min,r=t.max,o=M(n,2),i=M(r,5),s=e(Math.min(o,i),Math.max(o,i)+1,!0),a=[],u=0;u<s;u++)a.push(this.options.item.random(e));return a},t.prototype.fromJson=function(e){var t=this;return e?e.map(function(e){return t.options.item.fromJson(e)}):null},t.prototype.toJson=function(e){var t=this;return e?e.map(function(e){return t.options.item.toJson(e)}):null},t.STEP_ITEM="item",t.id=z.List,t.operations=Ht,t.computeds=Jt,t.baseType=new t({item:me.baseType}),t.describePriority=6,t.registered=!1,t}(B),nn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},on=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(rn(arguments[t]));return e},sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nn(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getType(e)}))},t.encode=function(e){var t=e.options.map(function(e){return e.encode()});return[this.id,t]},t.describe=function(e,t){return null},t.register=function(){},t.forItem=function(e){return new t(e.map(function(e){return di.parse(e)}))},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){var r=this;if(ze.is(e)){if("length"===e.value)return di.LENGTH;if(i(e.value))return this.options[e.value]}var o=e.getType(t,n);if(o){if((o=o.getRequired())instanceof xn)return di.mergeMany(this.options);if(o instanceof Je){if(o.options.value instanceof xn){var s=(a=Array.from(o.options.constants.values())).map(function(e){return r.options[e]}).filter(function(e){return!!e});return di.mergeMany(s)}var a;if(o.options.value instanceof Ve)if(1===(a=Array.from(o.options.constants.values())).length&&"length"===a[0])return di.LENGTH}}},t.prototype.getSubTypes=function(e){return on(this.options.map(function(e,t){return{key:t,value:e}}),[{key:"length",value:di.LENGTH},{key:new Je({key:xn.baseType,value:xn.baseType,constants:new Map(this.options.map(function(e,t){return[t,t]}))}),value:di.mergeMany(this.options)},{key:di.INDEX,value:di.optional(di.mergeMany(this.options))}])},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.getCreateExpression=function(){return Tn.tuple.apply(Tn,on(this.options.map(function(e){return e.getCreateExpression()})))},t.prototype.getValidateExpression=function(){return Tn.op(Yt.isValid,{value:Tn.get("value")}).and(this.options.map(function(e,t){return Tn.define({value:Tn.get("value",t)}).run(e.getValidateExpression())}))},t.prototype.getCompareExpression=function(){return Tn.or.apply(Tn,on([Tn.op(Ut.cmp,{value:Tn.get("value","length"),test:Tn.get("test","length")})],this.options.map(function(e,t){return Tn.define({value:Tn.get("value",t),test:Tn.get("test",t)}).run(e.getCompareExpression())})))},t.prototype.getValueChangeExpression=function(e,t,n){var r=i(t),o=i(n);return!r&&o?Tn.define({parent:Tn.get("value")},Tn.op(zt.insert,{list:Tn.get("value"),index:n,item:e})):r&&!o?Tn.body(Tn.op(zt.removeAt,{list:Tn.get("value"),index:t}),Tn.get("value")):t===n&&r?Tn.body(Tn.update("value",t).to(e,"value"),Tn.get("value")):e},t.prototype.isDeepCompatible=function(e,n){if(!n.exact&&!n.strict&&e instanceof tn&&!this.options.some(function(t){return!t.isCompatible(e.options.item,n)})&&i(e.options.min)&&e.options.min>=this.options.length)return!0;if(!(e instanceof t))return!1;var r=this.options,o=e.options;if(o.length<r.length||n.exact&&r.length!==o.length)return!1;for(var s=0;s<r.length;s++)if(!r[s].isCompatible(o[s],n))return!1;return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return t.options.map(function(n,r){return e.step(r,n,function(e){return t.options.splice(r,1,e)},function(){return t.options.splice(r,1)})})})},t.prototype.getTypeFromStep=function(e){return this.options[e]||null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.options.forEach(function(e){return e.setParent(t)})},t.prototype.removeDescribedRestrictions=function(){this.options.forEach(function(e){return e.removeDescribedRestrictions()})},t.prototype.isValid=function(e){if(!a(e))return!1;for(var t=this.options,n=0;n<t.length;n++)if(!t[n].isValid(e[n]))return!1;return!0},t.prototype.normalize=function(e){if(!a(e))return e;for(var t=this.options,n=0;n<t.length;n++)e[n]=t[n].normalize(e[n]);return e},t.prototype.newInstance=function(){return new t([])},t.prototype.clone=function(){return new t(this.options.map(function(e){return e.clone()}))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.options.map(function(e){return e.create()})},t.prototype.random=function(e){return this.options.map(function(t){return t.random(e)})},t.prototype.fromJson=function(e){return this.options.map(function(t,n){return t.fromJson(e[n])})},t.prototype.toJson=function(e){return this.options.map(function(t,n){return t.toJson(e[n])})},t.id=z.Tuple,t.operations=qt,t.computeds=Vt,t.baseType=new t([]),t.describePriority=-1,t.registered=!1,t}(B),an=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),un=function(e){function t(t){var n=e.call(this)||this;return n.expressions=t,n}return an(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getExpression(e)}))},t.encode=function(e){var t=e.expressions.map(function(e){return e.encode()});return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return this.expressions.reduce(function(t,n){return Math.max(t,n.getComplexity(e))},0)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(this.expressions.map(function(e){return e.clone()}))},t.prototype.getType=function(e,t){return new sn(this.expressions.map(function(n){return di.simplify(n.getType(e,t))}))},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return t.expressions.forEach(function(n,r){return e.step(r,n,function(e){return t.expressions.splice(r,1,e)},function(){return t.expressions.splice(r,1)})})})},t.prototype.getExpressionFromStep=function(e){return i(e[0])&&e[0]<this.expressions.length?[1,this.expressions[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.expressions.forEach(function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){this.expressions.forEach(function(r){r.validate(e,t,n)})},t.id="tuple",t}(W),pn=new J(z.Object+z.Delimiter),cn=new K(z.Object+z.Delimiter),ln=pn,fn={create:ln.set("create"),maybe:ln.set("maybe",{},["value"]),has:ln.set("has",{},["object","key"]),get:ln.set("get",{},["object","key"]),set:ln.set("set",{mutates:["object"]},["object","key","value"],[],["existingValue"],[],["object"]),delete:ln.set("del",{mutates:["object"]},["object","key"]),cmp:ln.set("cmp",{},["value","test"]),copy:ln.set("copy",{},["object"],[],[],[],["object"]),merge:ln.set("merge",{},["a","b"],["c","d","e"],[],[],["a","b","c","d","e"]),isValid:ln.set("?",{},["value"]),isEqual:ln.set("=",{},["value","test"]),isNotEqual:ln.set("!=",{},["value","test"]),isLess:ln.set("<",{},["value","test"]),isLessOrEqual:ln.set("<=",{},["value","test"]),isGreater:ln.set(">",{},["value","test"]),isGreaterOrEqual:ln.set(">=",{},["value","test"]),asAny:ln.set("~"+z.Any,{},["value"]),asBoolean:ln.set("~"+z.Boolean,{},["value"]),asColor:ln.set("~"+z.Color,{},["value"]),asDate:ln.set("~"+z.Date,{},["value"]),asList:ln.set("~"+z.List,{},["value"]),asMap:ln.set("~"+z.Map,{},["value"]),asNumber:ln.set("~"+z.Number,{},["value"]),asObject:ln.set("~"+z.Object,{},["value"]),asText:ln.set("~"+z.Text,{},["value"]),asTuple:ln.set("~"+z.Tuple,{},["value"]),asSet:ln.set("~"+z.Set,{},["value"])};cn.set("copy",fn.copy);var yn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},hn=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(dn(arguments[t]));return e},vn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yn(t,e),t.decode=function(e,n){return new t({props:x(e[1],function(e){return n.getType(e)})})},t.encode=function(e){var t=x(e.options.props,function(e){return e.encode()});return[this.id,t]},t.describe=function(e,n){return y(e)&&null!==e?new t({props:x(e,function(e){return n.describe(e)})}):null},t.register=function(){me.addJsonReader(7,function(e,t){if(y(e))return x(e,function(e){return t(e)})}),me.addJsonWriter(7,function(e,t){if(y(e))return x(e,function(e){return t(e)})}),k(7,function(e,t,n){if(y(e)){var r={};for(var o in n.set(e,r),e)r[t(o,n)]=t(e[o],n);return r}})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options.props,n=e.options.props;for(var r in t)r in n&&n[r]?t[r]=di.merge(t[r],n[r]):t[r]&&(t[r]=di.optional(t[r]));for(var r in n)r in t||!n[r]||(t[r]=di.optional(n[r]))},t.prototype.getSubType=function(e,t,n){var r=this;if(ze.is(e)&&s(e.value))return this.options.props[e.value];var o=e.getType(t,n);if(o){if((o=o.getRequired())instanceof Ve){var i=E(this.options.props);return di.mergeMany(i)}if(o instanceof Je){i=Array.from(o.options.constants.values()).map(function(e){return r.options.props[e]}).filter(function(e){return!!e});return di.mergeMany(i)}}return this.getWildcardType()},t.prototype.getSubTypes=function(e){return hn(E(this.options.props,function(e,t){return{key:t,value:e}}),[{key:new Je({key:Ve.baseType,value:Ve.baseType,constants:new Map(E(this.options.props,function(e,t){return[t,t]}))}),value:di.mergeMany(E(this.options.props))},{key:Ve.baseType,value:di.optional(di.mergeMany(E(this.options.props)))}])},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return O(t.options.props,function(n,r){return e.step(r,n,function(e){return t.options.props[r]=e},function(){return delete t.options.props[r]})})})},t.prototype.getTypeFromStep=function(e){return this.options.props[e]||null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,O(this.options.props,function(e){return e?e.setParent(t):0})},t.prototype.removeDescribedRestrictions=function(){O(this.options.props,function(e){return e?e.removeDescribedRestrictions():0})},t.prototype.isDeepCompatible=function(e,n){if(!(e instanceof t))return!1;var r=this.options.props;for(var o in r)if(o!==t.wilcardProperty&&r[o]){if(!e.options.props[o])return!1;if(!r[o].isCompatible(e.options.props[o],n))return!1}var i=this.getWildcardType();if(n.exact){for(var o in e.options.props)if(!r[o]&&e.options.props[o])return!1}else if(i)for(var o in e.options.props)if(!r[o]&&e.options.props[o]&&!i.isCompatible(e.options.props[o],n))return!1;return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.getCreateExpression=function(){return Tn.object(x(this.options.props,function(e){return e?e.getCreateExpression():Tn.noop()}))},t.prototype.getValidateExpression=function(){return Tn.and.apply(Tn,hn([Tn.op(fn.isValid,{value:Tn.get("value")})],E(this.options.props,function(e,t){return Tn.define({value:Tn.get("value",t)}).run(e?e.getValidateExpression():Tn.true())})))},t.prototype.getCompareExpression=function(){return Tn.or.apply(Tn,hn(E(this.options.props,function(e,t){return Tn.define({value:Tn.get("value",t),test:Tn.get("test",t)}).run(e?e.getCompareExpression():Tn.true())})))},t.prototype.getValueChangeExpression=function(e,t,n){var r=null!=t,o=null!=n;return!r&&o?Tn.define({parent:Tn.get("value")},Tn.op(fn.set,{object:Tn.get("value"),key:n,value:e})):r&&!o?Tn.body(Tn.op(fn.delete,{object:Tn.get("value"),key:t}),Tn.get("value")):t!==n?Tn.body(Tn.op(fn.set,{object:Tn.get("value"),key:n,value:Tn.get("value",t)}),Tn.op(fn.delete,{object:Tn.get("value"),key:t}),Tn.get("value")):t===n&&r?Tn.body(Tn.update("value",t).to(e,"value"),Tn.get("value")):e},t.prototype.isValid=function(e){if(!y(e))return!1;var n=this.options.props;for(var r in n)if(r!==t.wilcardProperty&&n[r]&&!n[r].isValid(e[r]))return!1;var o=this.getWildcardType();if(o)for(var r in e)if(!n[r]&&!o.isValid(e[r]))return!1;return!0},t.prototype.normalize=function(e){return e},t.prototype.newInstance=function(){return new t({props:{}})},t.prototype.clone=function(){return new t({props:x(this.options.props,function(e){return e?e.clone():e})})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return Object.create(null)},t.prototype.random=function(e){var t=this.options.props,n=Object.create(null);for(var r in t)t[r]&&(n[r]=t[r].random(e));return n},t.prototype.fromJson=function(e){var t=this;return x(e,function(e,n){var r=t.options.props[n];return r?r.fromJson(e):e})},t.prototype.toJson=function(e){var t=this;return x(e,function(e,n){var r=t.options.props[n];return r?r.toJson(e):e})},t.prototype.getWildcardType=function(){return this.options.props[t.wilcardProperty]||null},t.wilcardProperty="*",t.id=z.Object,t.operations=pn,t.computeds=cn,t.baseType=new t({props:{}}),t.describePriority=5,t.registered=!1,t}(B),mn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gn=function(e){function t(t){var n=e.call(this)||this;return n.props=t,n}return mn(t,e),t.decode=function(e,n){return new t(x(e[1],function(e){return n.getExpression(e)}))},t.encode=function(e){var t=x(e.props,function(e){return e.encode()});return[this.id,t]},t.prototype.getId=function(){return t.id},t.prototype.getComplexity=function(e){return S(this.props,function(t,n,r){return Math.max(r,t.getComplexity(e))},0)},t.prototype.getScope=function(){return null},t.prototype.encode=function(){return t.encode(this)},t.prototype.clone=function(){return new t(x(this.props,function(e){return e.clone()}))},t.prototype.getType=function(e,t){return new vn({props:x(this.props,function(n){return di.simplify(n.getType(e,t))})})},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return O(t.props,function(n,r){return e.step(r,n,function(e){return t.props[r]=e},function(){return delete t.props[r]})})})},t.prototype.getExpressionFromStep=function(e){return e[0]in this.props?[1,this.props[e[0]]]:null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,O(this.props,function(e){return e.setParent(t)})},t.prototype.validate=function(e,t,n){O(this.props,function(r){return r.validate(e,t,n)})},t.id="obj",t}(W),Tn=function(){function e(){}return e.setParent=function(e,t){return void 0===t&&(t=!1),(this.autoSetParent||t)&&e.setParent(),e},e.parse=function(e){var t=this;return a(e)?e.map(function(e){return t.parse(e)}):e instanceof W?e:y(e)?x(e,function(e){return t.parse(e)}):new ze(e)},e.cast=function(e,t,n){void 0===n&&(n=!0);var r=e.getId()+":~"+t.getId(),o=e.getOperations()[r];return o?this.op(o,{value:this.get("value")}):n?this.setParent(t.getCreateExpression()):null},e.and=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new ie(e))},e.body=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new _e(e))},e.const=function(e){return new ze(e)},e.define=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=de.instance),this.setParent(new be([],t).with(e))},e.do=function(e,t,n,r){return void 0===t&&(t=de.instance),this.setParent(new Se(t,e,n,r))},e.for=function(e,t,n,r,o,i){return void 0===t&&(t=new ze(0)),void 0===n&&(n=new ze(0)),void 0===r&&(r=de.instance),this.setParent(new Ze(e,this.parse(t),this.parse(n),r,o,i))},e.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new nt(this.parse(e)))},e.sub=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.setParent(new St(this.parse(e),this.parse(t)))},e.computed=function(e,t){return this.setParent(new De(this.parse(t),e))},e.if=function(e,t,n){return void 0===t&&(t=de.instance),void 0===n&&(n=de.instance),this.setParent(new pt([[e,t]],n))},e.invoke=function(e,t){return void 0===t&&(t={}),this.setParent(new lt(e,this.parse(t)))},e.noop=function(){return de.instance},e.not=function(e){return this.setParent(new re(e))},e.object=function(e){return this.setParent(new gn(this.parse(e)))},e.op=function(e,t,n){return void 0===n&&(n=Object.create(null)),this.setParent(new vt(e.id,this.parse(t),n))},e.or=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new yt(e))},e.return=function(e){return void 0===e&&(e=de.instance),this.setParent(new gt(this.parse(e)))},e.set=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new xt(this.parse(e),de.instance))},e.switch=function(e,t){return this.setParent(new _t(e,t.id,[],de.instance))},e.template=function(e,t){return void 0===t&&(t={}),this.setParent(new It(e,this.parse(t)))},e.tuple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new un(this.parse(e)))},e.update=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.setParent(new jt(this.parse(e),de.instance))},e.while=function(e,t,n,r){return void 0===t&&(t=de.instance),this.setParent(new Rt(e,t,n,r))},e.undefined=function(){return this.const(void 0)},e.null=function(){return this.const(null)},e.true=function(){return this.const(!0)},e.false=function(){return this.const(!1)},e.zero=function(){return this.const(0)},e.one=function(){return this.const(1)},e.compareEqual=function(){return this.const(1)},e.compareLess=function(){return this.const(-1)},e.compareGreater=function(){return this.const(1)},e.string=function(){return this.const("")},e.comment=function(e){return new Ie(e)},e.type=function(e){return new ot(e)},e.relation=function(e){return new st(e)},e.autoSetParent=!0,e}(),bn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return bn(t,e),t.decode=function(e){return new t(e[1]||{})},t.encode=function(e){return m(e.options)?this.id:[this.id,e.options]},t.describe=function(e,n){return i(e)?new t({min:e,max:e,whole:Math.abs(Math.floor(e)-e)<=t.WHOLE_EPSILON}):null},t.register=function(){},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.max=Math.max(t.max,n.max),t.min=Math.min(t.min,n.min),t.whole=t.whole&&n.whole},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){if(!(e instanceof t))return!1;if(n.value){var r=this.options.min,o=e.options.min;if(i(r)&&(!i(o)||o<r))return!1;var s=this.options.max,a=e.options.max;if(i(s)&&(!i(a)||a<s))return!1}return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){this.options={}},t.prototype.getCreateExpression=function(){return Tn.op(Ut.create,{})},t.prototype.getValidateExpression=function(){return Tn.op(Ut.isValid,{value:Tn.get("value")})},t.prototype.getCompareExpression=function(){return Tn.op(Ut.cmp,{value:Tn.get("value"),test:Tn.get("test")})},t.prototype.isValid=function(e){if(!i(e))return!1;var t=this.options,n=t.min,r=t.max,o=t.whole;return!(i(n)&&e<n)&&(!(i(r)&&e>r)&&!(o&&!v(e)))},t.prototype.normalize=function(e){return e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t(j(this.options))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return 0},t.prototype.random=function(e){var t=this.options,n=t.min,r=t.max,o=t.whole;return e(M(n,0),M(r,10),o)},t.prototype.fromJson=function(e){return e},t.prototype.toJson=function(e){return e},t.WHOLE_EPSILON=1e-6,t.id=z.Number,t.operations=Bt,t.computeds=Gt,t.baseType=new t({}),t.describePriority=4,t.registered=!1,t}(B),On=["th","st","nd","rd","th","th","th","th","th","th"],En={weekStartsOn:0,firstWeekContainsDate:4,am:"am",pm:"pm",formatLT:"h:mm A",formatLTS:"h:mm:ss A",formatL:"MM/DD/Y",formatl:"M/D/Y",formatLL:"MMMM D, Y",formatll:"MMM D, Y",formatLLL:"MMMM D, Y h:mm A",formatlll:"MMM D, Y h:mm A",formatLLLL:"dddd, MMMM D, Y h:mm A",formatllll:"ddd, MMM D, Y h:mm A",suffix:function(e){return e+(e>=11&&e<=13?"th":On[e%On.length])},list:function(e){for(var t=e.length-1,n=e[0],r=1;r<t;r++)n+=", "+e[r];return t>0&&(n+=" and "+e[t]),n},months:[["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["Ja","F","Mr","Ap","My","Je","Jl","Ag","S","O","N","D"]],weekdays:[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Su","M","Tu","W","Th","F","Sa"]]},Sn=1e3,wn=7,Pn=60*Sn,_n=60*Pn,Mn=24*_n,In=3,Cn=12,Dn=1,kn=31,jn=23,Nn=59,An=59,Ln=999,Rn=6,qn=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},Vn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Fn=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Vn(arguments[t]));return e},Yn={none:function(e){return e},floor:function(e){return Math.floor(e)},ceil:function(e){return Math.ceil(e)},round:function(e){return Math.round(e)},truncate:function(e){return e<0?Math.ceil(e):Math.floor(e)},down:function(e){return e<0?Math.ceil(e):Math.floor(e)},up:function(e){return e<0?Math.floor(e):Math.ceil(e)}},Bn={timestamp:function(e){return e.valueOf()},timestampSeconds:function(e){return Math.floor(e.valueOf()/Sn)},millis:function(e){return e.getMilliseconds()},second:function(e){return e.getSeconds()},minute:function(e){return e.getMinutes()},hour:function(e){return e.getHours()},day:function(e){return e.getDay()},dayOfMonth:function(e){return e.getDate()},lastDayOfMonth:rr,dayOfYear:xr,dayOfWeek:br,week:sr,weekOfMonth:hr,weekspanOfMonth:lr,fullWeekOfMonth:yr,lastWeekspanOfMonth:fr,lastFullWeekOfMonth:dr,weekOfYear:ir,weekspanOfYear:ar,fullWeekOfYear:ur,lastWeekspanOfYear:or,lastFullWeekOfYear:cr,month:function(e){return e.getMonth()},quarter:Cr,year:function(e){return e.getFullYear()},timeIdentifier:Qn,dayIdentifier:Zn,weekIdentifier:er,monthIdentifier:tr,quarterIdentifier:nr},Gn={timestamp:function(e,t){return Kn(e,function(e){return e.setTime(t)})},timestampSeconds:function(e,t){return Kn(e,function(e){return e.setTime(1e3*t)})},millis:function(e,t){return Kn(e,function(e){return e.setMilliseconds(t)})},second:function(e,t){return Kn(e,function(e){return e.setSeconds(t)})},minute:function(e,t){return Kn(e,function(e){return e.setMinutes(t)})},hour:function(e,t){return Kn(e,function(e){return e.setHours(t)})},day:function(e,t){return Kn(e,function(e){return Hn.day(e,t-e.getDay())})},dayOfMonth:function(e,t){return Kn(e,function(e){return e.setDate(t)})},lastDayOfMonth:function(e,t){return Kn(e,function(e){return Hn.day(e,t-rr(e))})},dayOfYear:function(e,t){return Kn(e,function(e){return Hn.day(e,t-xr(e))})},dayOfWeek:function(e,t){return Kn(e,function(e){return Hn.day(e,t-br(e))})},week:function(e,t){return Kn(e,function(e){return Hn.week(e,t-sr(e))})},weekOfMonth:function(e,t){return Kn(e,function(e){return Hn.week(e,t-hr(e))})},weekspanOfMonth:function(e,t){return Kn(e,function(e){return Hn.week(e,t-lr(e))})},fullWeekOfMonth:function(e,t){return Kn(e,function(e){return Hn.week(e,t-yr(e))})},lastWeekspanOfMonth:function(e,t){return Kn(e,function(e){return Hn.week(e,t-fr(e))})},lastFullWeekOfMonth:function(e,t){return Kn(e,function(e){return Hn.week(e,t-dr(e))})},weekOfYear:function(e,t){return Kn(e,function(e){return Hn.week(e,t-ir(e))})},weekspanOfYear:function(e,t){return Kn(e,function(e){return Hn.week(e,t-ar(e))})},fullWeekOfYear:function(e,t){return Kn(e,function(e){return Hn.week(e,t-ur(e))})},lastWeekspanOfYear:function(e,t){return Kn(e,function(e){return Hn.week(e,t-or(e))})},lastFullWeekOfYear:function(e,t){return Kn(e,function(e){return Hn.week(e,t-cr(e))})},month:function(e,t){return Kn(e,function(e){return e.setMonth(t)})},quarter:function(e,t){return Kn(e,function(e){return Hn.quarter(e,t-Cr(e))})},year:function(e,t){return Kn(e,function(e){return e.setFullYear(t)})}},Wn={millis:function(e){return e},second:Dr,minute:kr,hour:jr,day:Nr,week:Ar,month:Lr,quarter:Rr,year:qr},Un={millis:function(e){return e},second:Vr,minute:Fr,hour:Yr,day:Br,week:Gr,month:Wr,quarter:Ur,year:Hr},Hn={millis:Jr,second:Kr,minute:zr,hour:Xr,day:$r,week:Qr,month:Zr,quarter:eo,year:to},Jn={millis:no,second:ro,minute:oo,hour:io,day:so,week:ao,month:uo,quarter:po,year:co};function Kn(e,t,n){var r=new Date(e.getTime());return t(r,n),r}function zn(e,t,n,r){void 0===n&&(n="millis"),void 0===r&&(r=En);var o=Wn[n],i=Kn(e,o,r),s=Kn(t,o,r);return i.getTime()-s.getTime()}var Xn=[{pattern:/^(\d{4})[-\/](\d{1,22})[-\/](\d{1,2})(|[T ](\d{1,2})((|:(\d{1,2})(|:(\d{1,2})(|\.(\d+)Z?)))))$/,groups:[1,2,3,5,8,10,12]},{pattern:/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{4})(|[T ](\d{1,2})((|:(\d{1,2})(|:(\d{1,2})(|\.(\d+)Z?)))))$/,groups:[3,1,2,5,8,10,12]}];function $n(e,t){var n,r;if(void 0===t&&(t=!1),u(e))return e;if(i(e)&&e>0)return new Date(e);if(s(e)){try{for(var o=qn(Xn),a=o.next();!a.done;a=o.next()){var p=a.value,c=p.pattern,l=p.groups,f=c.exec(e);if(f){for(var y=[0,0,1,0,0,0,0],d=0;d<y.length;d++){var h=parseInt(f[l[d]]);isFinite(h)&&(y[d]=1===d?h-1:h)}return t?new Date(Date.UTC.apply(Date,Fn(y))):new(Date.bind.apply(Date,Fn([void 0],y)))}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}if(t){var v=e+" UTC",m=Date.parse(v);if(isFinite(m))return new Date(m)}var g=Date.parse(e);if(isFinite(g))return new Date(g)}return null}function Qn(e){return 1e8*e.getFullYear()+1e6*(e.getMonth()+1)+1e4*e.getDate()+100*e.getHours()+e.getMinutes()}function Zn(e){return 1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate()}function er(e){return 1e3*e.getFullYear()+sr(e)}function tr(e){return 100*e.getFullYear()+(e.getMonth()+1)}function nr(e){return 10*e.getFullYear()+Cr(e)}function rr(e){return _r(e)-e.getDate()+1}function or(e){var t=wr(e)-xr(e);return Math.floor(t/wn)}function ir(e,t){return void 0===t&&(t=En),mr(Kn(e,qr),xr(e),t)}function sr(e,t){return void 0===t&&(t=En),gr(Kn(e,qr),xr(e),t)}function ar(e){return Math.floor((xr(e)-1)/wn)}function ur(e,t){return void 0===t&&(t=En),Tr(Kn(e,qr),wr(e),t)}function pr(e,t){return void 0===t&&(t=En),ir(Kn(e,Hr),t)+1}function cr(e,t){void 0===t&&(t=En);var n=Kn(e,Hr),r=ir(e,t),o=ir(n,t)-r;return br(n,t)===Rn?o+1:o}function lr(e){return Math.floor((e.getDate()-1)/wn)}function fr(e){var t=_r(e)-e.getDate();return Math.floor(t/wn)}function yr(e,t){return void 0===t&&(t=En),Tr(Kn(e,Lr),e.getDate(),t)}function dr(e,t){void 0===t&&(t=En);var n=_r(e)-e.getDate(),r=Rn-br(e,t);return Math.floor((n-r+wn)/wn)}function hr(e,t){return void 0===t&&(t=En),mr(Kn(e,Lr),e.getDate(),t)}function vr(e,t){return void 0===t&&(t=En),gr(Kn(e,Lr),e.getDate(),t)}function mr(e,t,n){void 0===n&&(n=En);var r=n.firstWeekContainsDate,o=br(e,n),i=wn-o<r?o-1:o-1+wn;return Math.floor((t+i)/wn)}function gr(e,t,n){var r=br(e,n)-1+wn;return Math.floor((t+r)/wn)}function Tr(e,t,n){void 0===n&&(n=En);var r=br(e,n),o=0!==r?r-1:r-1+wn;return Math.floor((t+o)/wn)}function br(e,t){void 0===t&&(t=En);var n=t.weekStartsOn,r=e.getDay();return r<n?r-n+wn:r-n}function xr(e){return Math.round(so(e,Kn(e,qr)))+1}function Or(e){return 15*-Math.round(e.getTimezoneOffset()/15)}function Er(e){var t=Or(e);return t>Or(Kn(e,function(e){return e.setMonth(0)}))||t>Or(Kn(e,function(e){return e.setMonth(5)}))}function Sr(e){var t=e.getFullYear();return t%400==0||t%4==0&&t%100!=0}function wr(e){return Sr(e)?366:365}var Pr=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]];function _r(e){return Pr[Sr(e)?1:0][e.getMonth()]}function Mr(e){return e.getTime()-Ir(e)}function Ir(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();t.setSeconds(0,0);var r=t.getTime()%Pn;return n*Pn+r}function Cr(e){return Math.floor(e.getMonth()/In)}function Dr(e){e.setMilliseconds(0)}function kr(e){e.setSeconds(0,0)}function jr(e){e.setMinutes(0,0,0)}function Nr(e){e.setHours(0,0,0,0)}function Ar(e,t){void 0===t&&(t=En);var n=br(e,t);e.setDate(e.getDate()-n),e.setHours(0,0,0,0)}function Lr(e){e.setDate(Dn),e.setHours(0,0,0,0)}function Rr(e){var t=e.getMonth();e.setMonth(t-t%In,Dn),e.setHours(0,0,0,0)}function qr(e){var t=e.getFullYear();e.setTime(0),e.setFullYear(t,0,1),e.setHours(0,0,0,0)}function Vr(e){e.setMilliseconds(Ln)}function Fr(e){e.setSeconds(An,Ln)}function Yr(e){e.setMinutes(Nn,An,Ln)}function Br(e){e.setHours(jn,Nn,An,Ln)}function Gr(e,t){void 0===t&&(t=En);var n=br(e,t);e.setDate(e.getDate()+(Rn-n)),Br(e)}function Wr(e){e.setFullYear(e.getFullYear(),e.getMonth()+1,0),Br(e)}function Ur(e){var t=e.getMonth();e.setMonth(t-t%In+In,Dn),Br(e)}function Hr(e){e.setFullYear(e.getFullYear()+1,0,0),Br(e)}function Jr(e,t){e.setTime(e.getTime()+t)}function Kr(e,t){Jr(e,t*Sn)}function zr(e,t){Jr(e,t*Pn)}function Xr(e,t){Jr(e,t*_n)}function $r(e,t){e.setDate(e.getDate()+t)}function Qr(e,t){$r(e,t*wn)}function Zr(e,t){var n=e.getMonth()+t,r=new Date(0);r.setFullYear(r.getFullYear(),n,1),r.setHours(0,0,0,0);var o=_r(r);e.setMonth(n,Math.min(o,e.getDate()))}function eo(e,t){Zr(e,t*In)}function to(e,t){Zr(e,t*Cn)}function no(e,t){return e.getTime()-t.getTime()}function ro(e,t){return no(e,t)/Sn}function oo(e,t){return no(e,t)/Pn}function io(e,t){return no(e,t)/_n}function so(e,t){return(Mr(e)-Mr(t))/Mn}function ao(e,t){return so(e,t)/wn}function uo(e,t){var n=e.getFullYear()-t.getFullYear(),r=e.getMonth()-t.getMonth(),o=(e.getDate()-t.getDate())/kn;return n*Cn+r+o}function po(e,t){return uo(e,t)/In}function co(e,t){return uo(e,t)/Cn}var lo=new J(z.Date+z.Delimiter),fo=new K(z.Date+z.Delimiter),yo=lo,ho={create:yo.set("create"),now:yo.set("now"),today:yo.set("today"),tomorrow:yo.set("today+"),yesterday:yo.set("today-"),maybe:yo.set("maybe",{},["value"]),parse:yo.set("parse",{},["value"],["parseAsUTC"]),fromText:yo.set(">txt",{},["value"],["parseAsUTC"]),fromTimestamp:yo.set(">tms",{},["value"]),fromTimestampSeconds:yo.set(">tmss",{},["value"]),min:yo.set("min",{},["value","test"]),max:yo.set("max",{},["value","test"]),get:yo.set("get",{},["value","property"]),set:yo.set("set",{},["value","property","set"]),add:yo.set("+",{},["value","unit"],["amount"]),sub:yo.set("-",{},["value","unit"],["amount"]),startOf:yo.set("startOf",{},["value","unit"]),endOf:yo.set("endOf",{},["value","unit"],["inclusive"]),daysInMonth:yo.set("dim",{},["value"]),daysInYear:yo.set("diy",{},["value"]),weeksInYear:yo.set("wiy",{},["value"]),copy:yo.set("copy",{},["value"]),cmp:yo.set("cmp",{},["value","test"],["unit"]),diff:yo.set("diff",{},["value","test"],["unit","absolute","adjust"]),timezoneOffset:yo.set("offset",{},["value"]),toText:yo.set("toText",{},["value","format"]),toISOText:yo.set("toISOText",{},["value"]),isValid:yo.set("?",{},["value"]),isEqual:yo.set("=",{},["value","test"],["unit"]),isBefore:yo.set("<",{},["value","test"],["unit"]),isBeforeOrEqual:yo.set("<=",{},["value","test"],["unit"]),isAfter:yo.set(">",{},["value","test"],["unit"]),isAfterOrEqual:yo.set(">=",{},["value","test"],["unit"]),isBetween:yo.set("between",{},["value","start","end"],["unit","startInclusive","endInclusive"]),isStartOf:yo.set("startOf?",{},["value","unit"]),isEndOf:yo.set("endOf?",{},["value","unit"],["inclusive"]),isDST:yo.set("dst?",{},["value"]),isLeapYear:yo.set("leap?",{},["value"]),asAny:yo.set("~"+z.Any,{},["value"]),asBoolean:yo.set("~"+z.Boolean,{},["value"]),asColor:yo.set("~"+z.Color,{},["value"]),asDate:yo.set("~"+z.Date,{},["value"]),asList:yo.set("~"+z.List,{},["value"]),asMap:yo.set("~"+z.Map,{},["value"]),asNumber:yo.set("~"+z.Number,{},["value"]),asObject:yo.set("~"+z.Object,{},["value"]),asText:yo.set("~"+z.Text,{},["value"]),asTuple:yo.set("~"+z.Tuple,{},["value"]),asSet:yo.set("~"+z.Set,{},["value"])};fo.set("timestamp",ho.get,"value",{property:"timestamp"}),fo.set("timestampSeconds",ho.get,"value",{property:"timestampSeconds"}),fo.set("millis",ho.get,"value",{property:"millis"}),fo.set("second",ho.get,"value",{property:"second"}),fo.set("minute",ho.get,"value",{property:"minute"}),fo.set("hour",ho.get,"value",{property:"hour"}),fo.set("day",ho.get,"value",{property:"day"}),fo.set("dayOfMonth",ho.get,"value",{property:"dayOfMonth"}),fo.set("lastDayOfMonth",ho.get,"value",{property:"lastDayOfMonth"}),fo.set("dayOfYear",ho.get,"value",{property:"dayOfYear"}),fo.set("dayOfWeek",ho.get,"value",{property:"dayOfWeek"}),fo.set("week",ho.get,"value",{property:"week"}),fo.set("weekOfMonth",ho.get,"value",{property:"weekOfMonth"}),fo.set("weekspanOfMonth",ho.get,"value",{property:"weekspanOfMonth"}),fo.set("fullWeekOfMonth",ho.get,"value",{property:"fullWeekOfMonth"}),fo.set("lastWeekspanOfMonth",ho.get,"value",{property:"lastWeekspanOfMonth"}),fo.set("lastFullWeekOfMonth",ho.get,"value",{property:"lastFullWeekOfMonth"}),fo.set("weekOfYear",ho.get,"value",{property:"weekOfYear"}),fo.set("weekspanOfYear",ho.get,"value",{property:"weekspanOfYear"}),fo.set("fullWeekOfYear",ho.get,"value",{property:"fullWeekOfYear"}),fo.set("lastWeekspanOfYear",ho.get,"value",{property:"lastWeekspanOfYear"}),fo.set("lastFullWeekOfYear",ho.get,"value",{property:"lastFullWeekOfYear"}),fo.set("month",ho.get,"value",{property:"month"}),fo.set("quarter",ho.get,"value",{property:"quarter"}),fo.set("year",ho.get,"value",{property:"year"}),fo.set("timeIdentifier",ho.get,"value",{property:"timeIdentifier"}),fo.set("dayIdentifier",ho.get,"value",{property:"dayIdentifier"}),fo.set("weekIdentifier",ho.get,"value",{property:"weekIdentifier"}),fo.set("monthIdentifier",ho.get,"value",{property:"monthIdentifier"}),fo.set("quarterIdentifier",ho.get,"value",{property:"quarterIdentifier"}),fo.set("startOfSecond",ho.startOf,"value",{unit:"second"}),fo.set("startOfMinute",ho.startOf,"value",{unit:"minute"}),fo.set("startOfHour",ho.startOf,"value",{unit:"hour"}),fo.set("startOfDay",ho.startOf,"value",{unit:"day"}),fo.set("startOfWeek",ho.startOf,"value",{unit:"week"}),fo.set("startOfMonth",ho.startOf,"value",{unit:"month"}),fo.set("startOfQuarter",ho.startOf,"value",{unit:"quarter"}),fo.set("startOfYear",ho.startOf,"value",{unit:"year"}),fo.set("endOfSecond",ho.endOf,"value",{unit:"second"}),fo.set("endOfMinute",ho.endOf,"value",{unit:"minute"}),fo.set("endOfHour",ho.endOf,"value",{unit:"hour"}),fo.set("endOfDay",ho.endOf,"value",{unit:"day"}),fo.set("endOfWeek",ho.endOf,"value",{unit:"week"}),fo.set("endOfMonth",ho.endOf,"value",{unit:"month"}),fo.set("endOfQuarter",ho.endOf,"value",{unit:"quarter"}),fo.set("endOfYear",ho.endOf,"value",{unit:"year"}),fo.set("daysInMonth",ho.daysInMonth),fo.set("daysInYear",ho.daysInYear),fo.set("weeksInYear",ho.weeksInYear),fo.set("timezoneOffset",ho.timezoneOffset),fo.set("toISOText",ho.toISOText),fo.set("isDST",ho.isDST),fo.set("isLeapYear",ho.isLeapYear);var vo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mo=function(){return(mo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vo(t,e),t.decode=function(e,n){return new t(this.decodeOptions(e[1]||{}))},t.encode=function(e){return m(e.options)?this.id:[this.id,this.encodeOptions(e.options)]},t.decodeOptions=function(e){return e.validateMin&&(e.validateMin=new Date(e.validateMin)),e.validateMax&&(e.validateMax=new Date(e.validateMax)),e.forceMin&&(e.forceMin=new Date(e.forceMin)),e.forceMax&&(e.forceMax=new Date(e.forceMax)),e},t.encodeOptions=function(e){var t=mo({},e);return t.validateMin&&(t.validateMin=t.validateMin.toISOString()),t.validateMax&&(t.validateMax=t.validateMax.toISOString()),t.forceMin&&(t.forceMin=t.forceMin.toISOString()),t.forceMax&&(t.forceMax=t.forceMax.toISOString()),t},t.describe=function(e,n){return u(e)?new t({validateMin:new Date(e.getTime()),validateMax:new Date(e.getTime())}):null},t.register=function(){me.addJsonReader(9,function(e,t){if(y(e)&&s(e.$any)&&"date"===e.$any)return new Date(e.value)}),me.addJsonWriter(9,function(e,t){if(u(e))return{$any:"date",value:e.toISOString()}}),k(9,function(e,t,n){if(u(e)){var r=new Date(e.getTime());return n.set(e,r),r}})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.parseAsUTC=t.parseAsUTC&&n.parseAsUTC,t.validateMin&&n.validateMin&&t.validateMin.setTime(Math.min(t.validateMin.getTime(),n.validateMin.getTime())),t.validateMax&&n.validateMax&&t.validateMax.setTime(Math.max(t.validateMax.getTime(),n.validateMax.getTime()))},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){if(void 0===n&&(n={}),!(e instanceof t))return!1;if(n.value){if(e.options.withTime&&!this.options.withTime)return!1;var r=this.getMin(),o=e.getMin();if(r&&(!o||o.getTime()<r.getTime()))return!1;var i=this.getMax(),s=e.getMax();if(i&&(!s||s.getTime()>i.getTime()))return!1;var a=this.options,u=a.forceStartOf,p=a.forceEndOf;if(u&&u!==e.options.forceStartOf)return!1;if(p&&p!==e.options.forceEndOf)return!1}return!0},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.traverse=function(e){return e.enter(this)},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){var e=this.options,t=e.parseAsUTC,n=e.withTime;this.options={parseAsUTC:t,withTime:n}},t.prototype.getCreateExpression=function(){return Tn.op(ho.create,{})},t.prototype.getValidateExpression=function(){return Tn.op(ho.isValid,{value:Tn.get("value")})},t.prototype.getCompareExpression=function(){return Tn.op(ho.cmp,{value:Tn.get("value"),test:Tn.get("test")})},t.prototype.isValid=function(e){var t=this.options,n=t.parseAsUTC,r=t.validateMin,o=t.validateMax,i=$n(e,n);return!!i&&(!(r&&i.getTime()<r.getTime())&&!(o&&i.getTime()>o.getTime()))},t.prototype.normalize=function(e){var t=this.options,n=t.parseAsUTC,r=t.forceMin,o=t.forceMax,i=t.forceStartOf,s=t.forceEndOf,a=$n(e,n);return a?(r&&a.getTime()<r.getTime()&&a.setTime(r.getTime()),o&&a.getTime()>o.getTime()&&a.setTime(o.getTime()),i&&Wn[i](a),s&&Un[s](a),a):e},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t(j(this.options))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return new Date},t.prototype.random=function(e){var t=new Date,n=this.getMin(),r=this.getMax(),o=n?n.getTime():t.getTime(),i=r?r.getTime():t.getTime();return new Date(e(o,i,!0))},t.prototype.getMin=function(){return this.options.validateMin||this.options.forceMin},t.prototype.getMax=function(){return this.options.validateMax||this.options.forceMax},t.prototype.fromJson=function(e){return new Date(e)},t.prototype.toJson=function(e){return e?e.toISOString():null},t.id=z.Date,t.operations=lo,t.computeds=fo,t.baseType=new t({}),t.describePriority=6,t.registered=!1,t}(B),To=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bo=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},xo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Oo=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(xo(arguments[t]));return e},Eo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return To(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getType(e)}))},t.encode=function(e){var t=e.options.map(function(e){return e.encode()});return[this.id,t]},t.describe=function(e,t){return null},t.register=function(){},t.prototype.getOperations=function(){var e=this;return this.operations||(this.operations={},this.options.forEach(function(t){var n=t.getOperations();for(var r in n)e.operations[r]=n[r]})),this.operations},t.prototype.forMany=function(e,t){var n,r,o=this.options;try{for(var i=bo(o),s=i.next();!s.done;s=i.next()){var a=t(s.value);if(void 0!==a)return a}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return e},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){var r,o;try{for(var i=bo(this.options),s=i.next();!s.done;s=i.next()){var a=s.value.getSubType(e,t,n);if(a)return a}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return null},t.prototype.getSubTypes=function(e){var t=[];return this.options.forEach(function(n){n.getSubTypes(e).forEach(function(e){t.find(function(t){return t.key===e.key||t.key instanceof B&&e.key instanceof B&&h(t.key,e.key)})||t.push(e)})}),t.sort(function(e,t){return(e.key instanceof B?1:0)-(t.key instanceof B?1:0)}),t},t.prototype.getExactType=function(e){return this.forMany(this,function(t){return t.isValid(e)?t:void 0})},t.prototype.getSimplifiedType=function(){return 1===this.options.length?this.options[0]:this},t.prototype.getRequired=function(){return this.isOptional()?new t(this.options.map(function(e){return e.getRequired()})):this},t.prototype.isDeepCompatible=function(e,t){return this.forMany(!1,function(n){return!!n.isCompatible(e,t)||void 0})},t.prototype.isOptional=function(){return this.forMany(!0,function(e){return!!e.isOptional()&&void 0})},t.prototype.isSimple=function(){return this.forMany(!0,function(e){return!!e.isSimple()&&void 0})},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return t.options.map(function(n,r){return e.step(r,n,function(e){return t.options.splice(r,1,e)},function(){return t.options.splice(r,1)})})})},t.prototype.getTypeFromStep=function(e){return this.options[e]||null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.options.forEach(function(e){return e.setParent(t)})},t.prototype.removeDescribedRestrictions=function(){this.options.forEach(function(e){return e.removeDescribedRestrictions()})},t.prototype.getCreateExpression=function(){return this.options[0].getCreateExpression()},t.prototype.getValidateExpression=function(){return Tn.or.apply(Tn,Oo(this.options.map(function(e){return e.getValidateExpression()})))},t.prototype.getCompareExpression=function(){return Tn.op(ce.cmp,{value:Tn.get("value"),test:Tn.get("test")})},t.prototype.getValueChangeExpression=function(e,t,n){var r=i(t),o=i(n);if(r&&!o){var s=0===t?this.options[1]:this.options[0],a=this.options[t],u=Tn.cast(a,s);return Tn.if(s.getValidateExpression()).than(Tn.get("value")).else(u)}return!r&&o?e:n===t&&r?Tn.if(Tn.not(this.getValidateExpression())).than(e).else(Tn.get("value")):e},t.prototype.isValid=function(e){return this.forMany(!1,function(t){return!!t.isValid(e)||void 0})},t.prototype.normalize=function(e){return this.forMany(e,function(t){return t.isValid(e)?t.normalize(e):void 0})},t.prototype.newInstance=function(){return new t([])},t.prototype.clone=function(){return new t(this.options.map(function(e){return e.clone()}))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.options.length>0?this.options[0].create():null},t.prototype.random=function(e){var t=this.options;return t[e(0,t.length,!0)].random(e)},t.prototype.fromJson=function(e){var t,n,r=this.options;try{for(var o=bo(r),i=o.next();!i.done;i=o.next()){var s=i.value.normalize(e);if(null!=s)return s}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e},t.prototype.toJson=function(e){var t,n,r=this.options;try{for(var o=bo(r),i=o.next();!i.done;i=o.next()){var s=i.value;if(s.isValid(e))return s.toJson(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e},t.id=z.Many,t.operations=new J(z.Many+z.Delimiter),t.computeds=new K(z.Many+z.Delimiter),t.baseType=new t([me.baseType]),t.describePriority=-1,t.registered=!1,t}(B),So=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wo=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},Po=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},_o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return So(t,e),t.decode=function(e,n){var r=n.getType(e[1]);return new t({key:e[2]?n.getType(e[2]):Ve.baseType,value:r})},t.encode=function(e){var t=e.options,n=t.key,r=t.value;return n!==Ve.baseType?[this.id,r.encode()]:[this.id,r.encode(),n.encode()]},t.describe=function(e,n){var r,o;if(!p(e))return null;var i=new me({}),s=new me({});try{for(var a=wo(e.entries()),u=a.next();!u.done;u=a.next()){var c=Po(u.value,2),l=c[0],f=c[1];i=n.merge(i,l),s=n.merge(s,f)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return new t({key:i,value:s})},t.register=function(){me.addJsonReader(10,function(e,t){if(y(e)&&s(e.$any)&&"map"===e.$any)return new Map(e.value.map(function(e){var n=Po(e,2),r=n[0],o=n[1];return[t(r),t(o)]}))}),me.addJsonWriter(10,function(e,t){if(p(e))return{$any:"map",value:Array.from(e.entries()).map(function(e){var n=Po(e,2),r=n[0],o=n[1];return[t(r),t(o)]})}}),k(10,function(e,t,n){var r,o;if(p(e)){var i=new Map;n.set(e,i);try{for(var s=wo(e.entries()),a=s.next();!a.done;a=s.next()){var u=Po(a.value,2),c=u[0],l=u[1];i.set(t(c,n),t(l,n))}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}})},t.forItem=function(e,n){void 0===n&&(n=Ve);var r=di.parse(e);return new t({key:di.parse(n),value:r})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.key=di.merge(t.key,n.key),t.value=di.merge(t.value,n.value)},t.prototype.getSubType=function(e,t,n){if(ze.is(e)&&this.options.key.isValid(e.value))return this.options.value;var r=e.getType(t,n);return r&&h(r=r.getRequired(),this.options.key)?this.options.value:null},t.prototype.getSubTypes=function(e){return[{key:this.options.key,value:this.options.value}]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){return e instanceof t&&this.options.key.isCompatible(e.options.key,n)&&this.options.value.isCompatible(e.options.value,n)},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_KEY,n.options.key,function(e){return n.options.key=e}),e.step(t.STEP_VALUE,n.options.value,function(e){return n.options.value=e})})},t.prototype.getTypeFromStep=function(e){return e===t.STEP_KEY?this.options.key:e===t.STEP_VALUE?this.options.value:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.key.setParent(this),this.options.value.setParent(this)},t.prototype.removeDescribedRestrictions=function(){this.options.key.removeDescribedRestrictions(),this.options.value.removeDescribedRestrictions()},t.prototype.getCreateExpression=function(){return Tn.op(Ge.create,{})},t.prototype.getValidateExpression=function(){return Tn.and(Tn.op(Ge.isValid,{value:Tn.get("value")}),Tn.not(Tn.op(zt.contains,{list:Tn.op(Ge.values,{map:Tn.get("value")}),item:Tn.null(),isEqual:Tn.not(this.options.value.getValidateExpression())},{value:"ignore",test:"value"})),Tn.not(Tn.op(zt.contains,{list:Tn.op(Ge.keys,{map:Tn.get("value")}),item:Tn.null(),isEqual:Tn.not(this.options.key.getValidateExpression())},{value:"ignore",test:"value"})))},t.prototype.getCompareExpression=function(){return Tn.op(Ge.cmp,{value:Tn.get("value"),test:Tn.get("test"),compare:this.options.value.getValidateExpression()})},t.prototype.getValueChangeExpression=function(e,n,r){return n===t.STEP_KEY?Tn.op(Ge.map,{map:Tn.get("value"),transformKey:e},{key:"value",value:"actualValue"}):Tn.op(Ge.map,{map:Tn.get("value"),transform:e})},t.prototype.isValid=function(e){if(e instanceof Map||y(e)){var t=this.options,n=t.key,r=t.value;return this.iterate(e,!0,function(e,t){if(!n.isValid(e)||!r.isValid(t))return!1})}return!1},t.prototype.normalize=function(e){var t=this.options,n=t.key,r=t.value,o=[];return this.iterate(e,void 0,function(e,t){o.push([n.normalize(e),r.normalize(t)])}),new Map(o)},t.prototype.iterate=function(e,t,n){var r,o,i,s;if(e instanceof Map)try{for(var a=wo(e.entries()),u=a.next();!u.done;u=a.next()){var p=Po(u.value,2);if(void 0!==(f=n(p[0],p[1])))return f}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}else if(y(e))try{for(var c=wo(e),l=c.next();!l.done;l=c.next()){var f,d=l.value;if(void 0!==(f=n(d,e[d])))return f}}catch(e){i={error:e}}finally{try{l&&!l.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}return t},t.prototype.newInstance=function(){var e=this.options,n=e.key,r=e.value;return new t({key:n.newInstance(),value:r.newInstance()})},t.prototype.clone=function(){var e=this.options,n=e.key,r=e.value;return new t({key:n.clone(),value:r.clone()})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return new Map},t.prototype.random=function(e){for(var t=this.options,n=t.key,r=t.value,o=e(2,6,!0),i=new Map,s=0;s<o;s++){var a=n.random(e),u=r.random(e);i.set(a,u)}return i},t.prototype.fromJson=function(e){var t=this.options,n=t.key,r=t.value;return new Map(e.map(function(e){var t=Po(e,2),o=t[0],i=t[1];return[n.fromJson(o),r.fromJson(i)]}))},t.prototype.toJson=function(e){var t=this.options,n=t.key,r=t.value;return Array.from(e.entries()).map(function(e){var t=Po(e,2),o=t[0],i=t[1];return[n.toJson(o),r.toJson(i)]})},t.STEP_KEY="key",t.STEP_VALUE="value",t.id=z.Map,t.operations=Fe,t.computeds=Ye,t.baseType=new t({key:Ve.baseType,value:me.baseType}),t.describePriority=7,t.registered=!1,t}(B),Mo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Mo(t,e),t.decode=function(e,n){return new t(n.getType(e[1]))},t.encode=function(e){return[this.id,e.options.encode()]},t.describe=function(e,t){return null},t.register=function(){},t.for=function(e){return new t(di.parse(e))},t.prototype.getOperations=function(){return this.options.getOperations()},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return this.options.getSubType(e,t,n)},t.prototype.getSubTypes=function(e){return this.options.getSubTypes(e)},t.prototype.getExactType=function(e){return this.options.getExactType(e)},t.prototype.getSimplifiedType=function(){return this},t.prototype.getRequired=function(){return this.options},t.prototype.isDeepCompatible=function(e,n){return e instanceof t?this.options.isCompatible(e.options,n):this.options.isCompatible(e,n)},t.prototype.isOptional=function(){return!0},t.prototype.isSimple=function(){return this.options.isSimple()},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){return e.step(t.STEP_OPTIONAL,n.options,function(e){return n.options=e})})},t.prototype.getTypeFromStep=function(e){return e===t.STEP_OPTIONAL?this.options:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.setParent(this)},t.prototype.removeDescribedRestrictions=function(){this.options.removeDescribedRestrictions()},t.prototype.getCreateExpression=function(){return this.options.getCreateExpression()},t.prototype.getValidateExpression=function(){return Tn.or(Tn.op(ce.isEqual,{value:Tn.get("value"),test:Tn.undefined()}),this.options.getValidateExpression())},t.prototype.getCompareExpression=function(){return Tn.define({valueMissing:Tn.op(ce.isEqual,{value:Tn.get("value"),test:Tn.undefined()}),testMissing:Tn.op(ce.isEqual,{value:Tn.get("test"),test:Tn.undefined()})},Tn.if(Tn.and(Tn.get("valueMissing"),Tn.get("testMissing"))).than(Tn.compareEqual()).if(Tn.get("valueMissing")).than(Tn.compareLess()).if(Tn.get("testMissing")).than(Tn.compareGreater()).else(this.options.getCompareExpression()))},t.prototype.getValueChangeExpression=function(e,t,n){return Tn.if(this.options.getValidateExpression()).than(e).else(Tn.get("value"))},t.prototype.isValid=function(e){return null==e||this.options.isValid(e)},t.prototype.normalize=function(e){return null==e?e:this.options.normalize(e)},t.prototype.newInstance=function(){return new t(this.options.newInstance())},t.prototype.clone=function(){return new t(this.options.clone())},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.options?this.options.create():void 0},t.prototype.random=function(e){return this.options&&e(0,1,!1)>.3?this.options.random(e):void 0},t.prototype.fromJson=function(e){return null==e?void 0:this.options.fromJson(e)},t.prototype.toJson=function(e){return null==e?void 0:this.options.toJson(e)},t.STEP_OPTIONAL="optional",t.id=z.Optional,t.operations=new J(z.Optional+z.Delimiter),t.computeds=new K(z.Optional+z.Delimiter),t.baseType=new t(me.baseType),t.describePriority=-1,t.registered=!1,t}(B),Co=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Do=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},ko=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Co(t,e),t.decode=function(e,n){return new t(e[1].map(function(e){return n.getType(e)}))},t.encode=function(e){var t=e.options.map(function(e){return e.encode()});return[this.id,t]},t.describe=function(e,t){return null},t.register=function(){},t.prototype.getOperations=function(){return{}},t.prototype.forNot=function(e,t){var n,r,o=this.options;try{for(var i=Do(o),s=i.next();!s.done;s=i.next()){var a=t(s.value);if(void 0!==a)return a}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return e},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,t){return this.forNot(!0,function(n){return!n.isCompatible(e,t)&&void 0})},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.isOptional=function(){return!0},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var t=this;return e.enter(this,function(){return t.options.map(function(n,r){return e.step(r,n,function(e){return t.options.splice(r,1,e)},function(){return t.options.splice(r,1)})})})},t.prototype.getTypeFromStep=function(e){return this.options[e]||null},t.prototype.setParent=function(e){var t=this;void 0===e&&(e=null),this.parent=e,this.options.forEach(function(e){return e.setParent(t)})},t.prototype.removeDescribedRestrictions=function(){this.options.forEach(function(e){return e.removeDescribedRestrictions()})},t.prototype.getCreateExpression=function(){return de.instance},t.prototype.getValidateExpression=function(){return de.instance},t.prototype.getCompareExpression=function(){return de.instance},t.prototype.isValid=function(e){return this.forNot(!0,function(t){return!t.isValid(e)&&void 0})},t.prototype.normalize=function(e){return this.forNot(e,function(t){return t.isValid(e)?null:void 0})},t.prototype.newInstance=function(){return new t([])},t.prototype.clone=function(){return new t(this.options.map(function(e){return e.clone()}))},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return null},t.prototype.random=function(e){return null},t.prototype.fromJson=function(e){return me.baseType.fromJson(e)},t.prototype.toJson=function(e){return me.baseType.toJson(e)},t.id=z.Not,t.operations=new J(z.Not+z.Delimiter),t.computeds=new K(z.Not+z.Delimiter),t.baseType=new t([me.baseType]),t.describePriority=-1,t.registered=!1,t}(B),jo=new J(z.Color+z.Delimiter),No=new K(z.Color+z.Delimiter),Ao=jo,Lo={create:Ao.set("create",{}),maybe:Ao.set("maybe",{},["value"]),cmp:Ao.set("cmp",{},["value","test"]),copy:Ao.set("copy",{},["value"]),build:Ao.set("build",{},["r","g","b"],["a"]),map:Ao.set("map",{},["value","r","g","b"],["a"],["value","component"],["r","g","b","a"]),op:Ao.set("op",{},["value","test","r","g","b"],["a"],["value","test","component"],["r","g","b","a"]),clamp:Ao.set("clamp",{},["value"]),add:Ao.set("+",{},["value","addend"],["alpha"]),adds:Ao.set("+*",{},["value","addend","addendScale"],["alpha"]),sub:Ao.set("-",{},["value","subtrahend"],["alpha"]),mul:Ao.set("*",{},["value","multiplier"],["alpha"]),div:Ao.set("/",{},["value","divisor"],["alpha"]),mod:Ao.set("%",{},["value","divisor"],["alpha"]),format:Ao.set("format",{},["value","format"]),parse:Ao.set("parse",{},["value"]),lerp:Ao.set("lerp",{},["start","end","delta"]),lighten:Ao.set("lighten",{},["value","amount"]),darken:Ao.set("darken",{},["value","amount"]),toHSL:Ao.set("->hsl",{},["value"]),fromHSL:Ao.set("<-hsl",{},["value"]),luminance:Ao.set("luminance",{},["value"]),contrast:Ao.set("contrast",{},["value","test"]),invert:Ao.set("invert",{},["value"],["alpha"]),opaque:Ao.set("opaque",{},["value"]),alpha:Ao.set("alpha",{},["value","alpha"]),distance:Ao.set("distance",{},["value","test"]),named:Ao.set("named",{},["name"]),getName:Ao.set("getName",{},["value"]),blend:Ao.set("blend",{},["top","bottom","mode"]),isValid:Ao.set("?",{},["value"]),isEqual:Ao.set("=",{},["value","test"],["epsilon"]),isNotEqual:Ao.set("!=",{},["value","test"],["epsilon"]),isLess:Ao.set("<",{},["value","test"]),isLessOrEqual:Ao.set("<=",{},["value","test"]),isGreater:Ao.set(">",{},["value","test"]),isGreaterOrEqual:Ao.set(">=",{},["value","test"]),asAny:Ao.set("~"+z.Any,{},["value"]),asBoolean:Ao.set("~"+z.Boolean,{},["value"]),asColor:Ao.set("~"+z.Color,{},["value"]),asDate:Ao.set("~"+z.Date,{},["value"]),asList:Ao.set("~"+z.List,{},["value"]),asMap:Ao.set("~"+z.Map,{},["value"]),asNumber:Ao.set("~"+z.Number,{},["value"]),asObject:Ao.set("~"+z.Object,{},["value"]),asText:Ao.set("~"+z.Text,{},["value"]),asTuple:Ao.set("~"+z.Tuple,{},["value"]),asSet:Ao.set("~"+z.Set,{},["value"])};No.set("toHSL",Lo.toHSL),No.set("luminance",Lo.luminance),No.set("inverted",Lo.invert),No.set("opaque",Lo.opaque),No.set("name",Lo.getName);var Ro=0,qo=255;function Vo(e){return y(e)&&i(e.r)&&i(e.g)&&i(e.b)}function Fo(e){return g(Math.round(e),Ro,qo)}var Yo=function(){function e(e,t){this.code=e,this.name=t,this.formatMap={},this.formats=[]}return e.prototype.setType=function(e){return this.type=e,this},e.prototype.setToColor=function(e){return this.toColor=e,this},e.prototype.setFromColor=function(e){return this.fromColor=e,this},e.prototype.addFormat=function(e){return this.formatMap[e.code]=e,this.formats.push(e),this},e}(),Bo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Go=new Yo("rgb","RGB").setToColor(function(e){return e}).setFromColor(function(e){return e}).addFormat({code:"default",name:"Default",parser:function(e){return Vo(e)?e:null},formatter:function(e){return e}}).addFormat({code:"bestfit",name:"Best Fit",parser:function(e){return null},formatter:function(e){return e.a===qo?"#"+Uo(e.r)+Uo(e.g)+Uo(e.b):"rgba("+Fo(e.r)+","+Fo(e.g)+","+Fo(e.b)+","+Fo(e.a)/qo+")"}}).addFormat({code:"hexShort",name:"Hex (#rgb)",parser:function(e){if(!s(e))return null;var t=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);if(!t)return null;var n=Bo(t,4),r=n[1],o=n[2],i=n[3];return{r:parseInt(r+r,16),g:parseInt(o+o,16),b:parseInt(i+i,16),a:qo}},formatter:function(e){return"#"+Uo(e.r).substring(0,1)+Uo(e.g).substring(0,1)+Uo(e.b).substring(0,1)}}).addFormat({code:"hex",name:"Hex (#rrggbb)",parser:function(e){if(!s(e))return null;var t=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e);if(!t)return null;var n=Bo(t,4),r=n[1],o=n[2],i=n[3];return{r:parseInt(r,16),g:parseInt(o,16),b:parseInt(i,16),a:qo}},formatter:function(e){return"#"+Uo(e.r)+Uo(e.g)+Uo(e.b)}}).addFormat({code:"hexLong",name:"Hex (#rrggbbaa)",parser:function(e){if(!s(e))return null;var t=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e);if(!t)return null;var n=Bo(t,5),r=n[1],o=n[2],i=n[3],a=n[4];return{r:parseInt(r,16),g:parseInt(o,16),b:parseInt(i,16),a:parseInt(a,16)}},formatter:function(e){return"#"+Uo(e.r)+Uo(e.g)+Uo(e.b)+Uo(e.a)}}).addFormat({code:"rgb",name:"rgb(r, g, b)",parser:function(e){if(!s(e))return null;var t=/^rgb\(\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*\)$/i.exec(e);if(!t)return null;var n=Bo(t,4),r=n[1],o=n[2],i=n[3];return{r:Wo(r),g:Wo(o),b:Wo(i),a:qo}},formatter:function(e){return"rgb("+Fo(e.r)+","+Fo(e.g)+","+Fo(e.b)+")"}}).addFormat({code:"rgba",name:"rgba(r, g, b, a)",parser:function(e){if(!s(e))return null;var t=/^rgb\(\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*(\d{1,3}%?)\s*,\s*([01]?\.?[0-9]*)\s*\)$/i.exec(e);if(!t)return null;var n=Bo(t,5),r=n[1],o=n[2],i=n[3],a=n[4];return{r:Wo(r),g:Wo(o),b:Wo(i),a:Fo(Math.floor(parseFloat(a)*qo))}},formatter:function(e){return"rgba("+Fo(e.r)+","+Fo(e.g)+","+Fo(e.b)+","+Fo(e.a)/qo+")"}});function Wo(e){return-1===e.indexOf("%")?Fo(parseInt(e,10)):Fo(2.55*parseInt(e.substring(0,e.length-1),10))}function Uo(e){return A(Fo(e).toString(16),2,"0",!0)}var Ho=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function Jo(e){return y(e)&&i(e.h)&&i(e.s)&&i(e.l)}var Ko=new Yo("hsl","HSL").setType(new vn({props:{h:new xn({min:0,max:360,whole:!0}),s:new xn({min:0,max:100,whole:!0}),l:new xn({min:0,max:100,whole:!0}),a:new xn({min:0,max:255,whole:!0})}})).setToColor(function(e){var t=zo(e.h),n=Xo(e.l)/100,r=Xo(e.s)/100,o=(1-Math.abs(2*n-1))*r,i=o*(1-Math.abs(t/60%2-1)),s=n-o/2,a=t>=240?0:t>=60&&t<180?o:i,u=t<=120?0:t>=180&&t<300?o:i;return{r:Fo(((t<60||t>=300?o:t>=120&&t<240?0:i)+s)*qo),g:Fo((a+s)*qo),b:Fo((u+s)*qo),a:e.a}}).setFromColor(function(e){var t=Fo(e.r),n=Fo(e.g),r=Fo(e.b),o=t/qo,i=n/qo,s=r/qo,a=Math.max(o,i,s),u=Math.min(o,i,s),p=a-u,c=(a+u)/2,l=0===p?0:a===o?(i-s)/p%6:a===i?(s-o)/p+2:(o-i)/p+4,f=0===p?0:p/(1-Math.abs(2*c-1));return{h:zo(Math.round(60*l)),s:Xo(Math.round(100*f)),l:Xo(Math.round(100*c)),a:e.a}}).addFormat({code:"hsl",name:"HSL",parser:function(e){if(!s(e))return null;var t=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*\)$/i.exec(e);if(!t)return null;var n=Ho(t,4),r=n[1],o=n[2],i=n[3];return{h:zo(parseInt(r,10)),s:Xo(parseInt(o,10)),l:Xo(parseInt(i,10)),a:qo}},formatter:function(e){return"hsl("+zo(Math.round(e.h))+","+Xo(Math.round(e.s))+"%,"+Xo(Math.round(e.l))+"%)"}}).addFormat({code:"hsla",name:"HSLA",parser:function(e){if(!s(e))return null;var t=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*,\s*([01]?\.?[0-9]*)\s*\)$/i.exec(e);if(!t)return null;var n=Ho(t,5),r=n[1],o=n[2],i=n[3],a=n[4];return{h:zo(parseInt(r,10)),s:Xo(parseInt(o,10)),l:Xo(parseInt(i,10)),a:Fo(Math.floor(parseFloat(a)*qo))}},formatter:function(e){return"hsla("+zo(Math.round(e.h))+","+Xo(Math.round(e.s))+"%,"+Xo(Math.round(e.l))+"%,"+Fo(e.a)/qo+")"}});function zo(e){return e<0?360-Math.abs(e%360):e%360}function Xo(e){return g(e,0,100)}var $o=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qo=function(){return(Qo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Zo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ei=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},ti=function(e){function t(n){return void 0===n&&(n={}),e.call(this,Qo({},n,{props:t.componentProps}))||this}return $o(t,e),t.decode=function(e){return new t(e[1]||{})},t.encode=function(e){return e.options.hasAlpha?[this.id,{hasAlpha:!0}]:this.id},t.describe=function(e){var n=t.baseType.normalize(e);return n?new t({hasAlpha:n.a!==qo}):null},t.register=function(){},t.getFormat=function(e){var t=Zo(e.split(":"),2),n=t[0],r=t[1],o=this.spaces.find(function(e){return e.code===n});return o?o.formatMap[r]:void 0},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.hasAlpha=t.hasAlpha||n.hasAlpha},t.prototype.isDeepCompatible=function(e,n){return e instanceof t||!(n.strict||n.exact||!(e instanceof vn)||!e.isCompatible(this))},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!0},t.prototype.removeDescribedRestrictions=function(){e.prototype.removeDescribedRestrictions.call(this),delete this.options.hasAlpha},t.prototype.getCreateExpression=function(){return Tn.op(Lo.create,{})},t.prototype.getValidateExpression=function(){return Tn.op(Lo.isValid,{value:Tn.get("value")})},t.prototype.getCompareExpression=function(){return Tn.op(Lo.cmp,{value:Tn.get("value"),test:Tn.get("test")})},t.prototype.isValid=function(e){return void 0!==this.normalize(e)},t.prototype.normalize=function(e){var n,r,o,i;try{for(var s=ei(t.spaces),a=s.next();!a.done;a=s.next()){var u=a.value;try{for(var p=ei(u.formats),c=p.next();!c.done;c=p.next()){var l=c.value.parser(e);if(null!==l)return u.toColor(l)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},t.prototype.newInstance=function(){return new t({})},t.prototype.clone=function(){return new t({hasAlpha:this.options.hasAlpha})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return{r:0,g:0,b:0,a:0}},t.prototype.random=function(e){return{r:e(Ro,qo,!0),g:e(Ro,qo,!0),b:e(Ro,qo,!0),a:qo}},t.prototype.fromJson=function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}},t.prototype.toJson=function(e){return e?{r:e.r,g:e.g,b:e.b,a:e.a}:null},t.componentType=new xn({min:Ro,max:qo,whole:!0}),t.componentProps={r:t.componentType,g:t.componentType,b:t.componentType,a:t.componentType},t.spaces=[Go,Ko],t.id=z.Color,t.operations=jo,t.computeds=No,t.baseType=new t({hasAlpha:!0}),t.describePriority=7,t.registered=!1,t}(vn);Go.setType(ti.baseType);var ni=new J(z.Set+z.Delimiter),ri=new K(z.Set+z.Delimiter),oi=ni,ii={create:oi.set("create"),createLike:oi.set("createLike",{},["set"],[],[],[],["set"]),createFor:oi.set("createFor",{},["value"],[],[],[],["value"]),maybe:oi.set("maybe",{},["value"]),add:oi.set("add",{mutates:["set"]},["set","value"],[],[],[],["set"]),has:oi.set("has",{},["set","value"]),delete:oi.set("delete",{mutates:["set"]},["set","value"]),values:oi.set("values",{complexity:1},["set"],[],[],[],["set"]),clear:oi.set("clear",{mutates:["set"]},["set"],[],[],[],["set"]),count:oi.set("count",{},["set"]),cmp:oi.set("cmp",{complexity:1},["value","test"]),copy:oi.set("copy",{complexity:1},["set"],["deepCopy"],["set","value"],["deepCopy"],["set"]),map:oi.set("map",{complexity:1},["set"],["transform"],["set","value"],["transform"],["set"]),isValid:oi.set("?",{},["value"]),isEqual:oi.set("=",{complexity:1},["value","test"]),isNotEqual:oi.set("!=",{complexity:1},["value","test"]),isLess:oi.set("<",{complexity:1},["value","test"]),isLessOrEqual:oi.set("<=",{complexity:1},["value","test"]),isGreater:oi.set(">",{complexity:1},["value","test"]),isGreaterOrEqual:oi.set(">=",{complexity:1},["value","test"]),asAny:oi.set("~"+z.Any,{},["value"]),asBoolean:oi.set("~"+z.Boolean,{},["value"]),asColor:oi.set("~"+z.Color,{},["value"]),asDate:oi.set("~"+z.Date,{},["value"]),asList:oi.set("~"+z.List,{},["value"]),asMap:oi.set("~"+z.Map,{},["value"]),asNumber:oi.set("~"+z.Number,{},["value"]),asObject:oi.set("~"+z.Object,{},["value"]),asText:oi.set("~"+z.Text,{},["value"]),asTuple:oi.set("~"+z.Tuple,{},["value"]),asSet:oi.set("~"+z.Set,{},["value"])};ri.set("copy",ii.copy),ri.set("values",ii.values),ri.set("count",ii.count);var si,ai,ui,pi=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ci=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},li=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},fi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pi(t,e),t.decode=function(e,n){return new t({value:n.getType(e[1])})},t.encode=function(e){var t=e.options.value;return[this.id,t.encode()]},t.describe=function(e,n){var r,o;if(!c(e))return null;var i=new me({});try{for(var s=ci(e.entries()),a=s.next();!a.done;a=s.next()){var u=li(a.value,1)[0];i=n.merge(i,u)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return new t({value:i})},t.register=function(){me.addJsonReader(11,function(e,t){if(y(e)&&s(e.$any)&&"set"===e.$any)return new Set(e.value.map(function(e){return t(e)}))}),me.addJsonWriter(11,function(e,t){if(c(e))return{$any:"set",value:Array.from(e.entries()).map(function(e){return t(e)})}}),k(11,function(e,t,n){var r,o;if(c(e)){var i=new Set;n.set(e,i);try{for(var s=ci(e.entries()),a=s.next();!a.done;a=s.next()){var u=li(a.value,1)[0];i.add(t(u,n))}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}})},t.forItem=function(e){return new t({value:di.parse(e)})},t.prototype.getId=function(){return t.id},t.prototype.getOperations=function(){return t.operations.map},t.prototype.merge=function(e){var t=this.options,n=e.options;t.value=di.merge(t.value,n.value)},t.prototype.getSubType=function(e,t,n){return null},t.prototype.getSubTypes=function(e){return[]},t.prototype.getExactType=function(e){return this},t.prototype.getSimplifiedType=function(){return this},t.prototype.isDeepCompatible=function(e,n){return e instanceof t&&this.options.value.isCompatible(e.options.value,n)},t.prototype.isOptional=function(){return!1},t.prototype.isSimple=function(){return!1},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){e.step(t.STEP_VALUE,n.options.value,function(e){return n.options.value=e})})},t.prototype.getTypeFromStep=function(e){return e===t.STEP_VALUE?this.options.value:null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e,this.options.value.setParent(this)},t.prototype.removeDescribedRestrictions=function(){this.options.value.removeDescribedRestrictions()},t.prototype.getCreateExpression=function(){return Tn.op(ii.create,{})},t.prototype.getValidateExpression=function(){return Tn.and(Tn.op(ii.isValid,{value:Tn.get("value")}),Tn.not(Tn.op(zt.contains,{list:Tn.op(ii.values,{set:Tn.get("value")}),item:Tn.null(),isEqual:Tn.not(this.options.value.getValidateExpression())},{value:"ignore",test:"value"})))},t.prototype.getCompareExpression=function(){return Tn.op(ii.cmp,{value:Tn.get("value"),test:Tn.get("test")})},t.prototype.getValueChangeExpression=function(e,t,n){return Tn.op(ii.map,{set:Tn.get("value"),transform:e},{value:"value"})},t.prototype.isValid=function(e){if(e instanceof Set||a(e)){var t=this.options.value;return!Array.from(e).some(function(e){return!t.isValid(e)})}return!1},t.prototype.normalize=function(e){var t=this.options.value;return new Set(Array.from(e).map(function(e){return t.normalize(e)}))},t.prototype.newInstance=function(){return new t({value:this.options.value.newInstance()})},t.prototype.clone=function(){return new t({value:this.options.value.clone()})},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return new Set},t.prototype.random=function(e){for(var t=this.options.value,n=e(2,6,!0),r=new Set,o=0;o<n;o++){var i=t.random(e);r.add(i)}return r},t.prototype.fromJson=function(e){var t=this.options.value;return new Set(e.map(function(e){return t.fromJson(e)}))},t.prototype.toJson=function(e){var t=this.options.value;return Array.from(e.entries()).map(function(e){return t.toJson(e)})},t.STEP_VALUE="value",t.id=z.Set,t.operations=ni,t.computeds=ri,t.baseType=new t({value:me.baseType}),t.describePriority=7,t.registered=!1,t}(B),yi=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},di=function(){function e(){}return e.setParent=function(e,t){return void 0===t&&(t=!1),(this.autoSetParent||t)&&e.setParent(),e},e.any=function(){return new me({})},e.bool=function(e,t){return new te({true:e,false:t})},e.date=function(e){return void 0===e&&(e={}),new go(e)},e.enum=function(e,t,n){return void 0===t&&(t=Ve),void 0===n&&(n=new Map([])),this.setParent(new Je({value:this.parse(e),key:this.parse(t),constants:T(n)}))},e.enumForText=function(e){return this.setParent(new Je({value:this.text(),key:this.text(),constants:p(e)?e:a(e[0])?new Map(e):new Map(e.map(function(e){return[e,e]}))}))},e.list=function(e,t,n){return this.setParent(new tn({item:this.parse(e),min:t,max:n}))},e.many=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.setParent(new Eo(a(t[0])?t[0].map(function(t){return e.parse(t)}):t.map(function(t){return e.parse(t)})))},e.not=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.setParent(new ko(a(t[0])?t[0].map(function(t){return e.parse(t)}):t.map(function(t){return e.parse(t)})))},e.map=function(e,t){return void 0===t&&(t=Ve),this.setParent(new _o({key:this.parse(t),value:this.parse(e)}))},e.null=function(){return fe.baseType},e.number=function(e,t,n){return new xn({min:e,max:t,whole:n})},e.int=function(e,t){return new xn({min:e,max:t,whole:!0})},e.index=function(e){return new xn({min:0,max:e,whole:!0})},e.char=function(){return new Ve({min:1,max:1})},e.object=function(e){return void 0===e&&(e={}),this.setParent(new vn({props:this.resolve(e)}))},e.optional=function(e){var t=this.parse(e);return this.setParent(t.isOptional()?t:new Io(t))},e.color=function(e){return void 0===e&&(e={}),this.setParent(new ti(e))},e.set=function(e){return this.setParent(new fi({value:this.parse(e)}))},e.text=function(e){return void 0===e&&(e={}),new Ve(e)},e.tuple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.setParent(new sn(a(t[0])?t[0].map(function(t){return e.parse(t)}):t.map(function(t){return e.parse(t)})))},e.parse=function(e){return e instanceof B?e:e.baseType.newInstance()},e.simplify=function(e){return e?e.getSimplifiedType():null},e.resolve=function(e){var t,n=this;return e&&(e instanceof B?t=e:e.baseType instanceof B?t=e.baseType.newInstance():a(e)?t=e.map(function(e){return n.resolve(e)}):y(e)&&(t=x(e,function(e){return n.resolve(e)}))),t},e.reduce=function(e){return 1===e.length?e[0]:new Eo(e)},e.explode=function(e){return e instanceof Eo?e.options:[e]},e.maybe=function(e,t){if(e instanceof t)return e;if(e instanceof Io&&e.options instanceof t)return e;if(e instanceof Eo){var n=e.options.find(function(e){return e instanceof t});if(n)return this.optional(n);var r=e.options.find(function(e){return e instanceof Io&&e.options instanceof t});if(r)return r}return this.optional(t)},e.mergeMany=function(e){var t=this;return 0===e.length?null:e.find(function(e){return e instanceof me})?me.baseType:e.map(function(e){return e?e.clone():null}).reduce(function(e,n){return e&&n?t.merge(e,n):e||n})},e.merge=function(e,t){var n,r;if(e instanceof me)return t;var o=e instanceof Io||t instanceof Io,i=e.getRequired(),s=t.getRequired();if(h(i,s))return i.merge(s),o?this.optional(i):i;if(i instanceof Eo||s instanceof Eo){var a=this.explode(i),u=this.explode(s),p=a.length;try{for(var c=yi(u),l=c.next();!l.done;l=c.next()){for(var f=l.value,y=!1,d=f instanceof Io,v=d?f.options:f,m=0;m<p;m++){var g=a[m],T=g instanceof Io,b=T?g.options:g;h(b,v)&&(y=!0,b.merge(v),d&&!T&&(a[m]=this.optional(b)))}y||a.push(f)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return o?this.optional(this.reduce(a)):this.reduce(a)}return this.many(e,t)},e.INDEX=e.index(),e.LENGTH=e.index(),e.CHAR=e.char(),e.autoSetParent=!0,e}(),hi=function(){return(hi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},vi=function(){function e(e,t){var n=this;this.name=e.name,this.description=e.description,this.meta=e.meta,this.params=t.getTypeKind(e.params,vn,di.object()),this.expression=t.getExpression(e.expression),this.defaults=this.params.fromJson(e.defaults),this.tests=e.tests.map(function(e){return hi({},e,{args:n.params.fromJson(e.args)})})}return e.create=function(t,n){return void 0===n&&(n={}),new e(hi({name:"",description:"",meta:null,params:di.object(),expression:Tn.noop(),defaults:{},tests:[]},n),t)},e.prototype.encode=function(){var e=this,t=e.name,n=e.description,r=e.meta,o=e.params,i=e.expression,s=e.defaults,a=e.tests;return{name:t,description:n,meta:r,params:o.encode(),expression:i.encode(),defaults:o.toJson(s),tests:a.map(function(e){return hi({},e,{args:o.toJson(e.args)})})}},e.prototype.getReturnType=function(e,t){void 0===t&&(t={});var n=di.object(hi({},this.params.options.props,t));return this.expression.getType(e,n)},e.prototype.getParamTypes=function(){var e=this;return m(this.defaults)?this.params:di.object(x(this.params.options.props,function(t,n){return e.getParamType(n)}))},e.prototype.getParamType=function(e){var t=this.params.options.props[e];return t.isOptional()&&e in this.defaults&&t.isValid(this.defaults[e])?t.getRequired():t},e.prototype.getArguments=function(e,t){void 0===t&&(t=!0);var n=t?hi({},e):e;for(var r in this.defaults){this.params.options.props[r].getRequired().isValid(n[r])||(n[r]=j(this.defaults[r]))}return n},e.prototype.refactor=function(e,t){var n=t.getCommand(e);this.tests.forEach(function(e){e.args=n({value:e.args})})},e}(),mi=function(){return(mi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};!function(e){e[e.PRIMARY=0]="PRIMARY",e[e.FOREIGN=1]="FOREIGN",e[e.NONE=2]="NONE"}(ai||(ai={})),function(e){e[e.GIVEN=0]="GIVEN",e[e.AUTO_INCREMENT=1]="AUTO_INCREMENT",e[e.UUID=2]="UUID"}(ui||(ui={}));var gi,Ti,bi=function(){function e(e,t){var n=this;this.name=e.name,this.description=e.description,this.meta=e.meta,this.type=t.getTypeKind(e.type,vn,di.object()),this.instances=e.instances&&e.instances.length?e.instances.map(function(e){return n.type.fromJson(e)}):[],this.methods=e.methods?x(e.methods,function(e){return e instanceof vi?e:new vi(e,t)}):Object.create(null),this.key=e.key?t.getExpression(e.key):Tn.get("instance",this.getDynamicPrimaryKey()),this.keyType=this.key.getType(t,this.getKeyContext()),this.describe=e.describe?t.getExpression(e.describe):Tn.noop(),this.transcoders=this.decodeTranscoders(t,e.transcoders),this.indexes=this.decodeIndexes(e.indexes),this.primaryType=ui.AUTO_INCREMENT}return e.create=function(t,n){return void 0===n&&(n={}),new e(mi({name:"",description:"",meta:null,type:di.object(),instances:[],methods:Object.create(null)},n),t)},e.prototype.decodeTranscoders=function(e,t){return t?x(t,function(t){return{encode:e.getExpression(t.encode),decode:e.getExpression(t.decode),encodedType:e.getType(t.encodedType)}}):{}},e.prototype.decodeIndexes=function(e){return e?x(e,function(e,t){var n=e.unique,r=e.primary;return{name:t,props:e.props,unique:n,primary:r}}):{}},e.prototype.encode=function(){var e=this,t=e.name,n=e.description,r=e.meta,o=e.type,i=e.instances,s=e.methods,a=e.key,u=e.describe,p=e.transcoders,c=e.indexes;return{name:t,description:n,meta:r,type:o.encode(),instances:i.map(function(e){return o.toJson(e)}),methods:x(s,function(e){return e.encode()}),key:a.encode(),describe:u.encode(),transcoders:x(p,function(e){var t=e.encode,n=e.decode,r=e.encodedType;return{encode:t.encode(),decode:n.encode(),encodedType:r.encode()}}),indexes:x(c,function(e){return{props:e.props,unique:e.unique,primary:e.primary}})}},e.prototype.canStore=function(){return this.key!==Tn.noop()&&this.describe!==Tn.noop()},e.prototype.renameProp=function(e,t){e in this.transcoders&&(this.transcoders[t]=this.transcoders[e],delete this.transcoders[e]),O(this.indexes,function(n){var r=n.props.indexOf(e);-1!==r&&(n.props[r]=t)})},e.prototype.removeProp=function(e){var t=this;delete this.transcoders[e],O(this.indexes,function(n,r){var o=n.props.indexOf(e);-1!==o&&(n.props.splice(o,1),0===n.props.length&&delete t.indexes[r])})},e.prototype.getEntityProps=function(){var e=this,t=this.getPrimary(),n=t.props.map(function(n,r){return[n,t.types&&t.types[r]?t.types[r]:e.type.options.props[n]]});return{type:ai.PRIMARY,props:n}},e.prototype.getKey=function(e,t){var n=this.type,r=this.key;return e.run(r,{instance:t,type:n})},e.prototype.getDescribe=function(e,t){var n=this.type,r=this.describe;return e.run(r,{instance:t,type:n})},e.prototype.getDecodedPropertyTypes=function(){return this.type.options.props},e.prototype.getPropertyTypeFor=function(e){return e?di.enumForText([e]):this.getPropertyType()},e.prototype.getEncodedPropertyTypes=function(){var e=this;return x(this.type.options.props,function(t,n){return n in e.transcoders?e.transcoders[n].encodedType:t})},e.prototype.getEncodedType=function(){return di.object(this.getEncodedPropertyTypes())},e.prototype.getDecodedType=function(){return this.type},e.prototype.getProperties=function(){return Object.keys(this.getDecodedPropertyTypes())},e.prototype.getPropertyType=function(){return di.enumForText(this.getProperties())},e.prototype.getKeyReturnType=function(){return this.keyType},e.prototype.getKeyContext=function(){return di.object({instance:this.type,type:di.text()})},e.prototype.getDescribeContext=function(){return di.object({instance:this.type,type:di.text()})},e.prototype.getEncoded=function(e,t){var n={};for(var r in this.getDecodedPropertyTypes())n[r]=this.getEncodedValue(e,t,r);return n},e.prototype.getEncodedValue=function(e,t,n){var r=this.name,o=this.transcoders,i=n in o?o[n].encode:null,s=t[n];return i?e.run(i,{name:r,instance:t,property:n,value:s}):s},e.prototype.getEncodeContext=function(e){var t=di.enumForText([this.name]),n=this.getDecodedType(),r=this.getPropertyTypeFor(e),o=this.getDecodeExpected(e);return di.object({name:t,instance:n,property:r,value:o})},e.prototype.getEncodeExpected=function(e){return e&&e in this.transcoders?this.transcoders[e].encodedType:di.any()},e.prototype.getDecoded=function(e,t){var n={};for(var r in this.getDecodedPropertyTypes())n[r]=this.getDecodedValue(e,t,r);return n},e.prototype.getDecodedValue=function(e,t,n){var r=this.name,o=this.transcoders,i=n in o?o[n].decode:null,s=t[n];return i?e.run(i,{name:r,instance:t,property:n,value:s}):s},e.prototype.getDecodeContext=function(e){var t=di.enumForText([this.name]),n=this.getEncodedType(),r=this.getPropertyTypeFor(e),o=this.getEncodeExpected(e);return di.object({name:t,instance:n,property:r,value:o})},e.prototype.getDecodeExpected=function(e){return e&&this.type.options.props[e]||di.any()},e.prototype.getIndexExpectedType=function(){return di.set(this.getPropertyType())},e.prototype.getDynamicPrimaryKey=function(){var e=this.type.options.props;return"id"in e?"_id"in e?"__id":"_id":"id"},e.prototype.getPrimary=function(t,n){void 0===t&&(t="primary"),void 0===n&&(n=!0);var r=t in this.indexes?this.indexes[t]:S(this.indexes,function(e,t,n){return n||(e.primary?e:n)},null);return r||(n?{name:t,props:[this.getDynamicPrimaryKey()],types:[e.PRIMARY_TYPES[this.primaryType]],unique:!0,primary:!0}:null)},e.prototype.getUniqueIndexes=function(){return S(this.indexes,function(e,t,n){return e.unique&&n.push(e),n},[])},e.prototype.addPrimary=function(e){var t=a(e)?e:[e];return this.addIndex("primary",t,!0,!0),this.primaryType=ui.GIVEN,this},e.prototype.addIndex=function(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),this.indexes[e]={name:e,props:t,unique:n,primary:r},this},e.PRIMARY_TYPES=((si={})[ui.GIVEN]=null,si[ui.AUTO_INCREMENT]=di.int(1),si[ui.UUID]=di.text({min:36,max:36,forceLower:!0,matches:/^[\da-f]{8}\-[\da-f]{4}\-[\da-f]{4}\-[\da-f]{4}\-[\da-f]{12}$/i}),si),e}(),xi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};!function(e){e[e.HAS_MANY=0]="HAS_MANY",e[e.BELONGS_TO=1]="BELONGS_TO",e[e.HAS_ONE=2]="HAS_ONE",e[e.ONE=3]="ONE",e[e.HAS_ONE_POLYMORPHIC=4]="HAS_ONE_POLYMORPHIC",e[e.ONE_POLYMORPHIC=5]="ONE_POLYMORPHIC"}(gi||(gi={})),function(e){e[e.NONE=0]="NONE",e[e.CASCADE=1]="CASCADE",e[e.SET_NULL=2]="SET_NULL",e[e.RESTRICT=3]="RESTRICT"}(Ti||(Ti={}));var Oi=function(){function e(e,t){this.defs=e,this.name=t.name,this.kind=t.kind,this.subject=t.subject,this.subjectRelationName=t.subjectRelationName||t.related[0].name,this.morphs=t.morphs?this.decodeTypePair(t.morphs):null,this.morphsToRelated=T(t.morphsToRelated),this.related=t.related,this.relatedRelationName=t.relatedRelationName||t.subject.name,this.relatedToMorphs=b(this.morphsToRelated),this.multiple=!!t.multiple,this.required=!!t.required,this.owns=!!t.owns,this.extension=!!t.extension}return e.prototype.decodeTypePair=function(e){var t=xi(e,2),n=t[0],r=t[1];return[n,this.defs.getType(r)]},e.prototype.encodeTypePair=function(e){return e?[e[0],e[1].encode()]:null},e.prototype.encode=function(){var e=this,t=e.name,n=e.kind,r=e.subject,o=e.subjectRelationName,i=e.morphs,s=e.morphsToRelated,a=e.related,u=e.relatedRelationName,p=e.multiple,c=e.required,l=e.owns,f=e.extension;return{name:t,kind:n,subject:r,subjectRelationName:o,morphs:this.encodeTypePair(i),morphsToRelated:Array.from(s.entries()),related:a,relatedRelationName:u,multiple:p,required:c,owns:l,extension:f}},e.prototype.getRelatedWithName=function(e,t){return t.find(function(t){return t.name===e})},e.prototype.rename=function(e,t){this.renameReference(e,t,[this.subject]),this.renameReference(e,t,this.related)},e.prototype.renameReference=function(e,t,n){var r=this.getRelatedWithName(e,n);r&&(r.name=t)},e.prototype.remove=function(e){this.removeReference(e,[this.subject]),this.removeReference(e,this.related)},e.prototype.removeReference=function(e,t){var n=t.findIndex(function(t){return t.name===e});-1!==n&&(t.splice(n,1),t[n].props=[])},e.prototype.renameProp=function(e,t,n){this.renamePropReference(e,t,n,[this.subject]),this.renamePropReference(e,t,n,this.related)},e.prototype.renamePropReference=function(e,t,n,r){var o=this.getRelatedWithName(e,r);if(o){var i=o.props.indexOf(t);-1!==i&&(o.props[i]=n)}},e.prototype.removeProp=function(e,t){this.removePropReference(e,t,[this.subject]),this.removePropReference(e,t,this.related)},e.prototype.removePropReference=function(e,t,n){var r=n.findIndex(function(t){return t.name===e});if(-1!==r){var o=n[r],i=o.props.indexOf(t);if(-1!==i&&(o.props.splice(i,1),0===o.props.length))return n.splice(r,1),!0}return!1},e.prototype.getPropTypes=function(e){var t=this,n=[];return e.forEach(function(e){var r=e.name,o=e.props,i=t.defs.getEntity(r).getEntityProps();o.forEach(function(e,t){var r=i.props[t][1];n[t]=n[t]?di.merge(n[t],r):r.clone()})}),n},e.prototype.isEmpty=function(){return 0===this.subject.props.length||0===this.related.length},e.prototype.getItemType=function(e){var t=this,n=e.map(function(e){return t.defs.getType(e.name)});return n.length>1?di.many(n):n[0]},e.prototype.getSubjectRelation=function(e){if(this.subject.name!==e)return null;var t=this.subjectRelationName,n=this.subject.props,r=this.related,o=this.getItemType(r),i=this.owns&&this.multiple?Ti.CASCADE:this.required?Ti.RESTRICT:Ti.SET_NULL,s=this.required?o:di.optional(o),a={relation:this,name:t,kind:this.kind===gi.HAS_MANY?gi.BELONGS_TO:this.kind,local:n,cascade:i,related:r,itemType:o,relationType:s};return this.morphs&&(a.morphs=this.morphs,a.morphsToRelated=this.morphsToRelated,a.relatedToMorphs=this.relatedToMorphs),a},e.prototype.getRelatedRelation=function(e){var t=this.getRelatedWithName(e,this.related);if(!t)return null;var n=this.relatedRelationName,r=t.props,o=[this.subject],i=this.getItemType(o),s=Ti.NONE,a=this.multiple?di.list(i):this.required?i:di.optional(i),u={relation:this,name:n,kind:this.kind===gi.HAS_MANY?gi.HAS_MANY:this.morphs?gi.ONE_POLYMORPHIC:gi.ONE,local:r,cascade:s,related:o,itemType:i,relationType:a};return this.morphs&&(u.where=[this.morphs[0],this.relatedToMorphs.get(e)]),u},e.prototype.getTypeProps=function(e){var t=[];if(this.subject.name===e){var n=this.getPropTypes(this.related),r=this.subject.props.map(function(e,t){return[e,n[t]]});t.push({type:ai.FOREIGN,props:r,relation:this}),this.morphs&&t.push({type:ai.NONE,props:[this.morphs],relation:this})}return t},e.hasMany=function(t,n){var r=n.oneRelationName||n.many,o=n.manyRelationName||n.one,i=n.foreignKeyPrefix||o+"_",s=n.name||o+"_hasMany_"+r,a=t.getEntity(n.one).getPrimary().props,u=a.map(function(e){return i+e});return new e(t,{name:s,kind:gi.HAS_MANY,subject:{name:n.many,props:u},subjectRelationName:o,related:[{name:n.one,props:a}],relatedRelationName:r,multiple:!0,owns:!1!==n.owns,required:!1!==n.owns})},e.belongsTo=function(e,t){return this.hasMany(e,{name:t.name,one:t.belongsTo,many:t.oneOfMany,oneRelationName:t.belongsToRelationName,manyRelationName:t.oneOfManyRelationName,foreignKeyPrefix:t.foreignKeyPrefix,owns:t.owns})},e.hasOne=function(t,n){var r=n.oneRelationName||n.hasOne,o=n.hasOneRelationName||n.one,i=n.foreignKeyPrefix||o+"_",s=n.name||o+"_hasOne_"+r,a=t.getEntity(n.one).getPrimary().props,u=a.map(function(e){return i+e});return new e(t,{name:s,kind:gi.HAS_ONE,subject:{name:n.hasOne,props:u},subjectRelationName:o,related:[{name:n.one,props:a}],relatedRelationName:r,required:n.required,owns:n.owns})},e.belongsToOne=function(e,t){return this.hasOne(e,{name:t.name,hasOne:t.belongsTo,one:t.one,required:t.required,owns:t.owns,hasOneRelationName:t.belongsToRelationName,oneRelationName:t.oneRelationName,foreignKeyPrefix:t.foreignKeyPrefix})},e.hasOnePolymorphic=function(t,n){var r=n.hasOneRelationName,o=n.polyRelationName||n.hasOne,i=n.name||r+"_hasOnePolymorphic_"+o,s=n.foreignKeyPrefix||r+"_",a=n.poly.map(function(e){return{name:e,props:t.getEntity(e).getPrimary().props}}),u=a[0].props.map(function(e){return s+e});return new e(t,{name:i,kind:gi.HAS_ONE_POLYMORPHIC,subject:{name:n.hasOne,props:u},subjectRelationName:r,related:a,relatedRelationName:o,morphs:n.morphs,morphsToRelated:n.morphsToRelated,required:n.required,owns:n.owns})},e}(),Ei=function(){return(Ei=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Si=function(){function e(e,t){var n=this;this.name=e.name,this.author=e.author,this.description=e.description,this.meta=e.meta,this.created=e.created,this.updated=e.updated,this.dataType=t.getType(e.dataType),this.datasets=e.datasets.map(function(e){return Ei({},e,{data:n.dataType.fromJson(e.data)})}),this.expression=t.getExpression(e.expression)}return e.create=function(t,n){void 0===n&&(n={});var r=(new Date).getTime();return new e(Ei({name:name,author:"",description:"",meta:null,created:r,updated:r,dataType:di.object(),datasets:[{name:"Data Set #1",data:Object.create(null),created:r,updated:r,meta:null}],expression:de.instance},n),t)},e.prototype.encode=function(){var e=this,t=e.name,n=e.author,r=e.description,o=e.meta,i=e.created,s=e.updated,a=e.dataType,u=e.datasets,p=e.expression;return{name:t,author:n,description:r,meta:o,created:i,updated:s,dataType:a.encode(),datasets:u.map(function(e){return Ei({},e,{data:a.toJson(e.data)})}),expression:p.encode()}},e.prototype.refactor=function(e,t){var n=t.getCommand(e);this.datasets.forEach(function(e){e.data=n({value:e.data})})},e}(),wi=new J(z.Entity+z.Delimiter),Pi=new K(z.Entity+z.Delimiter),_i=wi,Mi={newInstance:_i.set("newInstance",{},["name"],[],[],[],["name"]),getKey:_i.set("getKey",{},["name","instance"],[],[],[],["name"]),save:_i.set("save",{mutates:["instance"]},["name","instance"],[],[],[],["name"]),remove:_i.set("remove",{mutates:["instance"]},["name","instance"],[],[],[],["name"]),setRelated:_i.set("setRelated",{complexity:1,mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),addRelated:_i.set("addRelated",{mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),removeRelated:_i.set("removeRelated",{mutates:["instance","related"]},["name","instance","relation","related"],[],[],[],["name","relation"]),clearRelated:_i.set("clearRelated",{complexity:1,mutates:["instance"]},["name","instance","relation"],[],[],[],["name","relation"]),getRelated:_i.set("getRelated",{complexity:1},["name","instance","relation"],[],[],[],["name","relation"]),isRelated:_i.set("isRelated",{},["name","instance","relation","related"],[],[],[],["name","relation"])},Ii=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ci=function(e){function t(t,n){var r=e.call(this,t)||this;return r.provider=n,r}return Ii(t,e),t.decode=function(e,n){return new t(e[1],n)},t.encode=function(e){return[this.id,e.options]},t.describe=function(e,t){return null},t.register=function(){},t.for=function(e,n){return new t(e,n)},t.prototype.getType=function(){return this.provider?this.provider.getType(this.options,fe.baseType):vn.baseType},t.prototype.getOperations=function(){return this.getType().getOperations()},t.prototype.getId=function(){return t.id},t.prototype.merge=function(e){},t.prototype.getSubType=function(e,t,n){return this.getType().getSubType(e,t,n)},t.prototype.getSubTypes=function(e){return this.getType().getSubTypes(e)},t.prototype.getExactType=function(e){return this.getType().getExactType(e)},t.prototype.getSimplifiedType=function(){return this.getType().getSimplifiedType()},t.prototype.isDeepCompatible=function(e,n){return e instanceof t?this.getType().isCompatible(e.getType(),n):this.getType().isCompatible(e,n)},t.prototype.isOptional=function(){return this.getType().isOptional()},t.prototype.isSimple=function(){return this.getType().isSimple()},t.prototype.acceptsOtherTypes=function(){return!0},t.prototype.traverse=function(e){var n=this;return e.enter(this,function(){return e.step(t.STEP_ENTITY,n.getType(),function(e){return e instanceof t?n.options=e.options:0})})},t.prototype.getTypeFromStep=function(e){return e===t.STEP_ENTITY?this.getType():null},t.prototype.setParent=function(e){void 0===e&&(e=null),this.parent=e},t.prototype.removeDescribedRestrictions=function(){},t.prototype.getCreateExpression=function(){return this.getType().getCreateExpression()},t.prototype.getValidateExpression=function(){return this.getType().getValidateExpression()},t.prototype.getCompareExpression=function(){return this.getType().getCompareExpression()},t.prototype.getValueChangeExpression=function(e,t,n){return e},t.prototype.isValid=function(e){return this.getType().isValid(e)},t.prototype.normalize=function(e){return this.getType().normalize(e)},t.prototype.newInstance=function(){return new t(this.options,this.provider)},t.prototype.clone=function(){return new t(this.options,this.provider)},t.prototype.encode=function(){return t.encode(this)},t.prototype.create=function(){return this.getType().create()},t.prototype.random=function(e){return this.getType().random(e)},t.prototype.fromJson=function(e){return this.getType().fromJson(e)},t.prototype.toJson=function(e){return this.getType().toJson(e)},t.STEP_ENTITY="entity",t.id=z.Entity,t.operations=wi,t.computeds=Pi,t.baseType=new t("",null),t.describePriority=-1,t.registered=!1,t}(B),Di=function(){return(Di=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ki=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},ji=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ni=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ji(arguments[t]));return e},Ai=function(){function e(e){this.types=Object.create(null),this.typeList=[],this.describers=[],this.expressions=Object.create(null),this.operations=new J(""),this.computeds=new K(""),this.parsers=Object.create(null),this.entities=Object.create(null),this.functions=Object.create(null),this.relations=Object.create(null),this.programs=Object.create(null),e&&this.add(e)}return e.prototype.extend=function(t,n){void 0===t&&(t=!1);var r=new e({types:E(this.types),expressions:E(this.expressions),entities:x(this.entities,function(e){return t?e.encode():e}),functions:x(this.functions,function(e){return t?e.encode():e}),relations:x(this.relations,function(e){return e.encode()}),programs:x(this.programs,function(e){return t?e.encode():e})});return n&&r.add(n),r},e.prototype.add=function(e){var t=this;e.types&&e.types.forEach(function(e){return t.addType(e,!0)}),this.sortDescribers(),e.expressions&&e.expressions.forEach(function(e){return t.addExpression(e)}),this.import(e)},e.prototype.describe=function(e){var t,n;try{for(var r=ki(this.describers),o=r.next();!o.done;o=r.next()){var i=o.value.describe(e,this);if(i)return i}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return me.baseType},e.prototype.merge=function(e,t){return di.merge(e,this.describe(t))},e.prototype.sortDescribers=function(){this.describers.sort(function(e,t){return t.describePriority-e.describePriority})},e.prototype.addType=function(e,t){void 0===t&&(t=!1),this.types[e.id]=e,this.typeList.push(e),this.parsers[e.id]=function(t,n){return e.decode(t,n)},this.describers.push(e),t||this.sortDescribers(),e.registered||(e.registered=!0,e.register())},e.prototype.findEntity=function(e,t){for(var n in void 0===t&&(t={strict:!0,value:!1,exact:!1}),this.entities){if(this.entities[n].type.isCompatible(e,t))return n}return!1},e.prototype.addFunction=function(e){return this.functions[e.name]=e instanceof vi?e:vi.create(this,e),this},e.prototype.getFunction=function(e){return this.functions[e]||null},e.prototype.addProgram=function(e){return this.programs[e.name]=e instanceof Si?e:Si.create(this,e),this},e.prototype.getProgram=function(e){return this.programs[e]},e.prototype.addEntity=function(e){return this.entities[e.name]=e instanceof bi?e:bi.create(this,e),this},e.prototype.getEntity=function(e){return this.entities[e]||null},e.prototype.getEntities=function(){return this.entities},e.prototype.addRelation=function(e){return this.relations[e.name]=e instanceof Oi?e:new Oi(this,e),this},e.prototype.getRelation=function(e){return this.relations[e]},e.prototype.getRelations=function(e){var t=[];return O(this.relations,function(n){var r=n.getSubjectRelation(e);r&&t.push(r);var o=n.getRelatedRelation(e);o&&t.push(o)}),t},e.prototype.getEntityProps=function(e){var t=[],n=this.entities[e];return n&&(t.push(n.getEntityProps()),O(this.relations,function(n){t.push.apply(t,Ni(n.getTypeProps(e)))})),t},e.prototype.renameProgram=function(e,t){var n=this.programs[e];return!!n&&(n.name=t,this.programs[t]=n,delete this.programs[e],!0)},e.prototype.renameEntity=function(e,t){var n=this.entities[e];if(e===t||!t||!n)return!1;n.name=e,this.entities[t]=n,delete this.entities[e],O(this.relations,function(n){n.rename(e,t)});var r=this.getEntityReferences(e);return r.forEach(function(e){e.value instanceof Ci?e.value.options=t:e.value.name=t}),r},e.prototype.renameEntityProp=function(e,t,n){var r=this.entities[e];r&&(r.renameProp(t,n),O(this.relations,function(r){r.renameProp(e,t,n)}))},e.prototype.removeEntityProp=function(e,t){var n=this,r=this.entities[e];r&&(r.removeProp(t),O(this.relations,function(r,o){r.removeProp(e,t),r.isEmpty()&&delete n.relations[o]}))},e.prototype.removeEntity=function(e,t){var n=this;return void 0===t&&(t=!0),!(e in this.entities)||!(t&&this.getEntityReferences(e).length>0)&&(delete this.entities[e],O(this.relations,function(t,r){t.remove(e),t.isEmpty()&&delete n.relations[r]}),!0)},e.prototype.refactorEntity=function(e,t,n){var r=this.getEntityDataReferences();return r.forEach(function(e){e.root.setParent();var r=e.type.getValueChangeAt(t);e.data=n.run(r,{value:e.data})}),r},e.prototype.renameRelation=function(e,t){var n=this.relations[e];if(!n)return!1;n.name=t,this.relations[t]=n,delete this.relations[e];var r=this.getRelationReferences(e);return r.forEach(function(e){e.value.name=t}),r},e.prototype.renameFunction=function(e,t){var n=this.functions[e];if(!n)return!1;n.name=t,this.functions[t]=n,delete this.functions[e];var r=this.getFunctionReferences(e);return r.forEach(function(e){e.value.name=t}),r},e.prototype.renameFunctionParameter=function(e,t,n){var r=this.functions[e];if(!r)return!1;r.params.options[n]=r.params.options[t],delete r.params.options[t],t in r.defaults&&(r.defaults[n]=r.defaults[t],delete r.defaults[t]);var o=this.getFunctionReferences(e,t);return o.forEach(function(e){e.value.args[n]=e.value.args[t],delete e.value.args[t]}),o},e.prototype.removeFunctionParameter=function(e,t){var n=this.functions[e];if(!n)return!1;delete n.params.options[t],delete n.defaults[t];var r=this.getFunctionReferences(e,t);return r.forEach(function(e){delete e.value.args[t]}),r},e.prototype.removeFunction=function(e,t){return void 0===t&&(t=!0),!(e in this.entities)||!(t&&this.getFunctionReferences(e).length>0)&&(delete this.functions[e],!0)},e.prototype.getTypeKind=function(e,t,n){void 0===n&&(n=null);var r=this.getType(e);return r instanceof t?r:n},e.prototype.getType=function(e,t){if(e instanceof B)return e;var n=a(e)?e[0]:e,r=a(e)?e:[],o=this.parsers[n];if(!o){if(n in this.entities)return this.entities[n].type;if(t)return t;throw new Error("No parser found for "+n+" with payload "+JSON.stringify(r))}return o(r,this)},e.prototype.getBaseTypes=function(){return this.typeList.map(function(e){return e.baseType})},e.prototype.getSimpleTypes=function(){return this.getBaseTypes().filter(function(e){return e.isSimple()})},e.prototype.getComplexTypes=function(){return this.getBaseTypes().filter(function(e){return!e.isSimple()})},e.prototype.getSimpleTypeClasses=function(){return this.typeList.filter(function(e){return e.baseType.isSimple()})},e.prototype.getComplexTypeClasses=function(){return this.typeList.filter(function(e){return!e.baseType.isSimple()})},e.prototype.getComputed=function(e){var t=this.computeds.get(e);if(t)return t;var n=ji(e.split(z.Delimiter),1)[0],r=this.types[n];return r?r.computeds.get(e):null},e.prototype.getComputedReturnType=function(e,t){var n;void 0===t&&(t=null);var r=this.getComputed(e);if(!r)return null;var o=this.getOperation(r.op),i=this.getOperationTypes(r.op);return o&&i?this.getOperationInputType(i.returnType,((n={})[r.value]=t,n)):null},e.prototype.getComputedsFor=function(e){var t=this.types[e.getId()];return t?t.computeds.list:[]},e.prototype.hasComputed=function(e,t){var n=this.types[e.getId()];return!!n&&!!n.computeds.get(t)},e.prototype.getOperation=function(e){var t=this.operations.get(e);if(t)return t;var n=ji(e.split(z.Delimiter),1)[0],r=this.types[n];return r?r.operations.get(e):null},e.prototype.getOperationTypes=function(e){var t=this.operations.getTypes(e);if(t)return t;var n=ji(e.split(z.Delimiter),1)[0],r=this.types[n];return r?r.operations.getTypes(e):null},e.prototype.getOperationReturnType=function(e,t,n,r){var o=this.getOperation(e),i=this.getOperationTypes(e);if(!o||!i)return null;var s=i.returnType;if(s instanceof B)return s;if(!U(s))return s.baseType.newInstance();var a=o.resultDependency.length>0?this.getOperationParamTypes(e,t,n,r,i.rawTypes):{};return this.getOperationInputType(i.returnType,a)},e.prototype.getOperationExpectedTypes=function(e,t,n,r,o){var i=this;void 0===o&&(o=!1);var s=this.getOperationTypes(e);if(!s)return{};var a=this.getOperationParamTypes(e,t,n,r,o);return x(a,function(e,t){return i.getOperationInputType(s.params[t]||s.optional[t]||e,a)})},e.prototype.getOperationParamTypes=function(e,t,n,r,o){var i,s,a,u,p,c;void 0===o&&(o=!1);var l={},f=this.getOperation(e),y=this.getOperationTypes(e);if(!f||!y)return l;for(var d in t){if(-1===f.hasScope.indexOf(d))(O=t[d].getType(this,r))&&(l[d]=o?O:O.getSimplifiedType())}var h=this.getContextWithScope(r),v=h.context,m=h.scope;try{for(var g=ki(f.scope),T=g.next();!T.done;T=g.next()){var b=T.value,x=this.getOperationInputType(y.scope[b],l);if(x)m[n[b]||b]=o?x:x.getSimplifiedType()}}catch(e){i={error:e}}finally{try{T&&!T.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}for(var d in t){var O;if(-1!==f.hasScope.indexOf(d))(O=t[d].getType(this,v))&&(l[d]=o?O:O.getSimplifiedType())}try{for(var E=ki(f.params),S=E.next();!S.done;S=E.next()){l[d=S.value]||(l[d]=this.getOperationInputType(y.params[d],l))}}catch(e){a={error:e}}finally{try{S&&!S.done&&(u=E.return)&&u.call(E)}finally{if(a)throw a.error}}try{for(var w=ki(f.optional),P=w.next();!P.done;P=w.next()){l[d=P.value]||(l[d]=this.getOperationInputType(y.optional[d],l))}}catch(e){p={error:e}}finally{try{P&&!P.done&&(c=w.return)&&c.call(w)}finally{if(p)throw p.error}}return l},e.prototype.getOperationScopeContext=function(e,t,n,r){var o,i,s=this.getOperation(e),a=this.getOperationTypes(e),u=this.getContextWithScope(r),p=u.context,c=u.scope;try{for(var l=ki(s.scope),f=l.next();!f.done;f=l.next()){var y=f.value,d=this.getOperationInputType(a.scope[y],t);if(d)c[n[y]||y]=d.getSimplifiedType()}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return p},e.prototype.getContextWithScope=function(e,t){return void 0===t&&(t={}),{context:e instanceof vn?new vn({props:t=Di({},e.options.props,t)}):new Eo([new vn({props:t}),e]),scope:t}},e.prototype.getContext=function(e,t){return this.getContextWithScope(e,t).context},e.prototype.getOperationMapping=function(e,t,n){var r,o,i,s,a=this,u=this.getOperation(e),p=this.getOperationTypes(n),c=u.params.concat(u.optional),l=this.getOperation(n),f=this.getOperationTypes(n),y=Object.create(null),d=Object.create(null),h=E(t,function(e,t){return[t,e,c.indexOf(t)]}).filter(function(e){return ji(e,3)[2]>=0}).sort(function(e,t){return ji(e,3)[2]-ji(t,3)[2]}),v=function(e,t){if(0===h.length)return null;var n=-1;if(U(t))-1===(n=h.findIndex(function(n){var r,o=ji(n,2)[1];return o.acceptsType(di.parse(t(Di({},d,((r={})[e]=o,r)),a)))}))&&(n=h.findIndex(function(n){var r,o=ji(n,2)[1];return di.parse(t(Di({},d,(r={},r[e]=o,r)),a)).acceptsType(o)}));else{var r=di.parse(t);n=h.findIndex(function(e){var t=ji(e,2)[1];return r.acceptsType(t)})}if(-1===n)return null;var o=h[n];h.splice(n,1),y[o[0]]=e,d[e]=o[1]};try{for(var m=ki(l.params),g=m.next();!g.done;g=m.next()){var T=g.value;if(null===v(T,f.params[T]))return null}}catch(e){r={error:e}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var b=ki(l.optional),x=b.next();!x.done;x=b.next()){var O=x.value;v(O,f.optional[O])}}catch(e){i={error:e}}finally{try{x&&!x.done&&(s=b.return)&&s.call(b)}finally{if(i)throw i.error}}var S=h.map(function(e){return ji(e,1)[0]});return{from:u,fromTypes:p,to:l,toTypes:f,mapping:y,unmapped:S}},e.prototype.getOperationInputType=function(e,t){return e instanceof B?e:"baseType"in e?e.baseType.clone():t?di.parse(e(t,this)):null},e.prototype.getOperationsForExpression=function(e,t){var n=e.getType(this,t);return n?this.getOperationsForType(n.getSimplifiedType()):[]},e.prototype.getOperationsWithMapping=function(e,t){var n=this;return this.getOperations().map(function(r){var o=r.op;return n.getOperationMapping(e,t,o.id)}).filter(function(e){return!!e})},e.prototype.getOperationsForType=function(e,t){var n=this;return void 0===t&&(t=!1),this.getOperations(function(r){var o,i=r.op,s=r.types,a=i.params[0],u=s.params[a];if(u){var p=n.getOperationInputType(u,((o={})[a]=e,o));if(p){if(e.acceptsType(p))return!0;if(t&&i.resultDependency.length>0&&U(s.returnType)&&(p instanceof me||p instanceof fe))return!0}}return!1})},e.prototype.getOperationsWithReturnExpression=function(e,t,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var o=e.getType(this,t);return o?this.getOperationsWithReturnType(o.getSimplifiedType(),n,r):[]},e.prototype.getOperationsWithReturnType=function(e,t,n){var r=this;return void 0===t&&(t={}),void 0===n&&(n=!1),this.getOperations(function(o){var i=o.op,s=o.types,a=r.getOperationInputType(s.returnType,t);if(a){if(e.acceptsType(a))return!0;if(n&&i.resultDependency.length>0&&U(s.returnType)&&(a instanceof me||a instanceof fe))return!0}return!1})},e.prototype.getOperationsForParamExpressions=function(e,t){var n=this;return this.getOperationsForParamTypes(x(e,function(e){var r=e.getType(n,t);return r?r.getSimplifiedType():void 0}))},e.prototype.getOperationsForParamTypes=function(e){var t=this,n=Object.keys(e);return this.getOperations(function(r){var o,i,s=r.types;try{for(var a=ki(n),u=a.next();!u.done;u=a.next()){var p=u.value,c=s.params[p]||s.optional[p];if(!c)return!1;var l=t.getOperationInputType(c,e);if(!l||!e[p].acceptsType(l))return!1}}catch(e){o={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(o)throw o.error}}return!0})},e.prototype.getOperations=function(e){void 0===e&&(e=function(){return!0});var t=[],n=function(n){var r=n.map;for(var o in r){var i={op:r[o],types:n.types[o]};e(i)&&t.push(i)}};return n(this.operations),O(this.types,function(e){return n(e.operations)}),t},e.prototype.getPathType=function(e,t,n){void 0===n&&(n=e.length);for(var r=!1,o=t,i=0;i<n;i++){if(!(o=o.getSubType(e[i],this,t)))return null;r=r||o.isOptional()}return r&&!o.isOptional()?di.optional(o):o},e.prototype.addExpression=function(e){this.expressions[e.id]=e},e.prototype.getExpression=function(e){if(e instanceof W)return e;if(a(e)){var t=this.expressions[e[0]];if(!t)throw new Error("An expression was not found for: "+JSON.stringify(e));return t.decode(e,this)}return new ze(e)},e.prototype.getEntityReferences=function(e){var t=this.getTypeClassReferences(Ci).filter(function(t){return!e||e===t.value.options}),n=this.getExpressionClassReferences(ot).filter(function(t){return!e||e===t.value.name});return t.concat(n)},e.prototype.getEntityDataReferences=function(e){return this.getDataTypeClassReferences(Ci).filter(function(t){return!e||e===t.type.options})},e.prototype.getRelationReferences=function(e){return this.getExpressionClassReferences(st).filter(function(t){return!e||e===t.value.name})},e.prototype.getFunctionReferences=function(e,t){return this.getExpressionClassReferences(lt).filter(function(n){return(!e||e===n.value.name)&&(!t||t in n.value.args)})},e.prototype.getTypeClassReferences=function(e){var t=[];return this.getTypeInstances().forEach(function(n){n.type.traverse(new Y(function(r){r instanceof e&&t.push({value:r,root:n.type,source:n.source})}))}),t},e.prototype.getDataTypeClassReferences=function(e){var t=[];return this.getDataInstances().forEach(function(n){n.type.traverse(new Y(function(r){r instanceof e&&t.push({type:r,data:n.data,root:n.type,source:n.source})}))}),t},e.prototype.getExpressionClassReferences=function(e){var t=[];return this.getExpressionInstances().forEach(function(n){n.expr.traverse(new Y(function(r){r instanceof e&&t.push({value:r,root:n.expr,source:n.source})}))}),t},e.prototype.getDataInstances=function(){var e=this,t=[];return O(this.programs,function(e){e.datasets.forEach(function(n){t.push({data:n.data,type:e.dataType,source:[e,n]})})}),O(this.functions,function(n){var r=n.getReturnType(e);n.tests.forEach(function(e){t.push({data:e.args,type:n.params,source:[n,e,"args"]}),t.push({data:e.expected,type:r,source:[n,e,"expected"]})})}),O(this.entities,function(n){n.instances&&n.instances.length>0&&t.push({data:n.instances,type:di.list(n.type),source:n}),O(n.methods,function(r){var o=r.getReturnType(e);r.tests.forEach(function(e){t.push({data:e.args,type:r.params,source:[n,r,e,"args"]}),t.push({data:e.expected,type:o,source:[n,r,e,"expected"]})})})}),t},e.prototype.getTypeInstances=function(e){var t=this;void 0===e&&(e=!1);var n=[];return O(this.programs,function(e){n.push({type:e.dataType,source:e})}),O(this.functions,function(r){n.push({type:r.params,source:[r,"params"]}),e&&n.push({type:r.getReturnType(t),source:[r,"returnType"]})}),O(this.entities,function(r){n.push({type:r.type,source:r}),O(r.methods,function(o){n.push({type:o.params,source:[r,o,"params"]}),e&&n.push({type:o.getReturnType(t),source:[r,o,"returnType"]})}),e&&(r.key!==de.instance&&n.push({type:r.getKeyContext(),source:[r,"key"]}),r.describe!==de.instance&&n.push({type:r.getDescribeContext(),source:[r,"describe"]})),O(r.transcoders,function(e,t){n.push({type:e.encodedType,source:[r,t,e]})})}),e&&O(this.relations,function(e){e.morphs&&n.push({type:e.morphs[1],source:e})}),n},e.prototype.getExpressionInstances=function(){var e=[];return O(this.programs,function(t){e.push({context:t.dataType,expr:t.expression,source:t})}),O(this.functions,function(t){e.push({context:t.params,expr:t.expression,source:t})}),O(this.entities,function(t){O(t.methods,function(n){e.push({context:n.getParamTypes(),expr:n.expression,source:[t,n]})}),t.canStore()&&(e.push({context:t.getKeyContext(),expr:t.key,source:[t,"key"]}),e.push({context:t.getDescribeContext(),expr:t.describe,source:[t,"describe"]}),O(t.transcoders,function(n,r){e.push({context:t.getEncodeContext(r),expr:n.encode,source:[t,r,n,"encode"]}),e.push({context:t.getDecodeContext(r),expr:n.decode,source:[t,r,n,"decode"]})}))}),e},e.prototype.export=function(){return{entities:x(this.entities,function(e){return e.encode()}),functions:x(this.functions,function(e){return e.encode()}),relations:x(this.relations,function(e){return e.encode()}),programs:x(this.programs,function(e){return e.encode()})}},e.prototype.import=function(e){var t=this;e.entities&&O(e.entities,function(e){return t.addEntity(e)}),e.functions&&O(e.functions,function(e){return t.addFunction(e)}),e.programs&&O(e.programs,function(e){return t.addProgram(e)}),e.relations&&O(e.relations,function(e){return t.addRelation(e)})},e}(),Li=function(){function e(t){this.defs=t,this.ops=Object.create(null),this.exprs=Object.create(null),this.returnProperty=e.DEFAULT_RETURN_PROPERTY}return e.prototype.extend=function(t){var n=new e(t||this.defs);return Object.assign(n.ops,this.ops),Object.assign(n.exprs,this.exprs),n.returnProperty=this.returnProperty,n},e.prototype.setOperation=function(e,t){return this.ops[e.id]=t,this},e.prototype.setExpression=function(e,t){return this.exprs[e.id]=t,this},e.prototype.getFunction=function(e){return this.defs.getFunction(e)},e.prototype.getOperation=function(e){return this.ops[e]},e.prototype.getComputed=function(e){return this.defs.getComputed(e)},e.prototype.getOperationScopeDefaults=function(e){var t=this.defs.getOperation(e);return t?t.scopeDefaults:{}},e.prototype.getExpression=function(e){return this.exprs[e]},e.prototype.getCommand=function(e,t){return void 0===t&&(t=this),this.exprs[e.getId()](e,t)},e.prototype.run=function(e,t,n){return void 0===n&&(n=this),this.eval(e,n)(t)},e.prototype.eval=function(e,t){return void 0===t&&(t=this),a(e)?this.getCommand(this.defs.getExpression(e),t):function(){return e}},e.DEFAULT_RETURN_PROPERTY="$$return",e}(),Ri=new Ai({types:[Ci,me,te,ti,go,Je,tn,Eo,_o,ko,fe,xn,vn,Io,fi,Ve,sn],expressions:[ie,_e,Ie,De,ze,be,Se,Ze,nt,ot,st,pt,lt,de,re,gn,vt,yt,gt,xt,St,_t,It,un,jt,Rt]}),qi=Ci.operations,Vi=function(e,t){return e.name instanceof Ci?e.name:vn.baseType},Fi=function(e,t){return e.name instanceof Ci?e.name:di.many(E(t.getEntities()))},Yi=function(e,t){if(!(e.name instanceof Ci))return null;var n=t.getRelations(e.name.options);if(e.relation instanceof Je){var r=e.relation.options.constants.get("relation");if(r){var o=n.find(function(e){return e.name===r});if(o)return o}}return n},Bi=function(e,t){var n=Yi(e,t);return null===n?fe.baseType:a(n)?di.many(n.map(function(e){return di.enum(Ve,Ve,[["relation",e.name]])})):e.relation},Gi=function(e,t){var n=Yi(e,t);return null===n||a(n)?fe.baseType:e.related&&n.relationType.acceptsType(e.related)?e.related:n.relationType},Wi=function(e,t){var n=Yi(e,t);return null===n||a(n)?fe.baseType:e.related&&n.itemType.acceptsType(e.related)?e.related:n.itemType},Ui={newInstance:qi.setTypes(Mi.newInstance,Vi,{name:Fi}),getKey:qi.setTypes(Mi.getKey,function(e,t){if(!(e.name instanceof Ci))return me;var n=t.getEntity(e.name.options);return n&&n.key?n.keyType:me},{name:Fi,instance:Vi}),save:qi.setTypes(Mi.save,te,{name:Fi,instance:Vi}),remove:qi.setTypes(Mi.remove,te,{name:Fi,instance:Vi}),setRelated:qi.setTypes(Mi.setRelated,xn,{name:Fi,instance:Vi,relation:Bi,related:Gi}),addRelated:qi.setTypes(Mi.addRelated,xn,{name:Fi,instance:Vi,relation:Bi,related:Wi}),removeRelated:qi.setTypes(Mi.removeRelated,xn,{name:Fi,instance:Vi,relation:Bi,related:Wi}),clearRelated:qi.setTypes(Mi.clearRelated,xn,{name:Fi,instance:Vi,relation:Bi}),getRelated:qi.setTypes(Mi.getRelated,function(e,t){return Gi(e,t)},{name:Fi,instance:Vi,relation:Bi}),isRelated:qi.setTypes(Mi.isRelated,xn,{name:Fi,instance:Vi,relation:Bi,related:Wi})};Ui.newInstance.rawTypes=!0,Ui.getKey.rawTypes=!0,Ui.save.rawTypes=!0,Ui.remove.rawTypes=!0,Ui.setRelated.rawTypes=!0,Ui.addRelated.rawTypes=!0,Ui.removeRelated.rawTypes=!0,Ui.clearRelated.rawTypes=!0,Ui.getRelated.rawTypes=!0,Ui.isRelated.rawTypes=!0;var Hi=me.operations,Ji={cmp:Hi.setTypes(ce.cmp,xn,{value:me,test:me}),copy:Hi.setTypes(ce.copy,me,{value:me}),isDefined:Hi.setTypes(ce.isDefined,te,{value:me}),getDefined:Hi.setTypes(ce.getDefined,te,{value:me,defined:me},{},{defined:function(e){return e.value instanceof Io?e.value.options:e.value}}),coalesce:Hi.setTypes(ce.coalesce,function(e){var t=!0,n=[],r=function(e){if(t&&e){var r=e instanceof Io,o=r?e.options:e;o instanceof Eo&&o.options.forEach(function(e){var t=e instanceof Io,o=t?e.options:e;r=r||t,n.some(function(e){return e.exactType(o)})||n.push(o)}),t=t&&r,n.some(function(e){return e.exactType(o)})||n.push(o)}};return r(e.a),r(e.b),r(e.c),r(e.d),r(e.e),n.length>1?t?di.optional(new Eo(n)):new Eo(n):1===n.length?t?di.optional(n[0]):n[0]:fe},{a:me,b:me},{c:me,d:me,e:me}),require:Hi.setTypes(ce.require,function(e){return e.value instanceof Io?e.value.options:e.value||me},{value:function(e){return e.value||me}}),ternary:Hi.setTypes(ce.ternary,function(e){return e.truthy&&e.falsy?di.mergeMany([e.truthy,e.falsy]):e.truthy?e.truthy:e.falsy?e.falsy:me},{condition:te,truthy:function(e){return e.truthy||me},falsy:function(e){return e.falsy||me}}),isValid:Hi.setTypes(ce.isValid,te,{value:me}),isEqual:Hi.setTypes(ce.isEqual,te,{value:me,test:me}),isNotEqual:Hi.setTypes(ce.isNotEqual,te,{value:me,test:me}),isLess:Hi.setTypes(ce.isLess,te,{value:me,test:me}),isLessOrEqual:Hi.setTypes(ce.isLessOrEqual,te,{value:me,test:me}),isGreater:Hi.setTypes(ce.isGreater,te,{value:me,test:me}),isGreaterOrEqual:Hi.setTypes(ce.isGreaterOrEqual,te,{value:me,test:me}),asAny:Hi.setTypes(ce.asAny,function(e){return e.value||me},{value:me}),asBoolean:Hi.setTypes(ce.asBoolean,te,{value:me}),asColor:Hi.setTypes(ce.asColor,ti,{value:me}),asDate:Hi.setTypes(ce.asDate,go,{value:me}),asList:Hi.setTypes(ce.asList,function(e){return tn.forItem(e.value||me)},{value:me}),asMap:Hi.setTypes(ce.asMap,function(e){return _o.forItem(e.value||me)},{value:me}),asNumber:Hi.setTypes(ce.asNumber,xn,{value:me}),asObject:Hi.setTypes(ce.asObject,vn,{value:me}),asText:Hi.setTypes(ce.asText,Ve,{value:me}),asTuple:Hi.setTypes(ce.asTuple,function(e){return sn.forItem([e.value||me])},{value:me}),asSet:Hi.setTypes(ce.asSet,function(e){return fi.forItem(e.value||me)},{value:me})},Ki=te.operations,zi={create:Ki.setTypes(Z.create,te),maybe:Ki.setTypes(Z.maybe,function(e){return di.maybe(e.value,te)},{value:me}),and:Ki.setTypes(Z.and,te,{a:te,b:te}),or:Ki.setTypes(Z.or,te,{a:te,b:te}),xor:Ki.setTypes(Z.xor,te,{a:te,b:te}),not:Ki.setTypes(Z.not,te,{a:te}),cmp:Ki.setTypes(Z.cmp,xn,{value:te,test:te}),isValid:Ki.setTypes(Z.isValid,te,{value:me}),isTrue:Ki.setTypes(Z.isTrue,te,{value:te}),isFalse:Ki.setTypes(Z.isFalse,te,{value:te}),isEqual:Ki.setTypes(Z.isEqual,te,{value:te,test:te}),isNotEqual:Ki.setTypes(Z.isNotEqual,te,{value:te,test:te}),asAny:Ki.setTypes(Z.asAny,me,{value:te}),asBoolean:Ki.setTypes(Z.asBoolean,function(e){return e.value||te},{value:te}),asColor:Ki.setTypes(Z.asColor,ti,{value:te}),asDate:Ki.setTypes(Z.asDate,go,{value:te}),asList:Ki.setTypes(Z.asList,function(e){return tn.forItem(e.value||te)},{value:te}),asMap:Ki.setTypes(Z.asMap,function(e){return _o.forItem(e.value||te)},{value:te}),asNumber:Ki.setTypes(Z.asNumber,xn,{value:te}),asObject:Ki.setTypes(Z.asObject,vn,{value:te}),asText:Ki.setTypes(Z.asText,Ve,{value:te}),asTuple:Ki.setTypes(Z.asTuple,function(e){return sn.forItem([e.value||te])},{value:te}),asSet:Ki.setTypes(Z.asSet,function(e){return fi.forItem(e.value||me)},{value:te})},Xi=ti.operations,$i=new Je({key:Ve.baseType,value:Ve.baseType,constants:new Map([["r","r"],["g","g"],["b","b"],["a","a"]])}),Qi=new Eo([ti.baseType,new xn({})]),Zi=new Je({key:Ve.baseType,value:Ve.baseType,constants:new Map([["Best Fit: #rrggbb or rgb()","rgb:bestfit"],["#rgb","rgb:hexShort"],["#rrggbb","rgb:hex"],["#rrggbbaa","rgb:hexLong"],["rgb(r, g, b)","rgb:rgb"],["rgba(r, g, b, a)","rgb:rgba"],["hsl(h, s, l)","hsl:hsl"],["hsla(h, s, l, a)","hsl:hsla"]])}),es=new Je({key:Ve.baseType,value:ti.baseType,constants:new Map([["Transparent",{r:255,g:255,b:255,a:0}],["Alice Blue",{r:240,g:248,b:255,a:255}],["Antique White",{r:250,g:235,b:215,a:255}],["Aqua",{r:0,g:255,b:255,a:255}],["Aquamarine",{r:127,g:255,b:212,a:255}],["Azure",{r:240,g:255,b:255,a:255}],["Beige",{r:245,g:245,b:220,a:255}],["Bisque",{r:255,g:228,b:196,a:255}],["Black",{r:0,g:0,b:0,a:255}],["Blanched Almond",{r:255,g:235,b:205,a:255}],["Blue",{r:0,g:0,b:255,a:255}],["Blue Violet",{r:138,g:43,b:226,a:255}],["Brown",{r:165,g:42,b:42,a:255}],["Burly Wood",{r:222,g:184,b:135,a:255}],["Cadet Blue",{r:95,g:158,b:160,a:255}],["Chartreuse",{r:127,g:255,b:0,a:255}],["Chocolate",{r:210,g:105,b:30,a:255}],["Coral",{r:255,g:127,b:80,a:255}],["Cornflower Blue",{r:100,g:149,b:237,a:255}],["Cornsilk",{r:255,g:248,b:220,a:255}],["Crimson",{r:220,g:20,b:60,a:255}],["Cyan",{r:0,g:255,b:255,a:255}],["Dark Blue",{r:0,g:0,b:139,a:255}],["Dark Cyan",{r:0,g:139,b:139,a:255}],["Dark Goldenrod",{r:184,g:134,b:11,a:255}],["Dark Gray",{r:169,g:169,b:169,a:255}],["Dark Green",{r:0,g:100,b:0,a:255}],["Dark Khaki",{r:189,g:183,b:107,a:255}],["Dark Magenta",{r:139,g:0,b:139,a:255}],["Dark Olive Green",{r:85,g:107,b:47,a:255}],["Dark Orange",{r:255,g:140,b:0,a:255}],["Dark Orchid",{r:153,g:50,b:204,a:255}],["Dark Red",{r:139,g:0,b:0,a:255}],["Dark Salmon",{r:233,g:150,b:122,a:255}],["Dark Sea Green",{r:143,g:188,b:139,a:255}],["Dark Slate Blue",{r:72,g:61,b:139,a:255}],["Dark Slate Gray",{r:47,g:79,b:79,a:255}],["Dark Turquoise",{r:0,g:206,b:209,a:255}],["Dark Violet",{r:148,g:0,b:211,a:255}],["Deep Pink",{r:255,g:20,b:147,a:255}],["Deep Sky Blue",{r:0,g:191,b:255,a:255}],["Dim Gray",{r:105,g:105,b:105,a:255}],["Dodger Blue",{r:30,g:144,b:255,a:255}],["Firebrick",{r:178,g:34,b:34,a:255}],["Floral White",{r:255,g:250,b:240,a:255}],["Forest Green",{r:34,g:139,b:34,a:255}],["Fuchsia",{r:255,g:0,b:255,a:255}],["Gainsboro",{r:220,g:220,b:220,a:255}],["Ghost White",{r:248,g:248,b:255,a:255}],["Gold",{r:255,g:215,b:0,a:255}],["Goldenrod",{r:218,g:165,b:32,a:255}],["Gray",{r:128,g:128,b:128,a:255}],["Green",{r:0,g:128,b:0,a:255}],["Green Yellow",{r:173,g:255,b:47,a:255}],["Honeydew",{r:240,g:255,b:240,a:255}],["Hot Pink",{r:255,g:105,b:180,a:255}],["Indian Red",{r:205,g:92,b:92,a:255}],["Indigo",{r:75,g:0,b:130,a:255}],["Ivory",{r:255,g:255,b:240,a:255}],["Khaki",{r:240,g:230,b:140,a:255}],["Lavender",{r:230,g:230,b:250,a:255}],["Lavender Blush",{r:255,g:240,b:245,a:255}],["Lawn Green",{r:124,g:252,b:0,a:255}],["Lemon Chiffon",{r:255,g:250,b:205,a:255}],["Light Blue",{r:173,g:216,b:230,a:255}],["Light Coral",{r:240,g:128,b:128,a:255}],["Light Cyan",{r:224,g:255,b:255,a:255}],["Light Goldenrod Yellow",{r:250,g:250,b:210,a:255}],["Light Gray",{r:211,g:211,b:211,a:255}],["Light Green",{r:144,g:238,b:144,a:255}],["Light Pink",{r:255,g:182,b:193,a:255}],["Light Salmon",{r:255,g:160,b:122,a:255}],["Light Sea Green",{r:32,g:178,b:170,a:255}],["Light Sky Blue",{r:135,g:206,b:250,a:255}],["Light Slate Gray",{r:119,g:136,b:153,a:255}],["Light Steel Blue",{r:176,g:196,b:222,a:255}],["Light Yellow",{r:255,g:255,b:224,a:255}],["Lime",{r:0,g:255,b:0,a:255}],["LimeGreen",{r:50,g:205,b:50,a:255}],["Linen",{r:250,g:240,b:230,a:255}],["Magenta",{r:255,g:0,b:255,a:255}],["Maroon",{r:128,g:0,b:0,a:255}],["Medium Aquamarine",{r:102,g:205,b:170,a:255}],["Medium Blue",{r:0,g:0,b:205,a:255}],["Medium Orchid",{r:186,g:85,b:211,a:255}],["Medium Purple",{r:147,g:112,b:219,a:255}],["Medium Sea Green",{r:60,g:179,b:113,a:255}],["Medium Slate Blue",{r:123,g:104,b:238,a:255}],["Medium Spring Green",{r:0,g:250,b:154,a:255}],["Medium Turquoise",{r:72,g:209,b:204,a:255}],["Medium VioletRed",{r:199,g:21,b:133,a:255}],["Midnight Blue",{r:25,g:25,b:112,a:255}],["Mint Cream",{r:245,g:255,b:250,a:255}],["Misty Rose",{r:255,g:228,b:225,a:255}],["Moccasin",{r:255,g:228,b:181,a:255}],["Navajo White",{r:255,g:222,b:173,a:255}],["Navy",{r:0,g:0,b:128,a:255}],["Old Lace",{r:253,g:245,b:230,a:255}],["Olive",{r:128,g:128,b:0,a:255}],["Olive Drab",{r:107,g:142,b:35,a:255}],["Orange",{r:255,g:165,b:0,a:255}],["Orange Red",{r:255,g:69,b:0,a:255}],["Orchid",{r:218,g:112,b:214,a:255}],["Pale Goldenrod",{r:238,g:232,b:170,a:255}],["Pale Green",{r:152,g:251,b:152,a:255}],["Pale Turquoise",{r:175,g:238,b:238,a:255}],["Pale Violet Red",{r:219,g:112,b:147,a:255}],["Papaya Whip",{r:255,g:239,b:213,a:255}],["Peach Puff",{r:255,g:218,b:185,a:255}],["Peru",{r:205,g:133,b:63,a:255}],["Pink",{r:255,g:192,b:203,a:255}],["Plum",{r:221,g:160,b:221,a:255}],["Powder Blue",{r:176,g:224,b:230,a:255}],["Purple",{r:128,g:0,b:128,a:255}],["Red",{r:255,g:0,b:0,a:255}],["Rosy Brown",{r:188,g:143,b:143,a:255}],["Royal Blue",{r:65,g:105,b:225,a:255}],["Saddle Brown",{r:139,g:69,b:19,a:255}],["Salmon",{r:250,g:128,b:114,a:255}],["Sandy Brown",{r:244,g:164,b:96,a:255}],["Sea Green",{r:46,g:139,b:87,a:255}],["Sea Shell",{r:255,g:245,b:238,a:255}],["Sienna",{r:160,g:82,b:45,a:255}],["Silver",{r:192,g:192,b:192,a:255}],["Sky Blue",{r:135,g:206,b:235,a:255}],["Slate Blue",{r:106,g:90,b:205,a:255}],["Slate Gray",{r:112,g:128,b:144,a:255}],["Snow",{r:255,g:250,b:250,a:255}],["Spring Green",{r:0,g:255,b:127,a:255}],["Steel Blue",{r:70,g:130,b:180,a:255}],["Tan",{r:210,g:180,b:140,a:255}],["Teal",{r:0,g:128,b:128,a:255}],["Thistle",{r:216,g:191,b:216,a:255}],["Tomato",{r:255,g:99,b:71,a:255}],["Turquoise",{r:64,g:224,b:208,a:255}],["Violet",{r:238,g:130,b:238,a:255}],["Wheat",{r:245,g:222,b:179,a:255}],["White",{r:255,g:255,b:255,a:255}],["White Smoke",{r:245,g:245,b:245,a:255}],["Yellow",{r:255,g:255,b:0,a:255}],["Yellow Green",{r:154,g:205,b:50,a:255}]])}),ts=new Je({key:Ve.baseType,value:Ve.baseType,constants:new Map([["Multiply","multiply"],["Screen","screen"],["Overlay","overlay"],["Hard Light","hard"],["Soft Light","soft"],["Dodge","dodge"],["Burn","burn"],["Divide","divide"],["Addition","add"],["Subtract","sub"],["Difference","diff"],["Darken Only","darken"],["Lighten Only","lighten"]])}),ns={create:Xi.setTypes(Lo.create,ti),maybe:Xi.setTypes(Lo.maybe,function(e){return di.maybe(e.value,ti)},{value:me}),cmp:Xi.setTypes(Lo.cmp,xn,{value:ti,test:ti}),copy:Xi.setTypes(Lo.copy,ti,{value:ti}),build:Xi.setTypes(Lo.build,ti,{r:xn,g:xn,b:xn},{a:xn}),map:Xi.setTypes(Lo.map,ti,{value:ti,r:xn,g:xn,b:xn},{a:xn},{value:xn,component:$i}),op:Xi.setTypes(Lo.op,ti,{value:ti,test:ti,r:xn,g:xn,b:xn},{a:xn},{value:xn,test:xn,component:$i}),clamp:Xi.setTypes(Lo.clamp,ti,{value:ti}),add:Xi.setTypes(Lo.add,ti,{value:ti,addend:Qi},{alpha:te}),adds:Xi.setTypes(Lo.adds,ti,{value:ti,addend:Qi,addendScale:Qi},{alpha:te}),sub:Xi.setTypes(Lo.sub,ti,{value:ti,subtrahend:Qi},{alpha:te}),mul:Xi.setTypes(Lo.mul,ti,{value:ti,multiplier:Qi},{alpha:te}),div:Xi.setTypes(Lo.div,ti,{value:ti,divisor:Qi},{alpha:te}),mod:Xi.setTypes(Lo.mod,ti,{value:ti,divisor:Qi},{alpha:te}),format:Xi.setTypes(Lo.format,Ve,{value:ti,format:Zi}),parse:Xi.setTypes(Lo.parse,di.optional(ti),{value:me}),lerp:Xi.setTypes(Lo.lerp,ti,{start:ti,end:ti,delta:xn}),lighten:Xi.setTypes(Lo.lighten,ti,{value:ti,amount:xn}),darken:Xi.setTypes(Lo.darken,ti,{value:ti,amount:xn}),toHSL:Xi.setTypes(Lo.toHSL,Ko.type,{value:ti}),fromHSL:Xi.setTypes(Lo.fromHSL,ti,{value:Ko.type}),luminance:Xi.setTypes(Lo.luminance,xn,{value:ti}),contrast:Xi.setTypes(Lo.contrast,xn,{value:ti,test:ti}),invert:Xi.setTypes(Lo.invert,ti,{value:ti},{alpha:te}),opaque:Xi.setTypes(Lo.opaque,ti,{value:ti}),alpha:Xi.setTypes(Lo.alpha,ti,{value:ti,alpha:xn}),distance:Xi.setTypes(Lo.distance,xn,{value:ti,test:ti}),named:Xi.setTypes(Lo.named,ti,{name:es}),getName:Xi.setTypes(Lo.getName,Ve,{value:ti}),blend:Xi.setTypes(Lo.blend,ti,{top:ti,bottom:ti,mode:ts}),isValid:Xi.setTypes(Lo.isValid,te,{value:me}),isEqual:Xi.setTypes(Lo.isEqual,te,{value:ti,test:ti},{epsilon:xn}),isNotEqual:Xi.setTypes(Lo.isNotEqual,te,{value:ti,test:ti},{epsilon:xn}),isLess:Xi.setTypes(Lo.isLess,te,{value:ti,test:ti}),isLessOrEqual:Xi.setTypes(Lo.isLessOrEqual,te,{value:ti,test:ti}),isGreater:Xi.setTypes(Lo.isGreater,te,{value:ti,test:ti}),isGreaterOrEqual:Xi.setTypes(Lo.isGreaterOrEqual,te,{value:ti,test:ti}),asAny:Xi.setTypes(Lo.asAny,me,{value:ti}),asBoolean:Xi.setTypes(Lo.asBoolean,te,{value:ti}),asColor:Xi.setTypes(Lo.asColor,ti,{value:ti}),asDate:Xi.setTypes(Lo.asDate,go,{value:ti}),asList:Xi.setTypes(Lo.asList,function(e){return tn.forItem(e.value||ti)},{value:ti}),asMap:Xi.setTypes(Lo.asMap,function(e){return _o.forItem(e.value||ti)},{value:ti}),asNumber:Xi.setTypes(Lo.asNumber,xn,{value:ti}),asObject:Xi.setTypes(Lo.asObject,function(e){return e.value||ti},{value:ti}),asText:Xi.setTypes(Lo.asText,Ve,{value:ti}),asTuple:Xi.setTypes(Lo.asTuple,function(e){return sn.forItem([e.value||ti])},{value:ti}),asSet:Xi.setTypes(Lo.asSet,function(e){return fi.forItem(e.value||me)},{value:ti})},rs=go.operations,os=new Je({key:Ve.baseType.newInstance(),value:Ve.baseType.newInstance(),constants:new Map([["Timestamp","timestamp"],["Timestamp (seconds)","timestampSeconds"],["Millisecond","millis"],["Second","second"],["Minute","minute"],["Hour","hour"],["Day","day"],["Day of Month","dayOfMonth"],["Last Day of Month","lastDayOfMonth"],["Day of Year","dayOfYear"],["Day of Week","dayOfWeek"],["Week","week"],["Week of Month","weekOfMonth"],["Weekspan of Month","weekspanOfMonth"],["Full Week of Month","fullWeekOfMonth"],["Last Weekspan of Month","lastWeekspanOfMonth"],["Last Full Week of Month","lastFullWeekOfMonth"],["Week of Year","weekOfYear"],["Weekspan of Year","weekspanOfYear"],["Full Week of Year","fullWeekOfYear"],["Last Weekspan of Year","lastWeekspanOfYear"],["Last Full Week of Year","lastFullWeekOfYear"],["Month","month"],["Quarter","quarter"],["Year","year"],["Time Identifier","timeIdentifier"],["Day Identifier","dayIdentifier"],["Week Identifier","weekIdentifier"],["Month Identifier","monthIdentifier"],["Quarter Identifier","quarterIdentifier"]])}),is=new Je({key:Ve.baseType.newInstance(),value:Ve.baseType.newInstance(),constants:new Map([["Millisecond","millis"],["Second","second"],["Minute","minute"],["Hour","hour"],["Day","day"],["Week","week"],["Month","month"],["Quarter","quarter"],["Year","year"]])}),ss=new Je({key:Ve.baseType.newInstance(),value:Ve.baseType.newInstance(),constants:new Map([["None","none"],["Floor","floor"],["Ceil","ceil"],["Round","round"],["Truncate","truncate"],["Up","up"],["Down","down"]])}),as={create:rs.setTypes(ho.create,go),now:rs.setTypes(ho.now,go),today:rs.setTypes(ho.today,go),tomorrow:rs.setTypes(ho.tomorrow,go),yesterday:rs.setTypes(ho.yesterday,go),maybe:rs.setTypes(ho.maybe,function(e){return di.maybe(e.value,te)},{value:me}),parse:rs.setTypes(ho.parse,di.optional(go),{value:new Eo([go.baseType,xn.baseType,Ve.baseType])},{parseAsUTC:te}),fromText:rs.setTypes(ho.fromText,di.optional(go),{value:Ve},{parseAsUTC:te}),fromTimestamp:rs.setTypes(ho.fromTimestamp,go,{value:xn}),fromTimestampSeconds:rs.setTypes(ho.fromTimestampSeconds,go,{value:xn}),min:rs.setTypes(ho.min,go,{value:go,test:go}),max:rs.setTypes(ho.max,go,{value:go,test:go}),get:rs.setTypes(ho.get,xn,{value:go,property:os}),set:rs.setTypes(ho.set,go,{value:go,property:os,set:xn}),add:rs.setTypes(ho.add,go,{value:go,unit:is},{amount:xn}),sub:rs.setTypes(ho.sub,go,{value:go,unit:is},{amount:xn}),startOf:rs.setTypes(ho.startOf,go,{value:go,unit:is}),endOf:rs.setTypes(ho.endOf,go,{value:go,unit:is},{inclusive:te}),daysInMonth:rs.setTypes(ho.daysInMonth,xn,{value:go}),daysInYear:rs.setTypes(ho.daysInYear,xn,{value:go}),weeksInYear:rs.setTypes(ho.weeksInYear,xn,{value:go}),copy:rs.setTypes(ho.copy,go,{value:go}),cmp:rs.setTypes(ho.cmp,xn,{value:go,test:go},{unit:is}),diff:rs.setTypes(ho.diff,xn,{value:go,test:go},{unit:is,absolute:te,adjust:ss}),timezoneOffset:rs.setTypes(ho.timezoneOffset,xn,{value:go}),toText:rs.setTypes(ho.toText,Ve,{value:go,format:Ve}),toISOText:rs.setTypes(ho.toISOText,Ve,{value:go}),isValid:rs.setTypes(ho.isValid,te,{value:me}),isEqual:rs.setTypes(ho.isEqual,te,{value:go,test:go},{unit:is}),isBefore:rs.setTypes(ho.isBefore,te,{value:go,test:go},{unit:is}),isBeforeOrEqual:rs.setTypes(ho.isBeforeOrEqual,te,{value:go,test:go},{unit:is}),isAfter:rs.setTypes(ho.isAfter,te,{value:go,test:go},{unit:is}),isAfterOrEqual:rs.setTypes(ho.isAfterOrEqual,te,{value:go,test:go},{unit:is}),isBetween:rs.setTypes(ho.isBetween,te,{value:go,start:go,end:go},{unit:is,startInclusive:te,endInclusive:te}),isStartOf:rs.setTypes(ho.isStartOf,te,{value:go,unit:is}),isEndOf:rs.setTypes(ho.isEndOf,te,{value:go,unit:is},{inclusive:te}),isDST:rs.setTypes(ho.isDST,te,{value:go}),isLeapYear:rs.setTypes(ho.isLeapYear,te,{value:go}),asAny:rs.setTypes(ho.asAny,me,{value:go}),asBoolean:rs.setTypes(ho.asBoolean,te,{value:go}),asColor:rs.setTypes(ho.asColor,ti,{value:go}),asDate:rs.setTypes(ho.asDate,function(e){return e.value||go},{value:go}),asList:rs.setTypes(ho.asList,function(e){return tn.forItem(e.value||go)},{value:go}),asMap:rs.setTypes(ho.asMap,function(e){return _o.forItem(e.value||go)},{value:go}),asNumber:rs.setTypes(ho.asNumber,xn,{value:go}),asObject:rs.setTypes(ho.asObject,vn,{value:go}),asText:rs.setTypes(ho.asText,Ve,{value:go}),asTuple:rs.setTypes(ho.asTuple,function(e){return sn.forItem([e.value||go])},{value:go}),asSet:rs.setTypes(ho.asSet,function(e){return fi.forItem(e.value||me)},{value:go})},us=tn.operations,ps=function(e,t){return e instanceof tn?e:t},cs=function(e,t){return e instanceof tn?e.options.item:t},ls=function(e){return ps(e.list)||tn},fs=function(e){return ps(e.value)||tn},ys=function(e){return ps(e.list)?e.list.options.item:me},ds=function(e){return di.optional(ys(e))},hs=function(e){return ps(e.value)?e.value.options.item:me},vs=function(e){return e.reduce||e.initial||me},ms={list:ls,value:ys,test:ys},gs={list:fs,value:hs,test:hs},Ts={list:ls,item:ys,index:xn},bs={create:us.setTypes(zt.create,tn),createLike:us.setTypes(zt.createLike,ls,{list:ls}),createFor:us.setTypes(zt.createFor,function(e){return tn.forItem(e.item||me)},{item:function(e){return e.item||me}}),maybe:us.setTypes(zt.maybe,function(e){return di.maybe(e.value,tn)},{value:me}),build:us.setTypes(zt.build,function(e){return tn.forItem(e.item||me)},{count:xn,item:function(e){return e.item||me}},{sameItem:te},{list:function(e){return tn.forItem(e.item||me)},index:xn,last:function(e){return e.item||me},count:xn}),get:us.setTypes(zt.get,ds,{list:ls,index:xn}),set:us.setTypes(zt.set,ds,{list:ls,index:xn,value:ys}),add:us.setTypes(zt.add,ls,{list:ls,item:ys}),addFirst:us.setTypes(zt.addFirst,ls,{list:ls,item:ys}),addLast:us.setTypes(zt.addLast,ls,{list:ls,item:ys}),insert:us.setTypes(zt.insert,ls,{list:ls,item:ys,index:xn}),remove:us.setTypes(zt.remove,xn,{list:ls,item:ys,isEqual:te},{},ms),removeFirst:us.setTypes(zt.removeFirst,ds,{list:ls}),removeLast:us.setTypes(zt.removeLast,ds,{list:ls}),removeAt:us.setTypes(zt.removeAt,ds,{list:ls,index:xn}),removeWhere:us.setTypes(zt.removeWhere,ls,{list:ls,where:te},{},Ts),clear:us.setTypes(zt.clear,ls,{list:ls}),contains:us.setTypes(zt.contains,te,{list:ls,item:ys,isEqual:te},{},ms),find:us.setTypes(zt.find,ds,{list:ls,where:te},{reverse:te,start:xn},Ts),copy:us.setTypes(zt.copy,ls,{list:ls},{deepCopy:ys},{copy:ys}),reverse:us.setTypes(zt.reverse,ls,{list:ls}),exclude:us.setTypes(zt.exclude,ls,{list:ls,exclude:ls,isEqual:te},{},ms),overlap:us.setTypes(zt.overlap,ls,{list:ls,overlap:ls,isEqual:te},{},ms),sort:us.setTypes(zt.sort,ls,{list:ls,compare:xn},{},ms),shuffle:us.setTypes(zt.shuffle,ls,{list:ls},{times:xn}),unique:us.setTypes(zt.unique,ls,{list:ls,isEqual:te},{},ms),duplicates:us.setTypes(zt.duplicates,ls,{list:ls,isEqual:te},{once:te},ms),take:us.setTypes(zt.take,ls,{list:ls,count:xn}),skip:us.setTypes(zt.skip,ls,{list:ls,count:xn}),drop:us.setTypes(zt.drop,ls,{list:ls,count:xn}),append:us.setTypes(zt.append,ls,{list:ls,append:ls}),prepend:us.setTypes(zt.prepend,ls,{list:ls,prepend:ls}),indexOf:us.setTypes(zt.indexOf,xn,{list:ls,item:ys,isEqual:te},{start:xn},ms),lastIndexOf:us.setTypes(zt.lastIndexOf,xn,{list:ls,item:ys,isEqual:te},{start:xn},ms),findIndex:us.setTypes(zt.findIndex,xn,{list:ls,where:te},{reverse:te,start:xn},Ts),last:us.setTypes(zt.last,ds,{list:ls}),first:us.setTypes(zt.first,ds,{list:ls}),count:us.setTypes(zt.count,xn,{list:ls}),randomList:us.setTypes(zt.randomList,ls,{list:ls,count:xn}),random:us.setTypes(zt.random,ds,{list:ls}),join:us.setTypes(zt.join,Ve,{list:ls},{delimiter:Ve,toText:Ve,prefix:Ve,suffix:Ve},Ts),each:us.setTypes(zt.each,ls,{list:ls,each:me},{reverse:te},Ts),filter:us.setTypes(zt.filter,ls,{list:ls,filter:te},{},Ts),not:us.setTypes(zt.not,ls,{list:ls,not:te},{},Ts),map:us.setTypes(zt.map,function(e){return tn.forItem(e.transform||me)},{list:ls,transform:function(e){return e.transform||me}},{},Ts),split:us.setTypes(zt.split,function(e){return di.object({pass:ls(e),fail:ls(e)})},{list:ls,pass:te},{},Ts),reduce:us.setTypes(zt.reduce,vs,{list:ls,reduce:vs,initial:vs},{},{list:ls,item:ys,reduced:vs,index:xn}),cmp:us.setTypes(zt.cmp,te,{value:fs,test:fs,compare:xn},{},gs),group:us.setTypes(zt.group,function(e){return tn.forItem(di.object({by:e.by||me,group:tn.forItem(e.getValue||ys(e))}))},{list:ls,by:function(e){return e.by||me}},{getValue:function(e){return e.getValue||ys(e)}},Ts),toListMap:us.setTypes(zt.toListMap,function(e){return _o.forItem(tn.forItem(e.getValue||ys(e)),e.getKey||me)},{list:ls,getKey:function(e){return e.getKey||me}},{getValue:function(e){return e.getValue||ys(e)}},Ts),toMap:us.setTypes(zt.toMap,function(e){return _o.forItem(e.getValue||ys(e),e.getKey||me)},{list:ls,getKey:function(e){return e.getKey||me}},{getValue:function(e){return e.getValue||ys(e)}},Ts),joinInner:us.setTypes(zt.joinInner,function(e){return tn.forItem(e.join||me)},{a:function(e){return ps(e.a,tn)},b:function(e){return ps(e.b,tn)},on:te,join:me},{},{onA:function(e){return cs(e.a,me)},onB:function(e){return cs(e.b,me)},joinA:function(e){return cs(e.a,me)},joinB:function(e){return cs(e.b,me)}}),joinLeft:us.setTypes(zt.joinLeft,function(e){return tn.forItem(e.join||me)},{a:function(e){return ps(e.a,tn)},b:function(e){return ps(e.b,tn)},on:te,join:me},{},{onA:function(e){return cs(e.a,me)},onB:function(e){return cs(e.b,me)},joinA:function(e){return cs(e.a,me)},joinB:function(e){return di.optional(cs(e.b,me))}}),joinRight:us.setTypes(zt.joinRight,function(e){return tn.forItem(e.join||me)},{a:function(e){return ps(e.a,tn)},b:function(e){return ps(e.b,tn)},on:te,join:me},{},{onA:function(e){return cs(e.a,me)},onB:function(e){return cs(e.b,me)},joinA:function(e){return di.optional(cs(e.a,me))},joinB:function(e){return cs(e.b,me)}}),joinFull:us.setTypes(zt.joinFull,function(e){return tn.forItem(e.join||me)},{a:function(e){return ps(e.a,tn)},b:function(e){return ps(e.b,tn)},on:te,join:me},{},{onA:function(e){return cs(e.a,me)},onB:function(e){return cs(e.b,me)},joinA:function(e){return di.optional(cs(e.a,me))},joinB:function(e){return di.optional(cs(e.b,me))}}),joinCross:us.setTypes(zt.joinCross,function(e){return tn.forItem(e.join||me)},{a:function(e){return ps(e.a,tn)},b:function(e){return ps(e.b,tn)},join:me},{},{joinA:function(e){return cs(e.a,me)},joinB:function(e){return cs(e.b,me)}}),min:us.setTypes(zt.min,di.optional(xn),{list:ls,value:xn},{},Ts),max:us.setTypes(zt.max,di.optional(xn),{list:ls,value:xn},{},Ts),sum:us.setTypes(zt.sum,di.optional(xn),{list:ls,value:xn},{},Ts),avg:us.setTypes(zt.avg,di.optional(xn),{list:ls,value:xn},{},Ts),std:us.setTypes(zt.std,di.optional(xn),{list:ls,value:xn},{},Ts),variance:us.setTypes(zt.variance,di.optional(xn),{list:ls,value:xn},{},Ts),median:us.setTypes(zt.median,di.optional(xn),{list:ls,value:xn},{},Ts),bitand:us.setTypes(zt.bitand,xn,{list:ls,value:xn},{},Ts),bitor:us.setTypes(zt.bitor,xn,{list:ls,value:xn},{},Ts),bitxor:us.setTypes(zt.bitxor,xn,{list:ls,value:xn},{},Ts),isValid:us.setTypes(zt.isValid,te,{value:me}),isEmpty:us.setTypes(zt.isEmpty,te,{list:ls}),isNotEmpty:us.setTypes(zt.isNotEmpty,te,{list:ls}),isEqual:us.setTypes(zt.isEqual,te,{list:ls,test:ls,isEqual:te},{},ms),isNotEqual:us.setTypes(zt.isNotEqual,te,{list:ls,test:ls,isEqual:te},{},ms),isLess:us.setTypes(zt.isLess,te,{value:fs,test:fs,compare:xn},{},gs),isLessOrEqual:us.setTypes(zt.isLessOrEqual,te,{value:fs,test:fs,compare:xn},{},gs),isGreater:us.setTypes(zt.isGreater,te,{value:fs,test:fs,compare:xn},{},gs),isGreaterOrEqual:us.setTypes(zt.isGreaterOrEqual,te,{value:fs,test:fs,compare:xn},{},gs),asAny:us.setTypes(zt.asAny,me,{value:fs}),asBoolean:us.setTypes(zt.asBoolean,te,{value:fs}),asColor:us.setTypes(zt.asColor,ti,{value:fs}),asDate:us.setTypes(zt.asDate,go,{value:fs}),asList:us.setTypes(zt.asList,fs,{value:fs}),asMap:us.setTypes(zt.asMap,function(e){return _o.forItem(hs(e))},{value:fs}),asNumber:us.setTypes(zt.asNumber,xn,{value:fs}),asObject:us.setTypes(zt.asObject,vn,{value:fs}),asText:us.setTypes(zt.asText,Ve,{value:fs}),asTuple:us.setTypes(zt.asTuple,sn,{value:fs}),asSet:us.setTypes(zt.asSet,function(e){return fi.forItem(hs(e))},{value:fs})},xs=_o.operations,Os=function(e){return e instanceof _o?e:void 0},Es=function(e){return Os(e.map)||_o},Ss=function(e){return Os(e.map)?e.map.options.value:me},ws=function(e){return di.optional(Ss(e))},Ps=function(e){return Os(e.map)?e.map.options.key:Ve},_s={map:Es,key:Ps,value:Ss},Ms=function(e){return Os(e.value)||_o},Is=function(e){return Os(e.value)?e.value.options.value:me},Cs={key:function(e){return Os(e.value)?e.value.options.key:Ve},value:Is,test:Is},Ds={create:xs.setTypes(Ge.create,_o),createLike:xs.setTypes(Ge.createLike,Es,{map:Es}),createFor:xs.setTypes(Ge.createFor,function(e){return _o.forItem(e.value||me,e.key||Ve)},{value:function(e){return e.value||me}},{key:function(e){return e.key||Ve}}),maybe:xs.setTypes(Ge.maybe,function(e){return di.maybe(e.value,_o)},{value:me}),get:xs.setTypes(Ge.get,ws,{map:Es,key:Ps}),set:xs.setTypes(Ge.set,ws,{map:Es,key:Ps,value:Ss},{},{existingValue:Ss}),has:xs.setTypes(Ge.has,te,{map:Es,key:Ps}),delete:xs.setTypes(Ge.delete,te,{map:Es,key:Ps}),keys:xs.setTypes(Ge.keys,function(e){return tn.forItem(Ps(e))},{map:Es}),values:xs.setTypes(Ge.values,function(e){return tn.forItem(Ss(e))},{map:Es}),entries:xs.setTypes(Ge.entries,function(e){return di.object({keys:tn.forItem(Ps(e)),values:tn.forItem(Ss(e))})},{map:Es}),pairs:xs.setTypes(Ge.pairs,function(e){return tn.forItem(di.object({key:Ps(e),value:Ss(e)}))},{map:Es}),clear:xs.setTypes(Ge.clear,Es,{map:Es}),count:xs.setTypes(Ge.count,xn,{map:Es}),cmp:xs.setTypes(Ge.cmp,xn,{value:Ms,test:Ms,compare:xn},{},Cs),copy:xs.setTypes(Ge.copy,Es,{map:Es},{deepCopy:Ss,deepCopyKey:Ps},_s),map:xs.setTypes(Ge.map,function(e){return _o.forItem(e.transform||Ss(e),e.transformKey||Ps(e))},{map:Es},{transform:function(e){return e.transform||Ss(e)},transformKey:function(e){return e.transformKey||Ps(e)}},_s),toPlainObject:xs.setTypes(Ge.toPlainObject,me,{map:Es}),fromPlainObject:xs.setTypes(Ge.fromPlainObject,function(e){if(!(e.object instanceof vn))return _o;var t=E(e.object.options.props);return t.length>0?_o.forItem(di.mergeMany(t)):_o},{object:function(e){return e.object||vn}}),isValid:xs.setTypes(Ge.isValid,te,{value:me}),isEqual:xs.setTypes(Ge.isEqual,te,{value:Ms,test:Ms,isEqual:te},{},Cs),isNotEqual:xs.setTypes(Ge.isNotEqual,te,{value:Ms,test:Ms,isEqual:te},{},Cs),isLess:xs.setTypes(Ge.isLess,te,{value:Ms,test:Ms,compare:xn},{},Cs),isLessOrEqual:xs.setTypes(Ge.isLessOrEqual,te,{value:Ms,test:Ms,compare:xn},{},Cs),isGreater:xs.setTypes(Ge.isGreater,te,{value:Ms,test:Ms,compare:xn},{},Cs),isGreaterOrEqual:xs.setTypes(Ge.isGreaterOrEqual,te,{value:Ms,test:Ms,compare:xn},{},Cs),asAny:xs.setTypes(Ge.asAny,me,{value:_o}),asBoolean:xs.setTypes(Ge.asBoolean,te,{value:_o}),asColor:xs.setTypes(Ge.asColor,ti,{value:_o}),asDate:xs.setTypes(Ge.asDate,go,{value:_o}),asList:xs.setTypes(Ge.asList,function(e){return tn.forItem(Is(e))},{value:_o}),asMap:xs.setTypes(Ge.asMap,function(e){return e.value||_o},{value:_o}),asNumber:xs.setTypes(Ge.asNumber,function(e){return xn},{value:_o}),asObject:xs.setTypes(Ge.asObject,vn,{value:_o}),asText:xs.setTypes(Ge.asText,Ve,{value:_o}),asTuple:xs.setTypes(Ge.asTuple,function(e){return sn.forItem([e.value||_o])},{value:_o}),asSet:xs.setTypes(Ge.asSet,function(e){return fi.forItem(Is(e))},{value:_o})},ks=xn.operations,js=new Je({key:Ve.baseType.newInstance(),value:Ve.baseType.newInstance(),constants:new Map([["has the bits","contain"],["does not have the bits","notcontain"],["has some of the bits","overlap"],["has none of the bits","none"],["has the same bits","equal"],["does not have the same bits","not"],["has all bits in","subset"]])}),Ns={create:ks.setTypes(Ut.create,xn),pi:ks.setTypes(Ut.pi,xn),pi2:ks.setTypes(Ut.pi2,xn),piHalf:ks.setTypes(Ut.piHalf,xn),e:ks.setTypes(Ut.e,xn),sqrt2:ks.setTypes(Ut.sqrt2,xn),sqrt12:ks.setTypes(Ut.sqrt12,xn),ln2:ks.setTypes(Ut.ln2,xn),ln10:ks.setTypes(Ut.ln10,xn),log2e:ks.setTypes(Ut.log2e,xn),log10e:ks.setTypes(Ut.log10e,xn),add:ks.setTypes(Ut.add,xn,{value:xn,addend:xn}),sub:ks.setTypes(Ut.sub,xn,{value:xn,subtrahend:xn}),mul:ks.setTypes(Ut.mul,xn,{value:xn,multiplier:xn}),div:ks.setTypes(Ut.div,xn,{value:xn,divisor:xn}),mod:ks.setTypes(Ut.mod,xn,{value:xn,divisor:xn}),min:ks.setTypes(Ut.min,xn,{a:xn,b:xn}),max:ks.setTypes(Ut.max,xn,{a:xn,b:xn}),pow:ks.setTypes(Ut.pow,xn,{value:xn,exponent:xn}),atan2:ks.setTypes(Ut.atan2,xn,{x:xn,y:xn}),hypot:ks.setTypes(Ut.hypot,xn,{a:xn,b:xn}),choose:ks.setTypes(Ut.choose,xn,{n:xn,k:xn}),gcd:ks.setTypes(Ut.gcd,xn,{a:xn,b:xn}),bitAnd:ks.setTypes(Ut.bitAnd,xn,{a:xn,b:xn}),bitOr:ks.setTypes(Ut.bitOr,xn,{a:xn,b:xn}),bitXor:ks.setTypes(Ut.bitXor,xn,{a:xn,b:xn}),cmp:ks.setTypes(Ut.cmp,xn,{value:xn,test:xn}),maybe:ks.setTypes(Ut.maybe,function(e){return di.maybe(e.value,xn)},{value:me}),sqrt:ks.setTypes(Ut.sqrt,xn,{value:xn}),sq:ks.setTypes(Ut.sq,xn,{value:xn}),cbrt:ks.setTypes(Ut.cbrt,xn,{value:xn}),floor:ks.setTypes(Ut.floor,xn,{value:xn}),ceil:ks.setTypes(Ut.ceil,xn,{value:xn}),up:ks.setTypes(Ut.up,xn,{value:xn}),down:ks.setTypes(Ut.down,xn,{value:xn}),round:ks.setTypes(Ut.round,xn,{value:xn}),abs:ks.setTypes(Ut.abs,xn,{value:xn}),neg:ks.setTypes(Ut.neg,xn,{value:xn}),sign:ks.setTypes(Ut.sign,xn,{value:xn}),log:ks.setTypes(Ut.log,xn,{value:xn}),sin:ks.setTypes(Ut.sin,xn,{value:xn}),cos:ks.setTypes(Ut.cos,xn,{value:xn}),tan:ks.setTypes(Ut.tan,xn,{value:xn}),sinh:ks.setTypes(Ut.sinh,xn,{value:xn}),cosh:ks.setTypes(Ut.cosh,xn,{value:xn}),asin:ks.setTypes(Ut.asin,xn,{value:xn}),acos:ks.setTypes(Ut.acos,xn,{value:xn}),atan:ks.setTypes(Ut.atan,xn,{value:xn}),factorial:ks.setTypes(Ut.factorial,xn,{value:xn}),bitFlip:ks.setTypes(Ut.bitFlip,xn,{value:xn}),clamp:ks.setTypes(Ut.clamp,xn,{value:xn,min:xn,max:xn}),triangleHeight:ks.setTypes(Ut.triangleHeight,xn,{base:xn,side1:xn,side2:xn}),lerp:ks.setTypes(Ut.lerp,xn,{delta:xn,start:xn,end:xn}),rnd:ks.setTypes(Ut.rnd,xn,{},{min:xn,max:xn,whole:te,includeMax:te}),toBaseText:ks.setTypes(Ut.toBaseText,Ve,{value:xn},{base:xn,minDigits:xn}),toText:ks.setTypes(Ut.toText,Ve,{value:xn},{prefix:Ve,suffix:Ve,minPlaces:xn,maxPlaces:xn,useExponent:te,thousandSeparator:Ve}),toPercent:ks.setTypes(Ut.toPercent,Ve,{value:xn},{minPlaces:xn,maxPlaces:xn,thousandSeparator:Ve}),fromPercent:ks.setTypes(Ut.fromPercent,di.optional(xn),{value:Ve}),isValid:ks.setTypes(Ut.isValid,te,{value:me}),isZero:ks.setTypes(Ut.isZero,te,{value:xn},{epsilon:xn}),isEqual:ks.setTypes(Ut.isEqual,te,{value:xn,test:xn},{epsilon:xn}),isNotEqual:ks.setTypes(Ut.isNotEqual,te,{value:xn,test:xn},{epsilon:xn}),isLess:ks.setTypes(Ut.isLess,te,{value:xn,test:xn}),isLessOrEqual:ks.setTypes(Ut.isLessOrEqual,te,{value:xn,test:xn}),isGreater:ks.setTypes(Ut.isGreater,te,{value:xn,test:xn}),isGreaterOrEqual:ks.setTypes(Ut.isGreaterOrEqual,te,{value:xn,test:xn}),isBetween:ks.setTypes(Ut.isBetween,te,{value:xn,min:xn,max:xn},{minInclusive:te,maxInclusive:te}),isWhole:ks.setTypes(Ut.isWhole,te,{value:xn},{epsilon:xn}),isDecimal:ks.setTypes(Ut.isDecimal,te,{value:xn},{epsilon:xn}),isPositive:ks.setTypes(Ut.isPositive,te,{value:xn}),isNegative:ks.setTypes(Ut.isNegative,te,{value:xn}),isDivisible:ks.setTypes(Ut.isDivisible,te,{value:xn,by:xn},{epsilon:xn}),bitCompare:ks.setTypes(Ut.bitCompare,te,{value:xn,method:js,test:xn}),asAny:ks.setTypes(Ut.asAny,me,{value:xn}),asBoolean:ks.setTypes(Ut.asBoolean,te,{value:xn}),asColor:ks.setTypes(Ut.asColor,ti,{value:xn}),asDate:ks.setTypes(Ut.asDate,go,{value:xn}),asList:ks.setTypes(Ut.asList,function(e){return tn.forItem(e.value||xn)},{value:xn}),asMap:ks.setTypes(Ut.asMap,function(e){return _o.forItem(e.value||xn)},{value:xn}),asNumber:ks.setTypes(Ut.asNumber,function(e){return e.value||xn},{value:xn}),asObject:ks.setTypes(Ut.asObject,vn,{value:xn}),asText:ks.setTypes(Ut.asText,Ve,{value:xn}),asTuple:ks.setTypes(Ut.asTuple,function(e){return sn.forItem([e.value||xn])},{value:xn}),asSet:ks.setTypes(Ut.asSet,function(e){return fi.forItem(e.value||xn)},{value:xn})},As=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},Ls=vn.operations,Rs=function(e){return e.object||vn},qs={create:Ls.setTypes(fn.create,Rs),maybe:Ls.setTypes(fn.maybe,function(e){return di.maybe(e.value,vn)},{value:me}),has:Ls.setTypes(fn.has,te,{object:Rs,key:Ve}),get:Ls.setTypes(fn.get,me,{object:Rs,key:Ve}),set:Ls.setTypes(fn.set,Rs,{object:Rs,key:Ve,value:me},{},{existingValue:me}),delete:Ls.setTypes(fn.delete,me,{object:Rs,key:Ve}),cmp:Ls.setTypes(fn.cmp,xn,{value:vn,test:vn}),copy:Ls.setTypes(fn.copy,Rs,{object:Rs}),merge:Ls.setTypes(fn.merge,function(e){var t,n,r={};try{for(var o=As(["a","b","c","d","e"]),i=o.next();!i.done;i=o.next()){var s=e[i.value];if(s instanceof Ci&&(s=s.getType()),s instanceof vn){var a=s.options.props;for(var u in a){var p=a[u];r[u]=u in r&&p instanceof Io?di.mergeMany([p,r[u]]):p}}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return new vn({props:r})},{a:vn,b:vn},{c:vn,d:vn,e:vn}),isValid:Ls.setTypes(fn.isValid,te,{value:me}),isEqual:Ls.setTypes(fn.isEqual,te,{value:vn,test:vn}),isNotEqual:Ls.setTypes(fn.isNotEqual,te,{value:vn,test:vn}),isLess:Ls.setTypes(fn.isLess,te,{value:vn,test:vn}),isLessOrEqual:Ls.setTypes(fn.isLessOrEqual,te,{value:vn,test:vn}),isGreater:Ls.setTypes(fn.isGreater,te,{value:vn,test:vn}),isGreaterOrEqual:Ls.setTypes(fn.isGreaterOrEqual,te,{value:vn,test:vn}),asAny:Ls.setTypes(fn.asAny,me,{value:vn}),asBoolean:Ls.setTypes(fn.asBoolean,te,{value:vn}),asColor:Ls.setTypes(fn.asColor,ti,{value:vn}),asDate:Ls.setTypes(fn.asDate,go,{value:vn}),asList:Ls.setTypes(fn.asList,function(e){return tn.forItem(e.value||vn)},{value:vn}),asMap:Ls.setTypes(fn.asMap,function(e){return _o.forItem(e.value||vn)},{value:vn}),asNumber:Ls.setTypes(fn.asNumber,xn,{value:vn}),asObject:Ls.setTypes(fn.asObject,function(e){return e.value||vn},{value:vn}),asText:Ls.setTypes(fn.asText,Ve,{value:vn}),asTuple:Ls.setTypes(fn.asTuple,function(e){return sn.forItem([e.value||vn])},{value:vn}),asSet:Ls.setTypes(fn.asSet,function(e){return fi.forItem(e.value||vn)},{value:vn})},Vs=fi.operations,Fs=function(e){return e instanceof fi?e:void 0},Ys=function(e){return Fs(e.set)||fi},Bs=function(e){return Fs(e.set)?e.set.options.value:me},Gs={set:Ys,value:Bs},Ws=function(e){return Fs(e.value)||fi},Us=function(e){return Fs(e.value)?e.value.options.value:me},Hs={create:Vs.setTypes(ii.create,fi),createLike:Vs.setTypes(ii.createLike,Ys,{set:Ys}),createFor:Vs.setTypes(ii.createFor,function(e){return tn.forItem(e.value||me)},{value:function(e){return e.value||me}}),maybe:Vs.setTypes(ii.maybe,function(e){return di.maybe(e.value,fi)},{value:me}),add:Vs.setTypes(ii.add,Ys,{set:Ys,value:Bs}),has:Vs.setTypes(ii.has,te,{set:Ys,value:Bs}),delete:Vs.setTypes(ii.delete,te,{set:Ys,value:Bs}),values:Vs.setTypes(ii.values,function(e){return tn.forItem(Bs(e))},{set:Ys}),clear:Vs.setTypes(ii.clear,Ys,{set:Ys}),count:Vs.setTypes(ii.count,xn,{set:Ys}),cmp:Vs.setTypes(ii.cmp,xn,{value:Ws,test:Ws}),copy:Vs.setTypes(ii.copy,Ys,{set:Ys},{deepCopy:Bs},Gs),map:Vs.setTypes(ii.map,function(e){return fi.forItem(e.transform||Bs(e))},{set:Ys},{transform:function(e){return e.transform||Bs(e)}},Gs),isValid:Vs.setTypes(ii.isValid,te,{value:me}),isEqual:Vs.setTypes(ii.isEqual,te,{value:Ws,test:Ws}),isNotEqual:Vs.setTypes(ii.isNotEqual,te,{value:Ws,test:Ws}),isLess:Vs.setTypes(ii.isLess,te,{value:Ws,test:Ws}),isLessOrEqual:Vs.setTypes(ii.isLessOrEqual,te,{value:Ws,test:Ws}),isGreater:Vs.setTypes(ii.isGreater,te,{value:Ws,test:Ws}),isGreaterOrEqual:Vs.setTypes(ii.isGreaterOrEqual,te,{value:Ws,test:Ws}),asAny:Vs.setTypes(ii.asAny,me,{value:fi}),asBoolean:Vs.setTypes(ii.asBoolean,te,{value:fi}),asColor:Vs.setTypes(ii.asColor,ti,{value:fi}),asDate:Vs.setTypes(ii.asDate,go,{value:fi}),asList:Vs.setTypes(ii.asList,function(e){return tn.forItem(Us(e))},{value:fi}),asMap:Vs.setTypes(ii.asMap,function(e){return _o.forItem(Us(e),Us(e))},{value:fi}),asNumber:Vs.setTypes(ii.asNumber,function(e){return xn},{value:fi}),asObject:Vs.setTypes(ii.asObject,vn,{value:fi}),asText:Vs.setTypes(ii.asText,Ve,{value:fi}),asTuple:Vs.setTypes(ii.asTuple,function(e){return sn.forItem([e.value||fi])},{value:fi}),asSet:Vs.setTypes(ii.asSet,function(e){return e.value||fi},{value:fi})},Js=Ve.operations,Ks=tn.forItem(Ve),zs=di.object({index:xn,lastIndex:xn,input:Ve,groups:Ks}),Xs={create:Js.setTypes(Ae.create,Ve),uuid:Js.setTypes(Ae.uuid,Ve),maybe:Js.setTypes(Ae.maybe,function(e){return di.maybe(e.value,Ve)},{value:me}),append:Js.setTypes(Ae.append,Ve,{value:Ve,append:Ve}),prepend:Js.setTypes(Ae.prepend,Ve,{value:Ve,prepend:Ve}),lower:Js.setTypes(Ae.lower,Ve,{value:Ve}),upper:Js.setTypes(Ae.upper,Ve,{value:Ve}),char:Js.setTypes(Ae.char,Ve,{value:Ve,index:xn},{outside:Ve}),replace:Js.setTypes(Ae.replace,Ve,{value:Ve,find:Ve,replace:Ve}),repeat:Js.setTypes(Ae.repeat,Ve,{value:Ve,times:xn}),split:Js.setTypes(Ae.split,Ks,{value:Ve,by:Ve},{limit:xn}),chars:Js.setTypes(Ae.chars,Ks,{value:Ve}),sub:Js.setTypes(Ae.sub,Ve,{value:Ve},{start:xn,end:xn}),indexOf:Js.setTypes(Ae.indexOf,xn,{value:Ve,search:Ve},{start:xn}),lastIndexOf:Js.setTypes(Ae.lastIndexOf,xn,{value:Ve,search:Ve},{start:xn}),trim:Js.setTypes(Ae.trim,Ve,{value:Ve},{start:te,end:te}),startsWith:Js.setTypes(Ae.startsWith,te,{value:Ve,test:Ve}),endsWith:Js.setTypes(Ae.endsWith,te,{value:Ve,test:Ve}),soundex:Js.setTypes(Ae.soundex,Ve,{value:Ve},{max:xn,min:xn}),metaphone:Js.setTypes(Ae.metaphone,Ve,{value:Ve}),distance:Js.setTypes(Ae.distance,xn,{value:Ve,test:Ve}),length:Js.setTypes(Ae.length,xn,{value:Ve}),compare:Js.setTypes(Ae.compare,xn,{value:Ve,test:Ve},{ignoreCase:te}),like:Js.setTypes(Ae.like,te,{value:Ve,pattern:Ve},{ignoreCase:te}),pad:Js.setTypes(Ae.pad,Ve,{value:Ve,padding:Ve,min:xn},{max:xn,append:te}),regexTest:Js.setTypes(Ae.regexTest,te,{value:Ve,regex:Ve},{ignoreCase:te,multiline:te}),regexSplit:Js.setTypes(Ae.regexSplit,Ks,{value:Ve,regex:Ve},{limit:xn,ignoreCase:te,multiline:te}),regexMatch:Js.setTypes(Ae.regexMatch,Ks,{value:Ve,regex:Ve},{ignoreCase:te,multiline:te}),regexMatchAll:Js.setTypes(Ae.regexMatchAll,tn.forItem(zs),{value:Ve,regex:Ve},{ignoreCase:te,multiline:te}),regexReplace:Js.setTypes(Ae.regexReplace,Ve,{value:Ve,regex:Ve,replacement:Ve},{all:te,ignoreCase:te,multiline:te}),regexReplaceDynamic:Js.setTypes(Ae.regexReplaceDynamic,Ve,{value:Ve,regex:Ve,replace:Ve},{all:te,ignoreCase:te,multiline:te},{match:zs}),regexIndexOf:Js.setTypes(Ae.regexIndexOf,xn,{value:Ve,regex:Ve},{ignoreCase:te,multiline:te}),base64:Js.setTypes(Ae.base64,Ve,{value:Ve}),unbase64:Js.setTypes(Ae.unbase64,Ve,{value:Ve}),encodeURI:Js.setTypes(Ae.encodeURI,Ve,{value:Ve}),decodeURI:Js.setTypes(Ae.decodeURI,Ve,{value:Ve}),encodeURIComponent:Js.setTypes(Ae.encodeURIComponent,Ve,{value:Ve}),decodeURIComponent:Js.setTypes(Ae.decodeURIComponent,Ve,{value:Ve}),md5:Js.setTypes(Ae.md5,Ve,{value:Ve}),encrypt:Js.setTypes(Ae.encrypt,Ve,{value:Ve,secret:Ve}),decrypt:Js.setTypes(Ae.decrypt,Ve,{value:Ve,secret:Ve}),toNumber:Js.setTypes(Ae.toNumber,xn,{value:Ve},{invalidValue:xn}),isValid:Js.setTypes(Ae.isValid,te,{value:me}),isEmpty:Js.setTypes(Ae.isEmpty,te,{value:Ve}),isNotEmpty:Js.setTypes(Ae.isNotEmpty,te,{value:Ve}),isEqual:Js.setTypes(Ae.isEqual,te,{a:Ve,b:Ve},{ignoreCase:te}),isNotEqual:Js.setTypes(Ae.isNotEqual,te,{a:Ve,b:Ve},{ignoreCase:te}),isLess:Js.setTypes(Ae.isLess,te,{value:Ve,test:Ve},{ignoreCase:te}),isLessOrEqual:Js.setTypes(Ae.isLessOrEqual,te,{value:Ve,test:Ve},{ignoreCase:te}),isGreater:Js.setTypes(Ae.isGreater,te,{value:Ve,test:Ve},{ignoreCase:te}),isGreaterOrEqual:Js.setTypes(Ae.isGreaterOrEqual,te,{value:Ve,test:Ve},{ignoreCase:te}),isLower:Js.setTypes(Ae.isLower,te,{value:Ve}),isUpper:Js.setTypes(Ae.isUpper,te,{value:Ve}),isUuid:Js.setTypes(Ae.isUuid,te,{value:Ve}),asAny:Js.setTypes(Ae.asAny,me,{value:Ve}),asBoolean:Js.setTypes(Ae.asBoolean,te,{value:Ve}),asColor:Js.setTypes(Ae.asColor,ti,{value:Ve}),asDate:Js.setTypes(Ae.asDate,go,{value:Ve}),asList:Js.setTypes(Ae.asList,function(e){return tn.forItem(e.value||Ve)},{value:Ve}),asMap:Js.setTypes(Ae.asMap,function(e){return _o.forItem(e.value||Ve)},{value:Ve}),asNumber:Js.setTypes(Ae.asNumber,xn,{value:Ve}),asObject:Js.setTypes(Ae.asObject,vn,{value:Ve}),asText:Js.setTypes(Ae.asText,function(e){return e.value||Ve},{value:Ve}),asTuple:Js.setTypes(Ae.asTuple,function(e){return sn.forItem([e.value||Ve])},{value:Ve}),asSet:Js.setTypes(Ae.asSet,function(e){return fi.forItem(e.value||Ve)},{value:Ve})},$s=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},Qs=sn.operations,Zs={create:Qs.setTypes(Yt.create,sn),maybe:Qs.setTypes(Yt.maybe,function(e){return di.maybe(e.value,sn)},{value:me}),cmp:Qs.setTypes(Yt.cmp,xn,{value:sn,test:sn}),copy:Qs.setTypes(Yt.copy,sn,{value:sn}),build:Qs.setTypes(Yt.build,function(e){var t,n,r=[],o=!1;try{for(var i=$s(["a","b","c","d","e"]),s=i.next();!s.done;s=i.next()){var a=e[s.value];a&&(a instanceof sn?r=r.concat(a.options):a instanceof tn?(o=!0,r.push(a.options.item)):r.push(a))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o?tn.forItem(di.mergeMany(r)):new sn(r)},{a:me,b:me},{c:me,d:me,e:me}),get:Qs.setTypes(Yt.get,me,{value:sn,index:xn}),set:Qs.setTypes(Yt.set,me,{value:sn,index:xn,element:me}),isValid:Qs.setTypes(Yt.isValid,te,{value:me}),isEqual:Qs.setTypes(Yt.isEqual,te,{value:sn,test:sn}),isNotEqual:Qs.setTypes(Yt.isNotEqual,te,{value:sn,test:sn}),isLess:Qs.setTypes(Yt.isLess,te,{value:sn,test:sn}),isLessOrEqual:Qs.setTypes(Yt.isLessOrEqual,te,{value:sn,test:sn}),isGreater:Qs.setTypes(Yt.isGreater,te,{value:sn,test:sn}),isGreaterOrEqual:Qs.setTypes(Yt.isGreaterOrEqual,te,{value:sn,test:sn}),asAny:Qs.setTypes(Yt.asAny,me,{value:sn}),asBoolean:Qs.setTypes(Yt.asBoolean,te,{value:sn}),asColor:Qs.setTypes(Yt.asColor,ti,{value:sn}),asDate:Qs.setTypes(Yt.asDate,go,{value:sn}),asList:Qs.setTypes(Yt.asList,function(e){return tn.forItem(e.value||sn)},{value:sn}),asMap:Qs.setTypes(Yt.asMap,function(e){return _o.forItem(e.value||sn)},{value:sn}),asNumber:Qs.setTypes(Yt.asNumber,xn,{value:sn}),asObject:Qs.setTypes(Yt.asObject,vn,{value:sn}),asText:Qs.setTypes(Yt.asText,Ve,{value:sn}),asTuple:Qs.setTypes(Yt.asTuple,function(e){return e.value||sn},{value:sn}),asSet:Qs.setTypes(Yt.asSet,function(e){return fi.forItem(e.value||sn)},{value:sn})},ea=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},ta=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},na=function(){function e(e,t){void 0===t&&(t={}),this.cached={},this.sections=[],this.add(e),this.escapes=t}return e.prototype.add=function(e,t){if(s(e))this.getSection(e.length).formats[e]=t;else for(var n in e)this.getSection(n.length).formats[n]=e[n];return this},e.prototype.getSection=function(e){var t,n,r=this.sections.length-e,o=this.sections[r];if(o&&o.size===e)return o;try{for(var i=ea(this.sections),s=i.next();!s.done;s=i.next()){var a=s.value;if(a.size===e)return a}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}var u={size:e,formats:{}};return this.sections.push(u),this.sortBySize(),u},e.prototype.sortBySize=function(){this.sections.sort(function(e,t){return t.size-e.size})},e.prototype.getEscaped=function(e,t){var n=e.charAt(t),r=this.escapes[n];if(!r)return!1;var o=r.start,i=r.end,s=r.startEscape,a=r.endEscape;if(e.substring(t,t+o.length)!==o)return!1;var u=t-s.indexOf(o);if(e.substring(u,u+s.length)===s)return!1;t+=o.length;var p=a.indexOf(i),c=e.indexOf(i,t),l=e.substring(t,c);for(t=c-p;-1!==c&&e.substring(t,t+a.length)===a;)l=l.substring(0,l.length-p),l+=i,t+=a.length,c=e.indexOf(i,t),l+=e.substring(t,c),t=c-p;return-1!==c&&[l,c+i.length]},e.prototype.getFormatter=function(e,t){if(void 0===t&&(t=!1),e in this.cached)return this.cached[e];for(var n,r=this.sections,o=[],i="",s=function(t){var s=a.getEscaped(e,t);if(!1!==s){var u=ta(s,2),p=u[0],c=u[1];return i+=p,n=t=c-1,"continue"}for(var l=!1,f=0;f<r.length&&!l;f++){var y=r[f],d=e.substring(t,t+y.size);if(d.length===y.size){var h=y.formats[d];h&&(o.push(h),t+=y.size-1,l=!0)}}if(l){if(i){var v=i;o.splice(o.length-1,0,function(){return v}),i=""}}else i+=e.charAt(t);n=t},a=this,u=0;u<e.length;u++)s(u),u=n;i&&o.push(function(){return i});var p=function(e){var t,n,r="";try{for(var i=ea(o),s=i.next();!s.done;s=i.next()){r+=(0,s.value)(e)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r};return t&&(this.cached[e]=p),p},e.prototype.format=function(e,t,n){return void 0===n&&(n=!1),this.getFormatter(e,n)(t)},e}(),ra=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},oa=new na({M:function(e){return ra(e,1)[0].getMonth()+1+""},Mo:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(n.getMonth()+1)},MM:function(e){return N(ra(e,1)[0].getMonth()+1,2)},MMm:function(e){var t=ra(e,2),n=t[0];return t[1].months[3][n.getMonth()]},MMM:function(e){var t=ra(e,2),n=t[0];return t[1].months[2][n.getMonth()]},MMMm:function(e){var t=ra(e,2),n=t[0];return t[1].months[1][n.getMonth()]},MMMM:function(e){var t=ra(e,2),n=t[0];return t[1].months[0][n.getMonth()]},Q:function(e){return Cr(ra(e,1)[0])+1+""},Qo:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(Cr(n)+1)},D:function(e){return ra(e,1)[0].getDate()+""},Do:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(n.getDate())},DD:function(e){return N(ra(e,1)[0].getDate(),2)},DDD:function(e){return xr(ra(e,1)[0])+""},DDDo:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(xr(n))},DDDD:function(e){return N(xr(ra(e,1)[0]),3)},d:function(e){return ra(e,1)[0].getDay()+""},do:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(n.getDay())},dd:function(e){var t=ra(e,2),n=t[0];return t[1].weekdays[3][n.getDay()]},ddd:function(e){var t=ra(e,2),n=t[0];return t[1].weekdays[2][n.getDay()]},dddd:function(e){var t=ra(e,2),n=t[0];return t[1].weekdays[0][n.getDay()]},e:function(e){return br(ra(e,1)[0])+""},E:function(e){return br(ra(e,1)[0])+1+""},eo:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(br(n))},Eo:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(br(n)+1)},w:function(e){return sr(ra(e,1)[0])+""},wo:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(sr(n))},ww:function(e){return N(sr(ra(e,1)[0]),2)},W:function(e){return ir(ra(e,1)[0])+""},Wo:function(e){var t=ra(e,2),n=t[0];return t[1].suffix(ir(n))},WW:function(e){return N(ir(ra(e,1)[0]),2)},Y:function(e){return ra(e,1)[0].getFullYear()+""},YY:function(e){return N(ra(e,1)[0].getFullYear()%100,2)},YYYY:function(e){return N(ra(e,1)[0].getFullYear(),4,10)},gg:function(e){return N(ra(e,1)[0].getFullYear()%100,2)},gggg:function(e){return N(ra(e,1)[0].getFullYear(),4,10)},GG:function(e){return N(ra(e,1)[0].getFullYear()%100,2)},GGGG:function(e){return N(ra(e,1)[0].getFullYear(),4,10)},a:function(e){var t=ra(e,2),n=t[0],r=t[1];return n.getHours()<12?r.am:r.pm},A:function(e){var t=ra(e,2),n=t[0],r=t[1];return n.getHours()<12?r.am.toUpperCase():r.pm.toUpperCase()},H:function(e){return ra(e,1)[0].getHours()+""},HH:function(e){return N(ra(e,1)[0].getHours(),2)},h:function(e){return(ra(e,1)[0].getHours()%12||12)+""},hh:function(e){return N(ra(e,1)[0].getHours()%12||12,2)},k:function(e){return ra(e,1)[0].getHours()+1+""},kk:function(e){return N(ra(e,1)[0].getHours()+1,2)},m:function(e){return ra(e,1)[0].getMinutes()+""},mm:function(e){return N(ra(e,1)[0].getMinutes(),2)},s:function(e){return ra(e,1)[0].getSeconds()+""},ss:function(e){return N(ra(e,1)[0].getSeconds(),2)},S:function(e){return N(ra(e,1)[0].getMilliseconds(),3,1)},SS:function(e){return N(ra(e,1)[0].getMilliseconds(),3,2)},SSS:function(e){return N(ra(e,1)[0].getMilliseconds(),3)},SSSS:function(e){return N(ra(e,1)[0].getMilliseconds(),3)+"0"},SSSSS:function(e){return N(ra(e,1)[0].getMilliseconds(),3)+"00"},SSSSSS:function(e){return N(ra(e,1)[0].getMilliseconds(),3)+"000"},SSSSSSS:function(e){return N(ra(e,1)[0].getMilliseconds(),3)+"0000"},SSSSSSSS:function(e){return N(ra(e,1)[0].getMilliseconds(),3)+"00000"},SSSSSSSSS:function(e){return N(ra(e,1)[0].getMilliseconds(),3)+"000000"},z:function(e){return ra(e,1)[0].toLocaleTimeString("en-us",{timeZoneName:"short"}).split(" ")[2]},zz:function(e){return ra(e,1)[0].toLocaleTimeString("en-us",{timeZoneName:"long"}).split(" ")[2]},Z:function(e){return sa(ra(e,1)[0],":")},ZZ:function(e){return sa(ra(e,1)[0],"")},X:function(e){var t=ra(e,1)[0];return Math.floor(t.valueOf()/1e3)+""},x:function(e){return ra(e,1)[0].valueOf()+""},LT:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatLT,[n,r])},LTS:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatLTS,[n,r])},L:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatL,[n,r])},l:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatl,[n,r])},LL:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatLL,[n,r])},ll:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatll,[n,r])},LLL:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatLLL,[n,r])},lll:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatlll,[n,r])},LLLL:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatLLLL,[n,r])},llll:function(e){var t=ra(e,2),n=t[0],r=t[1];return ia.format(r.formatllll,[n,r])}},{"[":{start:"[",startEscape:"\\[",end:"]",endEscape:"\\]"},"'":{start:"'",startEscape:"''",end:"'",endEscape:"''"}}),ia=oa;function sa(e,t){var n=Or(e),r=Math.floor(Math.abs(n)/100),o=Math.abs(n)%100;return(n<0?"-":"+")+N(r,2)+t+N(o,2)}n.d(t,"isNumber",function(){return i}),n.d(t,"isString",function(){return s}),n.d(t,"isArray",function(){return a}),n.d(t,"isDate",function(){return u}),n.d(t,"isMap",function(){return p}),n.d(t,"isSet",function(){return c}),n.d(t,"isBoolean",function(){return l}),n.d(t,"isFunction",function(){return f}),n.d(t,"isObject",function(){return y}),n.d(t,"isUndefined",function(){return d}),n.d(t,"isSameClass",function(){return h}),n.d(t,"isWhole",function(){return v}),n.d(t,"isEmpty",function(){return m}),n.d(t,"clamp",function(){return g}),n.d(t,"toMap",function(){return T}),n.d(t,"reverseMap",function(){return b}),n.d(t,"objectMap",function(){return x}),n.d(t,"objectEach",function(){return O}),n.d(t,"objectValues",function(){return E}),n.d(t,"objectReduce",function(){return S}),n.d(t,"objectFromProps",function(){return w}),n.d(t,"objectToArray",function(){return P}),n.d(t,"getCompare",function(){return _}),n.d(t,"coalesce",function(){return M}),n.d(t,"COMPARE_TYPE_ORDER",function(){return I}),n.d(t,"compare",function(){return C}),n.d(t,"copiers",function(){return D}),n.d(t,"addCopier",function(){return k}),n.d(t,"copy",function(){return j}),n.d(t,"padNumber",function(){return N}),n.d(t,"pad",function(){return A}),n.d(t,"toString",function(){return L}),n.d(t,"Definitions",function(){return Ai}),n.d(t,"EntityKeyType",function(){return ai}),n.d(t,"EntityStoragePrimaryType",function(){return ui}),n.d(t,"Entity",function(){return bi}),n.d(t,"Expression",function(){return W}),n.d(t,"Exprs",function(){return Tn}),n.d(t,"Func",function(){return vi}),n.d(t,"isOperationTypeFunction",function(){return U}),n.d(t,"Operations",function(){return J}),n.d(t,"Computeds",function(){return K}),n.d(t,"Program",function(){return Si}),n.d(t,"RelationKind",function(){return gi}),n.d(t,"RelationCascade",function(){return Ti}),n.d(t,"Relation",function(){return Oi}),n.d(t,"Runtime",function(){return Li}),n.d(t,"Type",function(){return B}),n.d(t,"Types",function(){return di}),n.d(t,"TraverseRemoveNoop",function(){return V}),n.d(t,"TraverseReplaceNoop",function(){return F}),n.d(t,"Traverser",function(){return Y}),n.d(t,"ValidationSeverity",function(){return R}),n.d(t,"ValidationType",function(){return q}),n.d(t,"ID",function(){return z}),n.d(t,"EntityType",function(){return Ci}),n.d(t,"AnyType",function(){return me}),n.d(t,"BooleanType",function(){return te}),n.d(t,"ColorType",function(){return ti}),n.d(t,"DateType",function(){return go}),n.d(t,"EnumType",function(){return Je}),n.d(t,"ListType",function(){return tn}),n.d(t,"ManyType",function(){return Eo}),n.d(t,"MapType",function(){return _o}),n.d(t,"NotType",function(){return ko}),n.d(t,"NullType",function(){return fe}),n.d(t,"NumberType",function(){return xn}),n.d(t,"ObjectType",function(){return vn}),n.d(t,"OptionalType",function(){return Io}),n.d(t,"SetType",function(){return fi}),n.d(t,"TextType",function(){return Ve}),n.d(t,"TupleType",function(){return sn}),n.d(t,"AndExpression",function(){return ie}),n.d(t,"ChainExpression",function(){return _e}),n.d(t,"CommentExpression",function(){return Ie}),n.d(t,"ComputedExpression",function(){return De}),n.d(t,"ConstantExpression",function(){return ze}),n.d(t,"DefineExpression",function(){return be}),n.d(t,"DoExpression",function(){return Se}),n.d(t,"ForExpression",function(){return Ze}),n.d(t,"GetExpression",function(){return nt}),n.d(t,"GetTypeExpression",function(){return ot}),n.d(t,"GetRelationExpression",function(){return st}),n.d(t,"IfExpression",function(){return pt}),n.d(t,"InvokeExpression",function(){return lt}),n.d(t,"NoExpression",function(){return de}),n.d(t,"NotExpression",function(){return re}),n.d(t,"ObjectExpression",function(){return gn}),n.d(t,"OperationExpression",function(){return vt}),n.d(t,"OrExpression",function(){return yt}),n.d(t,"ReturnExpression",function(){return gt}),n.d(t,"SetExpression",function(){return xt}),n.d(t,"SubExpression",function(){return St}),n.d(t,"SwitchExpression",function(){return _t}),n.d(t,"TemplateExpression",function(){return It}),n.d(t,"TupleExpression",function(){return un}),n.d(t,"UpdateExpression",function(){return jt}),n.d(t,"WhileExpression",function(){return Rt}),n.d(t,"defs",function(){return Ri}),n.d(t,"EntityOperations",function(){return wi}),n.d(t,"EntityComputeds",function(){return Pi}),n.d(t,"EntityOps",function(){return Mi}),n.d(t,"AnyOperations",function(){return se}),n.d(t,"AnyComputeds",function(){return ae}),n.d(t,"AnyOps",function(){return ce}),n.d(t,"BooleanOperations",function(){return X}),n.d(t,"BooleanComputeds",function(){return $}),n.d(t,"BooleanOps",function(){return Z}),n.d(t,"ColorOperations",function(){return jo}),n.d(t,"ColorComputeds",function(){return No}),n.d(t,"ColorOps",function(){return Lo}),n.d(t,"DateOperations",function(){return lo}),n.d(t,"DateComputeds",function(){return fo}),n.d(t,"DateOps",function(){return ho}),n.d(t,"ListOperations",function(){return Ht}),n.d(t,"ListComputeds",function(){return Jt}),n.d(t,"ListOps",function(){return zt}),n.d(t,"MapOperations",function(){return Fe}),n.d(t,"MapComputeds",function(){return Ye}),n.d(t,"MapOps",function(){return Ge}),n.d(t,"NumberOperations",function(){return Bt}),n.d(t,"NumberComputeds",function(){return Gt}),n.d(t,"NumberOps",function(){return Ut}),n.d(t,"ObjectOperations",function(){return pn}),n.d(t,"ObjectComputeds",function(){return cn}),n.d(t,"ObjectOps",function(){return fn}),n.d(t,"SetOperations",function(){return ni}),n.d(t,"SetComputeds",function(){return ri}),n.d(t,"SetOps",function(){return ii}),n.d(t,"TextOperations",function(){return ke}),n.d(t,"TextComputeds",function(){return je}),n.d(t,"TextOps",function(){return Ae}),n.d(t,"TupleOperations",function(){return qt}),n.d(t,"TupleComputeds",function(){return Vt}),n.d(t,"TupleOps",function(){return Yt}),n.d(t,"EntityOpsTypes",function(){return Ui}),n.d(t,"AnyOpsTypes",function(){return Ji}),n.d(t,"BooleanOpsTypes",function(){return zi}),n.d(t,"ColorComponentEnum",function(){return $i}),n.d(t,"ColorOrNumber",function(){return Qi}),n.d(t,"ColorFormats",function(){return Zi}),n.d(t,"ColorNames",function(){return es}),n.d(t,"ColorBlendModes",function(){return ts}),n.d(t,"ColorOpsTypes",function(){return ns}),n.d(t,"DateOpsTypes",function(){return as}),n.d(t,"ListOpsTypes",function(){return bs}),n.d(t,"MapOpsTypes",function(){return Ds}),n.d(t,"NumberOpsTypes",function(){return Ns}),n.d(t,"ObjectOpsTypes",function(){return qs}),n.d(t,"SetOpsTypes",function(){return Hs}),n.d(t,"TextOpsTypes",function(){return Xs}),n.d(t,"TupleOpsTypes",function(){return Zs}),n.d(t,"currentLocale",function(){return En}),n.d(t,"COMPONENT_MIN",function(){return Ro}),n.d(t,"COMPONENT_MAX",function(){return qo}),n.d(t,"isColor",function(){return Vo}),n.d(t,"clampComponent",function(){return Fo}),n.d(t,"ColorSpace",function(){return Yo}),n.d(t,"isColorHSL",function(){return Jo}),n.d(t,"ColorSpaceHSL",function(){return Ko}),n.d(t,"ColorSpaceRGB",function(){return Go}),n.d(t,"MILLIS_IN_SECOND",function(){return Sn}),n.d(t,"SECONDS_IN_MINUTE",function(){return 60}),n.d(t,"HOURS_IN_DAY",function(){return 24}),n.d(t,"DAYS_IN_WEEK",function(){return wn}),n.d(t,"MILLIS_IN_MINUTE",function(){return Pn}),n.d(t,"MILLIS_IN_HOUR",function(){return _n}),n.d(t,"MILLIS_IN_DAY",function(){return Mn}),n.d(t,"MONTHS_IN_QUARTER",function(){return In}),n.d(t,"MONTHS_IN_YEAR",function(){return Cn}),n.d(t,"DAY_MIN",function(){return Dn}),n.d(t,"DAY_MAX",function(){return kn}),n.d(t,"HOUR_MAX",function(){return jn}),n.d(t,"MINUTE_MAX",function(){return Nn}),n.d(t,"SECOND_MAX",function(){return An}),n.d(t,"MILLIS_MAX",function(){return Ln}),n.d(t,"WEEKDAY_MAX",function(){return Rn}),n.d(t,"DateFormat",function(){return oa}),n.d(t,"adjusters",function(){return Yn}),n.d(t,"getters",function(){return Bn}),n.d(t,"setters",function(){return Gn}),n.d(t,"startOf",function(){return Wn}),n.d(t,"endOf",function(){return Un}),n.d(t,"add",function(){return Hn}),n.d(t,"diff",function(){return Jn}),n.d(t,"mutate",function(){return Kn}),n.d(t,"compareDates",function(){return zn}),n.d(t,"DateParsers",function(){return Xn}),n.d(t,"parse",function(){return $n}),n.d(t,"getTimeIdentifier",function(){return Qn}),n.d(t,"getDayIdentifier",function(){return Zn}),n.d(t,"getWeekIdentifier",function(){return er}),n.d(t,"getMonthIdentifier",function(){return tr}),n.d(t,"getQuarterIdentifier",function(){return nr}),n.d(t,"getLastDayOfMonth",function(){return rr}),n.d(t,"getLastWeekspanOfYear",function(){return or}),n.d(t,"getWeekOfYearISO",function(){return ir}),n.d(t,"getWeekOfYear",function(){return sr}),n.d(t,"getWeekspanOfYear",function(){return ar}),n.d(t,"getFullWeekOfYear",function(){return ur}),n.d(t,"getWeeksInYear",function(){return pr}),n.d(t,"getLastFullWeekOfYear",function(){return cr}),n.d(t,"getWeekspanOfMonth",function(){return lr}),n.d(t,"getLastWeekspanOfMonth",function(){return fr}),n.d(t,"getFullWeekOfMonth",function(){return yr}),n.d(t,"getLastFullWeekOfMonth",function(){return dr}),n.d(t,"getWeekOfMonthISO",function(){return hr}),n.d(t,"getWeekOfMonth",function(){return vr}),n.d(t,"getWeekISO",function(){return mr}),n.d(t,"getWeek",function(){return gr}),n.d(t,"getFullWeekOf",function(){return Tr}),n.d(t,"getDayOfWeek",function(){return br}),n.d(t,"getDayOfYear",function(){return xr}),n.d(t,"getDateOffset",function(){return Or}),n.d(t,"isDaylightSavingTime",function(){return Er}),n.d(t,"isLeapYear",function(){return Sr}),n.d(t,"getDaysInYear",function(){return wr}),n.d(t,"daysInMonth",function(){return Pr}),n.d(t,"getDaysInMonth",function(){return _r}),n.d(t,"getAbsoluteTimestamp",function(){return Mr}),n.d(t,"getTimezoneOffsetInMilliseconds",function(){return Ir}),n.d(t,"getQuarter",function(){return Cr}),n.d(t,"startOfSecond",function(){return Dr}),n.d(t,"startOfMinute",function(){return kr}),n.d(t,"startOfHour",function(){return jr}),n.d(t,"startOfDay",function(){return Nr}),n.d(t,"startOfWeek",function(){return Ar}),n.d(t,"startOfMonth",function(){return Lr}),n.d(t,"startOfQuarter",function(){return Rr}),n.d(t,"startOfYear",function(){return qr}),n.d(t,"endOfSecond",function(){return Vr}),n.d(t,"endOfMinute",function(){return Fr}),n.d(t,"endOfHour",function(){return Yr}),n.d(t,"endOfDay",function(){return Br}),n.d(t,"endOfWeek",function(){return Gr}),n.d(t,"endOfMonth",function(){return Wr}),n.d(t,"endOfQuarter",function(){return Ur}),n.d(t,"endOfYear",function(){return Hr}),n.d(t,"addMilliseconds",function(){return Jr}),n.d(t,"addSeconds",function(){return Kr}),n.d(t,"addMinutes",function(){return zr}),n.d(t,"addHours",function(){return Xr}),n.d(t,"addDays",function(){return $r}),n.d(t,"addWeeks",function(){return Qr}),n.d(t,"addMonths",function(){return Zr}),n.d(t,"addQuarters",function(){return eo}),n.d(t,"addYears",function(){return to}),n.d(t,"diffMilliseconds",function(){return no}),n.d(t,"diffSeconds",function(){return ro}),n.d(t,"diffMinutes",function(){return oo}),n.d(t,"diffHours",function(){return io}),n.d(t,"diffDays",function(){return so}),n.d(t,"diffWeeks",function(){return ao}),n.d(t,"diffMonths",function(){return uo}),n.d(t,"diffQuarters",function(){return po}),n.d(t,"diffYears",function(){return co}),n.d(t,"Format",function(){return na})}])});
//# sourceMappingURL=expangine-runtime.js.map